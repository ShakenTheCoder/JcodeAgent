{
  "state": {
    "name": "JcodeAgent",
    "description": "Python project",
    "tech_stack": [
      "Python"
    ],
    "output_dir": "/Users/ioan_andrei/Desktop/JcodeAgent",
    "plan": null,
    "files": {
      "BEGINNER_GUIDE.md": "# Complete Beginner's Guide to JCode\n\n> **Never coded before? No problem!** This guide will walk you through everything you need to get JCode running on your computer, step by step.\n\n## What is JCode?\n\nJCode is like having a team of AI programmers on your computer. You describe what you want to build in plain English, and it creates the code for you \u2014 completely free, completely private, running on your own machine.\n\n**No coding knowledge required. No cloud services. No subscriptions.**\n\n---\n\n## \u26a1 One-Command Install (Recommended)\n\nThe fastest way to get started \u2014 **one line installs everything**:\n\n### Mac / Linux\n\nOpen Terminal and paste:\n\n```bash\ncurl -fsSL https://raw.githubusercontent.com/ShakenTheCoder/JcodeAgent/main/install.sh | bash\n```\n\n### Windows\n\nOpen PowerShell (right-click Start \u2192 \"Windows PowerShell\") and paste:\n\n```powershell\niwr -useb https://raw.githubusercontent.com/ShakenTheCoder/JcodeAgent/main/install.ps1 | iex\n```\n\n**That's it!** The installer automatically:\n- \u2705 Installs Python (if you don't have it)\n- \u2705 Installs Ollama (if you don't have it)\n- \u2705 Downloads the AI models (if you don't have them)\n- \u2705 Downloads JCode\n- \u2705 Sets everything up and adds `jcode` to your PATH\n\nAfter it finishes, just type `jcode` and start building!\n\n> **Want to understand what's happening?** The manual steps below explain everything the installer does automatically.\n\n---\n\n## Manual Install (Step by Step)\n\nIf you prefer to install things yourself, or the one-liner didn't work, follow these steps:\n\n---\n\n## Step 1: Install Python (The Language JCode Speaks)\n\n### For Mac Users\n\n1. **Open Terminal** (it's an app on your Mac):\n   - Press `Command + Space`\n   - Type \"Terminal\"\n   - Press Enter\n\n2. **Install Homebrew** (a tool that makes installing things easier):\n   ```bash\n   /bin/bash -c \"$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)\"\n   ```\n   - Paste that line into Terminal and press Enter\n   - It will ask for your password (the same one you use to unlock your Mac)\n   - Wait 5-10 minutes for it to finish\n\n3. **Install Python**:\n   ```bash\n   brew install python@3.12\n   ```\n   - Wait for it to finish (2-3 minutes)\n\n4. **Verify Python is installed**:\n   ```bash\n   python3 --version\n   ```\n   - You should see something like `Python 3.12.x`\n\n### For Windows Users\n\n1. **Download Python**:\n   - Go to https://www.python.org/downloads/\n   - Click the big yellow button \"Download Python 3.12.x\"\n   - Run the downloaded file\n\n2. **During installation**:\n   - \u2705 **IMPORTANT**: Check the box that says \"Add Python to PATH\"\n   - Click \"Install Now\"\n   - Wait for it to finish\n\n3. **Verify Python is installed**:\n   - Press `Windows Key + R`\n   - Type `cmd` and press Enter\n   - Type: `python --version`\n   - You should see `Python 3.12.x`\n\n### For Linux Users\n\n```bash\nsudo apt update\nsudo apt install python3.12 python3.12-venv python3-pip\n```\n\n---\n\n## Step 2: Install Ollama (The AI Brain)\n\nOllama is the free, local AI that powers JCode. It runs on your computer \u2014 no internet needed after setup.\n\n### For Mac Users\n\n1. Go to https://ollama.ai/download\n2. Click \"Download for macOS\"\n3. Open the downloaded file and drag Ollama to your Applications folder\n4. Open Ollama from Applications (it will add an icon to your menu bar)\n\n### For Windows Users\n\n1. Go to https://ollama.ai/download\n2. Click \"Download for Windows\"\n3. Run the installer\n4. Ollama will start automatically (look for the llama icon in your system tray)\n\n### For Linux Users\n\n```bash\ncurl -fsSL https://ollama.ai/install.sh | sh\n```\n\n---\n\n## Step 3: Download the AI Models\n\nThese are the \"brains\" JCode uses. You only need to do this once.\n\n### Open Terminal (Mac/Linux) or Command Prompt (Windows)\n\nType these two commands:\n\n```bash\nollama pull deepseek-r1:14b\n```\n\nWait for it to finish (10-15 minutes, downloads ~8 GB).\n\nThen:\n\n```bash\nollama pull qwen2.5-coder:14b\n```\n\nWait for this one too (10-15 minutes, downloads ~8 GB).\n\n**What's happening?** You're downloading two specialized AI models:\n- **deepseek-r1** \u2014 the \"architect\" that plans your project\n- **qwen2.5-coder** \u2014 the \"programmer\" that writes the code\n\n---\n\n## Step 4: Download JCode\n\n### Option A: Download as ZIP (Easiest)\n\n1. Go to wherever JCode is hosted (e.g., GitHub)\n2. Click the green \"Code\" button\n3. Click \"Download ZIP\"\n4. Unzip the file (double-click it)\n5. Move the `JcodeAgent` folder to your Desktop\n\n### Option B: Using Git (If You Have It)\n\n```bash\ncd ~/Desktop\ngit clone <jcode-repository-url>\ncd JcodeAgent\n```\n\n---\n\n## Step 5: Install JCode\n\n### Open Terminal/Command Prompt and Navigate to JCode\n\n**Mac/Linux:**\n```bash\ncd ~/Desktop/JcodeAgent\n```\n\n**Windows:**\n```bash\ncd %USERPROFILE%\\Desktop\\JcodeAgent\n```\n\n### Install JCode\n\n```bash\npip3 install -e .\n```\n\n**Windows users:** Use `pip install -e .` (without the 3)\n\nThis command tells Python to install JCode on your computer.\n\n---\n\n## Step 6: Start Ollama Server\n\nJCode needs Ollama to be running in the background.\n\n### Mac/Linux\n\nOpen a **new Terminal window** and type:\n\n```bash\nollama serve\n```\n\nLeave this window open while you use JCode.\n\n### Windows\n\nOllama starts automatically. Just make sure you see the llama icon in your system tray (bottom-right corner).\n\n---\n\n## Step 7: Launch JCode!\n\n### In your original Terminal/Command Prompt window:\n\n```bash\njcode\n```\n\nYou should see the JCode banner followed by an **interactive launcher**:\n\n```\n     \u2566\u2554\u2550\u2557\u2554\u2550\u2557\u2554\u2566\u2557\u2554\u2550\u2557\n     \u2551\u2551  \u2551 \u2551 \u2551\u2551\u2551\u2563\n    \u255a\u255d\u255a\u2550\u255d\u255a\u2550\u255d\u2550\u2569\u255d\u255a\u2550\u255d  v0.2.0\n  \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  Local AI Coding Agent\n  \ud83e\udde0 Planner  \u00b7 \ud83d\udcbb Coder\n  \ud83d\udd0d Reviewer \u00b7 \ud83d\udd2c Analyzer\n\n  What would you like to do?\n\n    1 \u00b7 \ud83c\udd95  Start a new project\n    2 \u00b7 \ud83d\udcc2  Continue a previous project\n    3 \u00b7 \ud83d\udce5  Import an existing project\n    4 \u00b7 \u23ed\ufe0f   Skip (go to prompt)\n```\n\nJust type the number of your choice and press Enter!\n\n**Congratulations! JCode is running!** \ud83c\udf89\n\n---\n\n## Step 8: Create Your First Project\n\n### Option 1: Use the Interactive Launcher (Easiest)\n\nWhen JCode starts, choose **1 \u00b7 Start a new project**.\n\nIt will ask you:\n1. **Where to save the project** \u2014 just press Enter for the default location, or type a path\n2. **What to build** \u2014 describe your idea in plain English\n3. **Clone from GitHub?** \u2014 if you have an existing repo, paste the URL; otherwise just say no\n\n### Option 2: From a GitHub Repository\n\nChoose **3 \u00b7 Import an existing project** from the launcher. You can:\n- Paste a **GitHub URL** (e.g. `https://github.com/user/repo`) and JCode will clone it\n- Or type a **local path** to a project folder on your computer\n\n### Option 3: At the `jcode>` Prompt\n\nIf you chose option 4 (skip) at the launcher, type at the prompt:\n\n```\nbuild a simple todo list web app with a nice interface\n```\n\n### Example: Build a Todo List Web App\n\nDescribe your idea and watch the magic happen:\n\n1. \ud83e\udde0 **Planner** figures out what files you need\n2. \ud83d\udcbb **Coder** writes the code\n3. \ud83d\udd0d **Reviewer** checks for bugs\n4. \u2705 **Verifier** tests the code\n5. \ud83d\udd2c **Analyzer** fixes any issues\n\nAfter a few minutes, you'll have a complete project in a new folder!\n\n### What If Something Goes Wrong?\n\nIf a task fails 3 times, JCode won't just crash \u2014 it will ask you what to do:\n\n- **\ud83d\udd04 Re-generate** \u2014 try from scratch with a fresh approach\n- **\ud83d\udcd0 Simplify** \u2014 create a minimal version with TODO comments for the hard parts\n- **\u23ed\ufe0f Skip** \u2014 move on to the next task\n- **\u23f8\ufe0f Pause** \u2014 pause and let you inspect the error, then provide guidance\n\n### More Example Prompts to Try\n\n```\nbuild a simple calculator app with a GUI\n```\n\n```\nbuild a REST API for managing a book library\n```\n\n```\nbuild a weather app that shows the forecast\n```\n\n```\nbuild a personal budget tracker\n```\n\n---\n\n## Understanding JCode Commands\n\nOnce JCode is running, you can use these commands:\n\n| Command | What It Does |\n|---------|-------------|\n| `build <description>` | Create a new project from your description |\n| `plan` | Show what JCode is building |\n| `tree` | See all the files JCode created |\n| `projects` | List all your past projects |\n| `resume` | Continue working on your last project |\n| `update` | Check for and install JCode updates |\n| `help` | Show all commands |\n| `quit` | Exit JCode |\n\n**Tip:** You don't have to memorize these \u2014 the interactive launcher handles the most common actions for you automatically!\n\n---\n\n## Troubleshooting\n\n### \"Command not found: jcode\"\n\n**Fix:**\n```bash\npip3 install -e .\n```\n\nMake sure you're in the JcodeAgent folder first.\n\n---\n\n### \"Ollama is not running\"\n\n**Mac/Linux:** Open a new Terminal and run:\n```bash\nollama serve\n```\n\n**Windows:** Make sure you see the Ollama icon in your system tray. If not, search for \"Ollama\" in Start menu and launch it.\n\n---\n\n### \"Model not found: deepseek-r1:14b\"\n\nYou need to download the models:\n```bash\nollama pull deepseek-r1:14b\nollama pull qwen2.5-coder:14b\n```\n\n---\n\n### \"Error: Read-only file system\"\n\nJCode tried to create files in a protected location. When it asks where to save your project, choose a different folder like:\n- `~/Desktop/my_projects`\n- `~/Documents/jcode_projects`\n\n---\n\n### Code Has Errors\n\nJCode will automatically try to fix errors up to 3 times. If it still doesn't work, JCode will offer you 4 choices:\n\n1. **Re-generate** \u2014 try a completely fresh approach\n2. **Simplify** \u2014 create a minimal version and mark the tricky parts with TODOs\n3. **Skip** \u2014 skip that file and continue with the rest\n4. **Pause** \u2014 let you look at the error and give JCode hints\n\nYou can also:\n- Type `resume` to continue from where it left off\n- Try a simpler prompt first\n- Check that both AI models are fully downloaded\n\n---\n\n## What Happens Behind the Scenes?\n\nWhen you type `build <something>`:\n\n```\nYour idea\n    \u2193\n\ud83e\udde0 Planner creates a blueprint\n    \u2193\n\ud83d\udcbb Coder writes the files one by one\n    \u2193\n\ud83d\udd0d Reviewer checks each file for bugs\n    \u2193\n\u2705 Verifier runs tests\n    \u2193\n\ud83d\udd2c Analyzer fixes any errors\n    \u2193\n\ud83d\udcc1 Complete working project!\n```\n\nAll of this happens **on your computer**. No data is sent to the cloud. No subscriptions. Completely free and private.\n\n---\n\n## Where Are My Projects Saved?\n\nBy default, JCode saves projects to:\n- **Mac/Linux:** `~/jcode_projects/`\n- **Windows:** `C:\\Users\\YourName\\jcode_projects\\`\n\nYou can change this with the `settings` command.\n\n---\n\n## Tips for Better Results\n\n### \u2705 Good Prompts\n\n```\nbuild a simple todo list web app with HTML, CSS, and JavaScript\n```\n\n```\nbuild a REST API with Python FastAPI for managing blog posts\n```\n\n```\nbuild a calculator app with a graphical interface using Python tkinter\n```\n\n### \u274c Vague Prompts\n\n```\nbuild something cool\n```\n\n```\nmake an app\n```\n\n**Tip:** Be specific about what you want. Mention the technology if you know it, or describe the features clearly.\n\n---\n\n## Next Steps\n\n1. **Experiment!** Try building simple projects to get comfortable\n2. **Read the files** JCode creates \u2014 you'll learn by seeing the code\n3. **Modify projects** \u2014 JCode creates a starting point, you can edit the files yourself\n4. **Try `resume`** \u2014 if a project didn't work perfectly, resume and try again\n\n---\n\n## Still Need Help?\n\n- Type `help` inside JCode for a command reference\n- Check `README.md` for technical details\n- Check `FEATURES.md` for a full feature list\n\n---\n\n## Frequently Asked Questions\n\n**Q: Do I need internet?**  \nA: Only for the initial setup (downloading Python, Ollama, and the AI models). After that, JCode works 100% offline.\n\n**Q: Is it really free?**  \nA: Yes! Everything is open-source and runs locally on your machine.\n\n**Q: How much disk space do I need?**  \nA: About 20 GB for the AI models, plus space for your projects.\n\n**Q: Can I use this for commercial projects?**  \nA: Yes, JCode is MIT licensed. The code it generates is yours.\n\n**Q: Will this work on my old computer?**  \nA: You need at least 16 GB of RAM. The AI models are quite large.\n\n**Q: Can I use different AI models?**  \nA: Yes, but you'll need to edit `jcode/config.py` to change the model names.\n\n**Q: What if the code doesn't work?**  \nA: JCode will automatically try to fix errors. You can also type `resume` to retry.\n\n---\n\n**Ready to build? Type `jcode` and let's go!** \ud83d\ude80\n",
      "CHANGELOG.md": "# Changelog\n\n## v0.9.9 \u2014 Reliability: Files Actually Get Written\n\nCritical reliability fixes discovered during real-world testing. The agent was generating correct code but never writing it to disk because models don't follow the exact output format. This release makes JCode bulletproof regardless of how the model formats its output.\n\n### Robust File Parser (THE critical fix)\n- **Multi-strategy parser**: `_apply_file_changes()` now handles 4 output formats:\n  - **Format 1**: `===FILE: path=== ... ===END===` (ideal, standard)\n  - **Format 2**: `===FILE: path===` followed by ` ```lang ... ``` ` (common model behavior \u2014 no ===END===)\n  - **Format 3**: Markdown headings (`### main.py`) or bold (`**main.py**`) followed by code blocks\n  - **Format 4**: `===FILE: path===` followed by raw content split at next marker (ultimate fallback)\n- **Confirmation message**: Shows `\u2713 N file(s) written to disk` after successful writes\n- **Build pipeline coder**: `_strip_fences()` in coder.py now handles models that add explanations around code blocks\n\n### Model Registry Fix\n- **Removed `qwen3-coder:8b`** \u2014 this model does not exist on Ollama (caused silent pull failures)\n- **Changed `qwen3-coder:32b` \u2192 `qwen3-coder:30b`** \u2014 the actual available model (19GB)\n- Only `qwen3-coder:30b` and `qwen3-coder:480b` exist as of June 2025\n\n### Crash Protection (KeyboardInterrupt)\n- **Ctrl+C during model streaming** no longer crashes the app \u2014 returns partial output gracefully\n- **Ctrl+C in REPL routing** caught \u2014 returns to prompt instead of stack trace\n- **General exception handling** in REPL mode dispatch \u2014 errors are displayed cleanly\n- `_stream()` in ollama_client.py: wrapped in try/except KeyboardInterrupt, shows partial output length\n\n### Strengthened System Prompts\n- **AGENTIC_SYSTEM**: Complete rewrite with explicit format rules, correct/incorrect examples, visual section separators\n- **Mode 1 (ACTION) prompt**: Stronger ===END=== requirement, explicit \"no markdown fences\" rule\n- Models now see concrete examples of correct vs incorrect file block formatting\n- Triple-reinforced: \"Remember: ===FILE:=== then raw code then ===END===. No markdown fences inside file blocks. Ever.\"\n\n### Display Text Cleanup\n- Response display now strips all file block formats (not just ===END=== ones) before showing summary panel\n\n## v0.9.8 \u2014 Simplified Two-Mode Architecture\n\nMajor refactor: JCode now has a clean two-mode architecture. No more intent classification \u2014 every message goes straight to the active mode handler.\n\n### Two Modes\n- **\u26a1 Agentic (default)**: Every message triggers autonomous action \u2014 classify, generate, auto-run, auto-fix. No ambiguity.\n- **\ud83d\udcac Chat**: Conversational mode with reasoning, web search, explanations \u2014 but NO file modifications. Fully read-only.\n- Switch with `/agentic` or `/chat`\n\n### Slash Commands\n- All utility commands now use `/` prefix: `/run`, `/commit`, `/push`, `/pull`, `/status`, `/log`, `/diff`, `/remote`, `/files`, `/tree`, `/plan`, `/models`, `/help`, `/version`, `/update`, `/clear`, `/quit`\n- Slash commands work identically in both modes\n\n### Agentic Intelligence\n- **Task classification on every request**: `classify_task()` runs before every agentic action \u2014 selects optimal models based on complexity \u00d7 size\n- **Model routing**: Shows classification label and routed models for transparency\n- **Build detection**: Prompts like \"build a tinder for linkedin\" auto-route to the full build pipeline (classify \u2192 research \u2192 plan \u2192 generate \u2192 review \u2192 verify \u2192 fix \u2192 run)\n- **Auto-run after code generation**: After writing files, JCode auto-detects and runs the project\n- **Auto-fix loop**: If run fails, JCode feeds the error back to the model and retries (up to 3 attempts)\n\n### Run Detection Improvements\n- Node.js entry files (`app.js`, `index.js`, `server.js`) now detected in subdirectories (`server/`, `backend/`, `src/`, `api/`)\n- `package.json` `main` field used as fallback when no scripts are defined\n- More subdirectories searched for `package.json` (`app/` added)\n\n### Architecture Cleanup\n- Removed intent classification system from REPL (no more `classify_intent()` calls)\n- Removed `_handle_navigate()` and `_handle_git()` \u2014 logic inlined into slash command handler\n- Added `_run_fix_prompt()` helper \u2014 shared by `/run` auto-fix, build post-fix, and agentic auto-fix\n- Chat mode (`_cmd_chat`) is now strictly read-only \u2014 strips any ===FILE:=== or ===RUN:=== blocks\n\n### Files Changed\n- `jcode/cli.py` \u2014 Major refactor: new REPL with slash commands, `_cmd_agentic()` with classification + auto-run, `_agentic_auto_run()`, `_run_fix_prompt()`, read-only `_cmd_chat()`, improved `_detect_run_command()`\n- `jcode/__init__.py` \u2014 Version bump to 0.9.8\n- `pyproject.toml` \u2014 Version bump to 0.9.8\n\n---\n\n## v0.9.7 \u2014 Model Pull UX Improvements\n\nBugfix & UX: Model pulling now shows real progress (bytes downloaded, transfer speed), handles Ctrl+C gracefully, and gives better size estimates.\n\n### Model Pull Improvements\n- **Real progress tracking**: Shows bytes downloaded and transfer speed (was stuck at 0%)\n- **Graceful cancellation**: Press Ctrl+C during download to skip a model and continue with fallback\n- **Accurate size estimates**: 70B models \u2192 40GB, 32B \u2192 20GB, 14B \u2192 9GB, 7B \u2192 5GB (was flat 12GB estimate)\n- **Better feedback**: \"Skipped \u2014 will use fallback\" when cancelled, \"may take 10-30min per model\" warning\n- **Tip shown**: User is informed they can press Ctrl+C to skip slow downloads\n\n### Technical Changes\n- `pull_model()` now uses `Live` progress with `DownloadColumn` and `TransferSpeedColumn`\n- Catches `KeyboardInterrupt` at two levels (inner loop + outer function) for clean exit\n- Returns `False` on cancellation instead of crashing\n- `ensure_models_for_complexity()` handles partial success (some models pulled, some skipped)\n\n### Files Changed\n- `jcode/config.py` \u2014 Rewritten `pull_model()` with better progress tracking and KeyboardInterrupt handling\n- `jcode/ollama_client.py` \u2014 Improved size estimates and user feedback in `ensure_models_for_complexity()`\n\n---\n\n## v0.9.6 \u2014 Interactive Model Pulling\n\nFeature: JCode now detects missing ideal models and offers to pull them before starting a build. Users can choose to download recommended models or continue with fallback models.\n\n### Interactive Model Management\n- Before starting a build, JCode checks if all ideal models for the task classification are installed\n- If missing models are detected, shows a table comparing ideal vs. fallback models for each role\n- Prompts user: \"Pull missing models now?\" with Yes/No choice\n- If Yes: pulls each missing model with progress bar, then continues with ideal models\n- If No: continues immediately with fallback models (no delay, no errors)\n- Example: `heavy/large` task recommends `deepseek-r1:70b` (not installed) \u2192 offers to pull or falls back to `deepseek-r1:14b`\n\n### New Functions\n- `get_ideal_and_actual_models()` \u2014 returns role \u2192 (ideal_model, actual_model, is_fallback) mapping\n- `get_missing_ideal_models()` \u2014 returns list of missing ideal models grouped by roles\n- `pull_model()` \u2014 pulls a model from Ollama registry with progress bar\n- Enhanced `ensure_models_for_complexity()` \u2014 interactive pre-check with pull option (was a stub)\n\n### User Experience\n```\n\u26a0 Some ideal models are not installed:\n\n  Role        Ideal Model           Will Use              Status\n  planner     deepseek-r1:70b       deepseek-r1:14b       fallback\n  coder       qwen3-coder:32b       qwen2.5-coder:32b     fallback\n  reviewer    qwen2.5-coder:14b     qwen2.5-coder:14b     \u2713\n  analyzer    deepseek-r1:14b       deepseek-r1:14b       \u2713\n\n  Missing models: deepseek-r1:70b, qwen3-coder:32b\n  Estimated download: ~24GB\n\nPull missing models now? (if no, will use fallback models) [y/N]:\n```\n\n### Files Changed\n- `jcode/config.py` \u2014 `get_ideal_and_actual_models()`, `get_missing_ideal_models()`, `pull_model()` with progress bar\n- `jcode/ollama_client.py` \u2014 Enhanced `ensure_models_for_complexity()` with interactive pull workflow\n\n---\n\n## v0.9.5 \u2014 Model Fallback Fix\n\nCritical bugfix: `_is_model_local()` incorrectly matched different quantizations of the same base model. When requesting `deepseek-r1:70b` (not installed), it returned True because `deepseek-r1:14b` was installed, causing `model 'deepseek-r1:70b' not found (status code: 404)` errors.\n\n### Model Resolution Fix\n- `_is_model_local()` now requires EXACT name match (including quantization tag)\n- Previously: `\"deepseek-r1:70b\"` matched `\"deepseek-r1:14b\"` via `startswith()` check on base name\n- Now: Only matches if full name is in local models (handles `:latest` normalization correctly)\n- Fallback now works correctly: `heavy/large` planner requests `reasoning/large` \u2192 no exact match \u2192 falls back to `deepseek-r1:14b` (reasoning/medium)\n\n### Files Changed\n- `jcode/config.py` \u2014 Fixed `_is_model_local()` to match full model names, not base prefixes\n\n---\n\n## v0.9.4 \u2014 Smart Classification (LLM + Semantic Signals)\n\nCritical fix: \"build a tinder for linkedin\" was classified as `simple/small` \u2192 now correctly classified as `heavy/large`. Short prompts describing complex apps no longer fall through to the default.\n\n### LLM-Based Pre-Classification\n- New `_llm_classify()` calls the fastest available model to reason about task complexity before keyword matching\n- Uses a structured classification prompt that understands what \"build a tinder for X\" actually implies (auth, database, matching, profiles, etc.)\n- Adds ~1-3s but prevents catastrophic misclassification of short prompts\n- Falls back gracefully to keyword-only scoring if no model is available\n- LLM result is fused with keyword scoring \u2014 the HIGHER classification always wins (err on the side of giving more resources)\n\n### App-Type Complexity Signals\n- Added \"clone\" signals to `_HEAVY_SIGNALS`: \"like tinder\", \"uber for\", \"a spotify\", \"an airbnb\", etc. \u2014 covers 19 major platforms\n- Added domain signals to `_HEAVY_SIGNALS`: \"social network\", \"marketplace\", \"dating app\", \"matching system\", \"recommendation engine\", \"booking system\", \"fintech\", \"saas\", etc.\n- Added domain signals to `_MEDIUM_SIGNALS`: \"web app\", \"mobile app\", \"game\", \"analytics\", \"profile\", \"search\", \"forum\", etc.\n- \"build a tinder for linkedin\" now matches 2 heavy signals \u2192 `heavy/medium` from keywords alone (LLM pushes to `heavy/large`)\n\n### Default Classification Bias Fix\n- When no keyword signals match AND no LLM available, default is now `medium/medium` instead of `simple/small`\n- Only classify as `simple` when explicit simple signals are present (\"simple\", \"basic\", \"calculator\", \"todo\", \"landing page\")\n- Short prompts with no signals (e.g., \"build a weather app\") now get `medium/medium` instead of being penalized\n\n### Classification Examples (Before \u2192 After)\n| Prompt | Before | After |\n|--------|--------|-------|\n| \"build a tinder for linkedin\" | simple/small | heavy/large |\n| \"build a weather app\" | simple/small | medium/medium |\n| \"build me an uber for dogs\" | simple/small | heavy/large |\n| \"create a social network\" | simple/small | medium/medium |\n| \"build a dating app with matching\" | simple/small | heavy/medium |\n| \"build a simple calculator\" | simple/small | simple/small \u2713 |\n| \"make a landing page\" | simple/small | simple/small \u2713 |\n\n### Files Changed\n- `jcode/config.py` \u2014 `_llm_classify()`, `_CLASSIFY_PROMPT`, expanded `_HEAVY_SIGNALS` (19 app-type + 12 domain signals), expanded `_MEDIUM_SIGNALS` (12 domain signals), `_classify_from_prompt()` rewritten with 2-phase LLM+keyword fusion, default bias fix\n\n---\n\n## v0.9.3 \u2014 Fence Stripping & Execution Safety\n\nBugfix: models wrap `===FILE:===` content in markdown fences (` ```json ``` `), corrupting files like `package.json`. Commands now stop on failure instead of blindly continuing.\n\n### Markdown Fence Stripping\n- New `_strip_content_fences()` strips ` ```lang ``` ` from file content inside `===FILE:===` blocks\n- Handles `json`, `javascript`, `python`, `typescript`, and bare ` ``` ` fences\n- Applied automatically in `_apply_file_changes()` before writing to disk\n- Fixes: `package.json` written with backtick fences \u2192 `npm install EJSONPARSE`\n\n### Command Execution: Stop on Failure\n- `_apply_run_commands()` now stops executing remaining `===RUN:===` commands when one fails\n- Prevents cascading failures (e.g., `npm start` running after `npm install` fails)\n- Shows \"Stopping \u2014 fix the error before continuing\" message\n- `===BACKGROUND:===` commands are not affected (they don't block)\n\n### Run Command Detection Improvements\n- Added Node.js entry file fallback: `app.js`, `index.js`, `server.js`, `main.js` detected even without `package.json`\n- `_detect_run_command` now logs a warning when `package.json` has invalid JSON instead of silently failing\n- Detection order: Python entry \u2192 `package.json` scripts \u2192 HTML \u2192 Node.js entry \u2192 any `.py` file\n\n### Files Changed\n- `jcode/cli.py` \u2014 `_strip_content_fences()`, stop-on-failure in `_apply_run_commands()`, Node.js fallback in `_detect_run_command()`, JSON parse error logging\n\n---\n\n## v0.9.2 \u2014 Autonomous Execution\n\nCritical fix: agent mode now actually executes commands and builds projects end-to-end instead of just printing instructions.\n\n### Intent Classification Fix\n- Added `_BUILD_PATTERNS` \u2014 \"i want you to build an app\", \"create a website\", \"make me a dashboard\" now correctly classify as BUILD (previously fell through to CHAT)\n- BUILD patterns score 1.5\u00d7 and always win over CHAT in tie-breaking\n- Added RUN patterns: \"get the project running\", \"auto run\", \"run the commands\", \"install and run\"\n- \"i want you to build an app that shows weather info\" now triggers the full build pipeline instead of a chat response\n\n### Agent Mode Routes All Input to Agentic Handler\n- In agent mode, CHAT-classified input now routes to `_cmd_agentic()` instead of `_cmd_chat()`\n- This means ANY request in agent mode gets autonomous file creation + command execution\n- Chat mode still uses `_cmd_chat()` for conversational responses\n\n### Command Execution (`===RUN:===` / `===BACKGROUND:===`)\n- New `_apply_run_commands()` function parses and executes shell commands from model output\n- `===RUN: command===` \u2014 synchronous execution with output display (120s timeout)\n- `===BACKGROUND: command===` \u2014 background processes for servers/watchers\n- Safety filter blocks dangerous commands (rm -rf /, sudo rm, mkfs, dd, fork bombs)\n- Output capped at 20 lines per command for clean display\n- Wired into both `_cmd_agentic()` and `_cmd_chat()` \u2014 files applied before commands run\n\n### Updated Prompts\n- `AGENTIC_SYSTEM`: now instructs model to emit `===RUN:===` blocks for package installation, project setup, and server startup \u2014 never tell user to run manually\n- `AGENTIC_TASK`: changed \"Modification Request\" to \"Request\", added autonomous mode instructions\n- `CHAT_SYSTEM` MODE 3: updated to emit `===RUN:===` blocks instead of showing commands to copy-paste\n\n### Files Changed\n- `jcode/intent.py` \u2014 Added `_BUILD_PATTERNS`, expanded `_RUN_PATTERNS`, BUILD always wins over CHAT\n- `jcode/cli.py` \u2014 CHAT\u2192agentic routing in agent mode, `_apply_run_commands()`, command block stripping in display\n- `jcode/prompts.py` \u2014 `===RUN:===`/`===BACKGROUND:===` format in AGENTIC_SYSTEM, CHAT_SYSTEM, AGENTIC_TASK\n\n---\n\n## v0.9.1 \u2014 Spec Contracts, RAG Memory & Structured Errors\n\nImplements the frontier-grade coding agent blueprint: planner outputs formal specs, coder enforces them as contracts, embedding-based RAG memory provides cross-file context, and structured error parsing enables smarter fix loops.\n\n### Spec-as-Contract Pipeline\n- **Planner** now outputs formal spec fields: `database_schema`, `api_surface`, `auth_flow`, `deployment`\n- **Coder** enforces spec compliance: \"NO STACK DRIFT \u2014 if the spec says React, don't use Vue\"\n- `get_spec_details()` extracts spec from plan and injects into every CODER_TASK prompt\n- Simple projects gracefully skip formal spec fields\n\n### Embedding-Based RAG Memory (`memory.py`)\n- New `ProjectMemory` class with `FileEmbedding` dataclass\n- `index_files()`: embeds file summaries with MD5 change detection (skips unchanged files)\n- `retrieve()`: cosine similarity search over embeddings\n- `get_relevant_context()`: formatted RAG context for prompt injection\n- Lazy initialization \u2014 only activates when an embedding model is installed\n- Full serialization via `to_dict()` / `from_dict()` for session persistence\n- Graceful fallback: all methods return empty results if no embedding model available\n\n### RAG Integration\n- Memory indexed before first wave and re-indexed after each generation wave\n- Coder receives \"Semantically Related\" context from RAG alongside dependency context\n- Session save/load preserves vector memory embeddings\n- `ctx.index_memory()` and `ctx.get_relevant_files()` convenience methods on ContextManager\n\n### Expanded Model Registry\n- **Coding**: Added `qwen3-coder:32b/8b` (priority 5 \u2014 highest), `deepseek-coder:33b/6.7b`\n- **Reasoning**: Added `deepseek-r1:70b` (priority 5 for large reasoning tasks)\n- **Summarizer**: Added `phi4:14b`, `phi3.5:latest`, `gemma3:4b` \u2014 new category\n- **Embedding**: Added `all-minilm:latest`, `nomic-embed-text:latest` \u2014 new category\n- **General**: Added `llama3.3:latest`, `llama3.1:latest`\n- `ModelSpec` extended with `is_embedding: bool` field\n- New helpers: `get_embedding_model()`, `get_summarizer_model()`\n\n### Structured Error Parsing\n- `VerificationResult.structured_errors` property parses raw error output\n- Extracts Python errors (`File \"path\", line N`), JS/ruff errors (`path:line:col: message`)\n- Returns `{file, line, category, message}` dicts for targeted fix routing\n\n### Size Threading\n- `size` parameter now threaded through entire pipeline: planner \u2192 coder \u2192 reviewer \u2192 analyzer \u2192 iteration\n- All `get_model_for_role()` calls include both complexity and size\n- Display shows `Classification: complexity/size` throughout\n\n### Files Changed\n- `jcode/memory.py` \u2014 **New**: Full RAG memory module (230+ lines)\n- `jcode/config.py` \u2014 Expanded MODEL_REGISTRY, added embedding/summarizer categories and helpers\n- `jcode/prompts.py` \u2014 Planner spec schema, coder spec enforcement, CODER_TASK `{spec_details}`\n- `jcode/context.py` \u2014 ProjectMemory integration, spec extraction, session persistence\n- `jcode/coder.py` \u2014 RAG context injection, size threading, spec_details in prompts\n- `jcode/executor.py` \u2014 structured_errors property on VerificationResult\n- `jcode/iteration.py` \u2014 Memory indexing per wave, size threading\n- `jcode/planner.py` \u2014 Size threading, display update\n- `jcode/reviewer.py` \u2014 Size threading\n- `jcode/analyzer.py` \u2014 Size threading\n\n---\n\n## v0.9.0 \u2014 Multi-Model Orchestrator\n\nMajor architecture redesign \u2014 JCode becomes an intelligent orchestrator that classifies tasks by complexity and size, then routes to the best available model for each role.\n\n### Task Classification System\n- **Complexity levels**: Heavy, Medium, Simple \u2014 detected from prompt keywords and project context\n- **Size levels**: Large, Medium, Small \u2014 based on file count and scope\n- **Matrix routing**: Each (complexity \u00d7 size) combination maps to optimal models per role (planner, coder, reviewer, analyzer)\n- Fast path for simple tasks, deep research pipeline for heavy tasks\n\n### Multi-Model Registry\n- `ModelSpec` dataclass: name, category, tier, supports_thinking, supports_tools, context_default, priority\n- `MODEL_REGISTRY`: extensible dict of all known models with capabilities\n- `MODEL_CATEGORIES`: coding, reasoning, agentic \u2014 each listing available models\n- Automatic fallback chains when preferred models aren't installed\n- `get_model_for_role()`: resolves best available model with graceful degradation\n\n### Simplified Modes\n- Two modes: **agent** and **chat** \u2014 switch by typing `agent` or `chat`\n- Removed legacy mode complexity (plan/agentic/etc.)\n- Agent mode: full build pipeline with classification-based routing\n- Chat mode: conversational coding assistance\n\n### Research Pipeline (Heavy Tasks)\n- `research_pipeline()`: parallel web search + documentation fetching\n- Uses `ThreadPoolExecutor` for concurrent research\n- `RESEARCH_SYNTHESIS_SYSTEM` prompt synthesizes findings into actionable context\n- Automatically triggered when task is classified as heavy\n\n### Enhanced Prompts\n- All role prompts (Planner, Coder, Reviewer, Analyzer) rewritten with stronger guidelines\n- Chat prompt enhanced with runtime error handling instructions\n- Agentic prompt enhanced for orchestrator behavior\n\n### New Commands\n- `models` \u2014 Shows available models, categories, and routing table\n- `agent` / `chat` \u2014 Direct mode switching\n\n### Rewritten Files\n- `jcode/config.py` \u2014 Complete rewrite: enums, ModelSpec, MODEL_REGISTRY, classify_task(), ROLE_ROUTING, get_model_for_role(), describe_model_plan()\n- `jcode/ollama_client.py` \u2014 Complete rewrite: _is_reasoning_model(), _get_options_for_model(), model-category-aware option tuning\n- `jcode/prompts.py` \u2014 Complete rewrite: enhanced all role prompts, added RESEARCH_SYNTHESIS_SYSTEM\n\n### Updated Files\n- `jcode/cli.py` \u2014 Build pipeline uses classification, mode switching, models command\n- `jcode/intent.py` \u2014 Added Intent.MODE, agent/chat as exact commands\n- `jcode/web.py` \u2014 Added research_pipeline() for heavy task research\n- `jcode/context.py` \u2014 Added get_size() method\n- `install.sh` / `install.ps1` \u2014 Updated model lists (+ deepseek-r1:14b)\n\n### Backward Compatibility\n- Legacy `detect_complexity()` wrapper preserved\n- Legacy model constants (PLANNER_MODEL, etc.) preserved as aliases\n- Default `size=\"medium\"` parameter ensures existing callers work unchanged\n- Unchanged modules: planner.py, iteration.py, coder.py, reviewer.py, analyzer.py, file_manager.py, settings.py, executor.py\n\n---\n\n## v0.8.1 \u2014 Speed Fix\n\n### Fixed\n- Replaced deepseek-r1 with qwen2.5-coder for all roles \u2014 eliminates 2+ minute thinking pauses\n- Added `<think>` tag filtering for reasoning model output cleanup\n\n---\n\n## v0.8.0 \u2014 Performance Overhaul\n\n### Fixed\n- Fixed 5+ minute builds caused by model pulling on every request\n- Implemented never-pull policy \u2014 uses only locally available models\n- Optimized model selection to prefer already-loaded models\n\n---\n\n## v0.7.0 \u2014 CWD-Aware Agent\n\n### Added\n- CWD-aware operation \u2014 builds in current working directory\n- Git integration with auto-commit on successful builds\n- Project scanning \u2014 detects existing project structure\n- Dual modes: plan (structured) and agentic (free-form)\n\n---\n\n## v0.6.0 \u2014 Smart Model Tiering\n\n### Added\n- Smart model tiering \u2014 selects model size based on task complexity\n- Parallel file generation for independent tasks\n- Task Graph Engine for dependency-aware execution\n\n---\n\n## v0.2.0 \u2014 Architecture Overhaul\n\nComplete rewrite implementing a 4-role multi-model system with structured memory.\n\n### New Architecture\n- **4-Role System**: Planner, Coder, Reviewer, Analyzer \u2014 each with isolated system prompts\n- **DAG Task Tree**: Tasks have dependencies; topological execution order\n- **Structured Memory**: Architecture summary + file index + failure log (replaces raw context dumps)\n- **Verification Pipeline**: Syntax \u2192 lint \u2192 type check per file\n- **Self-Correction Loop**: Analyze error \u2192 patch \u2192 re-verify (up to 3 attempts)\n- **Patch Mode**: Targeted minimal fixes instead of full file regeneration\n\n### New Files\n- `jcode/prompts.py` \u2014 All 4 role prompt templates with JSON schemas\n- `jcode/reviewer.py` \u2014 Pre-execution code review (catches bugs before running)\n- `jcode/analyzer.py` \u2014 Error diagnosis producing structured fix instructions\n- `jcode/executor.py` \u2014 Multi-language verification pipeline\n\n### Rewritten Files\n- `jcode/config.py` \u2014 TaskStatus enum, TaskNode dataclass, 4 model configs\n- `jcode/ollama_client.py` \u2014 Unified `call_model(role)` dispatcher\n- `jcode/context.py` \u2014 Full structured memory engine with DAG support\n- `jcode/planner.py` \u2014 DeepSeek-R1 think-tag stripping, architecture output\n- `jcode/coder.py` \u2014 `generate_file()` + `patch_file()` with structured context\n- `jcode/iteration.py` \u2014 DAG-based orchestration (generate\u2192review\u2192verify\u2192fix)\n- `jcode/cli.py` \u2014 All commands rebuilt, `build` replaces free-text prompt\n\n### Preserved Files\n- `jcode/settings.py` \u2014 User settings (unchanged from v0.1)\n- `jcode/file_manager.py` \u2014 File I/O (unchanged)\n\n---\n\n## v0.1.1 \u2014 Bug Fixes & Enhancements\n\n### Fixed\n- `OSError: [Errno 30] Read-only file system` when entering `/first_project`\n- Path expansion now handles `~`, relative paths, and validates writability\n\n### Added\n- First-run setup wizard for default output directory\n- Project tracking and resume capability (`projects`, `resume` commands)\n- Adaptive context windows based on project complexity\n- Auto-save sessions on file generation and exit\n- `settings` command for viewing/editing configuration\n\n---\n\n## v0.1.0 \u2014 Initial Release\n\n- Dual-model architecture: DeepSeek-R1 (planning) + Qwen2.5-Coder (generation)\n- Rich CLI with interactive prompt\n- Linear iteration loop with error feedback\n- File system manager with Rich tree display\n- Basic session save/load\n",
      "FEATURES.md": "# JCode v0.2.0 \u2014 Feature Summary\n\n## Core Architecture\n\n### 4-Role AI System\nEach role uses the same local model weights but with specialised system prompts for task isolation:\n\n| Role | Model | What It Does |\n|------|-------|-------------|\n| \ud83e\udde0 Planner | deepseek-r1:14b | Architecture design, task DAG creation, dependency mapping |\n| \ud83d\udcbb Coder | qwen2.5-coder:14b | File generation from structured context, targeted patches |\n| \ud83d\udd0d Reviewer | qwen2.5-coder:14b | Pre-execution code review (logic, security, completeness) |\n| \ud83d\udd2c Analyzer | deepseek-r1:14b | Error root cause analysis, fix strategy generation |\n\n### DAG Task Tree\n- Tasks have explicit `depends_on` fields\n- Execution follows topological order \u2014 a file isn't generated until its dependencies are verified\n- Deadlock detection with automatic skip for blocked tasks\n- Status state machine: `PENDING \u2192 IN_PROGRESS \u2192 GENERATED \u2192 REVIEWING \u2192 NEEDS_FIX \u2192 VERIFIED/FAILED/SKIPPED`\n\n### Structured Memory Engine\nInstead of dumping raw conversation history, each role gets only the context it needs:\n\n- **Coder** sees: architecture summary + file index + task description (not the full plan)\n- **Reviewer** sees: the file content + architecture context (not generation history)\n- **Analyzer** sees: error output + failure log of previous fixes (avoids repeating mistakes)\n- **Planner** sees: failure log + architecture when refining plans\n\n### Verification Pipeline\nMulti-check quality gate per file:\n\n| Check | Languages | Tool |\n|-------|-----------|------|\n| Syntax | Python, JS, JSON | `py_compile`, `node --check`, `json.loads` |\n| Lint | Python | `ruff` or `flake8` |\n| Type Check | Python | (extensible) |\n\n### Self-Correction Loop\n```\nGenerate \u2192 Review \u2192 Verify \u2192 [fail?] \u2192 Analyze \u2192 Patch \u2192 Re-verify\n                                                    \u2191         \u2502\n                                                    \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 (up to 3\u00d7)\n```\n\n- Analyzer produces structured JSON: `root_cause`, `fix_strategy`, `is_dependency_issue`\n- Failure log prevents the same fix from being attempted twice\n- After 3 failures, task is marked FAILED and execution continues\n\n### Patch Mode\n- Fixes use `patch_file()` instead of `generate_file()` \u2014 sends current file content + error + fix strategy\n- Results in minimal targeted changes rather than full regeneration\n- Preserves working code that passed review\n\n## CLI Features\n\n### Commands\n| Command | Description |\n|---------|-------------|\n| `build <prompt>` | Full pipeline: plan \u2192 generate \u2192 review \u2192 verify \u2192 fix |\n| `plan` | Show current plan with task statuses |\n| `files` | List generated files with sizes |\n| `tree` | Show project directory tree |\n| `projects` | List all saved projects |\n| `resume` | Resume the last project |\n| `save` | Manually save current session |\n| `load <path>` | Load a session file |\n| `settings` | View/edit settings |\n| `clear` | Clear screen |\n| `help` | Show help |\n| `quit` | Exit JCode |\n\n### First-Run Setup Wizard\n- Interactive setup on first launch\n- Choose default output directory\n- Settings persist in `~/.jcode/settings.json`\n\n### Project Management\n- Auto-save after each task completion\n- Session files in `.jcode_session.json` per project\n- Resume any project from where you left off\n- Project metadata tracked in `~/.jcode/projects/`\n\n### Adaptive Context Windows\n- Complexity auto-detected from prompt analysis\n- Context window scales: 16k (simple) \u2192 24k \u2192 32k \u2192 40k (large)\n- Based on file count, database usage, API complexity, auth, testing\n\n## File Structure\n\n```\njcode/\n\u251c\u2500\u2500 __init__.py          # v0.2.0\n\u251c\u2500\u2500 __main__.py          # python -m jcode\n\u251c\u2500\u2500 cli.py               # Rich interactive CLI + setup wizard\n\u251c\u2500\u2500 config.py            # TaskStatus, TaskNode, ProjectState, models\n\u251c\u2500\u2500 prompts.py           # All 4 role prompts with JSON schemas\n\u251c\u2500\u2500 ollama_client.py     # Unified call_model(role, ...) dispatcher\n\u251c\u2500\u2500 context.py           # Structured memory + DAG + session persistence\n\u251c\u2500\u2500 planner.py           # Plan creation with think-tag stripping\n\u251c\u2500\u2500 coder.py             # generate_file() + patch_file()\n\u251c\u2500\u2500 reviewer.py          # Pre-execution review \u2192 JSON verdict\n\u251c\u2500\u2500 analyzer.py          # Error diagnosis \u2192 structured fix plan\n\u251c\u2500\u2500 executor.py          # Verification pipeline + dependency install\n\u251c\u2500\u2500 iteration.py         # DAG-based orchestration engine\n\u251c\u2500\u2500 file_manager.py      # File I/O + Rich tree display\n\u2514\u2500\u2500 settings.py          # Persistent user settings\n```\n",
      "FRONTEND_SETUP_COMPLETE.md": "# Frontend Setup - Complete! \u2705\n\n## System Information\n- **Node.js Version:** v24.13.1 (LTS)\n- **npm Version:** 11.8.0\n- **Next.js Version:** 16.1.6 (latest, auto-upgraded from 14.1.0)\n- **Status:** \u2705 Running on http://localhost:3000\n\n## Installation Summary\n\n\u2705 **NVM Installed** \u2014 Node Version Manager at `~/.nvm`  \n\u2705 **Node.js LTS Installed** \u2014 v24.13.1 with npm 11.8.0  \n\u2705 **Dependencies Installed** \u2014 112 packages, 0 vulnerabilities  \n\u2705 **Next.js Build Successful** \u2014 985.7ms compile time  \n\u2705 **Dev Server Running** \u2014 Ready in 216ms on http://localhost:3000  \n\n## Routes Available\n\n- `http://localhost:3000/` \u2014 Home page (hero, features, releases)\n- `http://localhost:3000/guide` \u2014 Beginner's guide\n- `http://localhost:3000/technical` \u2014 Technical documentation\n- `http://localhost:3000/api/stats` \u2014 Analytics dashboard\n\n## Build Output\n\n```\nRoute (app)\n\u251c \u25cb /                      (Static)\n\u251c \u25cb /_not-found            (Static)\n\u251c \u0192 /api/install.ps1       (Dynamic - Edge Runtime)\n\u251c \u0192 /api/install.sh        (Dynamic - Edge Runtime)\n\u251c \u0192 /api/stats             (Dynamic - Edge Runtime)\n\u251c \u25cb /guide                 (Static)\n\u2514 \u25cb /technical             (Static)\n\n\u25cb  (Static)   prerendered as static content\n\u0192  (Dynamic)  server-rendered on demand\n```\n\n## Frontend Features Verified\n\n\u2705 TypeScript compilation successful  \n\u2705 Tailwind CSS working  \n\u2705 All pages prerendered/compiled  \n\u2705 API routes configured for Edge Runtime  \n\u2705 No security vulnerabilities  \n\n## Development Commands\n\n```bash\n# Start dev server (already running)\nnpm run dev\n\n# Build for production\nnpm run build\n\n# Start production server\nnpm start\n\n# Run linter\nnpm run lint\n\n# View build output\nnpm run build -- --debug\n```\n\n## Next Steps\n\n1. **Test in Browser** \u2014 Visit http://localhost:3000\n2. **Check Pages** \u2014 Browse /guide and /technical\n3. **Test Install Button** \u2014 Verify copy-to-clipboard works\n4. **Test Theme Toggle** \u2014 Dark/light mode persistence\n5. **Commit Changes** \u2014 `git add -A && git commit -m \"feat: Next.js frontend migration\"`\n6. **Deploy to Vercel** \u2014 When ready: `vercel --prod`\n\n## Troubleshooting\n\n### Dev Server Not Responding\n```bash\n# Kill the process\nlsof -i :3000 | grep LISTEN | awk '{print $2}' | xargs kill -9\n\n# Restart\nnpm run dev\n```\n\n### TypeScript Errors After Update\n```bash\n# Next.js auto-updated tsconfig.json\n# Delete node_modules and reinstall\nrm -rf node_modules package-lock.json\nnpm install\n```\n\n### Deployment Issues\nMake sure Vercel KV is connected:\n1. Vercel Dashboard \u2192 getjcode.vercel.app\n2. Storage \u2192 Create Database \u2192 KV\n3. Name: `jcode-analytics`\n4. Deploy with `vercel --prod`\n\n## File Changes\n\n**frontend/package.json updated:**\n- `next: ^14.1.0 \u2192 ^16.1.6`\n- All dependencies auto-updated for compatibility\n\n**frontend/tsconfig.json auto-configured:**\n- `jsx: \"react-jsx\"` (Next.js automatic runtime)\n- `.next/dev/types/**/*.ts` added to include\n\n## Performance Metrics\n\n- **Build Time:** 985.7ms\n- **Dev Server Startup:** 216ms\n- **Page Prerendering:** 141.5ms (5 static pages)\n- **Compiled Successfully:** \u2713\n\n## Ready to Deploy!\n\nThe frontend is production-ready. Just run:\n```bash\nnpm run build\nvercel --prod\n```\n\nAll URLs remain the same \u2014 your install commands will work unchanged!\n",
      "MIGRATION.md": "# Migration from Static HTML to Next.js\n\nThis document explains the migration from `docs/` (static HTML) to `frontend/` (Next.js).\n\n## What Changed\n\n### Structure\n```\nOLD (docs/):                    NEW (frontend/):\n\u251c\u2500\u2500 index.html              \u2192   \u251c\u2500\u2500 app/page.tsx\n\u251c\u2500\u2500 beginner-guide.html     \u2192   \u251c\u2500\u2500 app/guide/page.tsx\n\u251c\u2500\u2500 technical.html          \u2192   \u251c\u2500\u2500 app/technical/page.tsx\n\u251c\u2500\u2500 api/install.sh.js       \u2192   \u251c\u2500\u2500 app/api/install.sh/route.ts\n\u251c\u2500\u2500 api/install.ps1.js      \u2192   \u251c\u2500\u2500 app/api/install.ps1/route.ts\n\u251c\u2500\u2500 api/stats.js            \u2192   \u251c\u2500\u2500 app/api/stats/route.ts\n\u2514\u2500\u2500 vercel.json             \u2192   \u251c\u2500\u2500 vercel.json (updated routing)\n                                \u2514\u2500\u2500 components/ (extracted shared UI)\n```\n\n### Technology Stack\n- **Old:** Pure HTML/CSS/JS, Vercel serverless functions\n- **New:** Next.js 14, React 18, TypeScript, Tailwind CSS, Edge Runtime\n\n### Key Improvements\n\n1. **Component Reusability**\n   - Extracted `<Header>`, `<Footer>`, `<ThemeProvider>` for consistency\n   - Created `<FeatureCard>`, `<InstallButton>`, `<ReleaseItem>` for clean code\n\n2. **Type Safety**\n   - Full TypeScript coverage\n   - Compile-time error checking\n   - Better IDE autocomplete\n\n3. **Performance**\n   - Server-side rendering for faster initial load\n   - Automatic code splitting\n   - Optimized bundle sizes\n\n4. **Developer Experience**\n   - Hot module reload\n   - Modern tooling (ESLint, Prettier)\n   - Better debugging with React DevTools\n\n5. **Maintainability**\n   - Single source of truth for styles (Tailwind)\n   - Easier to add new pages/features\n   - Better code organization\n\n## Migration Steps (Already Done)\n\n\u2705 1. Created Next.js project structure  \n\u2705 2. Converted HTML pages to React components  \n\u2705 3. Migrated API endpoints to Next.js API routes  \n\u2705 4. Extracted shared components (Header, Footer, etc.)  \n\u2705 5. Converted CSS to Tailwind utility classes  \n\u2705 6. Copied assets (favicon, icons) to `public/`  \n\u2705 7. Configured vercel.json for routing  \n\n## Next Steps (TODO)\n\n\u2b1c 1. Install dependencies:\n```bash\ncd frontend\nnpm install\n```\n\n\u2b1c 2. Test locally:\n```bash\nnpm run dev\n# Visit http://localhost:3000\n```\n\n\u2b1c 3. Build for production:\n```bash\nnpm run build\n```\n\n\u2b1c 4. Deploy to Vercel:\n```bash\nvercel --prod\n```\n\n## Vercel Configuration\n\nThe new `frontend/vercel.json` handles routing:\n- `/install.sh` \u2192 `/api/install.sh` (Next.js route)\n- `/install.ps1` \u2192 `/api/install.ps1` (Next.js route)\n\nAnalytics still require Vercel KV (same setup as before).\n\n## Backward Compatibility\n\n- All URLs remain the same (`/`, `/guide`, `/technical`, `/api/stats`)\n- Install commands unchanged (`curl https://getjcode.vercel.app/install.sh | bash`)\n- Analytics schema unchanged (same KV keys)\n\n## Old `docs/` Folder\n\nThe old `docs/` folder can be kept as reference or archived. The frontend is now fully standalone in `frontend/`.\n\n## Future Enhancements\n\nNow that we're on Next.js, we can easily add:\n- Blog with MDX support\n- Search functionality\n- Interactive demos\n- User authentication (if needed)\n- API documentation with Swagger/OpenAPI\n- Real-time stats dashboard (WebSocket)\n",
      "NEXTJS_MIGRATION_COMPLETE.md": "# Next.js Frontend Migration Complete! \ud83c\udf89\n\n## \u2705 What Was Built\n\nI've successfully transformed your static HTML docs into a modern **Next.js 14** application with TypeScript and Tailwind CSS.\n\n### Project Structure\n\n```\nfrontend/\n\u251c\u2500\u2500 app/\n\u2502   \u251c\u2500\u2500 layout.tsx              # Root layout with Header, Footer, ThemeProvider\n\u2502   \u251c\u2500\u2500 page.tsx                # Home page (hero, features, releases)\n\u2502   \u251c\u2500\u2500 globals.css             # Tailwind + custom styles\n\u2502   \u251c\u2500\u2500 guide/page.tsx          # Beginner's guide\n\u2502   \u251c\u2500\u2500 technical/page.tsx      # Technical docs\n\u2502   \u2514\u2500\u2500 api/\n\u2502       \u251c\u2500\u2500 install.sh/route.ts # Install script + analytics (Edge)\n\u2502       \u251c\u2500\u2500 install.ps1/route.ts# Windows installer + analytics (Edge)\n\u2502       \u2514\u2500\u2500 stats/route.ts      # Analytics dashboard (Edge)\n\u251c\u2500\u2500 components/\n\u2502   \u251c\u2500\u2500 Header.tsx              # Navigation with theme toggle\n\u2502   \u251c\u2500\u2500 Footer.tsx              # Links and copyright\n\u2502   \u251c\u2500\u2500 ThemeProvider.tsx       # Dark/light mode context\n\u2502   \u2514\u2500\u2500 HomeComponents.tsx      # FeatureCard, InstallButton, ReleaseItem\n\u251c\u2500\u2500 public/\n\u2502   \u2514\u2500\u2500 *.ico                   # Favicons (copied from docs/)\n\u251c\u2500\u2500 package.json                # Dependencies (Next.js, React, @vercel/kv, etc.)\n\u251c\u2500\u2500 tsconfig.json               # TypeScript config\n\u251c\u2500\u2500 tailwind.config.ts          # Tailwind with custom colors\n\u251c\u2500\u2500 postcss.config.js           # PostCSS for Tailwind\n\u251c\u2500\u2500 vercel.json                 # URL rewrites for /install.sh, /install.ps1\n\u2514\u2500\u2500 README.md                   # Frontend documentation\n```\n\n### Features Implemented\n\n\u2705 **Server-Side Rendering** \u2014 Fast initial page loads  \n\u2705 **TypeScript** \u2014 Full type safety  \n\u2705 **Tailwind CSS** \u2014 Modern utility-first styling  \n\u2705 **Dark/Light Theme** \u2014 User preference with localStorage persistence  \n\u2705 **Edge Runtime API Routes** \u2014 Low-latency analytics  \n\u2705 **Component Architecture** \u2014 Reusable Header, Footer, FeatureCard, etc.  \n\u2705 **SEO Optimized** \u2014 Metadata, OpenGraph, Twitter cards  \n\u2705 **Mobile Responsive** \u2014 Tailwind responsive classes  \n\u2705 **Analytics Tracking** \u2014 Same Vercel KV integration as before  \n\n### Technology Stack\n\n- **Framework:** Next.js 14 (App Router)\n- **Language:** TypeScript 5.3\n- **Styling:** Tailwind CSS 3.4\n- **Runtime:** Edge (for API routes)\n- **Storage:** Vercel KV (Redis)\n- **Deployment:** Vercel\n\n## \ud83d\udccb Next Steps (Manual)\n\nSince Node.js isn't installed on your system, you'll need to install it first:\n\n### 1. Install Node.js\n\n**Option A: Via Homebrew** (recommended)\n```bash\n# Install Homebrew if you don't have it\n/bin/bash -c \"$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)\"\n\n# Install Node.js\nbrew install node\n```\n\n**Option B: Download from nodejs.org**\nVisit https://nodejs.org and download the macOS installer.\n\n### 2. Install Dependencies\n\n```bash\ncd /Users/ioan_andrei/Desktop/JcodeAgent/frontend\nnpm install\n```\n\n### 3. Test Locally\n\n```bash\nnpm run dev\n```\n\nVisit http://localhost:3000\n\nTest all pages:\n- `/` \u2014 Home page\n- `/guide` \u2014 Beginner's guide\n- `/technical` \u2014 Technical docs\n- `/api/stats` \u2014 Analytics dashboard\n\n### 4. Build for Production\n\n```bash\nnpm run build\n```\n\n### 5. Deploy to Vercel\n\n```bash\n# Install Vercel CLI\nnpm install -g vercel\n\n# Deploy\ncd frontend\nvercel --prod\n```\n\n**Important:** Connect Vercel KV before deploying (same as before):\n1. Vercel dashboard \u2192 Storage \u2192 Create Database \u2192 KV\n2. Name: `jcode-analytics`\n3. Connect to project\n\n## \ud83d\udd04 Migration Details\n\n### URL Compatibility\n\nAll URLs remain the same:\n- `https://getjcode.vercel.app/` \u2192 Home\n- `https://getjcode.vercel.app/guide` \u2192 Guide\n- `https://getjcode.vercel.app/technical` \u2192 Docs\n- `https://getjcode.vercel.app/install.sh` \u2192 Install script\n- `https://getjcode.vercel.app/api/stats` \u2192 Analytics\n\n### Analytics Schema\n\nUnchanged \u2014 same Vercel KV keys:\n```\njcode:install:count:unix\njcode:install:count:windows\njcode:installs (list)\njcode:installs:YYYY-MM-DD (daily counts)\n```\n\n### Old `docs/` Folder\n\nThe old `docs/` folder is still intact. Once you verify the Next.js frontend works, you can:\n- Archive it: `mv docs docs_old`\n- Or keep it as reference\n\n## \ud83c\udfa8 Design Improvements\n\n1. **Glass-morphism Effects** \u2014 Modern frosted-glass aesthetic\n2. **Smooth Transitions** \u2014 Theme toggle, hover states\n3. **Better Typography** \u2014 Tailwind's font stack\n4. **Responsive Grid** \u2014 Auto-fit columns for features\n5. **Accessible** \u2014 Proper ARIA labels, semantic HTML\n\n## \ud83d\ude80 Benefits\n\n1. **Performance** \u2014 SSR + automatic code splitting\n2. **SEO** \u2014 Better crawlability with server-rendered pages\n3. **Developer Experience** \u2014 Hot reload, TypeScript, ESLint\n4. **Maintainability** \u2014 Component reusability, single source of truth for styles\n5. **Scalability** \u2014 Easy to add blog, search, interactive demos, etc.\n\n## \ud83d\udcdd Files Created\n\nTotal: **22 files**\n\n- `frontend/package.json`\n- `frontend/tsconfig.json`\n- `frontend/next.config.js`\n- `frontend/tailwind.config.ts`\n- `frontend/postcss.config.js`\n- `frontend/vercel.json`\n- `frontend/.gitignore`\n- `frontend/README.md`\n- `frontend/app/layout.tsx`\n- `frontend/app/page.tsx`\n- `frontend/app/globals.css`\n- `frontend/app/guide/page.tsx`\n- `frontend/app/technical/page.tsx`\n- `frontend/app/api/install.sh/route.ts`\n- `frontend/app/api/install.ps1/route.ts`\n- `frontend/app/api/stats/route.ts`\n- `frontend/components/Header.tsx`\n- `frontend/components/Footer.tsx`\n- `frontend/components/ThemeProvider.tsx`\n- `frontend/components/HomeComponents.tsx`\n- `/MIGRATION.md` (root \u2014 explains the migration)\n- `/VERCEL_DEPLOY.md` (root \u2014 deployment checklist)\n\n## \u26a0\ufe0f Current Lint Errors\n\nThe TypeScript errors you see are expected \u2014 they'll disappear once you run `npm install` to install the dependencies (`next`, `react`, `@vercel/kv`, etc.).\n\n## \ud83c\udfaf Summary\n\nYour static HTML site is now a fully-featured Next.js application with:\n- Modern component architecture\n- Full TypeScript support\n- Tailwind CSS styling\n- Dark/light theme toggle\n- Edge runtime API routes\n- Same analytics functionality\n\nAll backward-compatible with existing install commands and URLs!\n",
      "QUICKSTART.md": "# \ud83d\ude80 Quick Start Guide\n\n## First Run Setup\n\nWhen you run JCode for the first time:\n\n```bash\njcode\n```\n\nYou'll be greeted with a setup wizard:\n\n```\n\u2699\ufe0f  First-Time Setup\n\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\nWelcome to JCode!\n\nLet's set up your preferences.\nYou can change these anytime in ~/.jcode/settings.json\n\nWhere should JCode save generated projects? [~/jcode_projects]:\n```\n\nChoose a directory where all your generated projects will be saved (defaults to `~/jcode_projects`).\n\n## Building Your First Project\n\n```\njcode> build a REST API with FastAPI for a todo list with SQLite\n```\n\nJCode will:\n1. **Analyze complexity** \u2014 detects it's a medium complexity project\n2. **Plan the structure** \u2014 creates file/folder layout\n3. **Ask for confirmation** \u2014 you can review before generating\n4. **Generate all files** \u2014 writes code with proper dependencies\n5. **Validate & fix** \u2014 runs checks and auto-corrects errors\n6. **Auto-save** \u2014 stores project metadata for later\n\n## Project Complexity Detection\n\nJCode automatically detects project complexity and adjusts context windows:\n\n| Complexity | File Count | Features | Context Size |\n|------------|-----------|----------|--------------|\n| **Simple** | 1-3 files | Basic logic | 1.0x (16k) |\n| **Medium** | 4-10 files | Moderate features | 1.5x (24k) |\n| **Complex** | 11-20 files | DB, API, Auth | 2.0x (32k) |\n| **Large** | 20+ files | Full application | 2.5x (40k) |\n\nThe system considers:\n- Number of files and tasks\n- Tech stack (database, API, auth, tests)\n- Feature complexity\n\n## Resuming Projects\n\nList all your saved projects:\n```\njcode> projects\n```\n\nResume working on one:\n```\njcode> resume my_project_name\n```\n\nJCode will load the full session including:\n- All generated files\n- Conversation history\n- Current state and errors\n- Output directory\n\n## Iterating on a Project\n\nAfter generating a project, you can continue working on it:\n\n```\njcode> add a login page with email/password authentication\n```\n\nJCode will:\n- Understand the existing project context\n- Generate/modify only the necessary files\n- Maintain consistency with existing code\n- Auto-save progress\n\n## Useful Commands\n\n| Command | Description |\n|---------|-------------|\n| `plan` | Show current project structure |\n| `files` | List all generated files |\n| `tree` | Visual directory tree |\n| `projects` | List all saved projects |\n| `resume <name>` | Continue a project |\n| `settings` | View configuration |\n| `clear` | Start fresh (auto-saves current) |\n\n## Settings Location\n\nAll JCode data is stored in `~/.jcode/`:\n\n```\n~/.jcode/\n\u251c\u2500\u2500 settings.json           # User preferences\n\u2514\u2500\u2500 projects/              # Project metadata\n    \u251c\u2500\u2500 my_api.json\n    \u251c\u2500\u2500 todo_app.json\n    \u2514\u2500\u2500 ...\n```\n\nEach generated project also has a hidden session file:\n```\n~/jcode_projects/my_project/.jcode_session.json\n```\n\n## Tips\n\n### 1. Be Specific in Prompts\n\u274c \"build a website\"  \n\u2705 \"build a React portfolio website with a projects page, about page, and contact form using TailwindCSS\"\n\n### 2. Iterate Incrementally\nAfter generating the base:\n```\njcode> add unit tests for all API endpoints\njcode> add error handling and logging\njcode> add a README with setup instructions\n```\n\n### 3. Check Before Confirming\nAlways review the plan before saying \"yes\" to generation:\n- File structure makes sense?\n- Tech stack is correct?\n- Tasks are in the right order?\n\n### 4. Use Project Complexity Wisely\nFor large projects, break them into phases:\n```\njcode> build the backend API first (Phase 1)\n# (after completion)\njcode> clear\njcode> now build the frontend dashboard (Phase 2)\n```\n\n## Troubleshooting\n\n### \"Read-only file system\" error\n\u2705 **Fixed!** Now validates and expands paths properly.\n\nUse full paths or `~/directory` notation:\n- \u2713 `/Users/you/projects/myapp`\n- \u2713 `~/Desktop/myapp`\n- \u2717 `/myapp` (root filesystem)\n\n### Project not resuming\nCheck if the session file exists:\n```bash\nls ~/jcode_projects/my_project/.jcode_session.json\n```\n\nIf missing, JCode can only show metadata. The files are still there, but conversation history is lost.\n\n### Models not found\nOn first run, JCode auto-downloads models. If interrupted:\n```bash\nollama pull deepseek-r1:14b\nollama pull qwen2.5-coder:14b\n```\n\n## Next Steps\n\n- Experiment with different project types\n- Try the `projects` command to see your portfolio\n- Use `resume` to continue multi-session projects\n- Check `~/.jcode/settings.json` to customize defaults\n",
      "README.md": "# JCode \ud83e\udd16\n\n> **A local AI coding agent powered by Ollama** \u2014 plans, generates, reviews, and iterates on full projects using 4 specialized AI roles.\n\n![Python 3.10+](https://img.shields.io/badge/Python-3.10+-blue)\n![Ollama](https://img.shields.io/badge/Ollama-local%20LLM-green)\n![License: MIT](https://img.shields.io/badge/License-MIT-yellow)\n\n## How It Works\n\n```\nPrompt \u2192 \ud83e\udde0 Planner \u2192 \ud83d\udcbb Coder \u2192 \ud83d\udd0d Reviewer \u2192 \u2705 Verify \u2192 \ud83d\udd2c Analyzer \u2192 \ud83d\udd04 Fix \u2192 \u2705 Done\n```\n\nJCode uses **4 AI roles** (same local models, different specialised prompts) to build software the way an engineering team would:\n\n1. **\ud83e\udde0 Plan** \u2014 DeepSeek-R1 creates architecture, dependency graph, and a DAG of tasks\n2. **\ud83d\udcbb Code** \u2014 Qwen2.5-Coder generates each file using structured memory (not raw plan dumps)\n3. **\ud83d\udd0d Review** \u2014 Pre-execution code review catches bugs *before* they run\n4. **\u2705 Verify** \u2014 Static analysis: syntax check, linting (ruff/flake8), type checks\n5. **\ud83d\udd2c Analyze** \u2014 If verification fails, the Analyzer diagnoses the root cause\n6. **\ud83d\udd04 Patch** \u2014 Targeted minimal fix applied; re-verify; repeat up to 3\u00d7\n7. **\u2705 Done** \u2014 Verified project output with full DAG completion\n\n### Key Innovations\n\n- **DAG Task Tree** \u2014 tasks have dependencies; a file isn't generated until its deps are verified\n- **Structured Memory** \u2014 architecture summary + file index + failure log (not context dumps)\n- **Patch Mode** \u2014 fixes are minimal targeted patches, not full regeneration\n- **Self-Correction** \u2014 Analyzer\u2192Coder feedback loop avoids repeating the same mistake\n\n## Prerequisites\n\n- **Python 3.10+**\n- **Ollama** installed and running (`ollama serve`)\n- ~20 GB disk space for both models\n\n## Quick Start\n\n### One-Command Install (Recommended)\n\n**Mac / Linux:**\n```bash\ncurl -fsSL https://raw.githubusercontent.com/ShakenTheCoder/JcodeAgent/main/install.sh | bash\n```\n\n**Windows (PowerShell):**\n```powershell\niwr -useb https://raw.githubusercontent.com/ShakenTheCoder/JcodeAgent/main/install.ps1 | iex\n```\n\nInstalls Python, Ollama, AI models, and JCode \u2014 only what's missing. Then just run `jcode`.\n\n### Manual Install\n\n```bash\n# 1. Clone / navigate to the project\ncd JcodeAgent\n\n# 2. Install\npip install -e .\n\n# 3. Start Ollama (in another terminal)\nollama serve\n\n# 4. Pull models (first time only)\nollama pull deepseek-r1:14b\nollama pull qwen2.5-coder:14b\n\n# 5. Launch JCode\njcode\n```\n\n## Usage\n\n```\njcode> build a REST API with FastAPI that manages a todo list with SQLite\n```\n\nJCode will:\n1. Plan the architecture and create a dependency-ordered task DAG\n2. Generate each file with full architectural context\n3. Review each file for bugs before execution\n4. Run static analysis (syntax + lint)\n5. Auto-diagnose and patch any failures\n6. Output the complete verified project\n\n### Commands\n\n| Command | Description |\n|---------|-------------|\n| `build <prompt>` | Full pipeline: plan \u2192 generate \u2192 review \u2192 verify \u2192 fix |\n| `plan` | Show current plan and task statuses |\n| `files` | List generated files with sizes |\n| `tree` | Show project directory tree |\n| `projects` | List all saved projects |\n| `resume` | Resume last project |\n| `save` | Manually save session |\n| `load <path>` | Load session from file |\n| `settings` | View/edit settings |\n| `clear` | Clear screen |\n| `help` | Show help |\n| `quit` | Exit JCode |\n\n## Architecture\n\n```\njcode/\n\u251c\u2500\u2500 __init__.py          # Package metadata (v0.2.0)\n\u251c\u2500\u2500 __main__.py          # python -m jcode entry\n\u251c\u2500\u2500 cli.py               # Rich interactive CLI\n\u251c\u2500\u2500 config.py            # Models, TaskStatus, TaskNode, ProjectState\n\u251c\u2500\u2500 prompts.py           # All 4 role prompt templates\n\u251c\u2500\u2500 ollama_client.py     # Unified model caller with role dispatch\n\u251c\u2500\u2500 context.py           # Structured memory engine + DAG\n\u251c\u2500\u2500 planner.py           # Plan creation (DeepSeek-R1)\n\u251c\u2500\u2500 coder.py             # File generation + patch mode\n\u251c\u2500\u2500 reviewer.py          # Pre-execution code review\n\u251c\u2500\u2500 analyzer.py          # Error diagnosis + fix strategy\n\u251c\u2500\u2500 executor.py          # Verification pipeline (syntax/lint/type)\n\u251c\u2500\u2500 iteration.py         # DAG-based orchestration engine\n\u251c\u2500\u2500 file_manager.py      # File I/O + Rich directory tree\n\u2514\u2500\u2500 settings.py          # Persistent user settings\n```\n\n## 4-Role System\n\n| Role | Model | Prompt Style | Purpose |\n|------|-------|-------------|---------|\n| \ud83e\udde0 Planner | `deepseek-r1:14b` | Architecture-focused | Task DAG, tech stack, dependency graph |\n| \ud83d\udcbb Coder | `qwen2.5-coder:14b` | Implementation-focused | File generation, targeted patches |\n| \ud83d\udd0d Reviewer | `qwen2.5-coder:14b` | Audit-focused | Pre-execution bug/security review |\n| \ud83d\udd2c Analyzer | `deepseek-r1:14b` | Diagnostic-focused | Root cause analysis, fix strategy |\n\nSame model weights, different system prompts = role specialisation without extra downloads.\n\n## Task Pipeline\n\n```\nFor each task in DAG order:\n\n  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510     \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510     \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n  \u2502 GENERATE \u251c\u2500\u2500\u2500\u2500\u25ba\u2502  REVIEW  \u251c\u2500\u2500\u2500\u2500\u25ba\u2502  VERIFY  \u2502\n  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518     \u2514\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2518     \u2514\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2518\n                       \u2502                 \u2502\n                  issues?            passed?\n                       \u2502                 \u2502\n                  \u250c\u2500\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2500\u2500\u2510      \u250c\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2500\u2510\n                  \u2502  PATCH   \u2502      \u2502VERIFIED\u2502\n                  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518      \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                       \u2502\n                       \u2502 still fails?\n                       \u2502\n                  \u250c\u2500\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2500\u2500\u2510     \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n                  \u2502 ANALYZE  \u251c\u2500\u2500\u2500\u2500\u25ba\u2502  PATCH   \u251c\u2500\u2500\u25ba re-verify (up to 3\u00d7)\n                  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518     \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n```\n\n## Configuration\n\nSettings are stored in `~/.jcode/settings.json`:\n- Default output directory\n- Auto-save preference\n- Project metadata in `~/.jcode/projects/`\n\nSessions are auto-saved to `.jcode_session.json` in each project directory and can be resumed with `resume`.\n\n## License\n\nMIT\n",
      "TECHNICAL_GUIDE.md": "# JCode Technical Guide\n\n> Architecture deep-dive for developers who want to understand, extend, or contribute to JCode.\n\n---\n\n## Table of Contents\n\n1. [System Architecture](#system-architecture)\n2. [4-Role System](#4-role-system)\n3. [DAG Task Engine](#dag-task-engine)\n4. [Structured Memory](#structured-memory)\n5. [Prompt Engineering](#prompt-engineering)\n6. [Verification Pipeline](#verification-pipeline)\n7. [Self-Correction & Failure Escalation](#self-correction--failure-escalation)\n8. [CLI Architecture](#cli-architecture)\n9. [Module Reference](#module-reference)\n10. [Extending JCode](#extending-jcode)\n11. [Development Setup](#development-setup)\n\n---\n\n## System Architecture\n\n```\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                        CLI (cli.py)                          \u2502\n\u2502   Interactive launcher \u2192 project selection \u2192 build command   \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                   Iteration Engine (iteration.py)            \u2502\n\u2502   DAG traversal \u2192 per-task pipeline \u2192 failure escalation     \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502Planner \u2502 Coder  \u2502  Reviewer  \u2502 Analyzer  \u2502    Executor      \u2502\n\u2502 (R1)   \u2502 (Qwen) \u2502  (Qwen)    \u2502  (R1)     \u2502  (subprocess)   \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502               Context Manager (context.py)                   \u2502\n\u2502   Structured memory: arch summary, file index, failure log   \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                   Ollama Client (ollama_client.py)            \u2502\n\u2502   Unified call_model(role, messages) \u2192 streaming output      \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                   Ollama Server (localhost:11434)             \u2502\n\u2502   deepseek-r1:14b  \u00b7  qwen2.5-coder:14b                     \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n```\n\n### Data Flow\n\n```\nUser prompt\n    \u2502\n    \u25bc\nPlanner (deepseek-r1:14b) \u2500\u2500\u2500 outputs JSON \u2500\u2500\u25ba  Plan\n    \u2502                                            \u251c\u2500\u2500 architecture_summary\n    \u2502                                            \u251c\u2500\u2500 tech_stack\n    \u2502                                            \u251c\u2500\u2500 file_index\n    \u2502                                            \u2514\u2500\u2500 tasks[] (DAG)\n    \u25bc\nIteration Engine \u2500\u2500\u2500 for each task in topological order:\n    \u2502\n    \u251c\u2500\u2500 1. Coder.generate_file(task, structured_context)\n    \u251c\u2500\u2500 2. Reviewer.review_file(file, architecture)\n    \u251c\u2500\u2500 3. Executor.verify_file(file_path)\n    \u2502       \u251c\u2500\u2500 syntax check\n    \u2502       \u251c\u2500\u2500 lint (ruff/flake8)\n    \u2502       \u2514\u2500\u2500 type check (extensible)\n    \u2502\n    \u251c\u2500\u2500 if verify fails (up to 3\u00d7):\n    \u2502   \u251c\u2500\u2500 Analyzer.analyze_error(file, error, failure_log)\n    \u2502   \u251c\u2500\u2500 Coder.patch_file(file, fix_strategy)\n    \u2502   \u2514\u2500\u2500 re-verify\n    \u2502\n    \u251c\u2500\u2500 if 3\u00d7 fails \u2192 escalation:\n    \u2502   \u251c\u2500\u2500 option: re-plan with Planner\n    \u2502   \u251c\u2500\u2500 option: simplify task\n    \u2502   \u251c\u2500\u2500 option: skip and continue\n    \u2502   \u2514\u2500\u2500 option: pause for user input\n    \u2502\n    \u2514\u2500\u2500 mark task: VERIFIED | FAILED | SKIPPED\n```\n\n---\n\n## 4-Role System\n\nThe core insight: **same model weights, different system prompts = role specialisation**.\n\nWe use only 2 model downloads but create 4 distinct behaviours:\n\n### Role Assignments\n\n| Role | Model | Temperature | Purpose |\n|------|-------|------------|---------|\n| \ud83e\udde0 Planner | `deepseek-r1:14b` | 0.6 | Architecture, task DAG, dependency mapping |\n| \ud83d\udcbb Coder | `qwen2.5-coder:14b` | 0.15 | Deterministic code generation, patches |\n| \ud83d\udd0d Reviewer | `qwen2.5-coder:14b` | 0.3 | Pre-execution bug/security review |\n| \ud83d\udd2c Analyzer | `deepseek-r1:14b` | 0.2 | Root cause analysis, fix strategies |\n\n### Why This Works\n\n- **DeepSeek-R1** is a reasoning model \u2014 it uses `<think>` tags internally for chain-of-thought. Perfect for planning and diagnosis.\n- **Qwen2.5-Coder** is a code-specialised model \u2014 it produces cleaner, more syntactically correct code. Perfect for generation and review.\n- Low temperature on Coder (0.15) = deterministic, consistent output.\n- Higher temperature on Planner (0.6) = creative architecture exploration.\n\n### Role Isolation\n\nEach role has:\n- Its own system prompt (defined in `prompts.py`)\n- Its own conversation history (stored in `context.py`)\n- Its own context slice (only receives relevant information)\n\nThis prevents \"role confusion\" where the model might mix planning with coding.\n\n---\n\n## DAG Task Engine\n\nTasks are **not** executed linearly. They form a Directed Acyclic Graph (DAG).\n\n### TaskNode\n\n```python\n@dataclass\nclass TaskNode:\n    id: int\n    file: str              # e.g., \"src/models.py\"\n    description: str       # e.g., \"Define SQLAlchemy models\"\n    depends_on: list[int]  # e.g., [1, 2] \u2014 must be VERIFIED first\n    status: TaskStatus     # State machine\n    failure_count: int     # Per-task failure counter\n    error_summary: str     # Last error for this task\n    review_feedback: str   # Last reviewer feedback\n```\n\n### State Machine\n\n```\nPENDING \u2192 IN_PROGRESS \u2192 GENERATED \u2192 REVIEWING \u2192 VERIFIED\n                                         \u2502\n                                    NEEDS_FIX \u2190 \u2500 \u2500 \u2500 \u2510\n                                         \u2502              \u2502\n                                    [fix attempt]       \u2502\n                                         \u2502              \u2502\n                                    re-VERIFY \u2500\u2500\u2500\u2500 still fails?\n                                         \u2502\n                                    FAILED (after 3\u00d7) or SKIPPED\n```\n\n### Execution Order\n\n`get_ready_tasks()` returns only tasks where **all dependencies are VERIFIED**:\n\n```python\ndef get_ready_tasks(self) -> list[TaskNode]:\n    verified_ids = {t.id for t in self._task_dag if t.status == TaskStatus.VERIFIED}\n    return [\n        t for t in self._task_dag\n        if t.status == TaskStatus.PENDING\n        and all(dep in verified_ids for dep in t.depends_on)\n    ]\n```\n\n### Deadlock Detection\n\nIf no tasks are ready but some are pending (circular dependency or failed dependency), the engine detects the deadlock and skips blocked tasks.\n\n---\n\n## Structured Memory\n\n**The key innovation.** Instead of dumping the entire conversation into context (which wastes tokens on a 14B model), we slice information by role:\n\n### What Each Role Sees\n\n| Role | Receives | Does NOT receive |\n|------|----------|-----------------|\n| Coder | Architecture summary, file index, task description | Raw plan JSON, failure log, review history |\n| Reviewer | File content, architecture summary | Generation history, other files |\n| Analyzer | Error output, failure log (previous attempts) | Plan, other files |\n| Planner | Failure log, architecture summary | Individual file contents |\n\n### Memory Layers\n\n1. **architecture_summary** \u2014 one-paragraph description of the system\n2. **file_index** \u2014 every file and its one-line purpose\n3. **dependency_graph** \u2014 who imports whom\n4. **failure_log** \u2014 what broke, what was tried, what worked\n5. **task_nodes** \u2014 current DAG state with statuses\n\n### Why This Matters\n\nA 14B model with 16k context and **curated 2k of structured memory** outperforms a 70B model with 128k context and raw dumps. Signal-to-noise ratio is everything.\n\n---\n\n## Prompt Engineering\n\n### DeepSeek-R1 Think Tags\n\nDeepSeek-R1 outputs `<think>...</think>` blocks for chain-of-thought reasoning. We strip these before parsing JSON:\n\n```python\ndef _extract_json(text: str) -> dict:\n    # Remove <think> blocks\n    text = re.sub(r\"<think>.*?</think>\", \"\", text, flags=re.DOTALL)\n    # Find JSON in remaining text\n    match = re.search(r\"\\{.*\\}\", text, re.DOTALL)\n    return json.loads(match.group()) if match else {}\n```\n\n### JSON-Only Output\n\nAll roles that need structured output are prompted with explicit JSON schemas:\n\n```\nYou MUST respond with a JSON object:\n{\n  \"approved\": true/false,\n  \"issues\": [{\"severity\": \"critical|warning|info\", \"description\": \"...\"}],\n  \"summary\": \"...\"\n}\n```\n\n### Prompt Structure\n\nEach prompt follows this pattern:\n1. **Role identity** \u2014 \"You are a senior code reviewer...\"\n2. **Constraints** \u2014 \"Respond ONLY with JSON. No explanation.\"\n3. **Context injection** \u2014 Architecture summary, file index (sliced)\n4. **Task** \u2014 Specific instruction for this file/error\n5. **Output schema** \u2014 Exact JSON structure expected\n\n---\n\n## Verification Pipeline\n\nMulti-check quality gate per file (`executor.py`):\n\n### Checks by Language\n\n| Language | Syntax | Lint | Type Check |\n|----------|--------|------|-----------|\n| Python | `py_compile` | `ruff` \u2192 `flake8` fallback | extensible |\n| JavaScript | `node --check` | \u2014 | \u2014 |\n| JSON | `json.loads()` | \u2014 | \u2014 |\n\n### VerificationResult\n\n```python\n@dataclass\nclass VerificationResult:\n    passed: bool\n    checks: dict[str, tuple[bool, str]]  # check_name \u2192 (passed, detail)\n    \n    @property\n    def summary(self) -> str:\n        return \"\\n\".join(f\"{'\u2705' if ok else '\u274c'} {name}: {msg}\"\n                        for name, (ok, msg) in self.checks.items())\n    \n    @property\n    def failed_checks(self) -> list[str]:\n        return [name for name, (ok, _) in self.checks.items() if not ok]\n```\n\n---\n\n## Self-Correction & Failure Escalation\n\n### Fix Loop (Per Task)\n\n```\nAttempt 1: Analyzer diagnoses \u2192 Coder patches \u2192 Verify\nAttempt 2: Analyzer diagnoses (with attempt 1 in failure_log) \u2192 Coder patches \u2192 Verify\nAttempt 3: Analyzer diagnoses (with attempts 1-2 in failure_log) \u2192 Coder patches \u2192 Verify\n```\n\nThe failure_log prevents the Analyzer from suggesting the same fix twice.\n\n### Escalation (After 3 Failures)\n\nWhen a task exhausts all fix attempts, the engine offers 4 strategies:\n\n1. **Re-plan** \u2014 Send failure context back to Planner for an alternative approach\n2. **Simplify** \u2014 Regenerate with a simplified task description\n3. **Skip** \u2014 Mark as SKIPPED, continue with remaining tasks\n4. **Pause** \u2014 Ask the user what to do\n\nThe engine picks automatically based on context, or asks the user in interactive mode.\n\n---\n\n## CLI Architecture\n\n### Launch Flow\n\n```\njcode\n  \u251c\u2500\u2500 First run? \u2192 Setup wizard (choose output dir)\n  \u251c\u2500\u2500 Check Ollama \u2192 fail fast if not running\n  \u2514\u2500\u2500 Interactive launcher:\n      \u251c\u2500\u2500 \ud83c\udd95 Create new project\n      \u2502   \u251c\u2500\u2500 Enter prompt\n      \u2502   \u251c\u2500\u2500 (Optional) clone GitHub repo as base\n      \u2502   \u2514\u2500\u2500 \u2192 Plan \u2192 Build pipeline\n      \u251c\u2500\u2500 \ud83d\udcc2 Continue a project (select from list)\n      \u2502   \u2514\u2500\u2500 \u2192 Resume from last state\n      \u251c\u2500\u2500 \ud83d\udce5 Import a project\n      \u2502   \u251c\u2500\u2500 Local path\n      \u2502   \u2514\u2500\u2500 GitHub URL \u2192 clone\n      \u2514\u2500\u2500 After build \u2192 REPL with commands\n```\n\n### Available Commands\n\n| Command | Module | Description |\n|---------|--------|-------------|\n| `build` | `cli.py` | Full pipeline |\n| `plan` | `cli.py` | Show current plan |\n| `files` | `cli.py` | List generated files |\n| `tree` | `file_manager.py` | Directory tree |\n| `projects` | `settings.py` | List saved projects |\n| `resume` | `cli.py` | Resume last project |\n| `update` | `cli.py` | Self-update JCode |\n| `save/load` | `context.py` | Session management |\n| `settings` | `settings.py` | Edit preferences |\n\n---\n\n## Module Reference\n\n| Module | Lines | Purpose |\n|--------|-------|---------|\n| `config.py` | ~190 | Models, TaskStatus, TaskNode, ProjectState, complexity detection |\n| `prompts.py` | ~200 | All 4 role system/task prompts with JSON schemas |\n| `ollama_client.py` | ~120 | Unified `call_model(role, msgs)`, streaming, model verification |\n| `context.py` | ~300 | Structured memory engine, DAG, session serialization |\n| `planner.py` | ~80 | `create_plan()`, `refine_plan()`, think-tag stripping |\n| `coder.py` | ~100 | `generate_file()`, `patch_file()`, fence stripping |\n| `reviewer.py` | ~60 | `review_file()` \u2192 JSON verdict |\n| `analyzer.py` | ~70 | `analyze_error()` \u2192 structured diagnosis |\n| `executor.py` | ~150 | `verify_file()`, multi-language checks |\n| `iteration.py` | ~240 | DAG orchestrator, fix loop, escalation |\n| `cli.py` | ~450 | Interactive CLI, launcher, all commands |\n| `settings.py` | ~120 | Persistent settings in `~/.jcode/` |\n| `file_manager.py` | ~90 | File I/O, Rich directory tree |\n\n---\n\n## Extending JCode\n\n### Adding a New Role\n\n1. Add model config in `config.py` (or reuse existing model)\n2. Create system + task prompts in `prompts.py`\n3. Create the role module (e.g., `tester.py`)\n4. Wire it into `iteration.py`'s pipeline\n5. Add conversation history in `context.py`\n\n### Adding a New Language Verifier\n\nIn `executor.py`, add a new case to `verify_file()`:\n\n```python\nelif suffix == \".rs\":\n    result = _verify_rust(file_path)\n```\n\nThen implement `_verify_rust()` following the pattern of `_verify_python()`.\n\n### Adding a New CLI Command\n\n1. Add the command handler as `_cmd_yourcommand()` in `cli.py`\n2. Add it to the dispatch block in `main()`\n3. Update `HELP_TEXT`\n\n### Custom Specialisation Templates\n\nCreate prompt templates for specific tech stacks:\n\n```python\nFASTAPI_TEMPLATE = {\n    \"tech_stack\": [\"python\", \"fastapi\", \"sqlalchemy\", \"pydantic\"],\n    \"files_hint\": [\"main.py\", \"models.py\", \"schemas.py\", \"database.py\", \"routers/\"],\n    \"conventions\": \"Use async endpoints. Use Pydantic v2 model_validator.\"\n}\n```\n\n---\n\n## Development Setup\n\n```bash\n# Clone\ngit clone https://github.com/YOUR_USERNAME/JcodeAgent.git\ncd JcodeAgent\n\n# Create venv\npython3 -m venv .venv\nsource .venv/bin/activate\n\n# Install in dev mode\npip install -e .\n\n# Run\njcode\n\n# Run module directly\npython -m jcode\n```\n\n### Project Structure\n\n```\nJcodeAgent/\n\u251c\u2500\u2500 jcode/                 # Source package\n\u2502   \u251c\u2500\u2500 __init__.py\n\u2502   \u251c\u2500\u2500 __main__.py\n\u2502   \u251c\u2500\u2500 cli.py\n\u2502   \u251c\u2500\u2500 config.py\n\u2502   \u251c\u2500\u2500 context.py\n\u2502   \u251c\u2500\u2500 prompts.py\n\u2502   \u251c\u2500\u2500 ollama_client.py\n\u2502   \u251c\u2500\u2500 planner.py\n\u2502   \u251c\u2500\u2500 coder.py\n\u2502   \u251c\u2500\u2500 reviewer.py\n\u2502   \u251c\u2500\u2500 analyzer.py\n\u2502   \u251c\u2500\u2500 executor.py\n\u2502   \u251c\u2500\u2500 iteration.py\n\u2502   \u251c\u2500\u2500 file_manager.py\n\u2502   \u2514\u2500\u2500 settings.py\n\u251c\u2500\u2500 docs/                  # Landing page\n\u2502   \u2514\u2500\u2500 index.html\n\u251c\u2500\u2500 install.sh             # Mac/Linux installer\n\u251c\u2500\u2500 install.ps1            # Windows installer\n\u251c\u2500\u2500 pyproject.toml\n\u251c\u2500\u2500 requirements.txt\n\u251c\u2500\u2500 README.md\n\u251c\u2500\u2500 CHANGELOG.md\n\u251c\u2500\u2500 FEATURES.md\n\u251c\u2500\u2500 BEGINNER_GUIDE.md\n\u2514\u2500\u2500 TECHNICAL_GUIDE.md\n```\n",
      "VERCEL_DEPLOY.md": "# Vercel Deployment Checklist\n\n## \u2705 Code Changes (DONE)\n- [x] Created Vercel API endpoints for install tracking\n- [x] Added analytics dashboard at /api/stats\n- [x] Updated install commands in docs to use getjcode.vercel.app\n- [x] Added `version` command to CLI\n- [x] Bumped version to 0.5.3\n- [x] Committed (1c09b08) and pushed to main\n\n## \ud83d\ude80 Vercel Setup (DO THIS NOW)\n\n### 1. Enable Vercel KV\n1. Go to https://vercel.com/dashboard\n2. Select your `getjcode.vercel.app` project\n3. Navigate to **Storage** tab\n4. Click **Create Database** \u2192 Select **KV**\n5. Name: `jcode-analytics` (or any name)\n6. Click **Create & Continue**\n7. Connect to your project\n\n### 2. Deploy (if auto-deploy not enabled)\n```bash\ncd docs\nvercel --prod\n```\n\n### 3. Test the Endpoints\n```bash\n# Test install script (should log analytics + return script)\ncurl -v https://getjcode.vercel.app/install.sh | head -20\n\n# Check analytics dashboard\nopen https://getjcode.vercel.app/api/stats\n```\n\n## \ud83d\udcca Analytics Schema\n\nAfter first install, Vercel KV will have:\n```\njcode:install:count:unix      \u2192 1\njcode:install:count:windows   \u2192 0\njcode:installs                \u2192 [\"{\"ip\":\"...\", \"timestamp\":\"...\", ...}\"]\njcode:installs:2026-02-XX     \u2192 1\n```\n\n## \ud83e\uddea Test Locally (Optional)\n```bash\n# Requires Vercel CLI with KV connected\ncd docs\nvercel dev\n# Visit http://localhost:3000/api/stats\n```\n\n## \ud83d\udcdd Notes\n- Analytics fail gracefully \u2014 if KV is down, install script still returns\n- Vercel free tier: 256MB storage, 10k requests/day (more than enough)\n- See `docs/ANALYTICS.md` for detailed documentation\n",
      "docs/ANALYTICS.md": "# JCode Analytics Setup\n\nThis document explains the analytics infrastructure for tracking JCode installs.\n\n## Architecture\n\nThe install analytics system uses Vercel Edge Functions + Vercel KV (Redis) to track installations in real-time.\n\n### Endpoints\n\n- **`/install.sh`** \u2192 `/api/install.sh.js` \u2014 Tracks Unix/Linux/macOS installs\n- **`/install.ps1`** \u2192 `/api/install.ps1.js` \u2014 Tracks Windows installs\n- **`/api/stats`** \u2192 `/api/stats.js` \u2014 Analytics dashboard\n\n### Data Collected\n\nEach install logs:\n- **IP Address** (first in proxy chain)\n- **Timestamp** (ISO 8601)\n- **User-Agent** string\n- **OS** (inferred from User-Agent: macOS, Linux, Windows)\n- **Platform** (`unix` or `windows`)\n\n### Storage Schema (Vercel KV)\n\n```\njcode:install:count:unix      \u2192 Integer (total Unix installs)\njcode:install:count:windows   \u2192 Integer (total Windows installs)\njcode:installs                \u2192 List (last 1000 installs, JSON strings)\njcode:installs:YYYY-MM-DD     \u2192 Integer (daily install count, 90-day TTL)\n```\n\n## Vercel Setup\n\n### 1. Enable Vercel KV\n\n1. Go to your Vercel project dashboard\n2. Navigate to **Storage** \u2192 **Create Database** \u2192 **KV**\n3. Name it `jcode-analytics` (or any name)\n4. Click **Create & Continue**\n5. Connect to your project (select `getjcode.vercel.app`)\n\n### 2. Environment Variables\n\nVercel KV automatically injects these variables:\n- `KV_REST_API_URL`\n- `KV_REST_API_TOKEN`\n- `KV_REST_API_READ_ONLY_TOKEN`\n\nNo manual configuration needed \u2014 the `@vercel/kv` package uses them automatically.\n\n### 3. Deploy\n\n```bash\n# From the JcodeAgent repo root\ncd docs\nvercel --prod\n```\n\nThe `vercel.json` config ensures `/install.sh` and `/install.ps1` are rewritten to the API endpoints.\n\n## Testing Locally\n\nInstall Vercel CLI:\n```bash\nnpm i -g vercel\n```\n\nRun dev server:\n```bash\ncd docs\nvercel dev\n```\n\nVisit:\n- `http://localhost:3000/install.sh` \u2014 Should return the install script\n- `http://localhost:3000/api/stats` \u2014 Should show analytics dashboard\n\n## Dashboard\n\nVisit **`https://getjcode.vercel.app/api/stats`** to see:\n- Total installs (Unix + Windows)\n- Today's installs\n- OS distribution (macOS, Linux, Windows)\n- Last 20 installs with timestamps\n\n## Maintenance\n\n- **Data retention**: Last 1000 installs kept in `jcode:installs` list\n- **Daily stats**: Expire after 90 days\n- **KV limits**: Vercel free tier = 256MB storage, 10k requests/day (plenty for this use case)\n\n## Privacy\n\n- IPs are stored but not displayed publicly on the dashboard\n- No personally identifiable information beyond IP/UA\n- Data is used solely for install metrics\n\n## Troubleshooting\n\nIf analytics fail (e.g., KV down), the install script still returns successfully \u2014 errors are logged but don't block installs.\n\nCheck Vercel logs:\n```bash\nvercel logs --prod\n```\n",
      "docs/api/install.ps1.js": "// Serverless function: /api/install.ps1\n// Tracks Windows installs and serves the PowerShell script\n\nimport { kv } from '@vercel/kv';\n\nexport const config = {\n  runtime: 'edge',\n};\n\nconst INSTALL_SCRIPT_URL = 'https://raw.githubusercontent.com/ShakenTheCoder/JcodeAgent/main/install.ps1';\n\nexport default async function handler(req) {\n  const ip = req.headers.get('x-forwarded-for') || req.headers.get('x-real-ip') || 'unknown';\n  const userAgent = req.headers.get('user-agent') || 'unknown';\n  const timestamp = new Date().toISOString();\n  \n  const installData = {\n    ip: ip.split(',')[0].trim(),\n    timestamp,\n    userAgent,\n    os: 'Windows',\n    platform: 'windows',\n  };\n\n  try {\n    await kv.incr('jcode:install:count:windows');\n    await kv.lpush('jcode:installs', JSON.stringify(installData));\n    await kv.ltrim('jcode:installs', 0, 999);\n    \n    const dateKey = `jcode:installs:${timestamp.split('T')[0]}`;\n    await kv.incr(dateKey);\n    await kv.expire(dateKey, 90 * 24 * 60 * 60);\n  } catch (err) {\n    console.error('Analytics error:', err);\n  }\n\n  try {\n    const response = await fetch(INSTALL_SCRIPT_URL);\n    const script = await response.text();\n    \n    return new Response(script, {\n      status: 200,\n      headers: {\n        'Content-Type': 'text/plain',\n        'Cache-Control': 'public, max-age=300',\n      },\n    });\n  } catch (err) {\n    return new Response('# Error\\nWrite-Host \"Failed to download installer. Visit https://github.com/ShakenTheCoder/JcodeAgent\" -ForegroundColor Red', {\n      status: 500,\n      headers: { 'Content-Type': 'text/plain' },\n    });\n  }\n}\n",
      "docs/api/install.sh.js": "// Serverless function: /api/install.sh\n// Tracks installs and serves the install script\n\nimport { kv } from '@vercel/kv';\n\nexport const config = {\n  runtime: 'edge',\n};\n\nconst INSTALL_SCRIPT_URL = 'https://raw.githubusercontent.com/ShakenTheCoder/JcodeAgent/main/install.sh';\n\nexport default async function handler(req) {\n  const ip = req.headers.get('x-forwarded-for') || req.headers.get('x-real-ip') || 'unknown';\n  const userAgent = req.headers.get('user-agent') || 'unknown';\n  const timestamp = new Date().toISOString();\n  \n  // Infer OS from User-Agent\n  let os = 'unknown';\n  if (userAgent.includes('Mac')) os = 'macOS';\n  else if (userAgent.includes('Linux')) os = 'Linux';\n  else if (userAgent.includes('Windows')) os = 'Windows';\n  \n  // Log install attempt\n  const installData = {\n    ip: ip.split(',')[0].trim(), // First IP in case of proxy chain\n    timestamp,\n    userAgent,\n    os,\n    platform: 'unix',\n  };\n\n  try {\n    // Increment global counter\n    await kv.incr('jcode:install:count:unix');\n    \n    // Log individual install\n    await kv.lpush('jcode:installs', JSON.stringify(installData));\n    \n    // Keep only last 1000 installs\n    await kv.ltrim('jcode:installs', 0, 999);\n    \n    // Track daily installs\n    const dateKey = `jcode:installs:${timestamp.split('T')[0]}`;\n    await kv.incr(dateKey);\n    await kv.expire(dateKey, 90 * 24 * 60 * 60); // 90 days expiry\n  } catch (err) {\n    console.error('Analytics error:', err);\n    // Don't fail install if analytics fail\n  }\n\n  // Fetch and return the actual install script\n  try {\n    const response = await fetch(INSTALL_SCRIPT_URL);\n    const script = await response.text();\n    \n    return new Response(script, {\n      status: 200,\n      headers: {\n        'Content-Type': 'text/plain',\n        'Cache-Control': 'public, max-age=300', // Cache for 5 minutes\n      },\n    });\n  } catch (err) {\n    return new Response('# Error fetching install script\\necho \"Failed to download installer. Please try again or visit https://github.com/ShakenTheCoder/JcodeAgent\"', {\n      status: 500,\n      headers: { 'Content-Type': 'text/plain' },\n    });\n  }\n}\n",
      "docs/api/stats.js": "// Serverless function: /api/stats\n// Analytics dashboard showing install metrics\n\nimport { kv } from '@vercel/kv';\n\nexport const config = {\n  runtime: 'edge',\n};\n\nexport default async function handler(req) {\n  try {\n    // Get total install counts\n    const unixCount = await kv.get('jcode:install:count:unix') || 0;\n    const windowsCount = await kv.get('jcode:install:count:windows') || 0;\n    const totalCount = Number(unixCount) + Number(windowsCount);\n    \n    // Get recent installs\n    const recentInstalls = await kv.lrange('jcode:installs', 0, 49); // Last 50\n    const parsedInstalls = recentInstalls.map(item => JSON.parse(item));\n    \n    // Calculate OS distribution\n    const osDistribution = {\n      macOS: 0,\n      Linux: 0,\n      Windows: Number(windowsCount),\n      unknown: 0,\n    };\n    \n    parsedInstalls.forEach(install => {\n      if (install.os === 'macOS') osDistribution.macOS++;\n      else if (install.os === 'Linux') osDistribution.Linux++;\n      else if (install.os === 'unknown') osDistribution.unknown++;\n    });\n    \n    // Get today's installs\n    const today = new Date().toISOString().split('T')[0];\n    const todayCount = await kv.get(`jcode:installs:${today}`) || 0;\n    \n    // Generate HTML response\n    const html = `<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>JCode Install Analytics</title>\n    <style>\n        * { margin: 0; padding: 0; box-sizing: border-box; }\n        body {\n            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;\n            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n            color: #fff;\n            padding: 40px 20px;\n            min-height: 100vh;\n        }\n        .container {\n            max-width: 1200px;\n            margin: 0 auto;\n        }\n        h1 {\n            font-size: 2.5rem;\n            margin-bottom: 40px;\n            text-align: center;\n            text-shadow: 2px 2px 4px rgba(0,0,0,0.2);\n        }\n        .stats-grid {\n            display: grid;\n            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));\n            gap: 20px;\n            margin-bottom: 40px;\n        }\n        .stat-card {\n            background: rgba(255, 255, 255, 0.1);\n            backdrop-filter: blur(10px);\n            border-radius: 12px;\n            padding: 30px;\n            border: 1px solid rgba(255, 255, 255, 0.2);\n        }\n        .stat-value {\n            font-size: 3rem;\n            font-weight: bold;\n            margin-bottom: 10px;\n        }\n        .stat-label {\n            font-size: 1rem;\n            opacity: 0.9;\n            text-transform: uppercase;\n            letter-spacing: 1px;\n        }\n        .recent-installs {\n            background: rgba(255, 255, 255, 0.1);\n            backdrop-filter: blur(10px);\n            border-radius: 12px;\n            padding: 30px;\n            border: 1px solid rgba(255, 255, 255, 0.2);\n        }\n        .recent-installs h2 {\n            margin-bottom: 20px;\n            font-size: 1.5rem;\n        }\n        .install-item {\n            padding: 15px;\n            background: rgba(0, 0, 0, 0.2);\n            border-radius: 8px;\n            margin-bottom: 10px;\n            display: flex;\n            justify-content: space-between;\n            align-items: center;\n            flex-wrap: wrap;\n            gap: 10px;\n        }\n        .install-time {\n            opacity: 0.8;\n            font-size: 0.9rem;\n        }\n        .install-os {\n            background: rgba(255, 255, 255, 0.2);\n            padding: 4px 12px;\n            border-radius: 20px;\n            font-size: 0.85rem;\n        }\n    </style>\n</head>\n<body>\n    <div class=\"container\">\n        <h1>\ud83d\udcca JCode Install Analytics</h1>\n        \n        <div class=\"stats-grid\">\n            <div class=\"stat-card\">\n                <div class=\"stat-value\">${totalCount}</div>\n                <div class=\"stat-label\">Total Installs</div>\n            </div>\n            <div class=\"stat-card\">\n                <div class=\"stat-value\">${todayCount}</div>\n                <div class=\"stat-label\">Today</div>\n            </div>\n            <div class=\"stat-card\">\n                <div class=\"stat-value\">${osDistribution.macOS}</div>\n                <div class=\"stat-label\">macOS</div>\n            </div>\n            <div class=\"stat-card\">\n                <div class=\"stat-value\">${osDistribution.Linux}</div>\n                <div class=\"stat-label\">Linux</div>\n            </div>\n            <div class=\"stat-card\">\n                <div class=\"stat-value\">${osDistribution.Windows}</div>\n                <div class=\"stat-label\">Windows</div>\n            </div>\n        </div>\n        \n        <div class=\"recent-installs\">\n            <h2>Recent Installs</h2>\n            ${parsedInstalls.slice(0, 20).map(install => {\n                const date = new Date(install.timestamp);\n                const timeStr = date.toLocaleString('en-US', { \n                    month: 'short', \n                    day: 'numeric', \n                    hour: '2-digit', \n                    minute: '2-digit' \n                });\n                return `\n                    <div class=\"install-item\">\n                        <span class=\"install-time\">${timeStr}</span>\n                        <span class=\"install-os\">${install.os}</span>\n                    </div>\n                `;\n            }).join('')}\n        </div>\n    </div>\n</body>\n</html>`;\n    \n    return new Response(html, {\n      status: 200,\n      headers: {\n        'Content-Type': 'text/html',\n        'Cache-Control': 'public, max-age=60', // Cache for 1 minute\n      },\n    });\n  } catch (err) {\n    console.error('Stats error:', err);\n    return new Response(`Error loading stats: ${err.message}`, {\n      status: 500,\n      headers: { 'Content-Type': 'text/plain' },\n    });\n  }\n}\n",
      "docs/beginner-guide.html": "<!DOCTYPE html>\n<html lang=\"en\" data-theme=\"dark\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>JCode \u2014 Beginner Guide</title>\n    <link rel=\"icon\" href=\"JcodeLogo.ico\" type=\"image/x-icon\">\n    <style>\n        *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }\n        :root {\n            --font-mono: 'SF Mono', 'Fira Code', 'JetBrains Mono', 'Cascadia Code', 'Consolas', monospace;\n            --font-sans: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;\n            --transition: 0.3s ease;\n        }\n        [data-theme=\"dark\"] {\n            --bg: #050508; --bg-card: #0c0c12; --bg-terminal: #0a0e17;\n            --text: #d4d4d8; --text-dim: #52525b; --accent: #22d3ee;\n            --accent-dim: rgba(34,211,238,0.08); --accent-glow: rgba(34,211,238,0.2);\n            --border: #1a1a2e; --border-glow: rgba(34,211,238,0.15);\n        }\n        [data-theme=\"light\"] {\n            --bg: #f8fafc; --bg-card: #ffffff; --bg-terminal: #f1f5f9;\n            --text: #1e293b; --text-dim: #64748b; --accent: #0891b2;\n            --accent-dim: rgba(8,145,178,0.06); --accent-glow: rgba(8,145,178,0.15);\n            --border: #e2e8f0; --border-glow: rgba(8,145,178,0.1);\n        }\n        body { font-family: var(--font-sans); background: var(--bg); color: var(--text); line-height: 1.8; transition: background var(--transition), color var(--transition); }\n        a { color: var(--accent); text-decoration: none; }\n        a:hover { text-decoration: underline; }\n        .container { max-width: 780px; margin: 0 auto; padding: 0 2rem; }\n\n        /* Theme Toggle */\n        .theme-switch { position: fixed; top: 1.5rem; right: 1.5rem; z-index: 100; display: flex; align-items: center; gap: 0.5rem; }\n        .switch { position: relative; width: 48px; height: 26px; }\n        .switch input { opacity: 0; width: 0; height: 0; }\n        .switch .slider { position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; background: var(--border); border: 1px solid var(--border-glow); border-radius: 26px; transition: all var(--transition); }\n        .switch .slider::before { content: ''; position: absolute; height: 20px; width: 20px; left: 2px; bottom: 2px; background: var(--accent); border-radius: 50%; transition: all var(--transition); box-shadow: 0 0 8px var(--accent-glow); }\n        .switch input:checked + .slider::before { transform: translateX(22px); }\n        .switch-icon { font-size: 0.85rem; }\n\n        nav { padding: 1.5rem 0; display: flex; align-items: center; justify-content: space-between; border-bottom: 1px solid var(--border); margin-bottom: 3rem; }\n        .nav-logo { font-size: 1.1rem; font-weight: 700; color: var(--accent); font-family: var(--font-mono); }\n        .nav-links { display: flex; gap: 1.5rem; }\n        .nav-links a { color: var(--text-dim); font-size: 0.8rem; font-family: var(--font-mono); }\n        .nav-links a:hover { color: var(--accent); text-decoration: none; }\n\n        h1 { font-size: 2rem; font-weight: 700; margin-bottom: 0.5rem; }\n        h1 .accent { color: var(--accent); }\n        .hero-sub { color: var(--text-dim); font-size: 1rem; margin-bottom: 3rem; }\n\n        h2 { font-size: 1.3rem; font-weight: 700; margin-top: 3rem; margin-bottom: 1rem; padding-bottom: 0.5rem; border-bottom: 1px solid var(--border); }\n        h3 { font-size: 1.05rem; font-weight: 600; margin-top: 1.5rem; margin-bottom: 0.5rem; color: var(--accent); }\n\n        p { margin-bottom: 1rem; }\n        ul, ol { margin-bottom: 1rem; padding-left: 1.5rem; }\n        li { margin-bottom: 0.3rem; }\n\n        code {\n            font-family: var(--font-mono); font-size: 0.85em;\n            background: var(--bg-terminal); padding: 0.15rem 0.4rem;\n            border-radius: 4px; border: 1px solid var(--border);\n        }\n        pre {\n            background: var(--bg-terminal); border: 1px solid var(--border);\n            border-radius: 10px; padding: 1.2rem 1.5rem;\n            overflow-x: auto; margin-bottom: 1.5rem;\n            font-family: var(--font-mono); font-size: 0.85rem;\n            line-height: 1.6;\n        }\n        pre code { background: none; border: none; padding: 0; }\n\n        .callout {\n            background: var(--accent-dim); border-left: 3px solid var(--accent);\n            padding: 1rem 1.2rem; border-radius: 0 8px 8px 0;\n            margin-bottom: 1.5rem; font-size: 0.9rem;\n        }\n        .callout strong { color: var(--accent); }\n\n        .step-grid {\n            display: grid; grid-template-columns: 40px 1fr;\n            gap: 0 1rem; margin-bottom: 1.5rem;\n        }\n        .step-num {\n            font-family: var(--font-mono); font-size: 0.8rem;\n            color: var(--accent); font-weight: 700;\n            padding-top: 0.15rem;\n        }\n\n        footer { border-top: 1px solid var(--border); padding: 2rem 0; text-align: center; color: var(--text-dim); font-size: 0.75rem; font-family: var(--font-mono); margin-top: 4rem; }\n\n        @media (max-width: 600px) { .container { padding: 0 1rem; } }\n    </style>\n</head>\n<body>\n\n<div class=\"theme-switch\">\n    \n    <label class=\"switch\"><input type=\"checkbox\" id=\"theme-checkbox\" onchange=\"toggleTheme()\"><span class=\"slider\"></span></label>\n   \n</div>\n\n<div class=\"container\">\n    <nav>\n        <a class=\"nav-logo\" href=\"index.html\">&gt; jcode</a>\n        <div class=\"nav-links\">\n            <a href=\"index.html\">Home</a>\n            <a href=\"technical.html\">Technical Docs</a>\n            <a href=\"https://github.com/ShakenTheCoder/JcodeAgent\" target=\"_blank\">GitHub</a>\n        </div>\n    </nav>\n\n    <h1>Beginner <span class=\"accent\">Guide</span></h1>\n    <p class=\"hero-sub\">Everything you need to get started with JCode &mdash; from installation to your first project.</p>\n\n    <!-- Prerequisites -->\n    <h2>Prerequisites</h2>\n    <p>Before installing JCode, make sure you have:</p>\n    <ul>\n        <li><strong>Python 3.10+</strong> &mdash; Check with <code>python3 --version</code></li>\n        <li><strong>Ollama</strong> &mdash; Install from <a href=\"https://ollama.ai\" target=\"_blank\">ollama.ai</a></li>\n        <li><strong>8GB+ RAM</strong> &mdash; For running 14B parameter models locally</li>\n        <li><strong>20GB+ disk space</strong> &mdash; For the two AI models (~7GB each)</li>\n    </ul>\n\n    <div class=\"callout\">\n        <strong>Note:</strong> JCode runs entirely on your machine. No API keys, no cloud accounts, and no internet connection required after installation.\n    </div>\n\n    <!-- Installation -->\n    <h2>Installation</h2>\n    <h3>One-command install (recommended)</h3>\n    <p>Mac / Linux:</p>\n    <pre><code>curl -fsSL https://getjcode.vercel.app/install.sh | bash</code></pre>\n    <p>Windows (PowerShell):</p>\n    <pre><code>iwr -useb https://getjcode.vercel.app/install.ps1 | iex</code></pre>\n    <p>The installer will:</p>\n    <ol>\n        <li>Clone the JCode repository</li>\n        <li>Create a Python virtual environment</li>\n        <li>Install all dependencies</li>\n        <li>Pull the required AI models (deepseek-r1:14b + qwen2.5-coder:14b)</li>\n        <li>Add <code>jcode</code> to your PATH</li>\n    </ol>\n\n    <h3>Manual install</h3>\n    <pre><code>git clone https://github.com/ShakenTheCoder/JcodeAgent.git\ncd JcodeAgent\npython3 -m venv .venv\nsource .venv/bin/activate\npip install -e .\nollama pull deepseek-r1:14b\nollama pull qwen2.5-coder:14b</code></pre>\n\n    <!-- First Launch -->\n    <h2>First Launch</h2>\n    <p>Start JCode by typing:</p>\n    <pre><code>jcode</code></pre>\n    <p>On your first run, JCode will ask for two permissions:</p>\n    <ul>\n        <li><strong>Autonomous file access</strong> &mdash; Lets JCode read and write files in your project directories</li>\n        <li><strong>Internet access</strong> &mdash; Lets JCode search the web for documentation and solutions</li>\n    </ul>\n    <p>Both are optional. You only get asked once &mdash; your choices are saved permanently.</p>\n\n    <!-- Your First Project -->\n    <h2>Your First Project</h2>\n    <p>Here is a step-by-step walkthrough of building your first project:</p>\n\n    <div class=\"step-grid\">\n        <div class=\"step-num\">01</div>\n        <div>\n            <p><strong>Start JCode and type your project idea:</strong></p>\n            <pre><code>jcode> build a todo app with Flask and SQLite</code></pre>\n        </div>\n\n        <div class=\"step-num\">02</div>\n        <div>\n            <p><strong>JCode plans the architecture.</strong> The Planner breaks down your idea into a dependency-ordered task graph. You will see something like:</p>\n            <pre><code>12:04:01  PHASE 1   Planning project architecture\n12:04:12  PLAN      5 task(s) created</code></pre>\n        </div>\n\n        <div class=\"step-num\">03</div>\n        <div>\n            <p><strong>JCode generates and reviews each file.</strong> Every file goes through: generate &rarr; review &rarr; verify. If anything fails, the fix engine kicks in automatically.</p>\n            <pre><code>12:04:15  GENERATE  app.py\n12:04:22  REVIEW    Approved\n12:04:23  VERIFY    passed</code></pre>\n        </div>\n\n        <div class=\"step-num\">04</div>\n        <div>\n            <p><strong>Build complete.</strong> Once all files pass, you drop into the project REPL:</p>\n            <pre><code>12:05:10  DONE      Build complete -- all files verified\n\ntodo-app></code></pre>\n        </div>\n\n        <div class=\"step-num\">05</div>\n        <div>\n            <p><strong>Chat naturally to iterate.</strong> Add features, fix bugs, or ask questions:</p>\n            <pre><code>todo-app> add user authentication with password hashing\ntodo-app> why did you use Flask-Login instead of JWT?\ntodo-app> make the UI look more modern</code></pre>\n        </div>\n\n        <div class=\"step-num\">06</div>\n        <div>\n            <p><strong>Run your project.</strong> Type <code>run</code> and JCode auto-detects the right command:</p>\n            <pre><code>todo-app> run\nRunning: python app.py\n * Running on http://127.0.0.1:5000</code></pre>\n        </div>\n    </div>\n\n    <!-- Chat Mode -->\n    <h2>Chat Mode</h2>\n    <p>Once inside a project, everything is natural language. JCode detects your intent automatically:</p>\n    <ul>\n        <li><strong>Action requests</strong> &mdash; \"add a search bar\", \"fix the login bug\", \"refactor the database layer\" &rarr; JCode modifies files</li>\n        <li><strong>Questions</strong> &mdash; \"how does the routing work?\", \"explain the auth flow\" &rarr; JCode answers without changing files</li>\n        <li><strong>Run/Deploy</strong> &mdash; \"how do I run this?\", \"how do I deploy to Vercel?\" &rarr; JCode gives step-by-step commands</li>\n    </ul>\n\n    <!-- Reserved Commands -->\n    <h2>Reserved Commands</h2>\n    <p>These are the only special commands. Everything else is natural language:</p>\n    <pre><code>run       Run the project (auto-detects framework)\nplan      Show the current task plan\nfiles     List all project files\ntree      Show directory tree\nrebuild   Re-run the full build pipeline\nback      Return to home screen\nclear     Clear the terminal\nhelp      Show help</code></pre>\n\n    <!-- Tips -->\n    <h2>Tips &amp; Best Practices</h2>\n    <ul>\n        <li><strong>Be specific.</strong> \"Build a REST API with FastAPI, PostgreSQL, JWT auth, and Docker\" gives better results than \"build an API\".</li>\n        <li><strong>Iterate in small steps.</strong> After the initial build, add features one at a time rather than asking for everything at once.</li>\n        <li><strong>Use <code>run</code> often.</strong> Test after every change. JCode auto-installs dependencies when needed.</li>\n        <li><strong>Ask questions.</strong> If something is unclear, ask JCode to explain. It has full context of your project.</li>\n        <li><strong>Trust the fix engine.</strong> If a file fails verification, JCode has 8 attempts with 5 different strategies. Let it work.</li>\n        <li><strong>Save your progress.</strong> Sessions auto-save. You can close JCode and resume later &mdash; your project and chat history are preserved.</li>\n    </ul>\n\n    <!-- Troubleshooting -->\n    <h2>Troubleshooting</h2>\n    <h3>Ollama not found</h3>\n    <p>Make sure Ollama is running: <code>ollama serve</code>. If not installed, get it from <a href=\"https://ollama.ai\" target=\"_blank\">ollama.ai</a>.</p>\n\n    <h3>Models not downloaded</h3>\n    <p>Pull both models manually:</p>\n    <pre><code>ollama pull deepseek-r1:14b\nollama pull qwen2.5-coder:14b</code></pre>\n\n    <h3>Out of memory</h3>\n    <p>14B models need ~8GB RAM. Close other applications, or use smaller models by editing <code>jcode/config.py</code>:</p>\n    <pre><code>PLANNER_MODEL = \"deepseek-r1:7b\"\nCODER_MODEL = \"qwen2.5-coder:7b\"</code></pre>\n\n    <h3>Permission denied</h3>\n    <p>Reset permissions by deleting <code>~/.jcode/settings.json</code>. JCode will ask again on next launch.</p>\n\n    <h3>Build keeps failing</h3>\n    <p>If the 8-attempt fix engine cannot resolve an issue, JCode will pause and ask for guidance. You can:</p>\n    <ul>\n        <li>Provide a hint about what is wrong</li>\n        <li>Skip the problematic file</li>\n        <li>Retry with a fresh attempt</li>\n    </ul>\n</div>\n\n<footer>\n    <div class=\"container\">\n        <p>JCode &middot; <a href=\"index.html\">Home</a> &middot; <a href=\"technical.html\">Technical Docs</a> &middot; <a href=\"https://github.com/ShakenTheCoder/JcodeAgent\">GitHub</a></p>\n    </div>\n</footer>\n\n<script>\nfunction toggleTheme() {\n    const cb = document.getElementById('theme-checkbox');\n    document.documentElement.setAttribute('data-theme', cb.checked ? 'light' : 'dark');\n    localStorage.setItem('jcode-theme', cb.checked ? 'light' : 'dark');\n}\n(function() {\n    if (localStorage.getItem('jcode-theme') === 'light') {\n        document.documentElement.setAttribute('data-theme', 'light');\n        document.getElementById('theme-checkbox').checked = true;\n    }\n})();\n</script>\n</body>\n</html>\n",
      "docs/index.html": "<!DOCTYPE html>\n<html lang=\"en\" data-theme=\"dark\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>JCode \u2014 Your Local, Unlimited & Private Software Engineer</title>\n    <meta name=\"description\" content=\"JCode is a local AI coding agent that iterates until your project works. 4 AI roles, zero cloud, 100% private.\">\n    <link rel=\"icon\" href=\"JcodeLogo.ico\" type=\"image/x-icon\">\n    <style>\n        *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }\n\n        :root {\n            --font-mono: 'SF Mono', 'Fira Code', 'JetBrains Mono', 'Cascadia Code', 'Consolas', monospace;\n            --font-sans: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;\n            --transition: 0.3s ease;\n        }\n\n        /* Dark Theme */\n        [data-theme=\"dark\"] {\n            --bg: #050508;\n            --bg-card: #0c0c12;\n            --bg-terminal: #0a0e17;\n            --text: #d4d4d8;\n            --text-dim: #52525b;\n            --accent: #22d3ee;\n            --accent-dim: rgba(34, 211, 238, 0.08);\n            --accent-glow: rgba(34, 211, 238, 0.2);\n            --border: #1a1a2e;\n            --border-glow: rgba(34, 211, 238, 0.15);\n            --holo-gradient: linear-gradient(135deg, rgba(34,211,238,0.06) 0%, rgba(6,182,212,0.02) 50%, rgba(34,211,238,0.06) 100%);\n            --scanline: rgba(34, 211, 238, 0.03);\n        }\n\n        /* Light Theme */\n        [data-theme=\"light\"] {\n            --bg: #f8fafc;\n            --bg-card: #ffffff;\n            --bg-terminal: #f1f5f9;\n            --text: #1e293b;\n            --text-dim: #64748b;\n            --accent: #0891b2;\n            --accent-dim: rgba(8, 145, 178, 0.06);\n            --accent-glow: rgba(8, 145, 178, 0.15);\n            --border: #e2e8f0;\n            --border-glow: rgba(8, 145, 178, 0.1);\n            --holo-gradient: linear-gradient(135deg, rgba(8,145,178,0.04) 0%, transparent 50%, rgba(8,145,178,0.04) 100%);\n            --scanline: rgba(8, 145, 178, 0.02);\n        }\n\n        body {\n            font-family: var(--font-mono);\n            background: var(--bg);\n            color: var(--text);\n            line-height: 1.7;\n            transition: background var(--transition), color var(--transition);\n            overflow-x: hidden;\n        }\n\n        a { color: var(--accent); text-decoration: none; }\n        a:hover { text-decoration: underline; }\n\n        .container { max-width: 920px; margin: 0 auto; padding: 0 2rem; }\n\n        /* Theme Toggle Switch */\n        .theme-switch {\n            position: fixed; top: 1.5rem; right: 1.5rem; z-index: 100;\n            display: flex; align-items: center; gap: 0.5rem;\n        }\n        .theme-switch .label {\n            font-size: 0.7rem; color: var(--text-dim);\n            font-family: var(--font-mono);\n        }\n        .switch {\n            position: relative; width: 48px; height: 26px;\n        }\n        .switch input { opacity: 0; width: 0; height: 0; }\n        .switch .slider {\n            position: absolute; cursor: pointer;\n            top: 0; left: 0; right: 0; bottom: 0;\n            background: var(--border);\n            border: 1px solid var(--border-glow);\n            border-radius: 26px;\n            transition: all var(--transition);\n        }\n        .switch .slider::before {\n            content: '';\n            position: absolute; height: 20px; width: 20px;\n            left: 2px; bottom: 2px;\n            background: var(--accent);\n            border-radius: 50%;\n            transition: all var(--transition);\n            box-shadow: 0 0 8px var(--accent-glow);\n        }\n        .switch input:checked + .slider::before {\n            transform: translateX(22px);\n        }\n        .switch-icon {\n            font-size: 0.85rem;\n            transition: opacity var(--transition);\n        }\n\n        /* Nav */\n        nav {\n            padding: 1.5rem 0; display: flex;\n            align-items: center; justify-content: space-between;\n        }\n        .nav-logo { font-size: 1.1rem; font-weight: 700; color: var(--accent); letter-spacing: 0.05em; }\n        .nav-links { display: flex; gap: 1.5rem; }\n        .nav-links a { color: var(--text-dim); font-size: 0.8rem; transition: color var(--transition); }\n        .nav-links a:hover { color: var(--accent); text-decoration: none; }\n\n        /* Hero */\n        .hero { text-align: center; padding: 5rem 0 3rem; }\n        .hero-ascii {\n            color: var(--accent);\n            font-size: clamp(0.45rem, 1.8vw, 0.75rem);\n            line-height: 1.2;\n            margin-bottom: 2rem;\n            white-space: pre;\n            text-shadow: 0 0 30px var(--accent-glow);\n            letter-spacing: 0.05em;\n        }\n        .hero h1 {\n            font-family: var(--font-sans);\n            font-size: clamp(1.5rem, 4vw, 2.4rem);\n            font-weight: 700;\n            margin-bottom: 1rem;\n            letter-spacing: -0.02em;\n            color: var(--text);\n        }\n        .hero h1 .accent { color: var(--accent); }\n        .hero p {\n            color: var(--text-dim);\n            font-size: 1rem;\n            max-width: 560px;\n            margin: 0 auto 2.5rem;\n            font-family: var(--font-sans);\n            line-height: 1.6;\n        }\n\n        /* Holographic Card */\n        .holo-card {\n            background: var(--holo-gradient);\n            border: 1px solid var(--border);\n            border-radius: 12px;\n            padding: 1.8rem;\n            position: relative;\n            overflow: hidden;\n            transition: all 0.4s ease;\n        }\n        .holo-card::before {\n            content: '';\n            position: absolute;\n            top: 0; left: 0; right: 0;\n            height: 1px;\n            background: linear-gradient(90deg, transparent, var(--accent-glow), transparent);\n            opacity: 0;\n            transition: opacity 0.4s ease;\n        }\n        .holo-card:hover {\n            border-color: var(--border-glow);\n            box-shadow: 0 0 40px var(--accent-dim), inset 0 1px 0 var(--accent-dim);\n            transform: translateY(-2px);\n        }\n        .holo-card:hover::before { opacity: 1; }\n\n        /* Install Box */\n        .install-box {\n            background: var(--bg-terminal);\n            border: 1px solid var(--border);\n            border-radius: 10px;\n            padding: 1.2rem 1.5rem;\n            margin: 0 auto 0.8rem;\n            max-width: 640px;\n            position: relative;\n        }\n        .install-box .label {\n            font-size: 0.7rem; color: var(--text-dim);\n            margin-bottom: 0.4rem; text-transform: uppercase; letter-spacing: 0.1em;\n        }\n        .install-box code { display: block; color: var(--accent); font-size: 0.85rem; word-break: break-all; }\n        .install-box .copy-btn {\n            position: absolute; top: 0.8rem; right: 0.8rem;\n            background: var(--border); border: none; color: var(--text-dim);\n            padding: 0.3rem 0.6rem; border-radius: 4px; cursor: pointer;\n            font-size: 0.7rem; font-family: var(--font-mono); transition: all var(--transition);\n        }\n        .install-box .copy-btn:hover { background: var(--accent); color: var(--bg); }\n\n        .install-tabs { display: flex; gap: 0; max-width: 640px; margin: 0 auto; }\n        .install-tab {\n            padding: 0.4rem 1rem; background: transparent;\n            border: 1px solid var(--border); border-bottom: none;\n            color: var(--text-dim); cursor: pointer;\n            font-family: var(--font-mono); font-size: 0.75rem;\n            transition: all var(--transition); border-radius: 6px 6px 0 0;\n        }\n        .install-tab.active { background: var(--bg-terminal); color: var(--accent); }\n        .install-panel { display: none; }\n        .install-panel.active { display: block; }\n\n        /* Terminal Demo */\n        .terminal {\n            background: var(--bg-terminal);\n            border: 1px solid var(--border);\n            border-radius: 12px;\n            overflow: hidden;\n            margin: 3rem auto;\n            max-width: 700px;\n            box-shadow: 0 8px 40px rgba(0,0,0,0.2);\n        }\n        .terminal-bar {\n            background: var(--border);\n            padding: 0.6rem 1rem;\n            display: flex; align-items: center; gap: 0.5rem;\n        }\n        .terminal-dot { width: 10px; height: 10px; border-radius: 50%; }\n        .terminal-dot.r { background: #f87171; }\n        .terminal-dot.y { background: #fbbf24; }\n        .terminal-dot.g { background: #4ade80; }\n        .terminal-title { margin-left: 0.5rem; color: var(--text-dim); font-size: 0.75rem; }\n        .terminal-body {\n            padding: 1.2rem 1.5rem;\n            font-size: 0.8rem;\n            line-height: 1.6;\n            min-height: 300px;\n        }\n        .terminal-body .prompt { color: var(--accent); }\n        .terminal-body .cmd { color: var(--text); }\n        .terminal-body .dim { color: var(--text-dim); }\n        .terminal-body .ok { color: #4ade80; }\n        .terminal-body .cyan { color: var(--accent); }\n        .terminal-body .typing-cursor {\n            display: inline-block; width: 7px; height: 1em;\n            background: var(--accent);\n            animation: blink 1s step-end infinite;\n            vertical-align: text-bottom;\n        }\n        @keyframes blink { 50% { opacity: 0; } }\n\n        /* Section */\n        section { padding: 4rem 0; border-top: 1px solid var(--border); }\n        section h2 {\n            font-family: var(--font-sans); font-size: 1.6rem;\n            font-weight: 700; margin-bottom: 0.4rem;\n        }\n        section h2 .accent { color: var(--accent); }\n        section .subtitle {\n            color: var(--text-dim); margin-bottom: 2.5rem;\n            font-family: var(--font-sans); font-size: 0.95rem;\n        }\n\n        /* Pipeline */\n        .pipeline { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1.2rem; }\n        .pipe-step { text-align: left; }\n        .pipe-step .step-num {\n            font-size: 0.7rem; color: var(--accent);\n            text-transform: uppercase; letter-spacing: 0.15em;\n            margin-bottom: 0.5rem;\n        }\n        .pipe-step h3 { font-size: 1rem; margin-bottom: 0.4rem; color: var(--text); }\n        .pipe-step p { font-size: 0.85rem; color: var(--text-dim); font-family: var(--font-sans); }\n\n        /* Features */\n        .features { display: grid; grid-template-columns: repeat(auto-fit, minmax(260px, 1fr)); gap: 1.2rem; }\n        .feature-card h3 { font-size: 0.9rem; margin-bottom: 0.4rem; color: var(--accent); }\n        .feature-card p { font-size: 0.85rem; color: var(--text-dim); font-family: var(--font-sans); }\n\n        /* Releases */\n        .releases { list-style: none; }\n        .release-item {\n            background: var(--bg-card); border: 1px solid var(--border);\n            border-radius: 10px; padding: 1.5rem; margin-bottom: 1rem;\n            transition: all var(--transition);\n        }\n        .release-item:hover { border-color: var(--border-glow); }\n        .release-header { display: flex; align-items: center; gap: 1rem; margin-bottom: 0.6rem; }\n        .release-tag {\n            background: var(--accent); color: var(--bg);\n            padding: 0.15rem 0.5rem; border-radius: 3px;\n            font-size: 0.75rem; font-weight: 700;\n        }\n        .release-tag.old { background: var(--border); color: var(--text-dim); }\n        .release-date { color: var(--text-dim); font-size: 0.75rem; }\n        .release-title { font-size: 0.95rem; font-weight: 600; }\n        .release-body {\n            color: var(--text-dim); font-size: 0.8rem;\n            font-family: var(--font-sans); line-height: 1.6;\n        }\n        .release-body ul { padding-left: 1.2rem; margin-top: 0.4rem; }\n\n        /* Footer */\n        footer {\n            border-top: 1px solid var(--border);\n            padding: 2rem 0; text-align: center;\n            color: var(--text-dim); font-size: 0.75rem;\n        }\n\n        @media (max-width: 600px) {\n            .container { padding: 0 1rem; }\n            .hero { padding: 3rem 0 2rem; }\n            .hero-ascii { font-size: 0.35rem; }\n            .theme-switch { top: 1rem; right: 1rem; }\n        }\n    </style>\n</head>\n<body>\n\n<div class=\"theme-switch\">\n    \n    <label class=\"switch\">\n        <input type=\"checkbox\" id=\"theme-checkbox\" onchange=\"toggleTheme()\">\n        <span class=\"slider\"></span>\n    </label>\n   \n</div>\n\n<div class=\"container\">\n\n    <nav>\n        <span class=\"nav-logo\">&gt; jcode</span>\n        <div class=\"nav-links\">\n            <a href=\"#how-it-works\">How It Works</a>\n            <a href=\"#features\">Features</a>\n            <a href=\"#releases\">Releases</a>\n            <a href=\"beginner-guide.html\">Guide</a>\n            <a href=\"technical.html\">Docs</a>\n            <a href=\"https://github.com/ShakenTheCoder/JcodeAgent\" target=\"_blank\">GitHub</a>\n        </div>\n    </nav>\n\n    <!-- Hero -->\n    <div class=\"hero\">\n        <pre class=\"hero-ascii\">\n     &#9608;&#9608;&#9580; &#9608;&#9608;&#9608;&#9608;&#9608;&#9608;&#9580; &#9608;&#9608;&#9608;&#9608;&#9608;&#9608;&#9580; &#9608;&#9608;&#9608;&#9608;&#9608;&#9608;&#9580; &#9608;&#9608;&#9608;&#9608;&#9608;&#9608;&#9608;&#9580;\n     &#9608;&#9608;&#9553;&#9608;&#9608;&#9580;&#9552;&#9552;&#9552;&#9552;&#9569;&#9608;&#9608;&#9580;&#9552;&#9552;&#9552;&#9608;&#9608;&#9580;&#9608;&#9608;&#9580;&#9552;&#9552;&#9608;&#9608;&#9580;&#9608;&#9608;&#9580;&#9552;&#9552;&#9552;&#9552;&#9569;\n     &#9608;&#9608;&#9553;&#9608;&#9608;&#9553;     &#9608;&#9608;&#9553;   &#9608;&#9608;&#9553;&#9608;&#9608;&#9553;  &#9608;&#9608;&#9553;&#9608;&#9608;&#9608;&#9608;&#9608;&#9580;\n&#9608;&#9608;   &#9608;&#9608;&#9553;&#9608;&#9608;&#9553;     &#9608;&#9608;&#9553;   &#9608;&#9608;&#9553;&#9608;&#9608;&#9553;  &#9608;&#9608;&#9553;&#9608;&#9608;&#9580;&#9552;&#9552;&#9569;\n&#9580;&#9608;&#9608;&#9608;&#9608;&#9608;&#9580;&#9569;&#9580;&#9608;&#9608;&#9608;&#9608;&#9608;&#9608;&#9580;&#9580;&#9608;&#9608;&#9608;&#9608;&#9608;&#9608;&#9580;&#9569;&#9608;&#9608;&#9608;&#9608;&#9608;&#9608;&#9580;&#9569;&#9608;&#9608;&#9608;&#9608;&#9608;&#9608;&#9608;&#9580;\n &#9580;&#9552;&#9552;&#9552;&#9552;&#9569; &#9580;&#9552;&#9552;&#9552;&#9552;&#9552;&#9569; &#9580;&#9552;&#9552;&#9552;&#9552;&#9552;&#9569; &#9580;&#9552;&#9552;&#9552;&#9552;&#9552;&#9569; &#9580;&#9552;&#9552;&#9552;&#9552;&#9552;&#9552;&#9569;\n        </pre>\n        <h1>Your <span class=\"accent\">local, unlimited &amp; private</span> software engineer</h1>\n        <p>JCode plans, codes, reviews, and iterates &mdash; automatically &mdash; until your project works. 4 AI roles running entirely on your machine. No cloud. No API keys. No limits.</p>\n\n        <div class=\"install-tabs\">\n            <button class=\"install-tab active\" onclick=\"switchTab('mac')\">Mac / Linux</button>\n            <button class=\"install-tab\" onclick=\"switchTab('win')\">Windows</button>\n        </div>\n        <div id=\"tab-mac\" class=\"install-panel active\">\n            <div class=\"install-box\">\n                <div class=\"label\">install</div>\n                <code>curl -fsSL https://getjcode.vercel.app/install.sh | bash</code>\n                <button class=\"copy-btn\" onclick=\"copyInstall('mac')\">Copy</button>\n            </div>\n        </div>\n        <div id=\"tab-win\" class=\"install-panel\">\n            <div class=\"install-box\">\n                <div class=\"label\">install</div>\n                <code>iwr -useb https://getjcode.vercel.app/install.ps1 | iex</code>\n                <button class=\"copy-btn\" onclick=\"copyInstall('win')\">Copy</button>\n            </div>\n        </div>\n    </div>\n\n    <!-- Terminal Demo -->\n    <div class=\"terminal\">\n        <div class=\"terminal-bar\">\n            <span class=\"terminal-dot r\"></span>\n            <span class=\"terminal-dot y\"></span>\n            <span class=\"terminal-dot g\"></span>\n            <span class=\"terminal-title\">jcode &mdash; zsh</span>\n        </div>\n        <div class=\"terminal-body\">\n            <div><span class=\"prompt\">$</span> <span class=\"cmd\">jcode</span></div>\n            <div><span class=\"cyan\">Ollama connected</span></div>\n            <div>&nbsp;</div>\n            <div><span class=\"prompt\">jcode&gt;</span> <span class=\"cmd\">build a REST API with FastAPI for a todo app</span></div>\n            <div>&nbsp;</div>\n            <div><span class=\"dim\">12:04:01</span>  <span class=\"cyan\">PHASE 1</span>   Planning project architecture</div>\n            <div><span class=\"dim\">12:04:12</span>  <span class=\"cyan\">PLAN</span>      6 task(s) created</div>\n            <div>&nbsp;</div>\n            <div><span class=\"dim\">12:04:12</span>  <span class=\"cyan\">PHASE 2</span>   Building</div>\n            <div><span class=\"dim\">12:04:15</span>  <span class=\"cyan\">GENERATE</span>  main.py</div>\n            <div><span class=\"dim\">12:04:22</span>  <span class=\"cyan\">REVIEW</span>    <span class=\"ok\">Approved</span></div>\n            <div><span class=\"dim\">12:04:23</span>  <span class=\"cyan\">VERIFY</span>    <span class=\"ok\">passed</span></div>\n            <div><span class=\"dim\">12:04:25</span>  <span class=\"cyan\">GENERATE</span>  models.py</div>\n            <div><span class=\"dim\">12:04:31</span>  <span class=\"cyan\">REVIEW</span>    2 issue(s) -- patching</div>\n            <div><span class=\"dim\">12:04:35</span>  <span class=\"cyan\">VERIFY</span>    failed</div>\n            <div><span class=\"dim\">12:04:35</span>  <span class=\"cyan\">FIX</span>       Attempt 1/8 <span class=\"dim\">(targeted patch)</span></div>\n            <div><span class=\"dim\">12:04:40</span>  <span class=\"cyan\">VERIFY</span>    <span class=\"ok\">passed after 1 attempt(s)</span></div>\n            <div>&nbsp;</div>\n            <div><span class=\"dim\">12:05:10</span>  <span class=\"cyan\">DONE</span>      Build complete -- all files verified</div>\n            <div>&nbsp;</div>\n            <div><span class=\"prompt\">todo-api&gt;</span> <span class=\"cmd\">add user authentication with JWT</span></div>\n            <div><span class=\"dim\">12:05:18</span>  <span class=\"cyan\">THINKING</span>  Processing your request...</div>\n            <div><span class=\"dim\">12:05:30</span>  <span class=\"cyan\">APPLIED</span>   Updated 3 file(s)</div>\n            <div>&nbsp;</div>\n            <div><span class=\"prompt\">todo-api&gt;</span> <span class=\"typing-cursor\"></span></div>\n        </div>\n    </div>\n\n    <!-- How It Works -->\n    <section id=\"how-it-works\">\n        <h2>How <span class=\"accent\">JCode</span> works</h2>\n        <p class=\"subtitle\">4 specialized AI roles collaborate through automated reiteration until every file compiles and passes checks.</p>\n        <div class=\"pipeline\">\n            <div class=\"holo-card pipe-step\">\n                <div class=\"step-num\">Step 01</div>\n                <h3>Planner</h3>\n                <p>Analyzes your description. Designs the architecture. Creates a dependency-ordered task graph so files are built in the right order.</p>\n            </div>\n            <div class=\"holo-card pipe-step\">\n                <div class=\"step-num\">Step 02</div>\n                <h3>Coder</h3>\n                <p>Generates each file using structured memory &mdash; only the context it needs, not everything. Writes clean, complete code.</p>\n            </div>\n            <div class=\"holo-card pipe-step\">\n                <div class=\"step-num\">Step 03</div>\n                <h3>Reviewer</h3>\n                <p>Pre-execution code review with re-review loop. Catches bugs, missing imports, and logic errors. Issues get patched and re-reviewed.</p>\n            </div>\n            <div class=\"holo-card pipe-step\">\n                <div class=\"step-num\">Step 04</div>\n                <h3>Verifier</h3>\n                <p>Static analysis: syntax checks, linting, type validation, test execution. Every file is verified individually against real tooling.</p>\n            </div>\n            <div class=\"holo-card pipe-step\">\n                <div class=\"step-num\">Step 05</div>\n                <h3>Analyzer</h3>\n                <p>When something fails, the Analyzer diagnoses the root cause with cross-file context. Deep analysis considers dependency chains.</p>\n            </div>\n            <div class=\"holo-card pipe-step\">\n                <div class=\"step-num\">Step 06</div>\n                <h3>Iterate</h3>\n                <p>Up to 8 fix cycles with 5 strategies: targeted patch, deep analysis, full regen, simplify, and research-based repair. No giving up.</p>\n            </div>\n        </div>\n    </section>\n\n    <!-- Features -->\n    <section id=\"features\">\n        <h2>Built <span class=\"accent\">different</span></h2>\n        <p class=\"subtitle\">Engineering over model size. Architecture over brute force.</p>\n        <div class=\"features\">\n            <div class=\"holo-card feature-card\">\n                <h3>100% Local & Private</h3>\n                <p>Everything runs on your machine. Your code never leaves your computer. No API keys, no cloud, no subscriptions. Ever.</p>\n            </div>\n            <div class=\"holo-card feature-card\">\n                <h3>Pure Chat-Driven</h3>\n                <p>No commands to memorize. Just type naturally: \"fix the login bug\", \"add dark mode\", \"how does routing work?\" JCode understands your intent.</p>\n            </div>\n            <div class=\"holo-card feature-card\">\n                <h3>8-Attempt Fix Engine</h3>\n                <p>5 escalating strategies per file: targeted patch, deep cross-file analysis, full regeneration, simplification, and research-based repair.</p>\n            </div>\n            <div class=\"holo-card feature-card\">\n                <h3>DAG Task Engine</h3>\n                <p>Tasks have dependencies. A file is not generated until its deps are verified. No more broken imports or circular references.</p>\n            </div>\n            <div class=\"holo-card feature-card\">\n                <h3>Structured Memory</h3>\n                <p>Each role sees only what it needs &mdash; architecture summary, file index, failure log. Not raw context dumps. That is how 14B competes with 200B.</p>\n            </div>\n            <div class=\"holo-card feature-card\">\n                <h3>Web Search & Docs</h3>\n                <p>Fetches documentation and searches the web to build better code. Reads APIs, frameworks docs, and guides. All with your permission.</p>\n            </div>\n            <div class=\"holo-card feature-card\">\n                <h3>Auto Run & Deploy</h3>\n                <p>Detects your tech stack and knows exactly how to run it. Ask for deploy guidance and get copy-pasteable commands for Vercel, Railway, Docker, and more.</p>\n            </div>\n            <div class=\"holo-card feature-card\">\n                <h3>Per-Project Chat</h3>\n                <p>Every project gets its own conversation history. Resume where you left off. Brainstorm features, request changes, or just ask questions.</p>\n            </div>\n            <div class=\"holo-card feature-card\">\n                <h3>Save & Resume</h3>\n                <p>Sessions auto-save. Resume any project from where you left off. Switch between projects freely. Your progress is never lost.</p>\n            </div>\n        </div>\n    </section>\n\n    <!-- Releases -->\n    <section id=\"releases\">\n        <h2>Release <span class=\"accent\">history</span></h2>\n        <p class=\"subtitle\">Latest updates and improvements.</p>\n        <ul class=\"releases\">\n            <li class=\"release-item\">\n                <div class=\"release-header\">\n                    <span class=\"release-tag\">v0.9.7</span>\n                    <span class=\"release-date\">Feb 2026</span>\n                    <span class=\"release-title\">Model Pull UX Improvements</span>\n                </div>\n                <div class=\"release-body\">\n                    Fixed model pulling progress, graceful Ctrl+C handling, and accurate size estimates.\n                    <ul>\n                        <li><strong>Real Progress Tracking:</strong> Shows bytes downloaded and transfer speed (was stuck at 0%)</li>\n                        <li><strong>Graceful Cancellation:</strong> Press Ctrl+C during download to skip a model</li>\n                        <li><strong>Accurate Size Estimates:</strong> 70B=40GB, 32B=20GB, 14B=9GB, 7B=5GB</li>\n                        <li><strong>Better Feedback:</strong> \"Skipped \u2014 will use fallback\" when cancelled</li>\n                    </ul>\n                </div>\n            </li>\n            <li class=\"release-item\">\n                <div class=\"release-header\">\n                    <span class=\"release-tag\">v0.9.6</span>\n                    <span class=\"release-date\">Feb 2026</span>\n                    <span class=\"release-title\">Interactive Model Pulling</span>\n                </div>\n                <div class=\"release-body\">\n                    JCode now detects missing ideal models and offers to pull them before builds.\n                    <ul>\n                        <li><strong>Interactive Model Check:</strong> Shows table of ideal vs fallback models</li>\n                        <li><strong>User Choice:</strong> \"Pull missing models now?\" with Yes/No option</li>\n                        <li><strong>No Silent Fallbacks:</strong> User sees exactly what models are missing</li>\n                        <li><strong>Model Pulling:</strong> Downloads models with progress bar</li>\n                        <li><strong>Fallback Ready:</strong> If declined, continues immediately with fallback models</li>\n                    </ul>\n                </div>\n            </li>\n            <li class=\"release-item\">\n                <div class=\"release-header\">\n                    <span class=\"release-tag\">v0.9.5</span>\n                    <span class=\"release-date\">Feb 2026</span>\n                    <span class=\"release-title\">Model Fallback Fix</span>\n                </div>\n                <div class=\"release-body\">\n                    Critical bugfix: Model matching now requires exact names, not just base prefixes.\n                    <ul>\n                        <li><strong>Exact Model Matching:</strong> deepseek-r1:70b no longer matches deepseek-r1:14b</li>\n                        <li><strong>Smart Fallback:</strong> Falls back to available models when ideal not installed</li>\n                        <li><strong>No 404 Errors:</strong> Model selection never tries to use uninstalled models</li>\n                    </ul>\n                </div>\n            </li>\n            <li class=\"release-item\">\n                <div class=\"release-header\">\n                    <span class=\"release-tag\">v0.9.4</span>\n                    <span class=\"release-date\">Feb 2026</span>\n                    <span class=\"release-title\">Smart Classification (LLM + Semantic Signals)</span>\n                </div>\n                <div class=\"release-body\">\n                    LLM-based pre-classification now correctly identifies complex tasks from short prompts.\n                    <ul>\n                        <li><strong>LLM Pre-Classification:</strong> Fastest model reasons about task complexity</li>\n                        <li><strong>App-Type Signals:</strong> \"Tinder for X\", \"Uber for Y\" now recognized as heavy/large</li>\n                        <li><strong>Domain Signals:</strong> Social network, marketplace, dating app, SaaS patterns detected</li>\n                        <li><strong>Default Bias Fix:</strong> Ambiguous prompts default to medium/medium (not simple/small)</li>\n                        <li><strong>Better Model Selection:</strong> Projects get better models based on actual complexity</li>\n                    </ul>\n                </div>\n            </li>\n            <li class=\"release-item\">\n                <div class=\"release-header\">\n                    <span class=\"release-tag old\">v0.9.3</span>\n                    <span class=\"release-date\">Feb 2026</span>\n                    <span class=\"release-title\">Fence Stripping & Execution Safety</span>\n                </div>\n                <div class=\"release-body\">\n                    Models wrapping file content in markdown fences no longer corrupt JSON. Commands stop on failure.\n                    <ul>\n                        <li><strong>Markdown Fence Stripping:</strong> Removes ` ```json ``` ` from ===FILE:=== blocks</li>\n                        <li><strong>Stop on Failure:</strong> Commands stop executing when one fails</li>\n                        <li><strong>Node.js Detection:</strong> Auto-detects app.js, index.js, server.js entry points</li>\n                    </ul>\n                </div>\n            </li>\n            <li class=\"release-item\">\n                <div class=\"release-header\">\n                    <span class=\"release-tag old\">v0.9.2</span>\n                    <span class=\"release-date\">Feb 2026</span>\n                    <span class=\"release-title\">Autonomous Execution</span>\n                </div>\n                <div class=\"release-body\">\n                    Agent mode now actually executes commands and builds end-to-end.\n                    <ul>\n                        <li><strong>Command Execution:</strong> ===RUN:=== and ===BACKGROUND:=== blocks execute automatically</li>\n                        <li><strong>BUILD Intent Fix:</strong> \"i want you to build...\" now correctly triggers build pipeline</li>\n                        <li><strong>Agent Mode Routes:</strong> CHAT-classified input routes to agentic handler in agent mode</li>\n                        <li><strong>Safety Filters:</strong> Dangerous commands (rm -rf, mkfs, etc.) blocked</li>\n                    </ul>\n                </div>\n            </li>\n            <li class=\"release-item\">\n                <div class=\"release-header\">\n                    <span class=\"release-tag old\">v0.9.1</span>\n                    <span class=\"release-date\">Feb 2026</span>\n                    <span class=\"release-title\">Spec Contracts, RAG Memory & Structured Errors</span>\n                </div>\n                <div class=\"release-body\">\n                    Planner specs become contracts. Coder enforces spec compliance. Memory enables RAG retrieval.\n                    <ul>\n                        <li><strong>Spec-as-Contract:</strong> Coder enforces schema from plan, prevents stack drift</li>\n                        <li><strong>RAG Memory:</strong> Embedding-based file retrieval for context</li>\n                        <li><strong>Structured Errors:</strong> Error logs parsed and categorized</li>\n                        <li><strong>Session Persistence:</strong> Memory and size saved with project</li>\n                    </ul>\n                </div>\n            </li>\n            <li class=\"release-item\">\n                <div class=\"release-header\">\n                    <span class=\"release-tag old\">v0.9.0</span>\n                    <span class=\"release-date\">Feb 2026</span>\n                    <span class=\"release-title\">Multi-Model Orchestrator</span>\n                </div>\n                <div class=\"release-body\">\n                    Intelligent routing selects best local model for each role based on task complexity.\n                    <ul>\n                        <li><strong>Model Registry:</strong> ~40 models across coding, reasoning, agentic, fast categories</li>\n                        <li><strong>Task Classification:</strong> heavy/large, medium/medium, simple/small routing</li>\n                        <li><strong>ROLE_ROUTING:</strong> 9-cell matrix maps complexity\u00d7size to model category per role</li>\n                        <li><strong>Graceful Fallback:</strong> 3-phase search for best available local model</li>\n                        <li><strong>Size Threading:</strong> Context window scaled by complexity and task size</li>\n                    </ul>\n                </div>\n            </li>\n            <li class=\"release-item\">\n                <div class=\"release-header\">\n                    <span class=\"release-tag old\">v0.6.0</span>\n                    <span class=\"release-date\">Feb 2026</span>\n                    <span class=\"release-title\">Parallel Generation & Smart Model Tiering</span>\n                </div>\n                <div class=\"release-body\">\n                    Lightning-fast project generation with adaptive AI model selection.\n                    <ul>\n                        <li><strong>Smart Model Tiering:</strong> 3 tiers (fast/medium/strong) auto-selected by project complexity</li>\n                        <li><strong>Parallel File Generation:</strong> Wave-based DAG execution \u2014 independent files build concurrently</li>\n                        <li><strong>Parallel Review & Verification:</strong> All files reviewed &amp; verified in parallel per wave</li>\n                        <li><strong>Worker Pool:</strong> Max 6 adaptive workers with CPU-aware throttling</li>\n                        <li><strong>Context Isolation:</strong> Thread-safe per-file memory, no full repo refeed</li>\n                        <li><strong>Dynamic Model Selection:</strong> Planner/Coder/Reviewer/Analyzer pick best model for task complexity</li>\n                        <li><strong>Silent Mode Generation:</strong> Threads use non-streaming model calls for speed</li>\n                        <li><strong>Deterministic Execution:</strong> Topological wave ordering guarantees correct dependency resolution</li>\n                    </ul>\n                </div>\n            </li>\n            <li class=\"release-item\">\n                <div class=\"release-header\">\n                    <span class=\"release-tag old\">v0.5.3</span>\n                    <span class=\"release-date\">Feb 2026</span>\n                    <span class=\"release-title\">Analytics & Version Command</span>\n                </div>\n                <div class=\"release-body\">\n                    Install tracking and version display.\n                    <ul>\n                        <li>Analytics-enabled install endpoints via Vercel serverless functions</li>\n                        <li>Real-time install metrics: IP, timestamp, User-Agent, OS, counter</li>\n                        <li>Dashboard at /api/stats showing install statistics</li>\n                        <li>New <code>version</code> command in CLI to display current version</li>\n                        <li>Install commands now use getjcode.vercel.app for tracking</li>\n                    </ul>\n                </div>\n            </li>\n            <li class=\"release-item\">\n                <div class=\"release-header\">\n                    <span class=\"release-tag old\">v0.5.2</span>\n                    <span class=\"release-date\">Feb 2026</span>\n                    <span class=\"release-title\">Agentic Auto-Fix</span>\n                </div>\n                <div class=\"release-body\">\n                    Eliminated generic advice &mdash; JCode now acts as true agentic fixer.\n                    <ul>\n                        <li>Auto-capture runtime errors and feed to agent (5-attempt loop)</li>\n                        <li>Post-build Phase 3: runtime verification catches missing imports</li>\n                        <li>CHAT_SYSTEM prompt rewritten: no generic tips, reads actual files, outputs fixes</li>\n                        <li>Smart run command: detects project type and executes properly</li>\n                    </ul>\n                </div>\n            </li>\n            <li class=\"release-item\">\n                <div class=\"release-header\">\n                    <span class=\"release-tag old\">v0.5.1</span>\n                    <span class=\"release-date\">Feb 2026</span>\n                    <span class=\"release-title\">Resilient Fix Engine & Docs</span>\n                </div>\n                <div class=\"release-body\">\n                    Major overhaul of the code review and fix pipeline.\n                    <ul>\n                        <li>8-attempt fix loop with 5 escalating strategies</li>\n                        <li>Cross-file dependency analysis for deeper root cause detection</li>\n                        <li>Research-based error pattern matching (last resort strategy)</li>\n                        <li>Agent knows how to run and deploy all major project types</li>\n                        <li>Beginner guide and technical documentation</li>\n                        <li>Landing page dark/light theme toggle</li>\n                    </ul>\n                </div>\n            </li>\n            <li class=\"release-item\">\n                <div class=\"release-header\">\n                    <span class=\"release-tag old\">v0.5.0</span>\n                    <span class=\"release-date\">Feb 2026</span>\n                    <span class=\"release-title\">Pure Chat-Driven Interaction</span>\n                </div>\n                <div class=\"release-body\">\n                    Complete UX rewrite &mdash; everything is natural language chat.\n                    <ul>\n                        <li>Removed separate modify/add/docs/search commands</li>\n                        <li>Agent detects intent: action mode vs discussion mode</li>\n                        <li>Stronger prompts for reliable file change format</li>\n                        <li>Installer visual overhaul: ASCII banner, spinners, progress bars</li>\n                        <li>Smart run command: auto npm install, subdirectory detection</li>\n                    </ul>\n                </div>\n            </li>\n            <li class=\"release-item\">\n                <div class=\"release-header\">\n                    <span class=\"release-tag old\">v0.4.0</span>\n                    <span class=\"release-date\">Feb 2026</span>\n                    <span class=\"release-title\">Per-Project Chat & Web Search</span>\n                </div>\n                <div class=\"release-body\">\n                    <ul>\n                        <li>Persistent permissions (ask once, remember forever)</li>\n                        <li>Per-project chat history with session persistence</li>\n                        <li>Web search and documentation fetching (DuckDuckGo)</li>\n                        <li>Run command with auto-detection</li>\n                        <li>Two-level REPL: home + project mode</li>\n                    </ul>\n                </div>\n            </li>\n            <li class=\"release-item\">\n                <div class=\"release-header\">\n                    <span class=\"release-tag old\">v0.3.0</span>\n                    <span class=\"release-date\">Feb 2026</span>\n                    <span class=\"release-title\">UX Redesign</span>\n                </div>\n                <div class=\"release-body\">\n                    <ul>\n                        <li>Clean terminal UI with timestamped log lines</li>\n                        <li>Removed all emojis for professional output</li>\n                        <li>Improved error handling and crash resilience</li>\n                    </ul>\n                </div>\n            </li>\n            <li class=\"release-item\">\n                <div class=\"release-header\">\n                    <span class=\"release-tag old\">v0.2.0</span>\n                    <span class=\"release-date\">Feb 2026</span>\n                    <span class=\"release-title\">Architecture Overhaul</span>\n                </div>\n                <div class=\"release-body\">\n                    Complete rewrite with 4-role multi-model system.\n                    <ul>\n                        <li>4 AI roles: Planner, Coder, Reviewer, Analyzer</li>\n                        <li>DAG-based task execution with dependency ordering</li>\n                        <li>Structured memory engine</li>\n                        <li>Verification pipeline: syntax, lint, type checks</li>\n                        <li>Self-correction loop with failure escalation</li>\n                        <li>One-command installer for Mac, Linux, Windows</li>\n                    </ul>\n                </div>\n            </li>\n            <li class=\"release-item\">\n                <div class=\"release-header\">\n                    <span class=\"release-tag old\">v0.1.0</span>\n                    <span class=\"release-date\">Feb 2026</span>\n                    <span class=\"release-title\">Initial Release</span>\n                </div>\n                <div class=\"release-body\">\n                    <ul>\n                        <li>Dual-model architecture (DeepSeek-R1 + Qwen2.5-Coder)</li>\n                        <li>Rich CLI with interactive prompt</li>\n                        <li>Linear iteration loop</li>\n                        <li>Basic session save/load</li>\n                    </ul>\n                </div>\n            </li>\n        </ul>\n    </section>\n</div>\n\n<footer>\n    <div class=\"container\">\n        <p>JCode is open source &middot; MIT License &middot; Developed by <a href=\"https://www.linkedin.com/in/tudor-andrei-ioan/\" target=\"_blank\">Ioan Andrei</a></p>\n        <p style=\"margin-top:0.4rem\">\n            <a href=\"https://github.com/ShakenTheCoder/JcodeAgent\">GitHub</a> &middot;\n            <a href=\"#releases\">Changelog</a> &middot;\n            <a href=\"beginner-guide.html\">Beginner Guide</a> &middot;\n            <a href=\"technical.html\">Technical Docs</a>\n        </p>\n    </div>\n</footer>\n\n<script>\n    function toggleTheme() {\n        const html = document.documentElement;\n        const cb = document.getElementById('theme-checkbox');\n        if (cb.checked) {\n            html.setAttribute('data-theme', 'light');\n            localStorage.setItem('jcode-theme', 'light');\n        } else {\n            html.setAttribute('data-theme', 'dark');\n            localStorage.setItem('jcode-theme', 'dark');\n        }\n    }\n\n    (function() {\n        const saved = localStorage.getItem('jcode-theme');\n        if (saved === 'light') {\n            document.documentElement.setAttribute('data-theme', 'light');\n            document.getElementById('theme-checkbox').checked = true;\n        }\n    })();\n\n    function switchTab(os) {\n        document.querySelectorAll('.install-tab').forEach(t => t.classList.remove('active'));\n        document.querySelectorAll('.install-panel').forEach(p => p.classList.remove('active'));\n        event.target.classList.add('active');\n        document.getElementById('tab-' + os).classList.add('active');\n    }\n\n    function copyInstall(os) {\n        const commands = {\n            mac: 'curl -fsSL https://getjcode.vercel.app/install.sh | bash',\n            win: 'iwr -useb https://getjcode.vercel.app/install.ps1 | iex'\n        };\n        navigator.clipboard.writeText(commands[os]).then(() => {\n            const btn = event.target;\n            btn.textContent = 'Copied!';\n            setTimeout(() => btn.textContent = 'Copy', 2000);\n        });\n    }\n</script>\n\n</body>\n</html>\n",
      "docs/package.json": "{\n  \"dependencies\": {\n    \"@vercel/kv\": \"^2.0.0\"\n  }\n}\n",
      "docs/technical.html": "<!DOCTYPE html>\n<html lang=\"en\" data-theme=\"dark\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>JCode \u2014 Technical Documentation</title>\n    <link rel=\"icon\" href=\"JcodeLogo.ico\" type=\"image/x-icon\">\n    <style>\n        *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }\n        :root {\n            --font-mono: 'SF Mono', 'Fira Code', 'JetBrains Mono', 'Cascadia Code', 'Consolas', monospace;\n            --font-sans: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;\n            --transition: 0.3s ease;\n        }\n        [data-theme=\"dark\"] {\n            --bg: #050508; --bg-card: #0c0c12; --bg-terminal: #0a0e17;\n            --text: #d4d4d8; --text-dim: #52525b; --accent: #22d3ee;\n            --accent-dim: rgba(34,211,238,0.08); --accent-glow: rgba(34,211,238,0.2);\n            --border: #1a1a2e; --border-glow: rgba(34,211,238,0.15);\n        }\n        [data-theme=\"light\"] {\n            --bg: #f8fafc; --bg-card: #ffffff; --bg-terminal: #f1f5f9;\n            --text: #1e293b; --text-dim: #64748b; --accent: #0891b2;\n            --accent-dim: rgba(8,145,178,0.06); --accent-glow: rgba(8,145,178,0.15);\n            --border: #e2e8f0; --border-glow: rgba(8,145,178,0.1);\n        }\n        body { font-family: var(--font-sans); background: var(--bg); color: var(--text); line-height: 1.8; transition: background var(--transition), color var(--transition); }\n        a { color: var(--accent); text-decoration: none; }\n        a:hover { text-decoration: underline; }\n        .container { max-width: 780px; margin: 0 auto; padding: 0 2rem; }\n\n        .theme-switch { position: fixed; top: 1.5rem; right: 1.5rem; z-index: 100; display: flex; align-items: center; gap: 0.5rem; }\n        .switch { position: relative; width: 48px; height: 26px; }\n        .switch input { opacity: 0; width: 0; height: 0; }\n        .switch .slider { position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; background: var(--border); border: 1px solid var(--border-glow); border-radius: 26px; transition: all var(--transition); }\n        .switch .slider::before { content: ''; position: absolute; height: 20px; width: 20px; left: 2px; bottom: 2px; background: var(--accent); border-radius: 50%; transition: all var(--transition); box-shadow: 0 0 8px var(--accent-glow); }\n        .switch input:checked + .slider::before { transform: translateX(22px); }\n        .switch-icon { font-size: 0.85rem; }\n\n        nav { padding: 1.5rem 0; display: flex; align-items: center; justify-content: space-between; border-bottom: 1px solid var(--border); margin-bottom: 3rem; }\n        .nav-logo { font-size: 1.1rem; font-weight: 700; color: var(--accent); font-family: var(--font-mono); }\n        .nav-links { display: flex; gap: 1.5rem; }\n        .nav-links a { color: var(--text-dim); font-size: 0.8rem; font-family: var(--font-mono); }\n        .nav-links a:hover { color: var(--accent); text-decoration: none; }\n\n        h1 { font-size: 2rem; font-weight: 700; margin-bottom: 0.5rem; }\n        h1 .accent { color: var(--accent); }\n        .hero-sub { color: var(--text-dim); font-size: 1rem; margin-bottom: 3rem; }\n\n        h2 { font-size: 1.3rem; font-weight: 700; margin-top: 3rem; margin-bottom: 1rem; padding-bottom: 0.5rem; border-bottom: 1px solid var(--border); }\n        h3 { font-size: 1.05rem; font-weight: 600; margin-top: 1.5rem; margin-bottom: 0.5rem; color: var(--accent); }\n        h4 { font-size: 0.95rem; font-weight: 600; margin-top: 1rem; margin-bottom: 0.4rem; }\n\n        p { margin-bottom: 1rem; }\n        ul, ol { margin-bottom: 1rem; padding-left: 1.5rem; }\n        li { margin-bottom: 0.3rem; }\n\n        code { font-family: var(--font-mono); font-size: 0.85em; background: var(--bg-terminal); padding: 0.15rem 0.4rem; border-radius: 4px; border: 1px solid var(--border); }\n        pre { background: var(--bg-terminal); border: 1px solid var(--border); border-radius: 10px; padding: 1.2rem 1.5rem; overflow-x: auto; margin-bottom: 1.5rem; font-family: var(--font-mono); font-size: 0.85rem; line-height: 1.6; }\n        pre code { background: none; border: none; padding: 0; }\n\n        .callout { background: var(--accent-dim); border-left: 3px solid var(--accent); padding: 1rem 1.2rem; border-radius: 0 8px 8px 0; margin-bottom: 1.5rem; font-size: 0.9rem; }\n        .callout strong { color: var(--accent); }\n\n        table { width: 100%; border-collapse: collapse; margin-bottom: 1.5rem; font-size: 0.85rem; }\n        th, td { padding: 0.6rem 0.8rem; border: 1px solid var(--border); text-align: left; }\n        th { background: var(--bg-terminal); font-weight: 600; color: var(--accent); font-family: var(--font-mono); font-size: 0.8rem; }\n        td code { font-size: 0.8rem; }\n\n        .arch-diagram {\n            background: var(--bg-terminal); border: 1px solid var(--border);\n            border-radius: 12px; padding: 1.5rem;\n            font-family: var(--font-mono); font-size: 0.75rem;\n            line-height: 1.4; overflow-x: auto;\n            margin-bottom: 1.5rem; white-space: pre;\n            color: var(--accent);\n        }\n\n        footer { border-top: 1px solid var(--border); padding: 2rem 0; text-align: center; color: var(--text-dim); font-size: 0.75rem; font-family: var(--font-mono); margin-top: 4rem; }\n\n        @media (max-width: 600px) { .container { padding: 0 1rem; } }\n    </style>\n</head>\n<body>\n\n<div class=\"theme-switch\">\n   \n    <label class=\"switch\"><input type=\"checkbox\" id=\"theme-checkbox\" onchange=\"toggleTheme()\"><span class=\"slider\"></span></label>\n    \n</div>\n\n<div class=\"container\">\n    <nav>\n        <a class=\"nav-logo\" href=\"index.html\">&gt; jcode</a>\n        <div class=\"nav-links\">\n            <a href=\"index.html\">Home</a>\n            <a href=\"beginner-guide.html\">Beginner Guide</a>\n            <a href=\"https://github.com/ShakenTheCoder/JcodeAgent\" target=\"_blank\">GitHub</a>\n        </div>\n    </nav>\n\n    <h1>Technical <span class=\"accent\">Documentation</span></h1>\n    <p class=\"hero-sub\">Architecture, internals, and module reference for JCode.</p>\n\n    <!-- Architecture Overview -->\n    <h2>Architecture Overview</h2>\n    <p>JCode is a multi-agent system with 4 specialized AI roles that collaborate through a structured pipeline. Each role has its own prompt template, model assignment, and memory context.</p>\n\n    <div class=\"arch-diagram\">\nUser Input\n    |\n    v\n+-------------------+\n|     Planner       |  deepseek-r1:14b\n|  (Architecture)   |  Breaks idea into DAG of tasks\n+-------------------+\n    |\n    v  Task Graph (dependency-ordered)\n+-------------------+\n|      Coder        |  qwen2.5-coder:14b\n| (File Generation) |  Generates each file with structured context\n+-------------------+\n    |\n    v  Generated code\n+-------------------+     +-------------------+\n|    Reviewer       | --> |      Coder        |\n|  (Code Critic)    |     |   (Patch Mode)    |\n+-------------------+     +-------------------+\n    |                         |\n    v  Approved code          v  Patched code\n+-------------------+\n|    Verifier       |  Static analysis: syntax, lint, types\n| (executor.py)     |  + test execution (pytest / npm test)\n+-------------------+\n    |\n    |--- PASS --> Next task\n    |\n    v  FAIL\n+-------------------+     +-------------------+\n|    Analyzer       | --> |   Fix Engine      |\n| (Error Diagnosis) |     |  5 strategies     |\n+-------------------+     |  8 attempts       |\n                          +-------------------+\n    </div>\n\n    <!-- Models -->\n    <h2>Model Configuration</h2>\n    <table>\n        <tr><th>Role</th><th>Model</th><th>Context Size</th><th>Purpose</th></tr>\n        <tr><td>Planner</td><td><code>deepseek-r1:14b</code></td><td>16,384</td><td>Architecture design, task decomposition</td></tr>\n        <tr><td>Coder</td><td><code>qwen2.5-coder:14b</code></td><td>16,384</td><td>Code generation, patching</td></tr>\n        <tr><td>Reviewer</td><td><code>qwen2.5-coder:14b</code></td><td>16,384</td><td>Pre-execution code review</td></tr>\n        <tr><td>Analyzer</td><td><code>deepseek-r1:14b</code></td><td>16,384</td><td>Error diagnosis, root cause analysis</td></tr>\n    </table>\n    <p>Context sizes scale based on project complexity (detected automatically). For complex projects, context doubles to 32,768 tokens.</p>\n\n    <!-- Module Reference -->\n    <h2>Module Reference</h2>\n\n    <h3>jcode/cli.py &mdash; Command Line Interface</h3>\n    <p>The main entry point. Implements a two-level REPL:</p>\n    <ul>\n        <li><strong>Home REPL</strong> (<code>_home_repl</code>) &mdash; Project selection, creation, update, uninstall</li>\n        <li><strong>Project REPL</strong> (<code>_project_repl</code>) &mdash; Chat-driven interaction within a project</li>\n    </ul>\n    <p>Key functions:</p>\n    <table>\n        <tr><th>Function</th><th>Description</th></tr>\n        <tr><td><code>main()</code></td><td>Entry point. Checks Ollama, permissions, starts home REPL</td></tr>\n        <tr><td><code>_cmd_build()</code></td><td>Runs Planner + execute_plan pipeline</td></tr>\n        <tr><td><code>_cmd_chat()</code></td><td>Natural language chat with project context</td></tr>\n        <tr><td><code>_cmd_run()</code></td><td>Auto-detects and runs the project</td></tr>\n        <tr><td><code>_apply_file_changes()</code></td><td>Parses ===FILE:=== markers from chat response</td></tr>\n        <tr><td><code>_install_deps_if_needed()</code></td><td>Auto npm install / pip install before run</td></tr>\n    </table>\n\n    <h3>jcode/iteration.py &mdash; Build Engine</h3>\n    <p>The core DAG-based task execution engine. Processes tasks in dependency order with a multi-strategy fix loop.</p>\n    <table>\n        <tr><th>Function</th><th>Description</th></tr>\n        <tr><td><code>execute_plan()</code></td><td>Main orchestrator. Resolves DAG, iterates until all pass or limits hit</td></tr>\n        <tr><td><code>_process_task()</code></td><td>Generate &rarr; Review &rarr; Verify single task</td></tr>\n        <tr><td><code>_review_and_patch()</code></td><td>2-round review loop with patching</td></tr>\n        <tr><td><code>_fix_loop()</code></td><td>8-attempt fix with 5 strategies</td></tr>\n        <tr><td><code>_escalate()</code></td><td>User prompt: retry / guided-fix / skip / pause</td></tr>\n    </table>\n\n    <h4>Fix Strategies (in order)</h4>\n    <table>\n        <tr><th>Strategy</th><th>Attempts</th><th>Approach</th></tr>\n        <tr><td>A: Targeted Patch</td><td>1&ndash;3</td><td>Analyze error &rarr; patch the specific issue</td></tr>\n        <tr><td>B: Deep Analysis</td><td>4&ndash;5</td><td>Cross-file dependency context, reverse dependency checking, dependency patching</td></tr>\n        <tr><td>C: Full Regeneration</td><td>6</td><td>Regenerate entire file from scratch with error history</td></tr>\n        <tr><td>D: Simplify</td><td>7</td><td>Generate minimal/simplified version prioritizing correctness</td></tr>\n        <tr><td>E: Research</td><td>8</td><td>Error pattern classification + web search for solutions</td></tr>\n    </table>\n\n    <h3>jcode/config.py &mdash; Configuration</h3>\n    <p>All constants, enums, and dataclasses:</p>\n    <table>\n        <tr><th>Constant</th><th>Value</th><th>Description</th></tr>\n        <tr><td><code>MAX_TASK_FAILURES</code></td><td>8</td><td>Fix attempts per file before escalation</td></tr>\n        <tr><td><code>MAX_ITERATIONS</code></td><td>15</td><td>Max full DAG passes</td></tr>\n        <tr><td><code>BASE_PLANNER_CTX</code></td><td>16,384</td><td>Base context window for planner</td></tr>\n        <tr><td><code>BASE_CODER_CTX</code></td><td>16,384</td><td>Base context window for coder</td></tr>\n    </table>\n    <p>Key types:</p>\n    <ul>\n        <li><code>TaskStatus</code> &mdash; Enum: PENDING, IN_PROGRESS, DONE, FAILED, SKIPPED</li>\n        <li><code>TaskNode</code> &mdash; Dataclass: task_id, description, file_path, deps, status, failures, output</li>\n        <li><code>ProjectState</code> &mdash; Dataclass: name, description, root, language, framework, complexity</li>\n    </ul>\n\n    <h3>jcode/context.py &mdash; Structured Memory</h3>\n    <p>The memory engine that gives each AI role precisely the context it needs.</p>\n    <table>\n        <tr><th>Feature</th><th>Description</th></tr>\n        <tr><td>Task DAG</td><td>Ordered task list with dependency edges</td></tr>\n        <tr><td>File Index</td><td>Map of file_path &rarr; content for all generated files</td></tr>\n        <tr><td>Failure Log</td><td>History of errors and fix attempts per file</td></tr>\n        <tr><td>Chat History</td><td>Per-project conversation log</td></tr>\n        <tr><td>Serialization</td><td>Save/load to <code>~/.jcode/projects/{name}/</code></td></tr>\n    </table>\n    <p>Context is trimmed per-role: the Coder gets the architecture summary + relevant dependency file contents, not the entire file index.</p>\n\n    <h3>jcode/prompts.py &mdash; Prompt Templates</h3>\n    <p>System prompts for each role:</p>\n    <ul>\n        <li><code>PLANNER_SYSTEM</code> / <code>PLANNER_REFINE</code> &mdash; Architecture planning with JSON DAG output</li>\n        <li><code>CODER_SYSTEM</code> / <code>CODER_TASK</code> / <code>CODER_PATCH</code> &mdash; File generation and targeted patching</li>\n        <li><code>REVIEWER_SYSTEM</code> / <code>REVIEWER_TASK</code> &mdash; Code review with JSON issue list</li>\n        <li><code>ANALYZER_SYSTEM</code> / <code>ANALYZER_TASK</code> &mdash; Error diagnosis with structured fix strategy</li>\n        <li><code>CHAT_SYSTEM</code> / <code>CHAT_CONTEXT</code> &mdash; Natural language chat with 3 modes (action / discussion / run-deploy)</li>\n    </ul>\n\n    <h3>jcode/executor.py &mdash; Execution &amp; Verification</h3>\n    <table>\n        <tr><th>Function</th><th>Description</th></tr>\n        <tr><td><code>verify_file()</code></td><td>Routes to language-specific verifier</td></tr>\n        <tr><td><code>_verify_python()</code></td><td>py_compile + optional pylint + pyflakes</td></tr>\n        <tr><td><code>_verify_javascript()</code></td><td>node --check + optional eslint</td></tr>\n        <tr><td><code>_verify_json()</code></td><td>json.loads validation</td></tr>\n        <tr><td><code>run_command()</code></td><td>Execute shell command with timeout and capture</td></tr>\n        <tr><td><code>install_dependencies()</code></td><td>Auto pip install / npm install</td></tr>\n        <tr><td><code>run_tests()</code></td><td>Detect and run pytest / npm test</td></tr>\n    </table>\n\n    <h3>jcode/ollama_client.py &mdash; Model Interface</h3>\n    <p>Wrapper around the Ollama Python SDK. All model calls go through <code>call_model(role, messages, stream, num_ctx)</code>.</p>\n    <ul>\n        <li>Streaming support for real-time output</li>\n        <li>Automatic context size based on role and project complexity</li>\n        <li>Legacy wrappers: <code>call_planner()</code>, <code>call_coder()</code>, <code>call_reviewer()</code>, <code>call_analyzer()</code></li>\n    </ul>\n\n    <h3>jcode/web.py &mdash; Web Search</h3>\n    <p>Web search and documentation fetching using DuckDuckGo (no API key required):</p>\n    <ul>\n        <li><code>web_search(query)</code> &mdash; Search DuckDuckGo, return top results</li>\n        <li><code>fetch_page(url)</code> &mdash; Fetch and extract text content from a URL</li>\n        <li><code>fetch_docs(query)</code> &mdash; Targeted documentation search</li>\n        <li><code>search_and_summarize(query)</code> &mdash; Search + fetch + summarize results</li>\n    </ul>\n\n    <h3>jcode/settings.py &mdash; User Settings</h3>\n    <p>Persistent settings stored in <code>~/.jcode/settings.json</code>:</p>\n    <ul>\n        <li><code>autonomous_access</code> &mdash; Permission to read/write project files</li>\n        <li><code>internet_access</code> &mdash; Permission to search the web</li>\n    </ul>\n\n    <!-- Data Flow -->\n    <h2>Data Flow</h2>\n    <h3>Build Pipeline</h3>\n    <pre><code>User description\n  |\n  v\nPlanner.plan() --> TaskNode[] (DAG)\n  |\n  v\nfor each task in topological order:\n  |\n  +-- Coder.generate_file(task, context)\n  |     |\n  |     v\n  +-- Reviewer.review_file(code)\n  |     |-- issues? --> Coder.patch_file(code, issues)\n  |     |               |-- re-review (max 2 rounds)\n  |     |\n  |     v\n  +-- Executor.verify_file(path)\n  |     |-- pass? --> mark DONE, continue\n  |     |\n  |     v  fail\n  +-- Fix Loop (8 attempts, 5 strategies)\n        |-- Analyzer.analyze_error(error)\n        |-- Strategy A/B/C/D/E --> patch/regen/research\n        |-- Executor.verify_file(path)\n        |-- pass? --> break\n        |-- all failed? --> escalate to user</code></pre>\n\n    <h3>Chat Pipeline</h3>\n    <pre><code>User message\n  |\n  v\nBuild context: architecture + file index + chat history\n  |\n  v\ncall_model(\"coder\", [system + context + message])\n  |\n  v\nResponse contains ===FILE:path=== markers?\n  |-- yes --> parse and apply file changes\n  |-- no  --> display as text answer</code></pre>\n\n    <!-- File Structure -->\n    <h2>Project Structure</h2>\n    <pre><code>JcodeAgent/\n  jcode/\n    __init__.py       Package init, version\n    cli.py            Main CLI entry point (two-level REPL)\n    config.py         Constants, enums, dataclasses\n    context.py        Structured memory engine\n    iteration.py      DAG build engine + fix loop\n    prompts.py        All prompt templates\n    coder.py          File generation + patching\n    reviewer.py       Code review\n    analyzer.py       Error diagnosis\n    executor.py       Verification + test execution\n    ollama_client.py  Ollama API wrapper\n    web.py            Web search + doc fetching\n    settings.py       User settings persistence\n  docs/\n    index.html        Landing page\n    beginner-guide.html  This guide\n    technical.html    You are here\n  install.sh          Unix installer\n  install.ps1         Windows installer\n  pyproject.toml      Package metadata\n  README.md           Repository readme</code></pre>\n\n    <!-- Extending -->\n    <h2>Extending JCode</h2>\n    <h3>Adding a new language verifier</h3>\n    <p>Edit <code>executor.py</code> and add a new <code>_verify_*</code> function. Register it in <code>verify_file()</code>'s extension-to-verifier map.</p>\n\n    <h3>Changing models</h3>\n    <p>Edit <code>config.py</code>. Set <code>PLANNER_MODEL</code> and <code>CODER_MODEL</code> to any Ollama-compatible model.</p>\n\n    <h3>Adding a new fix strategy</h3>\n    <p>In <code>iteration.py</code>, add a new strategy block in <code>_fix_loop()</code>. Assign it an attempt number range and implement the fix logic.</p>\n</div>\n\n<footer>\n    <div class=\"container\">\n        <p>JCode &middot; <a href=\"index.html\">Home</a> &middot; <a href=\"beginner-guide.html\">Beginner Guide</a> &middot; <a href=\"https://github.com/ShakenTheCoder/JcodeAgent\">GitHub</a></p>\n    </div>\n</footer>\n\n<script>\nfunction toggleTheme() {\n    const cb = document.getElementById('theme-checkbox');\n    document.documentElement.setAttribute('data-theme', cb.checked ? 'light' : 'dark');\n    localStorage.setItem('jcode-theme', cb.checked ? 'light' : 'dark');\n}\n(function() {\n    if (localStorage.getItem('jcode-theme') === 'light') {\n        document.documentElement.setAttribute('data-theme', 'light');\n        document.getElementById('theme-checkbox').checked = true;\n    }\n})();\n</script>\n</body>\n</html>\n",
      "docs/vercel.json": "{\n  \"rewrites\": [\n    { \"source\": \"/install.sh\", \"destination\": \"/api/install.sh\" },\n    { \"source\": \"/install.ps1\", \"destination\": \"/api/install.ps1\" }\n  ]\n}\n",
      "inactive/frontend/README.md": "# JCode Frontend - Next.js\n\nThis is the Next.js frontend for JCode's landing page and documentation.\n\n## Project Structure\n\n```\nfrontend/\n\u251c\u2500\u2500 app/\n\u2502   \u251c\u2500\u2500 layout.tsx          # Root layout with theme provider\n\u2502   \u251c\u2500\u2500 page.tsx            # Home page\n\u2502   \u251c\u2500\u2500 guide/page.tsx      # Beginner's guide\n\u2502   \u251c\u2500\u2500 technical/page.tsx  # Technical documentation\n\u2502   \u251c\u2500\u2500 globals.css         # Global styles + Tailwind\n\u2502   \u2514\u2500\u2500 api/\n\u2502       \u251c\u2500\u2500 install.sh/route.ts   # Install script with analytics\n\u2502       \u251c\u2500\u2500 install.ps1/route.ts  # Windows installer\n\u2502       \u2514\u2500\u2500 stats/route.ts        # Analytics dashboard\n\u251c\u2500\u2500 components/\n\u2502   \u251c\u2500\u2500 Header.tsx          # Navigation header\n\u2502   \u251c\u2500\u2500 Footer.tsx          # Site footer\n\u2502   \u251c\u2500\u2500 ThemeProvider.tsx   # Dark/light theme context\n\u2502   \u2514\u2500\u2500 HomeComponents.tsx  # Reusable home page components\n\u251c\u2500\u2500 public/\n\u2502   \u2514\u2500\u2500 *.ico               # Favicons\n\u251c\u2500\u2500 package.json\n\u251c\u2500\u2500 tsconfig.json\n\u251c\u2500\u2500 tailwind.config.ts\n\u2514\u2500\u2500 vercel.json             # Vercel routing config\n```\n\n## Development\n\nInstall dependencies:\n```bash\nnpm install\n```\n\nRun dev server:\n```bash\nnpm run dev\n```\n\nVisit http://localhost:3000\n\n## Build\n\n```bash\nnpm run build\nnpm start\n```\n\n## Deployment\n\nConfigured for Vercel with:\n- Edge runtime for API routes\n- Vercel KV for analytics storage\n- Automatic rewrites for `/install.sh` and `/install.ps1`\n\n## Analytics\n\nInstall tracking requires Vercel KV:\n1. Go to Vercel dashboard \u2192 Storage \u2192 Create Database \u2192 KV\n2. Name: `jcode-analytics`\n3. Connect to project\n4. Deploy\n\nSee `/api/stats` for the analytics dashboard.\n",
      "inactive/frontend/app/api/install.ps1/route.ts": "import { kv } from '@vercel/kv'\n\nconst INSTALL_SCRIPT_URL = 'https://raw.githubusercontent.com/ShakenTheCoder/JcodeAgent/main/install.ps1'\n\nexport const runtime = 'edge'\n\nexport async function GET(request: Request) {\n  const ip = request.headers.get('x-forwarded-for') || request.headers.get('x-real-ip') || 'unknown'\n  const userAgent = request.headers.get('user-agent') || 'unknown'\n  const timestamp = new Date().toISOString()\n  \n  const installData = {\n    ip: ip.split(',')[0].trim(),\n    timestamp,\n    userAgent,\n    os: 'Windows',\n    platform: 'windows',\n  }\n\n  try {\n    await kv.incr('jcode:install:count:windows')\n    await kv.lpush('jcode:installs', JSON.stringify(installData))\n    await kv.ltrim('jcode:installs', 0, 999)\n    \n    const dateKey = `jcode:installs:${timestamp.split('T')[0]}`\n    await kv.incr(dateKey)\n    await kv.expire(dateKey, 90 * 24 * 60 * 60)\n  } catch (err) {\n    console.error('Analytics error:', err)\n  }\n\n  try {\n    const response = await fetch(INSTALL_SCRIPT_URL)\n    const script = await response.text()\n    \n    return new Response(script, {\n      status: 200,\n      headers: {\n        'Content-Type': 'text/plain',\n        'Cache-Control': 'public, max-age=300',\n      },\n    })\n  } catch (err) {\n    return new Response(\n      '# Error\\nWrite-Host \"Failed to download installer. Visit https://github.com/ShakenTheCoder/JcodeAgent\" -ForegroundColor Red',\n      {\n        status: 500,\n        headers: { 'Content-Type': 'text/plain' },\n      }\n    )\n  }\n}\n",
      "inactive/frontend/app/api/install.sh/route.ts": "import { kv } from '@vercel/kv'\nimport { NextResponse } from 'next/server'\n\nconst INSTALL_SCRIPT_URL = 'https://raw.githubusercontent.com/ShakenTheCoder/JcodeAgent/main/install.sh'\n\nexport const runtime = 'edge'\n\nexport async function GET(request: Request) {\n  const ip = request.headers.get('x-forwarded-for') || request.headers.get('x-real-ip') || 'unknown'\n  const userAgent = request.headers.get('user-agent') || 'unknown'\n  const timestamp = new Date().toISOString()\n  \n  // Infer OS from User-Agent\n  let os = 'unknown'\n  if (userAgent.includes('Mac')) os = 'macOS'\n  else if (userAgent.includes('Linux')) os = 'Linux'\n  else if (userAgent.includes('Windows')) os = 'Windows'\n  \n  const installData = {\n    ip: ip.split(',')[0].trim(),\n    timestamp,\n    userAgent,\n    os,\n    platform: 'unix',\n  }\n\n  try {\n    await kv.incr('jcode:install:count:unix')\n    await kv.lpush('jcode:installs', JSON.stringify(installData))\n    await kv.ltrim('jcode:installs', 0, 999)\n    \n    const dateKey = `jcode:installs:${timestamp.split('T')[0]}`\n    await kv.incr(dateKey)\n    await kv.expire(dateKey, 90 * 24 * 60 * 60)\n  } catch (err) {\n    console.error('Analytics error:', err)\n  }\n\n  try {\n    const response = await fetch(INSTALL_SCRIPT_URL)\n    const script = await response.text()\n    \n    return new Response(script, {\n      status: 200,\n      headers: {\n        'Content-Type': 'text/plain',\n        'Cache-Control': 'public, max-age=300',\n      },\n    })\n  } catch (err) {\n    return new Response(\n      '# Error fetching install script\\necho \"Failed to download installer. Please try again or visit https://github.com/ShakenTheCoder/JcodeAgent\"',\n      {\n        status: 500,\n        headers: { 'Content-Type': 'text/plain' },\n      }\n    )\n  }\n}\n",
      "inactive/frontend/app/api/stats/route.ts": "import { kv } from '@vercel/kv'\n\nexport const runtime = 'edge'\n\nexport async function GET() {\n  try {\n    const unixCount = (await kv.get('jcode:install:count:unix')) || 0\n    const windowsCount = (await kv.get('jcode:install:count:windows')) || 0\n    const totalCount = Number(unixCount) + Number(windowsCount)\n    \n    const recentInstalls = await kv.lrange('jcode:installs', 0, 49)\n    const parsedInstalls = recentInstalls.map((item) => JSON.parse(item as string))\n    \n    const osDistribution = {\n      macOS: 0,\n      Linux: 0,\n      Windows: Number(windowsCount),\n      unknown: 0,\n    }\n    \n    parsedInstalls.forEach((install: any) => {\n      if (install.os === 'macOS') osDistribution.macOS++\n      else if (install.os === 'Linux') osDistribution.Linux++\n      else if (install.os === 'unknown') osDistribution.unknown++\n    })\n    \n    const today = new Date().toISOString().split('T')[0]\n    const todayCount = (await kv.get(`jcode:installs:${today}`)) || 0\n    \n    const html = `<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>JCode Install Analytics</title>\n    <style>\n        * { margin: 0; padding: 0; box-sizing: border-box; }\n        body {\n            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;\n            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n            color: #fff;\n            padding: 40px 20px;\n            min-height: 100vh;\n        }\n        .container {\n            max-width: 1200px;\n            margin: 0 auto;\n        }\n        h1 {\n            font-size: 2.5rem;\n            margin-bottom: 40px;\n            text-align: center;\n            text-shadow: 2px 2px 4px rgba(0,0,0,0.2);\n        }\n        .stats-grid {\n            display: grid;\n            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));\n            gap: 20px;\n            margin-bottom: 40px;\n        }\n        .stat-card {\n            background: rgba(255, 255, 255, 0.1);\n            backdrop-filter: blur(10px);\n            border-radius: 12px;\n            padding: 30px;\n            border: 1px solid rgba(255, 255, 255, 0.2);\n        }\n        .stat-value {\n            font-size: 3rem;\n            font-weight: bold;\n            margin-bottom: 10px;\n        }\n        .stat-label {\n            font-size: 1rem;\n            opacity: 0.9;\n            text-transform: uppercase;\n            letter-spacing: 1px;\n        }\n        .recent-installs {\n            background: rgba(255, 255, 255, 0.1);\n            backdrop-filter: blur(10px);\n            border-radius: 12px;\n            padding: 30px;\n            border: 1px solid rgba(255, 255, 255, 0.2);\n        }\n        .recent-installs h2 {\n            margin-bottom: 20px;\n            font-size: 1.5rem;\n        }\n        .install-item {\n            padding: 15px;\n            background: rgba(0, 0, 0, 0.2);\n            border-radius: 8px;\n            margin-bottom: 10px;\n            display: flex;\n            justify-content: space-between;\n            align-items: center;\n            flex-wrap: wrap;\n            gap: 10px;\n        }\n        .install-time {\n            opacity: 0.8;\n            font-size: 0.9rem;\n        }\n        .install-os {\n            background: rgba(255, 255, 255, 0.2);\n            padding: 4px 12px;\n            border-radius: 20px;\n            font-size: 0.85rem;\n        }\n        .back-link {\n            display: inline-block;\n            margin-bottom: 20px;\n            padding: 10px 20px;\n            background: rgba(255, 255, 255, 0.2);\n            border-radius: 8px;\n            text-decoration: none;\n            color: #fff;\n            transition: background 0.3s;\n        }\n        .back-link:hover {\n            background: rgba(255, 255, 255, 0.3);\n        }\n    </style>\n</head>\n<body>\n    <div class=\"container\">\n        <a href=\"/\" class=\"back-link\">\u2190 Back to Home</a>\n        <h1>\ud83d\udcca JCode Install Analytics</h1>\n        \n        <div class=\"stats-grid\">\n            <div class=\"stat-card\">\n                <div class=\"stat-value\">${totalCount}</div>\n                <div class=\"stat-label\">Total Installs</div>\n            </div>\n            <div class=\"stat-card\">\n                <div class=\"stat-value\">${todayCount}</div>\n                <div class=\"stat-label\">Today</div>\n            </div>\n            <div class=\"stat-card\">\n                <div class=\"stat-value\">${osDistribution.macOS}</div>\n                <div class=\"stat-label\">macOS</div>\n            </div>\n            <div class=\"stat-card\">\n                <div class=\"stat-value\">${osDistribution.Linux}</div>\n                <div class=\"stat-label\">Linux</div>\n            </div>\n            <div class=\"stat-card\">\n                <div class=\"stat-value\">${osDistribution.Windows}</div>\n                <div class=\"stat-label\">Windows</div>\n            </div>\n        </div>\n        \n        <div class=\"recent-installs\">\n            <h2>Recent Installs</h2>\n            ${parsedInstalls\n              .slice(0, 20)\n              .map((install: any) => {\n                const date = new Date(install.timestamp)\n                const timeStr = date.toLocaleString('en-US', {\n                  month: 'short',\n                  day: 'numeric',\n                  hour: '2-digit',\n                  minute: '2-digit',\n                })\n                return `\n                    <div class=\"install-item\">\n                        <span class=\"install-time\">${timeStr}</span>\n                        <span class=\"install-os\">${install.os}</span>\n                    </div>\n                `\n              })\n              .join('')}\n        </div>\n    </div>\n</body>\n</html>`\n    \n    return new Response(html, {\n      status: 200,\n      headers: {\n        'Content-Type': 'text/html',\n        'Cache-Control': 'public, max-age=60',\n      },\n    })\n  } catch (err) {\n    console.error('Stats error:', err)\n    return new Response(`Error loading stats: ${err}`, {\n      status: 500,\n      headers: { 'Content-Type': 'text/plain' },\n    })\n  }\n}\n",
      "inactive/frontend/app/globals.css": "*, *::before, *::after { \n  box-sizing: border-box; \n  margin: 0; \n  padding: 0; \n}\n\n:root {\n  --font-mono: 'SF Mono', 'Fira Code', 'JetBrains Mono', 'Cascadia Code', 'Consolas', monospace;\n  --font-sans: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;\n  --transition: 0.3s ease;\n}\n\n/* Dark Theme */\n[data-theme=\"dark\"] {\n  --bg: #050508;\n  --bg-card: #0c0c12;\n  --bg-terminal: #0a0e17;\n  --text: #d4d4d8;\n  --text-dim: #52525b;\n  --accent: #22d3ee;\n  --accent-dim: rgba(34, 211, 238, 0.08);\n  --accent-glow: rgba(34, 211, 238, 0.2);\n  --border: #1a1a2e;\n  --border-glow: rgba(34, 211, 238, 0.15);\n  --holo-gradient: linear-gradient(135deg, rgba(34,211,238,0.06) 0%, rgba(6,182,212,0.02) 50%, rgba(34,211,238,0.06) 100%);\n  --scanline: rgba(34, 211, 238, 0.03);\n}\n\n/* Light Theme */\n[data-theme=\"light\"] {\n  --bg: #f8fafc;\n  --bg-card: #ffffff;\n  --bg-terminal: #f1f5f9;\n  --text: #1e293b;\n  --text-dim: #64748b;\n  --accent: #0891b2;\n  --accent-dim: rgba(8, 145, 178, 0.06);\n  --accent-glow: rgba(8, 145, 178, 0.15);\n  --border: #e2e8f0;\n  --border-glow: rgba(8, 145, 178, 0.1);\n  --holo-gradient: linear-gradient(135deg, rgba(8,145,178,0.04) 0%, transparent 50%, rgba(8,145,178,0.04) 100%);\n  --scanline: rgba(8, 145, 178, 0.02);\n}\n\nhtml {\n  scroll-behavior: smooth;\n}\n\nbody {\n  font-family: var(--font-mono);\n  background: var(--bg);\n  color: var(--text);\n  line-height: 1.7;\n  transition: background var(--transition), color var(--transition);\n  overflow-x: hidden;\n}\n\na { \n  color: var(--accent); \n  text-decoration: none; \n}\n\na:hover { \n  text-decoration: underline; \n}\n\n.container { \n  max-width: 920px; \n  margin: 0 auto; \n  padding: 0 2rem; \n}\n\n@media (max-width: 600px) {\n  .container { \n    padding: 0 1rem; \n  }\n}\n\n@keyframes blink { \n  50% { opacity: 0; } \n}\n",
      "inactive/frontend/app/guide/guide.module.css": ".heroSub {\n  color: var(--text-dim);\n  font-size: 1rem;\n  margin-bottom: 3rem;\n}\n\n.callout {\n  background: var(--accent-dim);\n  border-left: 3px solid var(--accent);\n  padding: 1rem 1.2rem;\n  border-radius: 0 8px 8px 0;\n  margin-bottom: 1.5rem;\n  font-size: 0.9rem;\n}\n\n.callout strong {\n  color: var(--accent);\n}\n\n.stepGrid {\n  display: grid;\n  grid-template-columns: 40px 1fr;\n  gap: 0 1rem;\n  margin-bottom: 1.5rem;\n}\n\n.stepNum {\n  font-family: var(--font-mono);\n  font-size: 0.8rem;\n  color: var(--accent);\n  font-weight: 700;\n  padding-top: 0.15rem;\n}\n",
      "inactive/frontend/app/guide/page.tsx": "'use client'\n\nimport Link from 'next/link'\nimport styles from './guide.module.css'\n\nexport default function GuidePage() {\n  return (\n    <div className=\"container\">\n      <h1>Beginner <span className=\"accent\">Guide</span></h1>\n      <p className={styles.heroSub}>Everything you need to get started with JCode &mdash; from installation to your first project.</p>\n\n      <h2>Prerequisites</h2>\n      <p>Before installing JCode, make sure you have:</p>\n      <ul>\n        <li><strong>Python 3.10+</strong> &mdash; Check with <code>python3 --version</code></li>\n        <li><strong>Ollama</strong> &mdash; Install from <a href=\"https://ollama.ai\" target=\"_blank\" rel=\"noopener noreferrer\">ollama.ai</a></li>\n        <li><strong>8GB+ RAM</strong> &mdash; For running 14B parameter models locally</li>\n        <li><strong>20GB+ disk space</strong> &mdash; For the two AI models (~7GB each)</li>\n      </ul>\n\n      <div className={styles.callout}>\n        <strong>Note:</strong> JCode runs entirely on your machine. No API keys, no cloud accounts, and no internet connection required after installation.\n      </div>\n\n      <h2>Installation</h2>\n      <h3>One-command install (recommended)</h3>\n      <p>Mac / Linux:</p>\n      <pre><code>curl -fsSL https://getjcode.vercel.app/install.sh | bash</code></pre>\n      <p>Windows (PowerShell):</p>\n      <pre><code>iwr -useb https://getjcode.vercel.app/install.ps1 | iex</code></pre>\n      <p>The installer will:</p>\n      <ol>\n        <li>Clone the JCode repository</li>\n        <li>Create a Python virtual environment</li>\n        <li>Install all dependencies</li>\n        <li>Pull the required AI models (deepseek-r1:14b + qwen2.5-coder:14b)</li>\n        <li>Add <code>jcode</code> to your PATH</li>\n      </ol>\n\n      <h3>Manual install</h3>\n      <pre><code>{`git clone https://github.com/ShakenTheCoder/JcodeAgent.git\ncd JcodeAgent\npython3 -m venv .venv\nsource .venv/bin/activate\npip install -e .\nollama pull deepseek-r1:14b\nollama pull qwen2.5-coder:14b`}</code></pre>\n\n      <h2>First Launch</h2>\n      <p>Start JCode by typing:</p>\n      <pre><code>jcode</code></pre>\n      <p>On your first run, JCode will ask for two permissions:</p>\n      <ul>\n        <li><strong>Autonomous file access</strong> &mdash; Lets JCode read and write files in your project directories</li>\n        <li><strong>Internet access</strong> &mdash; Lets JCode search the web for documentation and solutions</li>\n      </ul>\n      <p>Both are optional. You only get asked once &mdash; your choices are saved permanently.</p>\n\n      <h2>Your First Project</h2>\n      <p>Here is a step-by-step walkthrough of building your first project:</p>\n\n      <div className={styles.stepGrid}>\n        <div className={styles.stepNum}>01</div>\n        <div>\n          <p><strong>Start JCode and type your project idea:</strong></p>\n          <pre><code>jcode&gt; build a todo app with Flask and SQLite</code></pre>\n        </div>\n\n        <div className={styles.stepNum}>02</div>\n        <div>\n          <p><strong>JCode plans the architecture.</strong> The Planner breaks down your idea into a dependency-ordered task graph. You will see something like:</p>\n          <pre><code>{`12:04:01  PHASE 1   Planning project architecture\n12:04:12  PLAN      5 task(s) created`}</code></pre>\n        </div>\n\n        <div className={styles.stepNum}>03</div>\n        <div>\n          <p><strong>JCode generates and reviews each file.</strong> Every file goes through: generate &rarr; review &rarr; verify. If anything fails, the fix engine kicks in automatically.</p>\n          <pre><code>{`12:04:15  GENERATE  app.py\n12:04:22  REVIEW    Approved\n12:04:23  VERIFY    passed`}</code></pre>\n        </div>\n\n        <div className={styles.stepNum}>04</div>\n        <div>\n          <p><strong>Build complete.</strong> Once all files pass, you drop into the project REPL:</p>\n          <pre><code>{`12:05:10  DONE      Build complete -- all files verified\n\ntodo-app>`}</code></pre>\n        </div>\n\n        <div className={styles.stepNum}>05</div>\n        <div>\n          <p><strong>Chat naturally to iterate.</strong> Add features, fix bugs, or ask questions:</p>\n          <pre><code>{`todo-app> add user authentication with password hashing\ntodo-app> why did you use Flask-Login instead of JWT?\ntodo-app> make the UI look more modern`}</code></pre>\n        </div>\n\n        <div className={styles.stepNum}>06</div>\n        <div>\n          <p><strong>Run your project.</strong> Type <code>run</code> and JCode auto-detects the right command:</p>\n          <pre><code>{`todo-app> run\nRunning: python app.py\n * Running on http://127.0.0.1:5000`}</code></pre>\n        </div>\n      </div>\n\n      <h2>Chat Mode</h2>\n      <p>Once inside a project, everything is natural language. JCode detects your intent automatically:</p>\n      <ul>\n        <li><strong>Action requests</strong> &mdash; \"add a search bar\", \"fix the login bug\", \"refactor the database layer\" &rarr; JCode modifies files</li>\n        <li><strong>Questions</strong> &mdash; \"how does the routing work?\", \"explain the auth flow\" &rarr; JCode answers without changing files</li>\n        <li><strong>Run/Deploy</strong> &mdash; \"how do I run this?\", \"how do I deploy to Vercel?\" &rarr; JCode gives step-by-step commands</li>\n      </ul>\n\n      <h2>Reserved Commands</h2>\n      <p>These are the only special commands. Everything else is natural language:</p>\n      <pre><code>{`run       Run the project (auto-detects framework)\nplan      Show the current task plan\nfiles     List all project files\ntree      Show directory tree\nrebuild   Re-run the full build pipeline\nback      Return to home screen\nclear     Clear the terminal\nhelp      Show help`}</code></pre>\n\n      <h2>Tips &amp; Best Practices</h2>\n      <ul>\n        <li><strong>Be specific.</strong> \"Build a REST API with FastAPI, PostgreSQL, JWT auth, and Docker\" gives better results than \"build an API\".</li>\n        <li><strong>Iterate in small steps.</strong> After the initial build, add features one at a time rather than asking for everything at once.</li>\n        <li><strong>Use <code>run</code> often.</strong> Test after every change. JCode auto-installs dependencies when needed.</li>\n        <li><strong>Ask questions.</strong> If something is unclear, ask JCode to explain. It has full context of your project.</li>\n        <li><strong>Trust the fix engine.</strong> If a file fails verification, JCode has 8 attempts with 5 different strategies. Let it work.</li>\n        <li><strong>Save your progress.</strong> Sessions auto-save. You can close JCode and resume later &mdash; your project and chat history are preserved.</li>\n      </ul>\n\n      <h2>Troubleshooting</h2>\n      <h3>Ollama not found</h3>\n      <p>Make sure Ollama is running: <code>ollama serve</code>. If not installed, get it from <a href=\"https://ollama.ai\" target=\"_blank\" rel=\"noopener noreferrer\">ollama.ai</a>.</p>\n\n      <h3>Models not downloaded</h3>\n      <p>Pull both models manually:</p>\n      <pre><code>{`ollama pull deepseek-r1:14b\nollama pull qwen2.5-coder:14b`}</code></pre>\n\n      <h3>Out of memory</h3>\n      <p>14B models need ~8GB RAM. Close other applications, or use smaller models by editing <code>jcode/config.py</code>:</p>\n      <pre><code>{`PLANNER_MODEL = \"deepseek-r1:7b\"\nCODER_MODEL = \"qwen2.5-coder:7b\"`}</code></pre>\n\n      <h3>Permission denied</h3>\n      <p>Reset permissions by deleting <code>~/.jcode/settings.json</code>. JCode will ask again on next launch.</p>\n\n      <h3>Build keeps failing</h3>\n      <p>If the 8-attempt fix engine cannot resolve an issue, JCode will pause and ask for guidance. You can:</p>\n      <ul>\n        <li>Provide a hint about what is wrong</li>\n        <li>Skip the problematic file</li>\n        <li>Retry with a fresh attempt</li>\n      </ul>\n    </div>\n  )\n}\n",
      "inactive/frontend/app/layout.tsx": "import type { Metadata } from 'next'\nimport './globals.css'\nimport { ThemeProvider } from '@/components/ThemeProvider'\nimport Header from '@/components/Header'\nimport Footer from '@/components/Footer'\n\nexport const metadata: Metadata = {\n  title: 'JCode \u2014 Your Local, Unlimited & Private Software Engineer',\n  description: 'JCode is a local AI coding agent that iterates until your project works. 4 AI roles, zero cloud, 100% private.',\n  keywords: 'AI coding agent, local AI, Ollama, code generation, project builder',\n  authors: [{ name: 'Ioan Andrei' }],\n  openGraph: {\n    title: 'JCode \u2014 Local AI Coding Agent',\n    description: 'Build complete projects from a single prompt. Powered by Ollama, running 100% locally.',\n    url: 'https://getjcode.vercel.app',\n    siteName: 'JCode',\n    locale: 'en_US',\n    type: 'website',\n  },\n  twitter: {\n    card: 'summary_large_image',\n    title: 'JCode \u2014 Local AI Coding Agent',\n    description: 'Build complete projects from a single prompt. Powered by Ollama, running 100% locally.',\n  },\n}\n\nexport default function RootLayout({\n  children,\n}: {\n  children: React.ReactNode\n}) {\n  return (\n    <html lang=\"en\" data-theme=\"dark\" suppressHydrationWarning>\n      <head>\n        <link rel=\"icon\" href=\"/JcodeLogo.ico\" type=\"image/x-icon\" />\n      </head>\n      <body>\n        <ThemeProvider>\n          <Header />\n          {children}\n          <Footer />\n        </ThemeProvider>\n      </body>\n    </html>\n  )\n}\n",
      "inactive/frontend/app/page.module.css": ".hero {\n  text-align: center;\n  padding: 5rem 0 3rem;\n}\n\n.heroAscii {\n  color: var(--accent);\n  font-size: clamp(0.45rem, 1.8vw, 0.75rem);\n  line-height: 1.2;\n  margin-bottom: 2rem;\n  white-space: pre;\n  text-shadow: 0 0 30px var(--accent-glow);\n  letter-spacing: 0.05em;\n  font-family: var(--font-mono);\n}\n\n.hero h1 {\n  font-family: var(--font-sans);\n  font-size: clamp(1.5rem, 4vw, 2.4rem);\n  font-weight: 700;\n  margin-bottom: 1rem;\n  letter-spacing: -0.02em;\n  color: var(--text);\n}\n\n.hero h1 .accent {\n  color: var(--accent);\n}\n\n.hero p {\n  color: var(--text-dim);\n  font-size: 1rem;\n  max-width: 560px;\n  margin: 0 auto 2.5rem;\n  font-family: var(--font-sans);\n  line-height: 1.6;\n}\n\n.installTabs {\n  display: flex;\n  gap: 0;\n  max-width: 640px;\n  margin: 0 auto;\n}\n\n.installTab {\n  padding: 0.4rem 1rem;\n  background: transparent;\n  border: 1px solid var(--border);\n  border-bottom: none;\n  color: var(--text-dim);\n  cursor: pointer;\n  font-family: var(--font-mono);\n  font-size: 0.75rem;\n  transition: all var(--transition);\n  border-radius: 6px 6px 0 0;\n  font-weight: 500;\n}\n\n.installTab:hover {\n  color: var(--accent);\n}\n\n.installTab.active {\n  background: var(--bg-terminal);\n  color: var(--accent);\n}\n\n.installPanel {\n  display: block;\n}\n\n.installBox {\n  background: var(--bg-terminal);\n  border: 1px solid var(--border);\n  border-radius: 10px;\n  padding: 1.2rem 1.5rem;\n  margin: 0 auto 0.8rem;\n  max-width: 640px;\n  position: relative;\n}\n\n.installBox .label {\n  font-size: 0.7rem;\n  color: var(--text-dim);\n  margin-bottom: 0.4rem;\n  text-transform: uppercase;\n  letter-spacing: 0.1em;\n}\n\n.installBox code {\n  display: block;\n  color: var(--accent);\n  font-size: 0.85rem;\n  word-break: break-all;\n  font-family: var(--font-mono);\n}\n\n.installBox .copyBtn {\n  position: absolute;\n  top: 0.8rem;\n  right: 0.8rem;\n  background: var(--border);\n  border: none;\n  color: var(--text-dim);\n  padding: 0.3rem 0.6rem;\n  border-radius: 4px;\n  cursor: pointer;\n  font-size: 0.7rem;\n  font-family: var(--font-mono);\n  transition: all var(--transition);\n}\n\n.installBox .copyBtn:hover {\n  background: var(--accent);\n  color: var(--bg);\n}\n\n.terminal {\n  background: var(--bg-terminal);\n  border: 1px solid var(--border);\n  border-radius: 12px;\n  overflow: hidden;\n  margin: 3rem auto;\n  max-width: 700px;\n  box-shadow: 0 8px 40px rgba(0, 0, 0, 0.2);\n}\n\n.terminalBar {\n  background: var(--border);\n  padding: 0.6rem 1rem;\n  display: flex;\n  align-items: center;\n  gap: 0.5rem;\n}\n\n.terminalDot {\n  width: 10px;\n  height: 10px;\n  border-radius: 50%;\n}\n\n.terminalDot.r {\n  background: #f87171;\n}\n\n.terminalDot.y {\n  background: #fbbf24;\n}\n\n.terminalDot.g {\n  background: #4ade80;\n}\n\n.terminalTitle {\n  margin-left: 0.5rem;\n  color: var(--text-dim);\n  font-size: 0.75rem;\n}\n\n.terminalBody {\n  padding: 1.2rem 1.5rem;\n  font-size: 0.8rem;\n  line-height: 1.6;\n  min-height: 300px;\n  font-family: var(--font-mono);\n}\n\n.terminalBody div {\n  color: var(--text);\n}\n\n.prompt {\n  color: var(--accent);\n}\n\n.cmd {\n  color: var(--text);\n}\n\n.dim {\n  color: var(--text-dim);\n}\n\n.ok {\n  color: #4ade80;\n}\n\n.cyan {\n  color: var(--accent);\n}\n\n.typingCursor {\n  display: inline-block;\n  width: 7px;\n  height: 1em;\n  background: var(--accent);\n  animation: blink 1s step-end infinite;\n  vertical-align: text-bottom;\n}\n\n@keyframes blink {\n  0%, 49% {\n    background: var(--accent);\n  }\n  50%, 100% {\n    background: transparent;\n  }\n}\n\n.section {\n  padding: 4rem 0;\n  border-top: 1px solid var(--border);\n}\n\n.sectionH2 {\n  font-family: var(--font-sans);\n  font-size: 1.6rem;\n  font-weight: 700;\n  margin-bottom: 0.4rem;\n}\n\n.subtitle {\n  color: var(--text-dim);\n  margin-bottom: 2.5rem;\n  font-family: var(--font-sans);\n  font-size: 0.95rem;\n}\n\n.pipeline {\n  display: grid;\n  grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));\n  gap: 1.2rem;\n}\n\n.pipeStep {\n  text-align: left;\n}\n\n.stepNum {\n  font-size: 0.7rem;\n  color: var(--accent);\n  text-transform: uppercase;\n  letter-spacing: 0.15em;\n  margin-bottom: 0.5rem;\n}\n\n.pipeStepH3 {\n  font-size: 1rem;\n  margin-bottom: 0.4rem;\n  color: var(--text);\n}\n\n.pipeStepP {\n  font-size: 0.85rem;\n  color: var(--text-dim);\n  font-family: var(--font-sans);\n}\n\n.features {\n  display: grid;\n  grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));\n  gap: 1.2rem;\n}\n\n.featureCardH3 {\n  font-size: 0.9rem;\n  margin-bottom: 0.4rem;\n  color: var(--accent);\n}\n\n.featureCardP {\n  font-size: 0.85rem;\n  color: var(--text-dim);\n  font-family: var(--font-sans);\n}\n\n.holoCard {\n  background: var(--holo-gradient);\n  border: 1px solid var(--border);\n  border-radius: 12px;\n  padding: 1.8rem;\n  position: relative;\n  overflow: hidden;\n  transition: all 0.4s ease;\n}\n\n.holoCard::before {\n  content: '';\n  position: absolute;\n  top: 0;\n  left: 0;\n  right: 0;\n  height: 1px;\n  background: linear-gradient(90deg, transparent, var(--accent-glow), transparent);\n  opacity: 0;\n  transition: opacity 0.4s ease;\n}\n\n.holoCard:hover {\n  border-color: var(--border-glow);\n  box-shadow: 0 0 40px var(--accent-dim), inset 0 1px 0 var(--accent-dim);\n  transform: translateY(-2px);\n}\n\n.holoCard:hover::before {\n  opacity: 1;\n}\n\n.releases {\n  list-style: none;\n}\n\n.releaseItem {\n  background: var(--bg-card);\n  border: 1px solid var(--border);\n  border-radius: 10px;\n  padding: 1.5rem;\n  margin-bottom: 1rem;\n  transition: all var(--transition);\n}\n\n.releaseItem:hover {\n  border-color: var(--border-glow);\n}\n\n.releaseHeader {\n  display: flex;\n  align-items: center;\n  gap: 1rem;\n  margin-bottom: 0.6rem;\n}\n\n.releaseTag {\n  background: var(--accent);\n  color: var(--bg);\n  padding: 0.15rem 0.5rem;\n  border-radius: 3px;\n  font-size: 0.75rem;\n  font-weight: 700;\n}\n\n.releaseTag.old {\n  background: var(--border);\n  color: var(--text-dim);\n}\n\n.releaseDate {\n  color: var(--text-dim);\n  font-size: 0.75rem;\n}\n\n.releaseTitle {\n  font-size: 0.95rem;\n  font-weight: 600;\n}\n\n.releaseBody {\n  color: var(--text-dim);\n  font-size: 0.8rem;\n  font-family: var(--font-sans);\n  line-height: 1.6;\n}\n\n.releaseBodyUl {\n  padding-left: 1.2rem;\n  margin-top: 0.4rem;\n}\n\n.releaseBodyCode {\n  background: var(--bg);\n  padding: 0.2rem 0.4rem;\n  border-radius: 3px;\n  font-family: var(--font-mono);\n  color: var(--accent);\n}\n\n@media (max-width: 600px) {\n  .hero {\n    padding: 3rem 0 2rem;\n  }\n\n  .heroAscii {\n    font-size: 0.35rem;\n  }\n}\n",
      "inactive/frontend/app/page.tsx": "'use client'\n\nimport { useState } from 'react'\nimport styles from './page.module.css'\n\nexport default function Home() {\n  const [activeTab, setActiveTab] = useState<'mac' | 'win'>('mac')\n  const [copied, setCopied] = useState(false)\n\n  const copyInstall = (os: 'mac' | 'win') => {\n    const commands = {\n      mac: 'curl -fsSL https://getjcode.vercel.app/install.sh | bash',\n      win: 'iwr -useb https://getjcode.vercel.app/install.ps1 | iex'\n    }\n    navigator.clipboard.writeText(commands[os]).then(() => {\n      setCopied(true)\n      setTimeout(() => setCopied(false), 2000)\n    })\n  }\n\n  return (\n    <>\n      <div className=\"container\">\n        {/* Hero */}\n        <div className={styles.hero}>\n          <pre className={styles.heroAscii}>{`     \u2588\u2580 \u2588\u2588\u2588\u2588\u2588\u2588\u2580 \u2588\u2588\u2588\u2588\u2588\u2588\u2580 \u2588\u2588\u2588\u2588\u2588\u2588\u2580 \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2580\n     \u2588\u2551\u2588\u2580\u2584\u2584\u2584\u2584\u2518\u2588\u2580\u2584\u2584\u2584\u2588\u2580\u2588\u2580\u2584\u2584\u2588\u2580\u2588\u2580\u2584\u2584\u2584\u2584\u2518\n     \u2588\u2551\u2588\u2551     \u2588\u2551   \u2588\u2551\u2588\u2551  \u2588\u2551\u2588\u2588\u2588\u2580\n\u2588   \u2588\u2551\u2588\u2551     \u2588\u2551   \u2588\u2551\u2588\u2551  \u2588\u2551\u2588\u2584\u2584\u2518\n\u2580\u2588\u2588\u2588\u2580\u2518\u2580\u2588\u2588\u2588\u2588\u2580\u2580\u2588\u2588\u2588\u2588\u2580\u2518\u2588\u2588\u2588\u2588\u2580\u2518\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2580\n \u2580\u2584\u2584\u2584\u2584\u2518 \u2580\u2584\u2584\u2584\u2584\u2584\u2518 \u2580\u2584\u2584\u2584\u2584\u2584\u2518 \u2580\u2584\u2584\u2584\u2584\u2584\u2518 \u2580\u2584\u2584\u2584\u2584\u2584\u2584\u2584\u2518`}</pre>\n          <h1>Your local, unlimited & private <span className=\"accent\">software engineer</span></h1>\n          <p>JCode plans, codes, reviews, and iterates \u2014 automatically \u2014 until your project works. 4 AI roles running entirely on your machine. No cloud. No API keys. No limits.</p>\n\n          <div className={styles.installTabs}>\n            <button \n              className={`${styles.installTab} ${activeTab === 'mac' ? styles.active : ''}`}\n              onClick={() => setActiveTab('mac')}\n            >\n              Mac / Linux\n            </button>\n            <button \n              className={`${styles.installTab} ${activeTab === 'win' ? styles.active : ''}`}\n              onClick={() => setActiveTab('win')}\n            >\n              Windows\n            </button>\n          </div>\n\n          {activeTab === 'mac' && (\n            <div className={styles.installPanel}>\n              <div className={styles.installBox}>\n                <div className=\"label\">install</div>\n                <code>curl -fsSL https://getjcode.vercel.app/install.sh | bash</code>\n                <button className={styles.copyBtn} onClick={() => copyInstall('mac')}>\n                  {copied ? 'Copied!' : 'Copy'}\n                </button>\n              </div>\n            </div>\n          )}\n\n          {activeTab === 'win' && (\n            <div className={styles.installPanel}>\n              <div className={styles.installBox}>\n                <div className=\"label\">install</div>\n                <code>iwr -useb https://getjcode.vercel.app/install.ps1 | iex</code>\n                <button className={styles.copyBtn} onClick={() => copyInstall('win')}>\n                  {copied ? 'Copied!' : 'Copy'}\n                </button>\n              </div>\n            </div>\n          )}\n        </div>\n\n        {/* Terminal Demo */}\n        <div className={styles.terminal}>\n          <div className={styles.terminalBar}>\n            <span className={`${styles.terminalDot} ${styles.r}`}></span>\n            <span className={`${styles.terminalDot} ${styles.y}`}></span>\n            <span className={`${styles.terminalDot} ${styles.g}`}></span>\n            <span className={styles.terminalTitle}>jcode \u2014 zsh</span>\n          </div>\n          <div className={styles.terminalBody}>\n            <div><span className={styles.prompt}>$</span> <span className={styles.cmd}>jcode</span></div>\n            <div><span className={styles.cyan}>Ollama connected</span></div>\n            <div>&nbsp;</div>\n            <div><span className={styles.prompt}>jcode&gt;</span> <span className={styles.cmd}>build a REST API with FastAPI for a todo app</span></div>\n            <div>&nbsp;</div>\n            <div><span className={styles.dim}>12:04:01</span>  <span className={styles.cyan}>PHASE 1</span>   Planning project architecture</div>\n            <div><span className={styles.dim}>12:04:12</span>  <span className={styles.cyan}>PLAN</span>      6 task(s) created</div>\n            <div>&nbsp;</div>\n            <div><span className={styles.dim}>12:04:12</span>  <span className={styles.cyan}>PHASE 2</span>   Building</div>\n            <div><span className={styles.dim}>12:04:15</span>  <span className={styles.cyan}>GENERATE</span>  main.py</div>\n            <div><span className={styles.dim}>12:04:22</span>  <span className={styles.cyan}>REVIEW</span>    <span className={styles.ok}>Approved</span></div>\n            <div><span className={styles.dim}>12:04:23</span>  <span className={styles.cyan}>VERIFY</span>    <span className={styles.ok}>passed</span></div>\n            <div><span className={styles.dim}>12:04:25</span>  <span className={styles.cyan}>GENERATE</span>  models.py</div>\n            <div><span className={styles.dim}>12:04:31</span>  <span className={styles.cyan}>REVIEW</span>    2 issue(s) -- patching</div>\n            <div><span className={styles.dim}>12:04:35</span>  <span className={styles.cyan}>VERIFY</span>    failed</div>\n            <div><span className={styles.dim}>12:04:35</span>  <span className={styles.cyan}>FIX</span>       Attempt 1/8 <span className={styles.dim}>(targeted patch)</span></div>\n            <div><span className={styles.dim}>12:04:40</span>  <span className={styles.cyan}>VERIFY</span>    <span className={styles.ok}>passed after 1 attempt(s)</span></div>\n            <div>&nbsp;</div>\n            <div><span className={styles.dim}>12:05:10</span>  <span className={styles.cyan}>DONE</span>      Build complete -- all files verified</div>\n            <div>&nbsp;</div>\n            <div><span className={styles.prompt}>todo-api&gt;</span> <span className={styles.cmd}>add user authentication with JWT</span></div>\n            <div><span className={styles.dim}>12:05:18</span>  <span className={styles.cyan}>THINKING</span>  Processing your request...</div>\n            <div><span className={styles.dim}>12:05:30</span>  <span className={styles.cyan}>APPLIED</span>   Updated 3 file(s)</div>\n            <div>&nbsp;</div>\n            <div><span className={styles.prompt}>todo-api&gt;</span> <span className={styles.typingCursor}></span></div>\n          </div>\n        </div>\n\n        {/* How It Works */}\n        <section id=\"how-it-works\" className={styles.section}>\n          <h2 className={styles.sectionH2}>How it <span className=\"accent\">works</span></h2>\n          <p className={styles.subtitle}>4 specialized AI agents cooperate through a 6-step build pipeline</p>\n          <div className={styles.pipeline}>\n            <div className={`${styles.holoCard} ${styles.pipeStep}`}>\n              <div className={styles.stepNum}>Step 01</div>\n              <h3 className={styles.pipeStepH3}>Planner</h3>\n              <p className={styles.pipeStepP}>Creates a task DAG (directed acyclic graph) from your request. Defines dependencies so tasks run in correct order. Estimates complexity.</p>\n            </div>\n            <div className={`${styles.holoCard} ${styles.pipeStep}`}>\n              <div className={styles.stepNum}>Step 02</div>\n              <h3 className={styles.pipeStepH3}>Coder</h3>\n              <p className={styles.pipeStepP}>Generates each file incrementally, with full context from previous files. Honors task dependencies. Applies best practices and conventions.</p>\n            </div>\n            <div className={`${styles.holoCard} ${styles.pipeStep}`}>\n              <div className={styles.stepNum}>Step 03</div>\n              <h3 className={styles.pipeStepH3}>Reviewer</h3>\n              <p className={styles.pipeStepP}>Pre-execution code review with re-review loop. Catches bugs, missing imports, and logic errors. Issues get patched and re-reviewed.</p>\n            </div>\n            <div className={`${styles.holoCard} ${styles.pipeStep}`}>\n              <div className={styles.stepNum}>Step 04</div>\n              <h3 className={styles.pipeStepH3}>Verifier</h3>\n              <p className={styles.pipeStepP}>Static analysis: syntax checks, linting, type validation, test execution. Every file is verified individually against real tooling.</p>\n            </div>\n            <div className={`${styles.holoCard} ${styles.pipeStep}`}>\n              <div className={styles.stepNum}>Step 05</div>\n              <h3 className={styles.pipeStepH3}>Analyzer</h3>\n              <p className={styles.pipeStepP}>When something fails, the Analyzer diagnoses the root cause with cross-file context. Deep analysis considers dependency chains.</p>\n            </div>\n            <div className={`${styles.holoCard} ${styles.pipeStep}`}>\n              <div className={styles.stepNum}>Step 06</div>\n              <h3 className={styles.pipeStepH3}>Iterate</h3>\n              <p className={styles.pipeStepP}>Up to 8 fix cycles with 5 strategies: targeted patch, deep analysis, full regen, simplify, and research-based repair. No giving up.</p>\n            </div>\n          </div>\n        </section>\n\n        {/* Features */}\n        <section id=\"features\" className={styles.section}>\n          <h2 className={styles.sectionH2}>Built <span className=\"accent\">different</span></h2>\n          <p className={styles.subtitle}>Engineering over model size. Architecture over brute force.</p>\n          <div className={styles.features}>\n            <div className={styles.holoCard}>\n              <h3 className={styles.featureCardH3}>100% Local & Private</h3>\n              <p className={styles.featureCardP}>Everything runs on your machine. Your code never leaves your computer. No API keys, no cloud, no subscriptions. Ever.</p>\n            </div>\n            <div className={styles.holoCard}>\n              <h3 className={styles.featureCardH3}>Pure Chat-Driven</h3>\n              <p className={styles.featureCardP}>No commands to memorize. Just type naturally: \"fix the login bug\", \"add dark mode\", \"how does routing work?\" JCode understands your intent.</p>\n            </div>\n            <div className={styles.holoCard}>\n              <h3 className={styles.featureCardH3}>8-Attempt Fix Engine</h3>\n              <p className={styles.featureCardP}>5 escalating strategies per file: targeted patch, deep cross-file analysis, full regeneration, simplification, and research-based repair.</p>\n            </div>\n            <div className={styles.holoCard}>\n              <h3 className={styles.featureCardH3}>DAG Task Engine</h3>\n              <p className={styles.featureCardP}>Tasks have dependencies. A file is not generated until its deps are verified. No more broken imports or circular references.</p>\n            </div>\n            <div className={styles.holoCard}>\n              <h3 className={styles.featureCardH3}>Structured Memory</h3>\n              <p className={styles.featureCardP}>Each role sees only what it needs \u2014 architecture summary, file index, failure log. Not raw context dumps. That is how 14B competes with 200B.</p>\n            </div>\n            <div className={styles.holoCard}>\n              <h3 className={styles.featureCardH3}>Web Search & Docs</h3>\n              <p className={styles.featureCardP}>Fetches documentation and searches the web to build better code. Reads APIs, frameworks docs, and guides. All with your permission.</p>\n            </div>\n            <div className={styles.holoCard}>\n              <h3 className={styles.featureCardH3}>Auto Run & Deploy</h3>\n              <p className={styles.featureCardP}>Detects your tech stack and knows exactly how to run it. Ask for deploy guidance and get copy-pasteable commands for Vercel, Railway, Docker, and more.</p>\n            </div>\n            <div className={styles.holoCard}>\n              <h3 className={styles.featureCardH3}>Per-Project Chat</h3>\n              <p className={styles.featureCardP}>Every project gets its own conversation history. Resume where you left off. Brainstorm features, request changes, or just ask questions.</p>\n            </div>\n            <div className={styles.holoCard}>\n              <h3 className={styles.featureCardH3}>Save & Resume</h3>\n              <p className={styles.featureCardP}>Sessions auto-save. Resume any project from where you left off. Switch between projects freely. Your progress is never lost.</p>\n            </div>\n          </div>\n        </section>\n\n        {/* Releases */}\n        <section id=\"releases\" className={styles.section}>\n          <h2 className={styles.sectionH2}>Release <span className=\"accent\">history</span></h2>\n          <p className={styles.subtitle}>Latest updates and improvements.</p>\n          <ul className={styles.releases}>\n            <li className={styles.releaseItem}>\n              <div className={styles.releaseHeader}>\n                <span className={styles.releaseTag}>v0.5.3</span>\n                <span className={styles.releaseDate}>Feb 2026</span>\n                <span className={styles.releaseTitle}>Analytics & Version Command</span>\n              </div>\n              <div className={styles.releaseBody}>\n                Install tracking and version display.\n                <ul className={styles.releaseBodyUl}>\n                  <li>Analytics-enabled install endpoints via Vercel serverless functions</li>\n                  <li>Real-time install metrics: IP, timestamp, User-Agent, OS, counter</li>\n                  <li>Dashboard at /api/stats showing install statistics</li>\n                  <li>New <code className={styles.releaseBodyCode}>version</code> command in CLI to display current version</li>\n                  <li>Install commands now use getjcode.vercel.app for tracking</li>\n                </ul>\n              </div>\n            </li>\n            <li className={styles.releaseItem}>\n              <div className={styles.releaseHeader}>\n                <span className={`${styles.releaseTag} ${styles.old}`}>v0.5.2</span>\n                <span className={styles.releaseDate}>Feb 2026</span>\n                <span className={styles.releaseTitle}>Agentic Auto-Fix</span>\n              </div>\n              <div className={styles.releaseBody}>\n                Eliminated generic advice \u2014 JCode now acts as true agentic fixer.\n                <ul className={styles.releaseBodyUl}>\n                  <li>Auto-capture runtime errors and feed to agent (5-attempt loop)</li>\n                  <li>Post-build Phase 3: runtime verification catches missing imports</li>\n                  <li>CHAT_SYSTEM prompt rewritten: no generic tips, reads actual files, outputs fixes</li>\n                  <li>Smart run command: detects project type and executes properly</li>\n                </ul>\n              </div>\n            </li>\n            <li className={styles.releaseItem}>\n              <div className={styles.releaseHeader}>\n                <span className={`${styles.releaseTag} ${styles.old}`}>v0.5.1</span>\n                <span className={styles.releaseDate}>Feb 2026</span>\n                <span className={styles.releaseTitle}>Resilient Fix Engine & Docs</span>\n              </div>\n              <div className={styles.releaseBody}>\n                Major overhaul of the code review and fix pipeline.\n                <ul className={styles.releaseBodyUl}>\n                  <li>8-attempt fix loop with 5 escalating strategies</li>\n                  <li>Cross-file dependency analysis for deeper root cause detection</li>\n                  <li>Research-based error pattern matching (last resort strategy)</li>\n                  <li>Agent knows how to run and deploy all major project types</li>\n                  <li>Beginner guide and technical documentation</li>\n                  <li>Landing page dark/light theme toggle</li>\n                </ul>\n              </div>\n            </li>\n          </ul>\n        </section>\n      </div>\n    </>\n  )\n}\n",
      "inactive/frontend/app/technical/page.tsx": "'use client'\n\nimport Link from 'next/link'\nimport styles from './technical.module.css'\n\nexport default function TechnicalPage() {\n  return (\n    <div className=\"container\">\n      <h1>Technical <span className=\"accent\">Documentation</span></h1>\n      <p className={styles.heroSub}>Architecture, internals, and module reference for JCode.</p>\n\n      <h2>Architecture Overview</h2>\n      <p>JCode is a multi-agent system with 4 specialized AI roles that collaborate through a structured pipeline. Each role has its own prompt template, model assignment, and memory context.</p>\n\n      <div className={styles.archDiagram}>{`User Input\n    |\n    v\n+-------------------+\n|     Planner       |  deepseek-r1:14b\n|  (Architecture)   |  Breaks idea into DAG of tasks\n+-------------------+\n    |\n    v  Task Graph (dependency-ordered)\n+-------------------+\n|      Coder        |  qwen2.5-coder:14b\n| (File Generation) |  Generates each file with structured context\n+-------------------+\n    |\n    v  Generated code\n+-------------------+     +-------------------+\n|    Reviewer       | --> |      Coder        |\n|  (Code Critic)    |     |   (Patch Mode)    |\n+-------------------+     +-------------------+\n    |                         |\n    v  Approved code          v  Patched code\n+-------------------+\n|    Verifier       |  Static analysis: syntax, lint, types\n| (executor.py)     |  + test execution (pytest / npm test)\n+-------------------+\n    |\n    |--- PASS --> Next task\n    |\n    v  FAIL\n+-------------------+     +-------------------+\n|    Analyzer       | --> |   Fix Engine      |\n| (Error Diagnosis) |     |  5 strategies     |\n+-------------------+     |  8 attempts       |\n                          +-------------------+`}</div>\n\n      <h2>Model Configuration</h2>\n      <table className={styles.table}>\n        <thead>\n          <tr><th>Role</th><th>Model</th><th>Context Size</th><th>Purpose</th></tr>\n        </thead>\n        <tbody>\n          <tr><td>Planner</td><td><code>deepseek-r1:14b</code></td><td>16,384</td><td>Architecture design, task decomposition</td></tr>\n          <tr><td>Coder</td><td><code>qwen2.5-coder:14b</code></td><td>16,384</td><td>Code generation, patching</td></tr>\n          <tr><td>Reviewer</td><td><code>qwen2.5-coder:14b</code></td><td>16,384</td><td>Pre-execution code review</td></tr>\n          <tr><td>Analyzer</td><td><code>deepseek-r1:14b</code></td><td>16,384</td><td>Error diagnosis, root cause analysis</td></tr>\n        </tbody>\n      </table>\n      <p>Context sizes scale based on project complexity (detected automatically). For complex projects, context doubles to 32,768 tokens.</p>\n\n      <h2>Module Reference</h2>\n\n      <h3>jcode/cli.py &mdash; Command Line Interface</h3>\n      <p>The main entry point. Implements a two-level REPL:</p>\n      <ul>\n        <li><strong>Home REPL</strong> (<code>_home_repl</code>) &mdash; Project selection, creation, update, uninstall</li>\n        <li><strong>Project REPL</strong> (<code>_project_repl</code>) &mdash; Chat-driven interaction within a project</li>\n      </ul>\n      <p>Key functions:</p>\n      <table className={styles.table}>\n        <thead>\n          <tr><th>Function</th><th>Description</th></tr>\n        </thead>\n        <tbody>\n          <tr><td><code>main()</code></td><td>Entry point. Checks Ollama, permissions, starts home REPL</td></tr>\n          <tr><td><code>_cmd_build()</code></td><td>Runs Planner + execute_plan pipeline</td></tr>\n          <tr><td><code>_cmd_chat()</code></td><td>Natural language chat with project context</td></tr>\n          <tr><td><code>_cmd_run()</code></td><td>Auto-detects and runs the project</td></tr>\n          <tr><td><code>_apply_file_changes()</code></td><td>Parses ===FILE:=== markers from chat response</td></tr>\n          <tr><td><code>_install_deps_if_needed()</code></td><td>Auto npm install / pip install before run</td></tr>\n        </tbody>\n      </table>\n\n      <h3>jcode/iteration.py &mdash; Build Engine</h3>\n      <p>The core DAG-based task execution engine. Processes tasks in dependency order with a multi-strategy fix loop.</p>\n      <table className={styles.table}>\n        <thead>\n          <tr><th>Function</th><th>Description</th></tr>\n        </thead>\n        <tbody>\n          <tr><td><code>execute_plan()</code></td><td>Main orchestrator. Resolves DAG, iterates until all pass or limits hit</td></tr>\n          <tr><td><code>_process_task()</code></td><td>Generate &rarr; Review &rarr; Verify single task</td></tr>\n          <tr><td><code>_review_and_patch()</code></td><td>2-round review loop with patching</td></tr>\n          <tr><td><code>_fix_loop()</code></td><td>8-attempt fix with 5 strategies</td></tr>\n          <tr><td><code>_escalate()</code></td><td>User prompt: retry / guided-fix / skip / pause</td></tr>\n        </tbody>\n      </table>\n\n      <h4>Fix Strategies (in order)</h4>\n      <table className={styles.table}>\n        <thead>\n          <tr><th>Strategy</th><th>Attempts</th><th>Approach</th></tr>\n        </thead>\n        <tbody>\n          <tr><td>A: Targeted Patch</td><td>1&ndash;3</td><td>Analyze error &rarr; patch the specific issue</td></tr>\n          <tr><td>B: Deep Analysis</td><td>4&ndash;5</td><td>Cross-file dependency context, reverse dependency checking, dependency patching</td></tr>\n          <tr><td>C: Full Regeneration</td><td>6</td><td>Regenerate entire file from scratch with error history</td></tr>\n          <tr><td>D: Simplify</td><td>7</td><td>Generate minimal/simplified version prioritizing correctness</td></tr>\n          <tr><td>E: Research</td><td>8</td><td>Error pattern classification + web search for solutions</td></tr>\n        </tbody>\n      </table>\n\n      <h3>jcode/config.py &mdash; Configuration</h3>\n      <p>All constants, enums, and dataclasses:</p>\n      <table className={styles.table}>\n        <thead>\n          <tr><th>Constant</th><th>Value</th><th>Description</th></tr>\n        </thead>\n        <tbody>\n          <tr><td><code>MAX_TASK_FAILURES</code></td><td>8</td><td>Fix attempts per file before escalation</td></tr>\n          <tr><td><code>MAX_ITERATIONS</code></td><td>15</td><td>Max full DAG passes</td></tr>\n          <tr><td><code>BASE_PLANNER_CTX</code></td><td>16,384</td><td>Base context window for planner</td></tr>\n          <tr><td><code>BASE_CODER_CTX</code></td><td>16,384</td><td>Base context window for coder</td></tr>\n        </tbody>\n      </table>\n      <p>Key types:</p>\n      <ul>\n        <li><code>TaskStatus</code> &mdash; Enum: PENDING, IN_PROGRESS, DONE, FAILED, SKIPPED</li>\n        <li><code>TaskNode</code> &mdash; Dataclass: task_id, description, file_path, deps, status, failures, output</li>\n        <li><code>ProjectState</code> &mdash; Dataclass: name, description, root, language, framework, complexity</li>\n      </ul>\n\n      <h3>jcode/context.py &mdash; Structured Memory</h3>\n      <p>The memory engine that gives each AI role precisely the context it needs.</p>\n      <table className={styles.table}>\n        <thead>\n          <tr><th>Feature</th><th>Description</th></tr>\n        </thead>\n        <tbody>\n          <tr><td>Task DAG</td><td>Ordered task list with dependency edges</td></tr>\n          <tr><td>File Index</td><td>Map of file_path &rarr; content for all generated files</td></tr>\n          <tr><td>Failure Log</td><td>History of errors and fix attempts per file</td></tr>\n          <tr><td>Chat History</td><td>Per-project conversation log</td></tr>\n          <tr><td>Serialization</td><td>Save/load to <code>~/.jcode/projects/{`{name}`}/</code></td></tr>\n        </tbody>\n      </table>\n      <p>Context is trimmed per-role: the Coder gets the architecture summary + relevant dependency file contents, not the entire file index.</p>\n\n      <h3>jcode/prompts.py &mdash; Prompt Templates</h3>\n      <p>System prompts for each role:</p>\n      <ul>\n        <li><code>PLANNER_SYSTEM</code> / <code>PLANNER_REFINE</code> &mdash; Architecture planning with JSON DAG output</li>\n        <li><code>CODER_SYSTEM</code> / <code>CODER_TASK</code> / <code>CODER_PATCH</code> &mdash; File generation and targeted patching</li>\n        <li><code>REVIEWER_SYSTEM</code> / <code>REVIEWER_TASK</code> &mdash; Code review with JSON issue list</li>\n        <li><code>ANALYZER_SYSTEM</code> / <code>ANALYZER_TASK</code> &mdash; Error diagnosis with structured fix strategy</li>\n        <li><code>CHAT_SYSTEM</code> / <code>CHAT_CONTEXT</code> &mdash; Natural language chat with 3 modes (action / discussion / run-deploy)</li>\n      </ul>\n\n      <h3>jcode/executor.py &mdash; Execution &amp; Verification</h3>\n      <table className={styles.table}>\n        <thead>\n          <tr><th>Function</th><th>Description</th></tr>\n        </thead>\n        <tbody>\n          <tr><td><code>verify_file()</code></td><td>Routes to language-specific verifier</td></tr>\n          <tr><td><code>_verify_python()</code></td><td>py_compile + optional pylint + pyflakes</td></tr>\n          <tr><td><code>_verify_javascript()</code></td><td>node --check + optional eslint</td></tr>\n          <tr><td><code>_verify_json()</code></td><td>json.loads validation</td></tr>\n          <tr><td><code>run_command()</code></td><td>Execute shell command with timeout and capture</td></tr>\n          <tr><td><code>install_dependencies()</code></td><td>Auto pip install / npm install</td></tr>\n          <tr><td><code>run_tests()</code></td><td>Detect and run pytest / npm test</td></tr>\n        </tbody>\n      </table>\n\n      <h3>jcode/ollama_client.py &mdash; Model Interface</h3>\n      <p>Wrapper around the Ollama Python SDK. All model calls go through <code>call_model(role, messages, stream, num_ctx)</code>.</p>\n      <ul>\n        <li>Streaming support for real-time output</li>\n        <li>Automatic context size based on role and project complexity</li>\n        <li>Legacy wrappers: <code>call_planner()</code>, <code>call_coder()</code>, <code>call_reviewer()</code>, <code>call_analyzer()</code></li>\n      </ul>\n\n      <h3>jcode/web.py &mdash; Web Search</h3>\n      <p>Web search and documentation fetching using DuckDuckGo (no API key required):</p>\n      <ul>\n        <li><code>web_search(query)</code> &mdash; Search DuckDuckGo, return top results</li>\n        <li><code>fetch_page(url)</code> &mdash; Fetch and extract text content from a URL</li>\n        <li><code>fetch_docs(query)</code> &mdash; Targeted documentation search</li>\n        <li><code>search_and_summarize(query)</code> &mdash; Search + fetch + summarize results</li>\n      </ul>\n\n      <h3>jcode/settings.py &mdash; User Settings</h3>\n      <p>Persistent settings stored in <code>~/.jcode/settings.json</code>:</p>\n      <ul>\n        <li><code>autonomous_access</code> &mdash; Permission to read/write project files</li>\n        <li><code>internet_access</code> &mdash; Permission to search the web</li>\n      </ul>\n\n      <h2>Data Flow</h2>\n      <h3>Build Pipeline</h3>\n      <pre><code>{`User description\n  |\n  v\nPlanner.plan() --> TaskNode[] (DAG)\n  |\n  v\nfor each task in topological order:\n  |\n  +-- Coder.generate_file(task, context)\n  |     |\n  |     v\n  +-- Reviewer.review_file(code)\n  |     |-- issues? --> Coder.patch_file(code, issues)\n  |     |               |-- re-review (max 2 rounds)\n  |     |\n  |     v\n  +-- Executor.verify_file(path)\n  |     |-- pass? --> mark DONE, continue\n  |     |\n  |     v  fail\n  +-- Fix Loop (8 attempts, 5 strategies)\n        |-- Analyzer.analyze_error(error)\n        |-- Strategy A/B/C/D/E --> patch/regen/research\n        |-- Executor.verify_file(path)\n        |-- pass? --> break\n        |-- all failed? --> escalate to user`}</code></pre>\n\n      <h3>Chat Pipeline</h3>\n      <pre><code>{`User message\n  |\n  v\nBuild context: architecture + file index + chat history\n  |\n  v\ncall_model(\"coder\", [system + context + message])\n  |\n  v\nResponse contains ===FILE:path=== markers?\n  |-- yes --> parse and apply file changes\n  |-- no  --> display as text answer`}</code></pre>\n\n      <h2>Project Structure</h2>\n      <pre><code>{`JcodeAgent/\n  jcode/\n    __init__.py       Package init, version\n    cli.py            Main CLI entry point (two-level REPL)\n    config.py         Constants, enums, dataclasses\n    context.py        Structured memory engine\n    iteration.py      DAG build engine + fix loop\n    prompts.py        All prompt templates\n    coder.py          File generation + patching\n    reviewer.py       Code review\n    analyzer.py       Error diagnosis\n    executor.py       Verification + test execution\n    ollama_client.py  Ollama API wrapper\n    web.py            Web search + doc fetching\n    settings.py       User settings persistence\n  docs/\n    index.html        Landing page\n    beginner-guide.html  This guide\n    technical.html    You are here\n  install.sh          Unix installer\n  install.ps1         Windows installer\n  pyproject.toml      Package metadata\n  README.md           Repository readme`}</code></pre>\n\n      <h2>Extending JCode</h2>\n      <h3>Adding a new language verifier</h3>\n      <p>Edit <code>executor.py</code> and add a new <code>_verify_*</code> function. Register it in <code>verify_file()</code>'s extension-to-verifier map.</p>\n\n      <h3>Changing models</h3>\n      <p>Edit <code>config.py</code>. Set <code>PLANNER_MODEL</code> and <code>CODER_MODEL</code> to any Ollama-compatible model.</p>\n\n      <h3>Adding a new fix strategy</h3>\n      <p>In <code>iteration.py</code>, add a new strategy block in <code>_fix_loop()</code>. Assign it an attempt number range and implement the fix logic.</p>\n    </div>\n  )\n}\n",
      "inactive/frontend/app/technical/technical.module.css": ".heroSub {\n  color: var(--text-dim);\n  font-size: 1rem;\n  margin-bottom: 3rem;\n}\n\n.archDiagram {\n  background: var(--bg-terminal);\n  border: 1px solid var(--border);\n  border-radius: 12px;\n  padding: 1.5rem;\n  font-family: var(--font-mono);\n  font-size: 0.75rem;\n  line-height: 1.4;\n  overflow-x: auto;\n  margin-bottom: 1.5rem;\n  white-space: pre;\n  color: var(--accent);\n}\n\n.table {\n  width: 100%;\n  border-collapse: collapse;\n  margin-bottom: 1.5rem;\n  font-size: 0.85rem;\n}\n\n.table th,\n.table td {\n  padding: 0.6rem 0.8rem;\n  border: 1px solid var(--border);\n  text-align: left;\n}\n\n.table th {\n  background: var(--bg-terminal);\n  font-weight: 600;\n  color: var(--accent);\n  font-family: var(--font-mono);\n  font-size: 0.8rem;\n}\n\n.table td code {\n  font-size: 0.8rem;\n}\n",
      "inactive/frontend/components/Footer.module.css": ".footer {\n  border-top: 1px solid var(--border);\n  padding: 2rem 0;\n  text-align: center;\n  color: var(--text-dim);\n  font-size: 0.75rem;\n}\n\n.footerLinks {\n  margin-top: 0.4rem;\n}\n\n.footer a {\n  color: var(--text-dim);\n  text-decoration: none;\n  transition: color var(--transition);\n}\n\n.footer a:hover {\n  color: var(--accent);\n}\n",
      "inactive/frontend/components/Footer.tsx": "import Link from 'next/link'\nimport styles from './Footer.module.css'\n\nexport default function Footer() {\n  return (\n    <footer className={styles.footer}>\n      <div className=\"container\">\n        <p>\n          JCode is open source \u00b7 MIT License \u00b7 Developed by{' '}\n          <a \n            href=\"https://www.linkedin.com/in/ioan-andrei-bbb908268/\" \n            target=\"_blank\" \n            rel=\"noopener noreferrer\"\n          >\n            Ioan Andrei\n          </a>\n        </p>\n        <p className={styles.footerLinks}>\n          <a \n            href=\"https://github.com/ShakenTheCoder/JcodeAgent\" \n            target=\"_blank\" \n            rel=\"noopener noreferrer\"\n          >\n            GitHub\n          </a>\n          {' \u00b7 '}\n          <Link href=\"#releases\">Changelog</Link>\n          {' \u00b7 '}\n          <Link href=\"/guide\">Beginner Guide</Link>\n          {' \u00b7 '}\n          <Link href=\"/technical\">Technical Docs</Link>\n        </p>\n      </div>\n    </footer>\n  )\n}\n",
      "inactive/frontend/components/Header.module.css": ".themeSwitch {\n  position: fixed;\n  top: 1.5rem;\n  right: 1.5rem;\n  z-index: 100;\n  display: flex;\n  align-items: center;\n  gap: 0.5rem;\n}\n\n.switch {\n  position: relative;\n  width: 48px;\n  height: 26px;\n}\n\n.switchInput {\n  opacity: 0;\n  width: 0;\n  height: 0;\n}\n\n.slider {\n  position: absolute;\n  cursor: pointer;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  background: var(--border);\n  border: 1px solid var(--border-glow);\n  border-radius: 26px;\n  transition: all var(--transition);\n}\n\n.slider::before {\n  content: '';\n  position: absolute;\n  height: 20px;\n  width: 20px;\n  left: 2px;\n  bottom: 2px;\n  background: var(--accent);\n  border-radius: 50%;\n  transition: all var(--transition);\n  box-shadow: 0 0 8px var(--accent-glow);\n}\n\n.switchInputChecked:checked + .slider::before {\n  transform: translateX(22px);\n}\n\n.nav {\n  padding: 1.5rem 0;\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n}\n\n.navLogo {\n  font-size: 1.1rem;\n  font-weight: 700;\n  color: var(--accent);\n  letter-spacing: 0.05em;\n}\n\n.navLinks {\n  display: flex;\n  gap: 1.5rem;\n}\n\n.navLinks a {\n  color: var(--text-dim);\n  font-size: 0.8rem;\n  transition: color var(--transition);\n  text-decoration: none;\n}\n\n.navLinks a:hover {\n  color: var(--accent);\n}\n\n@media (max-width: 600px) {\n  .themeSwitch {\n    top: 1rem;\n    right: 1rem;\n  }\n\n  .navLinks {\n    display: none;\n  }\n}\n",
      "inactive/frontend/components/Header.tsx": "'use client'\n\nimport Link from 'next/link'\nimport { useTheme } from './ThemeProvider'\nimport styles from './Header.module.css'\n\nexport default function Header() {\n  const { theme, toggleTheme } = useTheme()\n\n  return (\n    <>\n      <div className={styles.themeSwitch}>\n        <label className={styles.switch}>\n          <input \n            type=\"checkbox\" \n            checked={theme === 'light'} \n            onChange={toggleTheme}\n            aria-label=\"Toggle theme\"\n          />\n          <span className={styles.slider}></span>\n        </label>\n      </div>\n\n      <div className=\"container\">\n        <nav className={styles.nav}>\n          <span className={styles.navLogo}>&gt; jcode</span>\n          <div className={styles.navLinks}>\n            <Link href=\"#how-it-works\">How It Works</Link>\n            <Link href=\"#features\">Features</Link>\n            <Link href=\"#releases\">Releases</Link>\n            <Link href=\"/guide\">Guide</Link>\n            <Link href=\"/technical\">Docs</Link>\n            <a href=\"https://github.com/ShakenTheCoder/JcodeAgent\" target=\"_blank\" rel=\"noopener noreferrer\">\n              GitHub\n            </a>\n          </div>\n        </nav>\n      </div>\n    </>\n  )\n}\n",
      "inactive/frontend/components/HomeComponents.tsx": "'use client'\n\nimport { useState } from 'react'\n\ninterface FeatureCardProps {\n  icon: string\n  title: string\n  description: string\n}\n\nexport function FeatureCard({ icon, title, description }: FeatureCardProps) {\n  return (\n    <div className=\"glass-effect rounded-xl p-8 hover:scale-105 transition-transform duration-300\">\n      <div className=\"text-4xl mb-4\">{icon}</div>\n      <h3 className=\"text-xl font-bold mb-3\">{title}</h3>\n      <p className=\"opacity-90\">{description}</p>\n    </div>\n  )\n}\n\ninterface InstallButtonProps {\n  platform: 'mac' | 'windows'\n}\n\nexport function InstallButton({ platform }: InstallButtonProps) {\n  const [copied, setCopied] = useState(false)\n\n  const commands = {\n    mac: \"curl -fsSL https://getjcode.vercel.app/install.sh | bash\",\n    windows: \"iwr -useb https://getjcode.vercel.app/install.ps1 | iex\"\n  }\n\n  const copyToClipboard = () => {\n    navigator.clipboard.writeText(commands[platform])\n    setCopied(true)\n    setTimeout(() => setCopied(false), 2000)\n  }\n\n  return (\n    <div className=\"glass-effect rounded-lg p-4 flex items-center justify-between\">\n      <code className=\"text-sm flex-1\">{commands[platform]}</code>\n      <button\n        onClick={copyToClipboard}\n        className=\"ml-4 px-4 py-2 bg-accent rounded-lg hover:bg-accent-light transition-colors\"\n      >\n        {copied ? '\u2713 Copied!' : 'Copy'}\n      </button>\n    </div>\n  )\n}\n\ninterface ReleaseItemProps {\n  version: string\n  date: string\n  title: string\n  features: string[]\n  isLatest?: boolean\n}\n\nexport function ReleaseItem({ version, date, title, features, isLatest }: ReleaseItemProps) {\n  return (\n    <div className=\"glass-effect rounded-xl p-6 mb-4\">\n      <div className=\"flex flex-wrap items-center gap-4 mb-4\">\n        <span className={`px-4 py-1 rounded-full text-sm font-semibold ${isLatest ? 'bg-accent' : 'bg-white/20'}`}>\n          {version}\n        </span>\n        <span className=\"text-sm opacity-70\">{date}</span>\n        <span className=\"text-lg font-bold\">{title}</span>\n      </div>\n      <ul className=\"space-y-2 opacity-90\">\n        {features.map((feature, idx) => (\n          <li key={idx} className=\"flex items-start\">\n            <span className=\"mr-2\">\u2022</span>\n            <span dangerouslySetInnerHTML={{ __html: feature }} />\n          </li>\n        ))}\n      </ul>\n    </div>\n  )\n}\n",
      "inactive/frontend/components/ThemeProvider.tsx": "'use client'\n\nimport { createContext, useContext, useEffect, useState } from 'react'\n\ntype Theme = 'light' | 'dark'\n\nconst ThemeContext = createContext<{\n  theme: Theme\n  toggleTheme: () => void\n}>({\n  theme: 'dark',\n  toggleTheme: () => {},\n})\n\nexport function ThemeProvider({ children }: { children: React.ReactNode }) {\n  const [theme, setTheme] = useState<Theme>('dark')\n  const [mounted, setMounted] = useState(false)\n\n  useEffect(() => {\n    setMounted(true)\n    const stored = localStorage.getItem('theme') as Theme | null\n    if (stored) {\n      setTheme(stored)\n      document.documentElement.setAttribute('data-theme', stored)\n    } else {\n      document.documentElement.setAttribute('data-theme', 'dark')\n    }\n  }, [])\n\n  const toggleTheme = () => {\n    const newTheme = theme === 'dark' ? 'light' : 'dark'\n    setTheme(newTheme)\n    localStorage.setItem('theme', newTheme)\n    document.documentElement.setAttribute('data-theme', newTheme)\n  }\n\n  if (!mounted) return <>{children}</>\n\n  return (\n    <ThemeContext.Provider value={{ theme, toggleTheme }}>\n      {children}\n    </ThemeContext.Provider>\n  )\n}\n\nexport const useTheme = () => useContext(ThemeContext)\n",
      "inactive/frontend/next-env.d.ts": "/// <reference types=\"next\" />\n/// <reference types=\"next/image-types/global\" />\nimport \"./.next/dev/types/routes.d.ts\";\n\n// NOTE: This file should not be edited\n// see https://nextjs.org/docs/app/api-reference/config/typescript for more information.\n",
      "inactive/frontend/next.config.js": "/** @type {import('next').NextConfig} */\nconst nextConfig = {\n  reactStrictMode: true,\n}\n\nmodule.exports = nextConfig\n",
      "inactive/frontend/package-lock.json": "{\n  \"name\": \"jcode-frontend\",\n  \"version\": \"0.5.3\",\n  \"lockfileVersion\": 3,\n  \"requires\": true,\n  \"packages\": {\n    \"\": {\n      \"name\": \"jcode-frontend\",\n      \"version\": \"0.5.3\",\n      \"dependencies\": {\n        \"@vercel/kv\": \"^2.0.0\",\n        \"next\": \"^16.1.6\",\n        \"react\": \"^18.2.0\",\n        \"react-dom\": \"^18.2.0\"\n      },\n      \"devDependencies\": {\n        \"@types/node\": \"^20.11.0\",\n        \"@types/react\": \"^18.2.48\",\n        \"@types/react-dom\": \"^18.2.18\",\n        \"autoprefixer\": \"^10.4.17\",\n        \"postcss\": \"^8.4.33\",\n        \"tailwindcss\": \"^3.4.1\",\n        \"typescript\": \"^5.3.3\"\n      }\n    },\n    \"node_modules/@alloc/quick-lru\": {\n      \"version\": \"5.2.0\",\n      \"resolved\": \"https://registry.npmjs.org/@alloc/quick-lru/-/quick-lru-5.2.0.tgz\",\n      \"integrity\": \"sha512-UrcABB+4bUrFABwbluTIBErXwvbsU/V7TZWfmbgJfbkwiBuziS9gxdODUyuiecfdGQ85jglMW6juS3+z5TsKLw==\",\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"engines\": {\n        \"node\": \">=10\"\n      },\n      \"funding\": {\n        \"url\": \"https://github.com/sponsors/sindresorhus\"\n      }\n    },\n    \"node_modules/@emnapi/runtime\": {\n      \"version\": \"1.8.1\",\n      \"resolved\": \"https://registry.npmjs.org/@emnapi/runtime/-/runtime-1.8.1.tgz\",\n      \"integrity\": \"sha512-mehfKSMWjjNol8659Z8KxEMrdSJDDot5SXMq00dM8BN4o+CLNXQ0xH2V7EchNHV4RmbZLmmPdEaXZc5H2FXmDg==\",\n      \"license\": \"MIT\",\n      \"optional\": true,\n      \"dependencies\": {\n        \"tslib\": \"^2.4.0\"\n      }\n    },\n    \"node_modules/@img/colour\": {\n      \"version\": \"1.0.0\",\n      \"resolved\": \"https://registry.npmjs.org/@img/colour/-/colour-1.0.0.tgz\",\n      \"integrity\": \"sha512-A5P/LfWGFSl6nsckYtjw9da+19jB8hkJ6ACTGcDfEJ0aE+l2n2El7dsVM7UVHZQ9s2lmYMWlrS21YLy2IR1LUw==\",\n      \"license\": \"MIT\",\n      \"optional\": true,\n      \"engines\": {\n        \"node\": \">=18\"\n      }\n    },\n    \"node_modules/@img/sharp-darwin-arm64\": {\n      \"version\": \"0.34.5\",\n      \"resolved\": \"https://registry.npmjs.org/@img/sharp-darwin-arm64/-/sharp-darwin-arm64-0.34.5.tgz\",\n      \"integrity\": \"sha512-imtQ3WMJXbMY4fxb/Ndp6HBTNVtWCUI0WdobyheGf5+ad6xX8VIDO8u2xE4qc/fr08CKG/7dDseFtn6M6g/r3w==\",\n      \"cpu\": [\n        \"arm64\"\n      ],\n      \"license\": \"Apache-2.0\",\n      \"optional\": true,\n      \"os\": [\n        \"darwin\"\n      ],\n      \"engines\": {\n        \"node\": \"^18.17.0 || ^20.3.0 || >=21.0.0\"\n      },\n      \"funding\": {\n        \"url\": \"https://opencollective.com/libvips\"\n      },\n      \"optionalDependencies\": {\n        \"@img/sharp-libvips-darwin-arm64\": \"1.2.4\"\n      }\n    },\n    \"node_modules/@img/sharp-darwin-x64\": {\n      \"version\": \"0.34.5\",\n      \"resolved\": \"https://registry.npmjs.org/@img/sharp-darwin-x64/-/sharp-darwin-x64-0.34.5.tgz\",\n      \"integrity\": \"sha512-YNEFAF/4KQ/PeW0N+r+aVVsoIY0/qxxikF2SWdp+NRkmMB7y9LBZAVqQ4yhGCm/H3H270OSykqmQMKLBhBJDEw==\",\n      \"cpu\": [\n        \"x64\"\n      ],\n      \"license\": \"Apache-2.0\",\n      \"optional\": true,\n      \"os\": [\n        \"darwin\"\n      ],\n      \"engines\": {\n        \"node\": \"^18.17.0 || ^20.3.0 || >=21.0.0\"\n      },\n      \"funding\": {\n        \"url\": \"https://opencollective.com/libvips\"\n      },\n      \"optionalDependencies\": {\n        \"@img/sharp-libvips-darwin-x64\": \"1.2.4\"\n      }\n    },\n    \"node_modules/@img/sharp-libvips-darwin-arm64\": {\n      \"version\": \"1.2.4\",\n      \"resolved\": \"https://registry.npmjs.org/@img/sharp-libvips-darwin-arm64/-/sharp-libvips-darwin-arm64-1.2.4.tgz\",\n      \"integrity\": \"sha512-zqjjo7RatFfFoP0MkQ51jfuFZBnVE2pRiaydKJ1G/rHZvnsrHAOcQALIi9sA5co5xenQdTugCvtb1cuf78Vf4g==\",\n      \"cpu\": [\n        \"arm64\"\n      ],\n      \"license\": \"LGPL-3.0-or-later\",\n      \"optional\": true,\n      \"os\": [\n        \"darwin\"\n      ],\n      \"funding\": {\n        \"url\": \"https://opencollective.com/libvips\"\n      }\n    },\n    \"node_modules/@img/sharp-libvips-darwin-x64\": {\n      \"version\": \"1.2.4\",\n      \"resolved\": \"https://registry.npmjs.org/@img/sharp-libvips-darwin-x64/-/sharp-libvips-darwin-x64-1.2.4.tgz\",\n      \"integrity\": \"sha512-1IOd5xfVhlGwX+zXv2N93k0yMONvUlANylbJw1eTah8K/Jtpi15KC+WSiaX/nBmbm2HxRM1gZ0nSdjSsrZbGKg==\",\n      \"cpu\": [\n        \"x64\"\n      ],\n      \"license\": \"LGPL-3.0-or-later\",\n      \"optional\": true,\n      \"os\": [\n        \"darwin\"\n      ],\n      \"funding\": {\n        \"url\": \"https://opencollective.com/libvips\"\n      }\n    },\n    \"node_modules/@img/sharp-libvips-linux-arm\": {\n      \"version\": \"1.2.4\",\n      \"resolved\": \"https://registry.npmjs.org/@img/sharp-libvips-linux-arm/-/sharp-libvips-linux-arm-1.2.4.tgz\",\n      \"integrity\": \"sha512-bFI7xcKFELdiNCVov8e44Ia4u2byA+l3XtsAj+Q8tfCwO6BQ8iDojYdvoPMqsKDkuoOo+X6HZA0s0q11ANMQ8A==\",\n      \"cpu\": [\n        \"arm\"\n      ],\n      \"license\": \"LGPL-3.0-or-later\",\n      \"optional\": true,\n      \"os\": [\n        \"linux\"\n      ],\n      \"funding\": {\n        \"url\": \"https://opencollective.com/libvips\"\n      }\n    },\n    \"node_modules/@img/sharp-libvips-linux-arm64\": {\n      \"version\": \"1.2.4\",\n      \"resolved\": \"https://registry.npmjs.org/@img/sharp-libvips-linux-arm64/-/sharp-libvips-linux-arm64-1.2.4.tgz\",\n      \"integrity\": \"sha512-excjX8DfsIcJ10x1Kzr4RcWe1edC9PquDRRPx3YVCvQv+U5p7Yin2s32ftzikXojb1PIFc/9Mt28/y+iRklkrw==\",\n      \"cpu\": [\n        \"arm64\"\n      ],\n      \"license\": \"LGPL-3.0-or-later\",\n      \"optional\": true,\n      \"os\": [\n        \"linux\"\n      ],\n      \"funding\": {\n        \"url\": \"https://opencollective.com/libvips\"\n      }\n    },\n    \"node_modules/@img/sharp-libvips-linux-ppc64\": {\n      \"version\": \"1.2.4\",\n      \"resolved\": \"https://registry.npmjs.org/@img/sharp-libvips-linux-ppc64/-/sharp-libvips-linux-ppc64-1.2.4.tgz\",\n      \"integrity\": \"sha512-FMuvGijLDYG6lW+b/UvyilUWu5Ayu+3r2d1S8notiGCIyYU/76eig1UfMmkZ7vwgOrzKzlQbFSuQfgm7GYUPpA==\",\n      \"cpu\": [\n        \"ppc64\"\n      ],\n      \"license\": \"LGPL-3.0-or-later\",\n      \"optional\": true,\n      \"os\": [\n        \"linux\"\n      ],\n      \"funding\": {\n        \"url\": \"https://opencollective.com/libvips\"\n      }\n    },\n    \"node_modules/@img/sharp-libvips-linux-riscv64\": {\n      \"version\": \"1.2.4\",\n      \"resolved\": \"https://registry.npmjs.org/@img/sharp-libvips-linux-riscv64/-/sharp-libvips-linux-riscv64-1.2.4.tgz\",\n      \"integrity\": \"sha512-oVDbcR4zUC0ce82teubSm+x6ETixtKZBh/qbREIOcI3cULzDyb18Sr/Wcyx7NRQeQzOiHTNbZFF1UwPS2scyGA==\",\n      \"cpu\": [\n        \"riscv64\"\n      ],\n      \"license\": \"LGPL-3.0-or-later\",\n      \"optional\": true,\n      \"os\": [\n        \"linux\"\n      ],\n      \"funding\": {\n        \"url\": \"https://opencollective.com/libvips\"\n      }\n    },\n    \"node_modules/@img/sharp-libvips-linux-s390x\": {\n      \"version\": \"1.2.4\",\n      \"resolved\": \"https://registry.npmjs.org/@img/sharp-libvips-linux-s390x/-/sharp-libvips-linux-s390x-1.2.4.tgz\",\n      \"integrity\": \"sha512-qmp9VrzgPgMoGZyPvrQHqk02uyjA0/QrTO26Tqk6l4ZV0MPWIW6LTkqOIov+J1yEu7MbFQaDpwdwJKhbJvuRxQ==\",\n      \"cpu\": [\n        \"s390x\"\n      ],\n      \"license\": \"LGPL-3.0-or-later\",\n      \"optional\": true,\n      \"os\": [\n        \"linux\"\n      ],\n      \"funding\": {\n        \"url\": \"https://opencollective.com/libvips\"\n      }\n    },\n    \"node_modules/@img/sharp-libvips-linux-x64\": {\n      \"version\": \"1.2.4\",\n      \"resolved\": \"https://registry.npmjs.org/@img/sharp-libvips-linux-x64/-/sharp-libvips-linux-x64-1.2.4.tgz\",\n      \"integrity\": \"sha512-tJxiiLsmHc9Ax1bz3oaOYBURTXGIRDODBqhveVHonrHJ9/+k89qbLl0bcJns+e4t4rvaNBxaEZsFtSfAdquPrw==\",\n      \"cpu\": [\n        \"x64\"\n      ],\n      \"license\": \"LGPL-3.0-or-later\",\n      \"optional\": true,\n      \"os\": [\n        \"linux\"\n      ],\n      \"funding\": {\n        \"url\": \"https://opencollective.com/libvips\"\n      }\n    },\n    \"node_modules/@img/sharp-libvips-linuxmusl-arm64\": {\n      \"version\": \"1.2.4\",\n      \"resolved\": \"https://registry.npmjs.org/@img/sharp-libvips-linuxmusl-arm64/-/sharp-libvips-linuxmusl-arm64-1.2.4.tgz\",\n      \"integrity\": \"sha512-FVQHuwx1IIuNow9QAbYUzJ+En8KcVm9Lk5+uGUQJHaZmMECZmOlix9HnH7n1TRkXMS0pGxIJokIVB9SuqZGGXw==\",\n      \"cpu\": [\n        \"arm64\"\n      ],\n      \"license\": \"LGPL-3.0-or-later\",\n      \"optional\": true,\n      \"os\": [\n        \"linux\"\n      ],\n      \"funding\": {\n        \"url\": \"https://opencollective.com/libvips\"\n      }\n    },\n    \"node_modules/@img/sharp-libvips-linuxmusl-x64\": {\n      \"version\": \"1.2.4\",\n      \"resolved\": \"https://registry.npmjs.org/@img/sharp-libvips-linuxmusl-x64/-/sharp-libvips-linuxmusl-x64-1.2.4.tgz\",\n      \"integrity\": \"sha512-+LpyBk7L44ZIXwz/VYfglaX/okxezESc6UxDSoyo2Ks6Jxc4Y7sGjpgU9s4PMgqgjj1gZCylTieNamqA1MF7Dg==\",\n      \"cpu\": [\n        \"x64\"\n      ],\n      \"license\": \"LGPL-3.0-or-later\",\n      \"optional\": true,\n      \"os\": [\n        \"linux\"\n      ],\n      \"funding\": {\n        \"url\": \"https://opencollective.com/libvips\"\n      }\n    },\n    \"node_modules/@img/sharp-linux-arm\": {\n      \"version\": \"0.34.5\",\n      \"resolved\": \"https://registry.npmjs.org/@img/sharp-linux-arm/-/sharp-linux-arm-0.34.5.tgz\",\n      \"integrity\": \"sha512-9dLqsvwtg1uuXBGZKsxem9595+ujv0sJ6Vi8wcTANSFpwV/GONat5eCkzQo/1O6zRIkh0m/8+5BjrRr7jDUSZw==\",\n      \"cpu\": [\n        \"arm\"\n      ],\n      \"license\": \"Apache-2.0\",\n      \"optional\": true,\n      \"os\": [\n        \"linux\"\n      ],\n      \"engines\": {\n        \"node\": \"^18.17.0 || ^20.3.0 || >=21.0.0\"\n      },\n      \"funding\": {\n        \"url\": \"https://opencollective.com/libvips\"\n      },\n      \"optionalDependencies\": {\n        \"@img/sharp-libvips-linux-arm\": \"1.2.4\"\n      }\n    },\n    \"node_modules/@img/sharp-linux-arm64\": {\n      \"version\": \"0.34.5\",\n      \"resolved\": \"https://registry.npmjs.org/@img/sharp-linux-arm64/-/sharp-linux-arm64-0.34.5.tgz\",\n      \"integrity\": \"sha512-bKQzaJRY/bkPOXyKx5EVup7qkaojECG6NLYswgktOZjaXecSAeCWiZwwiFf3/Y+O1HrauiE3FVsGxFg8c24rZg==\",\n      \"cpu\": [\n        \"arm64\"\n      ],\n      \"license\": \"Apache-2.0\",\n      \"optional\": true,\n      \"os\": [\n        \"linux\"\n      ],\n      \"engines\": {\n        \"node\": \"^18.17.0 || ^20.3.0 || >=21.0.0\"\n      },\n      \"funding\": {\n        \"url\": \"https://opencollective.com/libvips\"\n      },\n      \"optionalDependencies\": {\n        \"@img/sharp-libvips-linux-arm64\": \"1.2.4\"\n      }\n    },\n    \"node_modules/@img/sharp-linux-ppc64\": {\n      \"version\": \"0.34.5\",\n      \"resolved\": \"https://registry.npmjs.org/@img/sharp-linux-ppc64/-/sharp-linux-ppc64-0.34.5.tgz\",\n      \"integrity\": \"sha512-7zznwNaqW6YtsfrGGDA6BRkISKAAE1Jo0QdpNYXNMHu2+0dTrPflTLNkpc8l7MUP5M16ZJcUvysVWWrMefZquA==\",\n      \"cpu\": [\n        \"ppc64\"\n      ],\n      \"license\": \"Apache-2.0\",\n      \"optional\": true,\n      \"os\": [\n        \"linux\"\n      ],\n      \"engines\": {\n        \"node\": \"^18.17.0 || ^20.3.0 || >=21.0.0\"\n      },\n      \"funding\": {\n        \"url\": \"https://opencollective.com/libvips\"\n      },\n      \"optionalDependencies\": {\n        \"@img/sharp-libvips-linux-ppc64\": \"1.2.4\"\n      }\n    },\n    \"node_modules/@img/sharp-linux-riscv64\": {\n      \"version\": \"0.34.5\",\n      \"resolved\": \"https://registry.npmjs.org/@img/sharp-linux-riscv64/-/sharp-linux-riscv64-0.34.5.tgz\",\n      \"integrity\": \"sha512-51gJuLPTKa7piYPaVs8GmByo7/U7/7TZOq+cnXJIHZKavIRHAP77e3N2HEl3dgiqdD/w0yUfiJnII77PuDDFdw==\",\n      \"cpu\": [\n        \"riscv64\"\n      ],\n      \"license\": \"Apache-2.0\",\n      \"optional\": true,\n      \"os\": [\n        \"linux\"\n      ],\n      \"engines\": {\n        \"node\": \"^18.17.0 || ^20.3.0 || >=21.0.0\"\n      },\n      \"funding\": {\n        \"url\": \"https://opencollective.com/libvips\"\n      },\n      \"optionalDependencies\": {\n        \"@img/sharp-libvips-linux-riscv64\": \"1.2.4\"\n      }\n    },\n    \"node_modules/@img/sharp-linux-s390x\": {\n      \"version\": \"0.34.5\",\n      \"resolved\": \"https://registry.npmjs.org/@img/sharp-linux-s390x/-/sharp-linux-s390x-0.34.5.tgz\",\n      \"integrity\": \"sha512-nQtCk0PdKfho3eC5MrbQoigJ2gd1CgddUMkabUj+rBevs8tZ2cULOx46E7oyX+04WGfABgIwmMC0VqieTiR4jg==\",\n      \"cpu\": [\n        \"s390x\"\n      ],\n      \"license\": \"Apache-2.0\",\n      \"optional\": true,\n      \"os\": [\n        \"linux\"\n      ],\n      \"engines\": {\n        \"node\": \"^18.17.0 || ^20.3.0 || >=21.0.0\"\n      },\n      \"funding\": {\n        \"url\": \"https://opencollective.com/libvips\"\n      },\n      \"optionalDependencies\": {\n        \"@img/sharp-libvips-linux-s390x\": \"1.2.4\"\n      }\n    },\n    \"node_modules/@img/sharp-linux-x64\": {\n      \"version\": \"0.34.5\",\n      \"resolved\": \"https://registry.npmjs.org/@img/sharp-linux-x64/-/sharp-linux-x64-0.34.5.tgz\",\n      \"integrity\": \"sha512-MEzd8HPKxVxVenwAa+JRPwEC7QFjoPWuS5NZnBt6B3pu7EG2Ge0id1oLHZpPJdn3OQK+BQDiw9zStiHBTJQQQQ==\",\n      \"cpu\": [\n        \"x64\"\n      ],\n      \"license\": \"Apache-2.0\",\n      \"optional\": true,\n      \"os\": [\n        \"linux\"\n      ],\n      \"engines\": {\n        \"node\": \"^18.17.0 || ^20.3.0 || >=21.0.0\"\n      },\n      \"funding\": {\n        \"url\": \"https://opencollective.com/libvips\"\n      },\n      \"optionalDependencies\": {\n        \"@img/sharp-libvips-linux-x64\": \"1.2.4\"\n      }\n    },\n    \"node_modules/@img/sharp-linuxmusl-arm64\": {\n      \"version\": \"0.34.5\",\n      \"resolved\": \"https://registry.npmjs.org/@img/sharp-linuxmusl-arm64/-/sharp-linuxmusl-arm64-0.34.5.tgz\",\n      \"integrity\": \"sha512-fprJR6GtRsMt6Kyfq44IsChVZeGN97gTD331weR1ex1c1rypDEABN6Tm2xa1wE6lYb5DdEnk03NZPqA7Id21yg==\",\n      \"cpu\": [\n        \"arm64\"\n      ],\n      \"license\": \"Apache-2.0\",\n      \"optional\": true,\n      \"os\": [\n        \"linux\"\n      ],\n      \"engines\": {\n        \"node\": \"^18.17.0 || ^20.3.0 || >=21.0.0\"\n      },\n      \"funding\": {\n        \"url\": \"https://opencollective.com/libvips\"\n      },\n      \"optionalDependencies\": {\n        \"@img/sharp-libvips-linuxmusl-arm64\": \"1.2.4\"\n      }\n    },\n    \"node_modules/@img/sharp-linuxmusl-x64\": {\n      \"version\": \"0.34.5\",\n      \"resolved\": \"https://registry.npmjs.org/@img/sharp-linuxmusl-x64/-/sharp-linuxmusl-x64-0.34.5.tgz\",\n      \"integrity\": \"sha512-Jg8wNT1MUzIvhBFxViqrEhWDGzqymo3sV7z7ZsaWbZNDLXRJZoRGrjulp60YYtV4wfY8VIKcWidjojlLcWrd8Q==\",\n      \"cpu\": [\n        \"x64\"\n      ],\n      \"license\": \"Apache-2.0\",\n      \"optional\": true,\n      \"os\": [\n        \"linux\"\n      ],\n      \"engines\": {\n        \"node\": \"^18.17.0 || ^20.3.0 || >=21.0.0\"\n      },\n      \"funding\": {\n        \"url\": \"https://opencollective.com/libvips\"\n      },\n      \"optionalDependencies\": {\n        \"@img/sharp-libvips-linuxmusl-x64\": \"1.2.4\"\n      }\n    },\n    \"node_modules/@img/sharp-wasm32\": {\n      \"version\": \"0.34.5\",\n      \"resolved\": \"https://registry.npmjs.org/@img/sharp-wasm32/-/sharp-wasm32-0.34.5.tgz\",\n      \"integrity\": \"sha512-OdWTEiVkY2PHwqkbBI8frFxQQFekHaSSkUIJkwzclWZe64O1X4UlUjqqqLaPbUpMOQk6FBu/HtlGXNblIs0huw==\",\n      \"cpu\": [\n        \"wasm32\"\n      ],\n      \"license\": \"Apache-2.0 AND LGPL-3.0-or-later AND MIT\",\n      \"optional\": true,\n      \"dependencies\": {\n        \"@emnapi/runtime\": \"^1.7.0\"\n      },\n      \"engines\": {\n        \"node\": \"^18.17.0 || ^20.3.0 || >=21.0.0\"\n      },\n      \"funding\": {\n        \"url\": \"https://opencollective.com/libvips\"\n      }\n    },\n    \"node_modules/@img/sharp-win32-arm64\": {\n      \"version\": \"0.34.5\",\n      \"resolved\": \"https://registry.npmjs.org/@img/sharp-win32-arm64/-/sharp-win32-arm64-0.34.5.tgz\",\n      \"integrity\": \"sha512-WQ3AgWCWYSb2yt+IG8mnC6Jdk9Whs7O0gxphblsLvdhSpSTtmu69ZG1Gkb6NuvxsNACwiPV6cNSZNzt0KPsw7g==\",\n      \"cpu\": [\n        \"arm64\"\n      ],\n      \"license\": \"Apache-2.0 AND LGPL-3.0-or-later\",\n      \"optional\": true,\n      \"os\": [\n        \"win32\"\n      ],\n      \"engines\": {\n        \"node\": \"^18.17.0 || ^20.3.0 || >=21.0.0\"\n      },\n      \"funding\": {\n        \"url\": \"https://opencollective.com/libvips\"\n      }\n    },\n    \"node_modules/@img/sharp-win32-ia32\": {\n      \"version\": \"0.34.5\",\n      \"resolved\": \"https://registry.npmjs.org/@img/sharp-win32-ia32/-/sharp-win32-ia32-0.34.5.tgz\",\n      \"integrity\": \"sha512-FV9m/7NmeCmSHDD5j4+4pNI8Cp3aW+JvLoXcTUo0IqyjSfAZJ8dIUmijx1qaJsIiU+Hosw6xM5KijAWRJCSgNg==\",\n      \"cpu\": [\n        \"ia32\"\n      ],\n      \"license\": \"Apache-2.0 AND LGPL-3.0-or-later\",\n      \"optional\": true,\n      \"os\": [\n        \"win32\"\n      ],\n      \"engines\": {\n        \"node\": \"^18.17.0 || ^20.3.0 || >=21.0.0\"\n      },\n      \"funding\": {\n        \"url\": \"https://opencollective.com/libvips\"\n      }\n    },\n    \"node_modules/@img/sharp-win32-x64\": {\n      \"version\": \"0.34.5\",\n      \"resolved\": \"https://registry.npmjs.org/@img/sharp-win32-x64/-/sharp-win32-x64-0.34.5.tgz\",\n      \"integrity\": \"sha512-+29YMsqY2/9eFEiW93eqWnuLcWcufowXewwSNIT6UwZdUUCrM3oFjMWH/Z6/TMmb4hlFenmfAVbpWeup2jryCw==\",\n      \"cpu\": [\n        \"x64\"\n      ],\n      \"license\": \"Apache-2.0 AND LGPL-3.0-or-later\",\n      \"optional\": true,\n      \"os\": [\n        \"win32\"\n      ],\n      \"engines\": {\n        \"node\": \"^18.17.0 || ^20.3.0 || >=21.0.0\"\n      },\n      \"funding\": {\n        \"url\": \"https://opencollective.com/libvips\"\n      }\n    },\n    \"node_modules/@jridgewell/gen-mapping\": {\n      \"version\": \"0.3.13\",\n      \"resolved\": \"https://registry.npmjs.org/@jridgewell/gen-mapping/-/gen-mapping-0.3.13.tgz\",\n      \"integrity\": \"sha512-2kkt/7niJ6MgEPxF0bYdQ6etZaA+fQvDcLKckhy1yIQOzaoKjBBjSj63/aLVjYE3qhRt5dvM+uUyfCg6UKCBbA==\",\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"@jridgewell/sourcemap-codec\": \"^1.5.0\",\n        \"@jridgewell/trace-mapping\": \"^0.3.24\"\n      }\n    },\n    \"node_modules/@jridgewell/resolve-uri\": {\n      \"version\": \"3.1.2\",\n      \"resolved\": \"https://registry.npmjs.org/@jridgewell/resolve-uri/-/resolve-uri-3.1.2.tgz\",\n      \"integrity\": \"sha512-bRISgCIjP20/tbWSPWMEi54QVPRZExkuD9lJL+UIxUKtwVJA8wW1Trb1jMs1RFXo1CBTNZ/5hpC9QvmKWdopKw==\",\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"engines\": {\n        \"node\": \">=6.0.0\"\n      }\n    },\n    \"node_modules/@jridgewell/sourcemap-codec\": {\n      \"version\": \"1.5.5\",\n      \"resolved\": \"https://registry.npmjs.org/@jridgewell/sourcemap-codec/-/sourcemap-codec-1.5.5.tgz\",\n      \"integrity\": \"sha512-cYQ9310grqxueWbl+WuIUIaiUaDcj7WOq5fVhEljNVgRfOUhY9fy2zTvfoqWsnebh8Sl70VScFbICvJnLKB0Og==\",\n      \"dev\": true,\n      \"license\": \"MIT\"\n    },\n    \"node_modules/@jridgewell/trace-mapping\": {\n      \"version\": \"0.3.31\",\n      \"resolved\": \"https://registry.npmjs.org/@jridgewell/trace-mapping/-/trace-mapping-0.3.31.tgz\",\n      \"integrity\": \"sha512-zzNR+SdQSDJzc8joaeP8QQoCQr8NuYx2dIIytl1QeBEZHJ9uW6hebsrYgbz8hJwUQao3TWCMtmfV8Nu1twOLAw==\",\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"@jridgewell/resolve-uri\": \"^3.1.0\",\n        \"@jridgewell/sourcemap-codec\": \"^1.4.14\"\n      }\n    },\n    \"node_modules/@next/env\": {\n      \"version\": \"16.1.6\",\n      \"resolved\": \"https://registry.npmjs.org/@next/env/-/env-16.1.6.tgz\",\n      \"integrity\": \"sha512-N1ySLuZjnAtN3kFnwhAwPvZah8RJxKasD7x1f8shFqhncnWZn4JMfg37diLNuoHsLAlrDfM3g4mawVdtAG8XLQ==\",\n      \"license\": \"MIT\"\n    },\n    \"node_modules/@next/swc-darwin-arm64\": {\n      \"version\": \"16.1.6\",\n      \"resolved\": \"https://registry.npmjs.org/@next/swc-darwin-arm64/-/swc-darwin-arm64-16.1.6.tgz\",\n      \"integrity\": \"sha512-wTzYulosJr/6nFnqGW7FrG3jfUUlEf8UjGA0/pyypJl42ExdVgC6xJgcXQ+V8QFn6niSG2Pb8+MIG1mZr2vczw==\",\n      \"cpu\": [\n        \"arm64\"\n      ],\n      \"license\": \"MIT\",\n      \"optional\": true,\n      \"os\": [\n        \"darwin\"\n      ],\n      \"engines\": {\n        \"node\": \">= 10\"\n      }\n    },\n    \"node_modules/@next/swc-darwin-x64\": {\n      \"version\": \"16.1.6\",\n      \"resolved\": \"https://registry.npmjs.org/@next/swc-darwin-x64/-/swc-darwin-x64-16.1.6.tgz\",\n      \"integrity\": \"sha512-BLFPYPDO+MNJsiDWbeVzqvYd4NyuRrEYVB5k2N3JfWncuHAy2IVwMAOlVQDFjj+krkWzhY2apvmekMkfQR0CUQ==\",\n      \"cpu\": [\n        \"x64\"\n      ],\n      \"license\": \"MIT\",\n      \"optional\": true,\n      \"os\": [\n        \"darwin\"\n      ],\n      \"engines\": {\n        \"node\": \">= 10\"\n      }\n    },\n    \"node_modules/@next/swc-linux-arm64-gnu\": {\n      \"version\": \"16.1.6\",\n      \"resolved\": \"https://registry.npmjs.org/@next/swc-linux-arm64-gnu/-/swc-linux-arm64-gnu-16.1.6.tgz\",\n      \"integrity\": \"sha512-OJYkCd5pj/QloBvoEcJ2XiMnlJkRv9idWA/j0ugSuA34gMT6f5b7vOiCQHVRpvStoZUknhl6/UxOXL4OwtdaBw==\",\n      \"cpu\": [\n        \"arm64\"\n      ],\n      \"license\": \"MIT\",\n      \"optional\": true,\n      \"os\": [\n        \"linux\"\n      ],\n      \"engines\": {\n        \"node\": \">= 10\"\n      }\n    },\n    \"node_modules/@next/swc-linux-arm64-musl\": {\n      \"version\": \"16.1.6\",\n      \"resolved\": \"https://registry.npmjs.org/@next/swc-linux-arm64-musl/-/swc-linux-arm64-musl-16.1.6.tgz\",\n      \"integrity\": \"sha512-S4J2v+8tT3NIO9u2q+S0G5KdvNDjXfAv06OhfOzNDaBn5rw84DGXWndOEB7d5/x852A20sW1M56vhC/tRVbccQ==\",\n      \"cpu\": [\n        \"arm64\"\n      ],\n      \"license\": \"MIT\",\n      \"optional\": true,\n      \"os\": [\n        \"linux\"\n      ],\n      \"engines\": {\n        \"node\": \">= 10\"\n      }\n    },\n    \"node_modules/@next/swc-linux-x64-gnu\": {\n      \"version\": \"16.1.6\",\n      \"resolved\": \"https://registry.npmjs.org/@next/swc-linux-x64-gnu/-/swc-linux-x64-gnu-16.1.6.tgz\",\n      \"integrity\": \"sha512-2eEBDkFlMMNQnkTyPBhQOAyn2qMxyG2eE7GPH2WIDGEpEILcBPI/jdSv4t6xupSP+ot/jkfrCShLAa7+ZUPcJQ==\",\n      \"cpu\": [\n        \"x64\"\n      ],\n      \"license\": \"MIT\",\n      \"optional\": true,\n      \"os\": [\n        \"linux\"\n      ],\n      \"engines\": {\n        \"node\": \">= 10\"\n      }\n    },\n    \"node_modules/@next/swc-linux-x64-musl\": {\n      \"version\": \"16.1.6\",\n      \"resolved\": \"https://registry.npmjs.org/@next/swc-linux-x64-musl/-/swc-linux-x64-musl-16.1.6.tgz\",\n      \"integrity\": \"sha512-oicJwRlyOoZXVlxmIMaTq7f8pN9QNbdes0q2FXfRsPhfCi8n8JmOZJm5oo1pwDaFbnnD421rVU409M3evFbIqg==\",\n      \"cpu\": [\n        \"x64\"\n      ],\n      \"license\": \"MIT\",\n      \"optional\": true,\n      \"os\": [\n        \"linux\"\n      ],\n      \"engines\": {\n        \"node\": \">= 10\"\n      }\n    },\n    \"node_modules/@next/swc-win32-arm64-msvc\": {\n      \"version\": \"16.1.6\",\n      \"resolved\": \"https://registry.npmjs.org/@next/swc-win32-arm64-msvc/-/swc-win32-arm64-msvc-16.1.6.tgz\",\n      \"integrity\": \"sha512-gQmm8izDTPgs+DCWH22kcDmuUp7NyiJgEl18bcr8irXA5N2m2O+JQIr6f3ct42GOs9c0h8QF3L5SzIxcYAAXXw==\",\n      \"cpu\": [\n        \"arm64\"\n      ],\n      \"license\": \"MIT\",\n      \"optional\": true,\n      \"os\": [\n        \"win32\"\n      ],\n      \"engines\": {\n        \"node\": \">= 10\"\n      }\n    },\n    \"node_modules/@next/swc-win32-x64-msvc\": {\n      \"version\": \"16.1.6\",\n      \"resolved\": \"https://registry.npmjs.org/@next/swc-win32-x64-msvc/-/swc-win32-x64-msvc-16.1.6.tgz\",\n      \"integrity\": \"sha512-NRfO39AIrzBnixKbjuo2YiYhB6o9d8v/ymU9m/Xk8cyVk+k7XylniXkHwjs4s70wedVffc6bQNbufk5v0xEm0A==\",\n      \"cpu\": [\n        \"x64\"\n      ],\n      \"license\": \"MIT\",\n      \"optional\": true,\n      \"os\": [\n        \"win32\"\n      ],\n      \"engines\": {\n        \"node\": \">= 10\"\n      }\n    },\n    \"node_modules/@nodelib/fs.scandir\": {\n      \"version\": \"2.1.5\",\n      \"resolved\": \"https://registry.npmjs.org/@nodelib/fs.scandir/-/fs.scandir-2.1.5.tgz\",\n      \"integrity\": \"sha512-vq24Bq3ym5HEQm2NKCr3yXDwjc7vTsEThRDnkp2DK9p1uqLR+DHurm/NOTo0KG7HYHU7eppKZj3MyqYuMBf62g==\",\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"@nodelib/fs.stat\": \"2.0.5\",\n        \"run-parallel\": \"^1.1.9\"\n      },\n      \"engines\": {\n        \"node\": \">= 8\"\n      }\n    },\n    \"node_modules/@nodelib/fs.stat\": {\n      \"version\": \"2.0.5\",\n      \"resolved\": \"https://registry.npmjs.org/@nodelib/fs.stat/-/fs.stat-2.0.5.tgz\",\n      \"integrity\": \"sha512-RkhPPp2zrqDAQA/2jNhnztcPAlv64XdhIp7a7454A5ovI7Bukxgt7MX7udwAu3zg1DcpPU0rz3VV1SeaqvY4+A==\",\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"engines\": {\n        \"node\": \">= 8\"\n      }\n    },\n    \"node_modules/@nodelib/fs.walk\": {\n      \"version\": \"1.2.8\",\n      \"resolved\": \"https://registry.npmjs.org/@nodelib/fs.walk/-/fs.walk-1.2.8.tgz\",\n      \"integrity\": \"sha512-oGB+UxlgWcgQkgwo8GcEGwemoTFt3FIO9ababBmaGwXIoBKZ+GTy0pP185beGg7Llih/NSHSV2XAs1lnznocSg==\",\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"@nodelib/fs.scandir\": \"2.1.5\",\n        \"fastq\": \"^1.6.0\"\n      },\n      \"engines\": {\n        \"node\": \">= 8\"\n      }\n    },\n    \"node_modules/@swc/helpers\": {\n      \"version\": \"0.5.15\",\n      \"resolved\": \"https://registry.npmjs.org/@swc/helpers/-/helpers-0.5.15.tgz\",\n      \"integrity\": \"sha512-JQ5TuMi45Owi4/BIMAJBoSQoOJu12oOk/gADqlcUL9JEdHB8vyjUSsxqeNXnmXHjYKMi2WcYtezGEEhqUI/E2g==\",\n      \"license\": \"Apache-2.0\",\n      \"dependencies\": {\n        \"tslib\": \"^2.8.0\"\n      }\n    },\n    \"node_modules/@types/node\": {\n      \"version\": \"20.19.33\",\n      \"resolved\": \"https://registry.npmjs.org/@types/node/-/node-20.19.33.tgz\",\n      \"integrity\": \"sha512-Rs1bVAIdBs5gbTIKza/tgpMuG1k3U/UMJLWecIMxNdJFDMzcM5LOiLVRYh3PilWEYDIeUDv7bpiHPLPsbydGcw==\",\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"undici-types\": \"~6.21.0\"\n      }\n    },\n    \"node_modules/@types/prop-types\": {\n      \"version\": \"15.7.15\",\n      \"resolved\": \"https://registry.npmjs.org/@types/prop-types/-/prop-types-15.7.15.tgz\",\n      \"integrity\": \"sha512-F6bEyamV9jKGAFBEmlQnesRPGOQqS2+Uwi0Em15xenOxHaf2hv6L8YCVn3rPdPJOiJfPiCnLIRyvwVaqMY3MIw==\",\n      \"dev\": true,\n      \"license\": \"MIT\"\n    },\n    \"node_modules/@types/react\": {\n      \"version\": \"18.3.28\",\n      \"resolved\": \"https://registry.npmjs.org/@types/react/-/react-18.3.28.tgz\",\n      \"integrity\": \"sha512-z9VXpC7MWrhfWipitjNdgCauoMLRdIILQsAEV+ZesIzBq/oUlxk0m3ApZuMFCXdnS4U7KrI+l3WRUEGQ8K1QKw==\",\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"@types/prop-types\": \"*\",\n        \"csstype\": \"^3.2.2\"\n      }\n    },\n    \"node_modules/@types/react-dom\": {\n      \"version\": \"18.3.7\",\n      \"resolved\": \"https://registry.npmjs.org/@types/react-dom/-/react-dom-18.3.7.tgz\",\n      \"integrity\": \"sha512-MEe3UeoENYVFXzoXEWsvcpg6ZvlrFNlOQ7EOsvhI3CfAXwzPfO8Qwuxd40nepsYKqyyVQnTdEfv68q91yLcKrQ==\",\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"peerDependencies\": {\n        \"@types/react\": \"^18.0.0\"\n      }\n    },\n    \"node_modules/@upstash/redis\": {\n      \"version\": \"1.36.2\",\n      \"resolved\": \"https://registry.npmjs.org/@upstash/redis/-/redis-1.36.2.tgz\",\n      \"integrity\": \"sha512-C0Yt8hc12vLaQYRG1fMci8iPrLtnTdbJG0HR5T8vKnvEP/1RdMMblsOJs5/jp0JXZJ1oSzMnQz4J9EVezNpI6A==\",\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"uncrypto\": \"^0.1.3\"\n      }\n    },\n    \"node_modules/@vercel/kv\": {\n      \"version\": \"2.0.0\",\n      \"resolved\": \"https://registry.npmjs.org/@vercel/kv/-/kv-2.0.0.tgz\",\n      \"integrity\": \"sha512-zdVrhbzZBYo5d1Hfn4bKtqCeKf0FuzW8rSHauzQVMUgv1+1JOwof2mWcBuI+YMJy8s0G0oqAUfQ7HgUDzb8EbA==\",\n      \"deprecated\": \"Vercel KV is deprecated. If you had an existing KV store, it should have moved to Upstash Redis which you will see under Vercel Integrations. For new projects, install a Redis integration from Vercel Marketplace: https://vercel.com/marketplace?category=storage&search=redis\",\n      \"license\": \"Apache-2.0\",\n      \"dependencies\": {\n        \"@upstash/redis\": \"^1.31.3\"\n      },\n      \"engines\": {\n        \"node\": \">=14.6\"\n      }\n    },\n    \"node_modules/any-promise\": {\n      \"version\": \"1.3.0\",\n      \"resolved\": \"https://registry.npmjs.org/any-promise/-/any-promise-1.3.0.tgz\",\n      \"integrity\": \"sha512-7UvmKalWRt1wgjL1RrGxoSJW/0QZFIegpeGvZG9kjp8vrRu55XTHbwnqq2GpXm9uLbcuhxm3IqX9OB4MZR1b2A==\",\n      \"dev\": true,\n      \"license\": \"MIT\"\n    },\n    \"node_modules/anymatch\": {\n      \"version\": \"3.1.3\",\n      \"resolved\": \"https://registry.npmjs.org/anymatch/-/anymatch-3.1.3.tgz\",\n      \"integrity\": \"sha512-KMReFUr0B4t+D+OBkjR3KYqvocp2XaSzO55UcB6mgQMd3KbcE+mWTyvVV7D/zsdEbNnV6acZUutkiHQXvTr1Rw==\",\n      \"dev\": true,\n      \"license\": \"ISC\",\n      \"dependencies\": {\n        \"normalize-path\": \"^3.0.0\",\n        \"picomatch\": \"^2.0.4\"\n      },\n      \"engines\": {\n        \"node\": \">= 8\"\n      }\n    },\n    \"node_modules/arg\": {\n      \"version\": \"5.0.2\",\n      \"resolved\": \"https://registry.npmjs.org/arg/-/arg-5.0.2.tgz\",\n      \"integrity\": \"sha512-PYjyFOLKQ9y57JvQ6QLo8dAgNqswh8M1RMJYdQduT6xbWSgK36P/Z/v+p888pM69jMMfS8Xd8F6I1kQ/I9HUGg==\",\n      \"dev\": true,\n      \"license\": \"MIT\"\n    },\n    \"node_modules/autoprefixer\": {\n      \"version\": \"10.4.24\",\n      \"resolved\": \"https://registry.npmjs.org/autoprefixer/-/autoprefixer-10.4.24.tgz\",\n      \"integrity\": \"sha512-uHZg7N9ULTVbutaIsDRoUkoS8/h3bdsmVJYZ5l3wv8Cp/6UIIoRDm90hZ+BwxUj/hGBEzLxdHNSKuFpn8WOyZw==\",\n      \"dev\": true,\n      \"funding\": [\n        {\n          \"type\": \"opencollective\",\n          \"url\": \"https://opencollective.com/postcss/\"\n        },\n        {\n          \"type\": \"tidelift\",\n          \"url\": \"https://tidelift.com/funding/github/npm/autoprefixer\"\n        },\n        {\n          \"type\": \"github\",\n          \"url\": \"https://github.com/sponsors/ai\"\n        }\n      ],\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"browserslist\": \"^4.28.1\",\n        \"caniuse-lite\": \"^1.0.30001766\",\n        \"fraction.js\": \"^5.3.4\",\n        \"picocolors\": \"^1.1.1\",\n        \"postcss-value-parser\": \"^4.2.0\"\n      },\n      \"bin\": {\n        \"autoprefixer\": \"bin/autoprefixer\"\n      },\n      \"engines\": {\n        \"node\": \"^10 || ^12 || >=14\"\n      },\n      \"peerDependencies\": {\n        \"postcss\": \"^8.1.0\"\n      }\n    },\n    \"node_modules/baseline-browser-mapping\": {\n      \"version\": \"2.9.19\",\n      \"resolved\": \"https://registry.npmjs.org/baseline-browser-mapping/-/baseline-browser-mapping-2.9.19.tgz\",\n      \"integrity\": \"sha512-ipDqC8FrAl/76p2SSWKSI+H9tFwm7vYqXQrItCuiVPt26Km0jS+NzSsBWAaBusvSbQcfJG+JitdMm+wZAgTYqg==\",\n      \"license\": \"Apache-2.0\",\n      \"bin\": {\n        \"baseline-browser-mapping\": \"dist/cli.js\"\n      }\n    },\n    \"node_modules/binary-extensions\": {\n      \"version\": \"2.3.0\",\n      \"resolved\": \"https://registry.npmjs.org/binary-extensions/-/binary-extensions-2.3.0.tgz\",\n      \"integrity\": \"sha512-Ceh+7ox5qe7LJuLHoY0feh3pHuUDHAcRUeyL2VYghZwfpkNIy/+8Ocg0a3UuSoYzavmylwuLWQOf3hl0jjMMIw==\",\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"engines\": {\n        \"node\": \">=8\"\n      },\n      \"funding\": {\n        \"url\": \"https://github.com/sponsors/sindresorhus\"\n      }\n    },\n    \"node_modules/braces\": {\n      \"version\": \"3.0.3\",\n      \"resolved\": \"https://registry.npmjs.org/braces/-/braces-3.0.3.tgz\",\n      \"integrity\": \"sha512-yQbXgO/OSZVD2IsiLlro+7Hf6Q18EJrKSEsdoMzKePKXct3gvD8oLcOQdIzGupr5Fj+EDe8gO/lxc1BzfMpxvA==\",\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"fill-range\": \"^7.1.1\"\n      },\n      \"engines\": {\n        \"node\": \">=8\"\n      }\n    },\n    \"node_modules/browserslist\": {\n      \"version\": \"4.28.1\",\n      \"resolved\": \"https://registry.npmjs.org/browserslist/-/browserslist-4.28.1.tgz\",\n      \"integrity\": \"sha512-ZC5Bd0LgJXgwGqUknZY/vkUQ04r8NXnJZ3yYi4vDmSiZmC/pdSN0NbNRPxZpbtO4uAfDUAFffO8IZoM3Gj8IkA==\",\n      \"dev\": true,\n      \"funding\": [\n        {\n          \"type\": \"opencollective\",\n          \"url\": \"https://opencollective.com/browserslist\"\n        },\n        {\n          \"type\": \"tidelift\",\n          \"url\": \"https://tidelift.com/funding/github/npm/browserslist\"\n        },\n        {\n          \"type\": \"github\",\n          \"url\": \"https://github.com/sponsors/ai\"\n        }\n      ],\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"baseline-browser-mapping\": \"^2.9.0\",\n        \"caniuse-lite\": \"^1.0.30001759\",\n        \"electron-to-chromium\": \"^1.5.263\",\n        \"node-releases\": \"^2.0.27\",\n        \"update-browserslist-db\": \"^1.2.0\"\n      },\n      \"bin\": {\n        \"browserslist\": \"cli.js\"\n      },\n      \"engines\": {\n        \"node\": \"^6 || ^7 || ^8 || ^9 || ^10 || ^11 || ^12 || >=13.7\"\n      }\n    },\n    \"node_modules/camelcase-css\": {\n      \"version\": \"2.0.1\",\n      \"resolved\": \"https://registry.npmjs.org/camelcase-css/-/camelcase-css-2.0.1.tgz\",\n      \"integrity\": \"sha512-QOSvevhslijgYwRx6Rv7zKdMF8lbRmx+uQGx2+vDc+KI/eBnsy9kit5aj23AgGu3pa4t9AgwbnXWqS+iOY+2aA==\",\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"engines\": {\n        \"node\": \">= 6\"\n      }\n    },\n    \"node_modules/caniuse-lite\": {\n      \"version\": \"1.0.30001770\",\n      \"resolved\": \"https://registry.npmjs.org/caniuse-lite/-/caniuse-lite-1.0.30001770.tgz\",\n      \"integrity\": \"sha512-x/2CLQ1jHENRbHg5PSId2sXq1CIO1CISvwWAj027ltMVG2UNgW+w9oH2+HzgEIRFembL8bUlXtfbBHR1fCg2xw==\",\n      \"funding\": [\n        {\n          \"type\": \"opencollective\",\n          \"url\": \"https://opencollective.com/browserslist\"\n        },\n        {\n          \"type\": \"tidelift\",\n          \"url\": \"https://tidelift.com/funding/github/npm/caniuse-lite\"\n        },\n        {\n          \"type\": \"github\",\n          \"url\": \"https://github.com/sponsors/ai\"\n        }\n      ],\n      \"license\": \"CC-BY-4.0\"\n    },\n    \"node_modules/chokidar\": {\n      \"version\": \"3.6.0\",\n      \"resolved\": \"https://registry.npmjs.org/chokidar/-/chokidar-3.6.0.tgz\",\n      \"integrity\": \"sha512-7VT13fmjotKpGipCW9JEQAusEPE+Ei8nl6/g4FBAmIm0GOOLMua9NDDo/DWp0ZAxCr3cPq5ZpBqmPAQgDda2Pw==\",\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"anymatch\": \"~3.1.2\",\n        \"braces\": \"~3.0.2\",\n        \"glob-parent\": \"~5.1.2\",\n        \"is-binary-path\": \"~2.1.0\",\n        \"is-glob\": \"~4.0.1\",\n        \"normalize-path\": \"~3.0.0\",\n        \"readdirp\": \"~3.6.0\"\n      },\n      \"engines\": {\n        \"node\": \">= 8.10.0\"\n      },\n      \"funding\": {\n        \"url\": \"https://paulmillr.com/funding/\"\n      },\n      \"optionalDependencies\": {\n        \"fsevents\": \"~2.3.2\"\n      }\n    },\n    \"node_modules/chokidar/node_modules/glob-parent\": {\n      \"version\": \"5.1.2\",\n      \"resolved\": \"https://registry.npmjs.org/glob-parent/-/glob-parent-5.1.2.tgz\",\n      \"integrity\": \"sha512-AOIgSQCepiJYwP3ARnGx+5VnTu2HBYdzbGP45eLw1vr3zB3vZLeyed1sC9hnbcOc9/SrMyM5RPQrkGz4aS9Zow==\",\n      \"dev\": true,\n      \"license\": \"ISC\",\n      \"dependencies\": {\n        \"is-glob\": \"^4.0.1\"\n      },\n      \"engines\": {\n        \"node\": \">= 6\"\n      }\n    },\n    \"node_modules/client-only\": {\n      \"version\": \"0.0.1\",\n      \"resolved\": \"https://registry.npmjs.org/client-only/-/client-only-0.0.1.tgz\",\n      \"integrity\": \"sha512-IV3Ou0jSMzZrd3pZ48nLkT9DA7Ag1pnPzaiQhpW7c3RbcqqzvzzVu+L8gfqMp/8IM2MQtSiqaCxrrcfu8I8rMA==\",\n      \"license\": \"MIT\"\n    },\n    \"node_modules/commander\": {\n      \"version\": \"4.1.1\",\n      \"resolved\": \"https://registry.npmjs.org/commander/-/commander-4.1.1.tgz\",\n      \"integrity\": \"sha512-NOKm8xhkzAjzFx8B2v5OAHT+u5pRQc2UCa2Vq9jYL/31o2wi9mxBA7LIFs3sV5VSC49z6pEhfbMULvShKj26WA==\",\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"engines\": {\n        \"node\": \">= 6\"\n      }\n    },\n    \"node_modules/cssesc\": {\n      \"version\": \"3.0.0\",\n      \"resolved\": \"https://registry.npmjs.org/cssesc/-/cssesc-3.0.0.tgz\",\n      \"integrity\": \"sha512-/Tb/JcjK111nNScGob5MNtsntNM1aCNUDipB/TkwZFhyDrrE47SOx/18wF2bbjgc3ZzCSKW1T5nt5EbFoAz/Vg==\",\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"bin\": {\n        \"cssesc\": \"bin/cssesc\"\n      },\n      \"engines\": {\n        \"node\": \">=4\"\n      }\n    },\n    \"node_modules/csstype\": {\n      \"version\": \"3.2.3\",\n      \"resolved\": \"https://registry.npmjs.org/csstype/-/csstype-3.2.3.tgz\",\n      \"integrity\": \"sha512-z1HGKcYy2xA8AGQfwrn0PAy+PB7X/GSj3UVJW9qKyn43xWa+gl5nXmU4qqLMRzWVLFC8KusUX8T/0kCiOYpAIQ==\",\n      \"dev\": true,\n      \"license\": \"MIT\"\n    },\n    \"node_modules/detect-libc\": {\n      \"version\": \"2.1.2\",\n      \"resolved\": \"https://registry.npmjs.org/detect-libc/-/detect-libc-2.1.2.tgz\",\n      \"integrity\": \"sha512-Btj2BOOO83o3WyH59e8MgXsxEQVcarkUOpEYrubB0urwnN10yQ364rsiByU11nZlqWYZm05i/of7io4mzihBtQ==\",\n      \"license\": \"Apache-2.0\",\n      \"optional\": true,\n      \"engines\": {\n        \"node\": \">=8\"\n      }\n    },\n    \"node_modules/didyoumean\": {\n      \"version\": \"1.2.2\",\n      \"resolved\": \"https://registry.npmjs.org/didyoumean/-/didyoumean-1.2.2.tgz\",\n      \"integrity\": \"sha512-gxtyfqMg7GKyhQmb056K7M3xszy/myH8w+B4RT+QXBQsvAOdc3XymqDDPHx1BgPgsdAA5SIifona89YtRATDzw==\",\n      \"dev\": true,\n      \"license\": \"Apache-2.0\"\n    },\n    \"node_modules/dlv\": {\n      \"version\": \"1.1.3\",\n      \"resolved\": \"https://registry.npmjs.org/dlv/-/dlv-1.1.3.tgz\",\n      \"integrity\": \"sha512-+HlytyjlPKnIG8XuRG8WvmBP8xs8P71y+SKKS6ZXWoEgLuePxtDoUEiH7WkdePWrQ5JBpE6aoVqfZfJUQkjXwA==\",\n      \"dev\": true,\n      \"license\": \"MIT\"\n    },\n    \"node_modules/electron-to-chromium\": {\n      \"version\": \"1.5.286\",\n      \"resolved\": \"https://registry.npmjs.org/electron-to-chromium/-/electron-to-chromium-1.5.286.tgz\",\n      \"integrity\": \"sha512-9tfDXhJ4RKFNerfjdCcZfufu49vg620741MNs26a9+bhLThdB+plgMeou98CAaHu/WATj2iHOOHTp1hWtABj2A==\",\n      \"dev\": true,\n      \"license\": \"ISC\"\n    },\n    \"node_modules/escalade\": {\n      \"version\": \"3.2.0\",\n      \"resolved\": \"https://registry.npmjs.org/escalade/-/escalade-3.2.0.tgz\",\n      \"integrity\": \"sha512-WUj2qlxaQtO4g6Pq5c29GTcWGDyd8itL8zTlipgECz3JesAiiOKotd8JU6otB3PACgG6xkJUyVhboMS+bje/jA==\",\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"engines\": {\n        \"node\": \">=6\"\n      }\n    },\n    \"node_modules/fast-glob\": {\n      \"version\": \"3.3.3\",\n      \"resolved\": \"https://registry.npmjs.org/fast-glob/-/fast-glob-3.3.3.tgz\",\n      \"integrity\": \"sha512-7MptL8U0cqcFdzIzwOTHoilX9x5BrNqye7Z/LuC7kCMRio1EMSyqRK3BEAUD7sXRq4iT4AzTVuZdhgQ2TCvYLg==\",\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"@nodelib/fs.stat\": \"^2.0.2\",\n        \"@nodelib/fs.walk\": \"^1.2.3\",\n        \"glob-parent\": \"^5.1.2\",\n        \"merge2\": \"^1.3.0\",\n        \"micromatch\": \"^4.0.8\"\n      },\n      \"engines\": {\n        \"node\": \">=8.6.0\"\n      }\n    },\n    \"node_modules/fast-glob/node_modules/glob-parent\": {\n      \"version\": \"5.1.2\",\n      \"resolved\": \"https://registry.npmjs.org/glob-parent/-/glob-parent-5.1.2.tgz\",\n      \"integrity\": \"sha512-AOIgSQCepiJYwP3ARnGx+5VnTu2HBYdzbGP45eLw1vr3zB3vZLeyed1sC9hnbcOc9/SrMyM5RPQrkGz4aS9Zow==\",\n      \"dev\": true,\n      \"license\": \"ISC\",\n      \"dependencies\": {\n        \"is-glob\": \"^4.0.1\"\n      },\n      \"engines\": {\n        \"node\": \">= 6\"\n      }\n    },\n    \"node_modules/fastq\": {\n      \"version\": \"1.20.1\",\n      \"resolved\": \"https://registry.npmjs.org/fastq/-/fastq-1.20.1.tgz\",\n      \"integrity\": \"sha512-GGToxJ/w1x32s/D2EKND7kTil4n8OVk/9mycTc4VDza13lOvpUZTGX3mFSCtV9ksdGBVzvsyAVLM6mHFThxXxw==\",\n      \"dev\": true,\n      \"license\": \"ISC\",\n      \"dependencies\": {\n        \"reusify\": \"^1.0.4\"\n      }\n    },\n    \"node_modules/fill-range\": {\n      \"version\": \"7.1.1\",\n      \"resolved\": \"https://registry.npmjs.org/fill-range/-/fill-range-7.1.1.tgz\",\n      \"integrity\": \"sha512-YsGpe3WHLK8ZYi4tWDg2Jy3ebRz2rXowDxnld4bkQB00cc/1Zw9AWnC0i9ztDJitivtQvaI9KaLyKrc+hBW0yg==\",\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"to-regex-range\": \"^5.0.1\"\n      },\n      \"engines\": {\n        \"node\": \">=8\"\n      }\n    },\n    \"node_modules/fraction.js\": {\n      \"version\": \"5.3.4\",\n      \"resolved\": \"https://registry.npmjs.org/fraction.js/-/fraction.js-5.3.4.tgz\",\n      \"integrity\": \"sha512-1X1NTtiJphryn/uLQz3whtY6jK3fTqoE3ohKs0tT+Ujr1W59oopxmoEh7Lu5p6vBaPbgoM0bzveAW4Qi5RyWDQ==\",\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"engines\": {\n        \"node\": \"*\"\n      },\n      \"funding\": {\n        \"type\": \"github\",\n        \"url\": \"https://github.com/sponsors/rawify\"\n      }\n    },\n    \"node_modules/fsevents\": {\n      \"version\": \"2.3.3\",\n      \"resolved\": \"https://registry.npmjs.org/fsevents/-/fsevents-2.3.3.tgz\",\n      \"integrity\": \"sha512-5xoDfX+fL7faATnagmWPpbFtwh/R77WmMMqqHGS65C3vvB0YHrgF+B1YmZ3441tMj5n63k0212XNoJwzlhffQw==\",\n      \"dev\": true,\n      \"hasInstallScript\": true,\n      \"license\": \"MIT\",\n      \"optional\": true,\n      \"os\": [\n        \"darwin\"\n      ],\n      \"engines\": {\n        \"node\": \"^8.16.0 || ^10.6.0 || >=11.0.0\"\n      }\n    },\n    \"node_modules/function-bind\": {\n      \"version\": \"1.1.2\",\n      \"resolved\": \"https://registry.npmjs.org/function-bind/-/function-bind-1.1.2.tgz\",\n      \"integrity\": \"sha512-7XHNxH7qX9xG5mIwxkhumTox/MIRNcOgDrxWsMt2pAr23WHp6MrRlN7FBSFpCpr+oVO0F744iUgR82nJMfG2SA==\",\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"funding\": {\n        \"url\": \"https://github.com/sponsors/ljharb\"\n      }\n    },\n    \"node_modules/glob-parent\": {\n      \"version\": \"6.0.2\",\n      \"resolved\": \"https://registry.npmjs.org/glob-parent/-/glob-parent-6.0.2.tgz\",\n      \"integrity\": \"sha512-XxwI8EOhVQgWp6iDL+3b0r86f4d6AX6zSU55HfB4ydCEuXLXc5FcYeOu+nnGftS4TEju/11rt4KJPTMgbfmv4A==\",\n      \"dev\": true,\n      \"license\": \"ISC\",\n      \"dependencies\": {\n        \"is-glob\": \"^4.0.3\"\n      },\n      \"engines\": {\n        \"node\": \">=10.13.0\"\n      }\n    },\n    \"node_modules/hasown\": {\n      \"version\": \"2.0.2\",\n      \"resolved\": \"https://registry.npmjs.org/hasown/-/hasown-2.0.2.tgz\",\n      \"integrity\": \"sha512-0hJU9SCPvmMzIBdZFqNPXWa6dqh7WdH0cII9y+CyS8rG3nL48Bclra9HmKhVVUHyPWNH5Y7xDwAB7bfgSjkUMQ==\",\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"function-bind\": \"^1.1.2\"\n      },\n      \"engines\": {\n        \"node\": \">= 0.4\"\n      }\n    },\n    \"node_modules/is-binary-path\": {\n      \"version\": \"2.1.0\",\n      \"resolved\": \"https://registry.npmjs.org/is-binary-path/-/is-binary-path-2.1.0.tgz\",\n      \"integrity\": \"sha512-ZMERYes6pDydyuGidse7OsHxtbI7WVeUEozgR/g7rd0xUimYNlvZRE/K2MgZTjWy725IfelLeVcEM97mmtRGXw==\",\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"binary-extensions\": \"^2.0.0\"\n      },\n      \"engines\": {\n        \"node\": \">=8\"\n      }\n    },\n    \"node_modules/is-core-module\": {\n      \"version\": \"2.16.1\",\n      \"resolved\": \"https://registry.npmjs.org/is-core-module/-/is-core-module-2.16.1.tgz\",\n      \"integrity\": \"sha512-UfoeMA6fIJ8wTYFEUjelnaGI67v6+N7qXJEvQuIGa99l4xsCruSYOVSQ0uPANn4dAzm8lkYPaKLrrijLq7x23w==\",\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"hasown\": \"^2.0.2\"\n      },\n      \"engines\": {\n        \"node\": \">= 0.4\"\n      },\n      \"funding\": {\n        \"url\": \"https://github.com/sponsors/ljharb\"\n      }\n    },\n    \"node_modules/is-extglob\": {\n      \"version\": \"2.1.1\",\n      \"resolved\": \"https://registry.npmjs.org/is-extglob/-/is-extglob-2.1.1.tgz\",\n      \"integrity\": \"sha512-SbKbANkN603Vi4jEZv49LeVJMn4yGwsbzZworEoyEiutsN3nJYdbO36zfhGJ6QEDpOZIFkDtnq5JRxmvl3jsoQ==\",\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"engines\": {\n        \"node\": \">=0.10.0\"\n      }\n    },\n    \"node_modules/is-glob\": {\n      \"version\": \"4.0.3\",\n      \"resolved\": \"https://registry.npmjs.org/is-glob/-/is-glob-4.0.3.tgz\",\n      \"integrity\": \"sha512-xelSayHH36ZgE7ZWhli7pW34hNbNl8Ojv5KVmkJD4hBdD3th8Tfk9vYasLM+mXWOZhFkgZfxhLSnrwRr4elSSg==\",\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"is-extglob\": \"^2.1.1\"\n      },\n      \"engines\": {\n        \"node\": \">=0.10.0\"\n      }\n    },\n    \"node_modules/is-number\": {\n      \"version\": \"7.0.0\",\n      \"resolved\": \"https://registry.npmjs.org/is-number/-/is-number-7.0.0.tgz\",\n      \"integrity\": \"sha512-41Cifkg6e8TylSpdtTpeLVMqvSBEVzTttHvERD741+pnZ8ANv0004MRL43QKPDlK9cGvNp6NZWZUBlbGXYxxng==\",\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"engines\": {\n        \"node\": \">=0.12.0\"\n      }\n    },\n    \"node_modules/jiti\": {\n      \"version\": \"1.21.7\",\n      \"resolved\": \"https://registry.npmjs.org/jiti/-/jiti-1.21.7.tgz\",\n      \"integrity\": \"sha512-/imKNG4EbWNrVjoNC/1H5/9GFy+tqjGBHCaSsN+P2RnPqjsLmv6UD3Ej+Kj8nBWaRAwyk7kK5ZUc+OEatnTR3A==\",\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"bin\": {\n        \"jiti\": \"bin/jiti.js\"\n      }\n    },\n    \"node_modules/js-tokens\": {\n      \"version\": \"4.0.0\",\n      \"resolved\": \"https://registry.npmjs.org/js-tokens/-/js-tokens-4.0.0.tgz\",\n      \"integrity\": \"sha512-RdJUflcE3cUzKiMqQgsCu06FPu9UdIJO0beYbPhHN4k6apgJtifcoCtT9bcxOpYBtpD2kCM6Sbzg4CausW/PKQ==\",\n      \"license\": \"MIT\"\n    },\n    \"node_modules/lilconfig\": {\n      \"version\": \"3.1.3\",\n      \"resolved\": \"https://registry.npmjs.org/lilconfig/-/lilconfig-3.1.3.tgz\",\n      \"integrity\": \"sha512-/vlFKAoH5Cgt3Ie+JLhRbwOsCQePABiU3tJ1egGvyQ+33R/vcwM2Zl2QR/LzjsBeItPt3oSVXapn+m4nQDvpzw==\",\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"engines\": {\n        \"node\": \">=14\"\n      },\n      \"funding\": {\n        \"url\": \"https://github.com/sponsors/antonk52\"\n      }\n    },\n    \"node_modules/lines-and-columns\": {\n      \"version\": \"1.2.4\",\n      \"resolved\": \"https://registry.npmjs.org/lines-and-columns/-/lines-and-columns-1.2.4.tgz\",\n      \"integrity\": \"sha512-7ylylesZQ/PV29jhEDl3Ufjo6ZX7gCqJr5F7PKrqc93v7fzSymt1BpwEU8nAUXs8qzzvqhbjhK5QZg6Mt/HkBg==\",\n      \"dev\": true,\n      \"license\": \"MIT\"\n    },\n    \"node_modules/loose-envify\": {\n      \"version\": \"1.4.0\",\n      \"resolved\": \"https://registry.npmjs.org/loose-envify/-/loose-envify-1.4.0.tgz\",\n      \"integrity\": \"sha512-lyuxPGr/Wfhrlem2CL/UcnUc1zcqKAImBDzukY7Y5F/yQiNdko6+fRLevlw1HgMySw7f611UIY408EtxRSoK3Q==\",\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"js-tokens\": \"^3.0.0 || ^4.0.0\"\n      },\n      \"bin\": {\n        \"loose-envify\": \"cli.js\"\n      }\n    },\n    \"node_modules/merge2\": {\n      \"version\": \"1.4.1\",\n      \"resolved\": \"https://registry.npmjs.org/merge2/-/merge2-1.4.1.tgz\",\n      \"integrity\": \"sha512-8q7VEgMJW4J8tcfVPy8g09NcQwZdbwFEqhe/WZkoIzjn/3TGDwtOCYtXGxA3O8tPzpczCCDgv+P2P5y00ZJOOg==\",\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"engines\": {\n        \"node\": \">= 8\"\n      }\n    },\n    \"node_modules/micromatch\": {\n      \"version\": \"4.0.8\",\n      \"resolved\": \"https://registry.npmjs.org/micromatch/-/micromatch-4.0.8.tgz\",\n      \"integrity\": \"sha512-PXwfBhYu0hBCPw8Dn0E+WDYb7af3dSLVWKi3HGv84IdF4TyFoC0ysxFd0Goxw7nSv4T/PzEJQxsYsEiFCKo2BA==\",\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"braces\": \"^3.0.3\",\n        \"picomatch\": \"^2.3.1\"\n      },\n      \"engines\": {\n        \"node\": \">=8.6\"\n      }\n    },\n    \"node_modules/mz\": {\n      \"version\": \"2.7.0\",\n      \"resolved\": \"https://registry.npmjs.org/mz/-/mz-2.7.0.tgz\",\n      \"integrity\": \"sha512-z81GNO7nnYMEhrGh9LeymoE4+Yr0Wn5McHIZMK5cfQCl+NDX08sCZgUc9/6MHni9IWuFLm1Z3HTCXu2z9fN62Q==\",\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"any-promise\": \"^1.0.0\",\n        \"object-assign\": \"^4.0.1\",\n        \"thenify-all\": \"^1.0.0\"\n      }\n    },\n    \"node_modules/nanoid\": {\n      \"version\": \"3.3.11\",\n      \"resolved\": \"https://registry.npmjs.org/nanoid/-/nanoid-3.3.11.tgz\",\n      \"integrity\": \"sha512-N8SpfPUnUp1bK+PMYW8qSWdl9U+wwNWI4QKxOYDy9JAro3WMX7p2OeVRF9v+347pnakNevPmiHhNmZ2HbFA76w==\",\n      \"funding\": [\n        {\n          \"type\": \"github\",\n          \"url\": \"https://github.com/sponsors/ai\"\n        }\n      ],\n      \"license\": \"MIT\",\n      \"bin\": {\n        \"nanoid\": \"bin/nanoid.cjs\"\n      },\n      \"engines\": {\n        \"node\": \"^10 || ^12 || ^13.7 || ^14 || >=15.0.1\"\n      }\n    },\n    \"node_modules/next\": {\n      \"version\": \"16.1.6\",\n      \"resolved\": \"https://registry.npmjs.org/next/-/next-16.1.6.tgz\",\n      \"integrity\": \"sha512-hkyRkcu5x/41KoqnROkfTm2pZVbKxvbZRuNvKXLRXxs3VfyO0WhY50TQS40EuKO9SW3rBj/sF3WbVwDACeMZyw==\",\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"@next/env\": \"16.1.6\",\n        \"@swc/helpers\": \"0.5.15\",\n        \"baseline-browser-mapping\": \"^2.8.3\",\n        \"caniuse-lite\": \"^1.0.30001579\",\n        \"postcss\": \"8.4.31\",\n        \"styled-jsx\": \"5.1.6\"\n      },\n      \"bin\": {\n        \"next\": \"dist/bin/next\"\n      },\n      \"engines\": {\n        \"node\": \">=20.9.0\"\n      },\n      \"optionalDependencies\": {\n        \"@next/swc-darwin-arm64\": \"16.1.6\",\n        \"@next/swc-darwin-x64\": \"16.1.6\",\n        \"@next/swc-linux-arm64-gnu\": \"16.1.6\",\n        \"@next/swc-linux-arm64-musl\": \"16.1.6\",\n        \"@next/swc-linux-x64-gnu\": \"16.1.6\",\n        \"@next/swc-linux-x64-musl\": \"16.1.6\",\n        \"@next/swc-win32-arm64-msvc\": \"16.1.6\",\n        \"@next/swc-win32-x64-msvc\": \"16.1.6\",\n        \"sharp\": \"^0.34.4\"\n      },\n      \"peerDependencies\": {\n        \"@opentelemetry/api\": \"^1.1.0\",\n        \"@playwright/test\": \"^1.51.1\",\n        \"babel-plugin-react-compiler\": \"*\",\n        \"react\": \"^18.2.0 || 19.0.0-rc-de68d2f4-20241204 || ^19.0.0\",\n        \"react-dom\": \"^18.2.0 || 19.0.0-rc-de68d2f4-20241204 || ^19.0.0\",\n        \"sass\": \"^1.3.0\"\n      },\n      \"peerDependenciesMeta\": {\n        \"@opentelemetry/api\": {\n          \"optional\": true\n        },\n        \"@playwright/test\": {\n          \"optional\": true\n        },\n        \"babel-plugin-react-compiler\": {\n          \"optional\": true\n        },\n        \"sass\": {\n          \"optional\": true\n        }\n      }\n    },\n    \"node_modules/next/node_modules/postcss\": {\n      \"version\": \"8.4.31\",\n      \"resolved\": \"https://registry.npmjs.org/postcss/-/postcss-8.4.31.tgz\",\n      \"integrity\": \"sha512-PS08Iboia9mts/2ygV3eLpY5ghnUcfLV/EXTOW1E2qYxJKGGBUtNjN76FYHnMs36RmARn41bC0AZmn+rR0OVpQ==\",\n      \"funding\": [\n        {\n          \"type\": \"opencollective\",\n          \"url\": \"https://opencollective.com/postcss/\"\n        },\n        {\n          \"type\": \"tidelift\",\n          \"url\": \"https://tidelift.com/funding/github/npm/postcss\"\n        },\n        {\n          \"type\": \"github\",\n          \"url\": \"https://github.com/sponsors/ai\"\n        }\n      ],\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"nanoid\": \"^3.3.6\",\n        \"picocolors\": \"^1.0.0\",\n        \"source-map-js\": \"^1.0.2\"\n      },\n      \"engines\": {\n        \"node\": \"^10 || ^12 || >=14\"\n      }\n    },\n    \"node_modules/node-releases\": {\n      \"version\": \"2.0.27\",\n      \"resolved\": \"https://registry.npmjs.org/node-releases/-/node-releases-2.0.27.tgz\",\n      \"integrity\": \"sha512-nmh3lCkYZ3grZvqcCH+fjmQ7X+H0OeZgP40OierEaAptX4XofMh5kwNbWh7lBduUzCcV/8kZ+NDLCwm2iorIlA==\",\n      \"dev\": true,\n      \"license\": \"MIT\"\n    },\n    \"node_modules/normalize-path\": {\n      \"version\": \"3.0.0\",\n      \"resolved\": \"https://registry.npmjs.org/normalize-path/-/normalize-path-3.0.0.tgz\",\n      \"integrity\": \"sha512-6eZs5Ls3WtCisHWp9S2GUy8dqkpGi4BVSz3GaqiE6ezub0512ESztXUwUB6C6IKbQkY2Pnb/mD4WYojCRwcwLA==\",\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"engines\": {\n        \"node\": \">=0.10.0\"\n      }\n    },\n    \"node_modules/object-assign\": {\n      \"version\": \"4.1.1\",\n      \"resolved\": \"https://registry.npmjs.org/object-assign/-/object-assign-4.1.1.tgz\",\n      \"integrity\": \"sha512-rJgTQnkUnH1sFw8yT6VSU3zD3sWmu6sZhIseY8VX+GRu3P6F7Fu+JNDoXfklElbLJSnc3FUQHVe4cU5hj+BcUg==\",\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"engines\": {\n        \"node\": \">=0.10.0\"\n      }\n    },\n    \"node_modules/object-hash\": {\n      \"version\": \"3.0.0\",\n      \"resolved\": \"https://registry.npmjs.org/object-hash/-/object-hash-3.0.0.tgz\",\n      \"integrity\": \"sha512-RSn9F68PjH9HqtltsSnqYC1XXoWe9Bju5+213R98cNGttag9q9yAOTzdbsqvIa7aNm5WffBZFpWYr2aWrklWAw==\",\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"engines\": {\n        \"node\": \">= 6\"\n      }\n    },\n    \"node_modules/path-parse\": {\n      \"version\": \"1.0.7\",\n      \"resolved\": \"https://registry.npmjs.org/path-parse/-/path-parse-1.0.7.tgz\",\n      \"integrity\": \"sha512-LDJzPVEEEPR+y48z93A0Ed0yXb8pAByGWo/k5YYdYgpY2/2EsOsksJrq7lOHxryrVOn1ejG6oAp8ahvOIQD8sw==\",\n      \"dev\": true,\n      \"license\": \"MIT\"\n    },\n    \"node_modules/picocolors\": {\n      \"version\": \"1.1.1\",\n      \"resolved\": \"https://registry.npmjs.org/picocolors/-/picocolors-1.1.1.tgz\",\n      \"integrity\": \"sha512-xceH2snhtb5M9liqDsmEw56le376mTZkEX/jEb/RxNFyegNul7eNslCXP9FDj/Lcu0X8KEyMceP2ntpaHrDEVA==\",\n      \"license\": \"ISC\"\n    },\n    \"node_modules/picomatch\": {\n      \"version\": \"2.3.1\",\n      \"resolved\": \"https://registry.npmjs.org/picomatch/-/picomatch-2.3.1.tgz\",\n      \"integrity\": \"sha512-JU3teHTNjmE2VCGFzuY8EXzCDVwEqB2a8fsIvwaStHhAWJEeVd1o1QD80CU6+ZdEXXSLbSsuLwJjkCBWqRQUVA==\",\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"engines\": {\n        \"node\": \">=8.6\"\n      },\n      \"funding\": {\n        \"url\": \"https://github.com/sponsors/jonschlinkert\"\n      }\n    },\n    \"node_modules/pify\": {\n      \"version\": \"2.3.0\",\n      \"resolved\": \"https://registry.npmjs.org/pify/-/pify-2.3.0.tgz\",\n      \"integrity\": \"sha512-udgsAY+fTnvv7kI7aaxbqwWNb0AHiB0qBO89PZKPkoTmGOgdbrHDKD+0B2X4uTfJ/FT1R09r9gTsjUjNJotuog==\",\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"engines\": {\n        \"node\": \">=0.10.0\"\n      }\n    },\n    \"node_modules/pirates\": {\n      \"version\": \"4.0.7\",\n      \"resolved\": \"https://registry.npmjs.org/pirates/-/pirates-4.0.7.tgz\",\n      \"integrity\": \"sha512-TfySrs/5nm8fQJDcBDuUng3VOUKsd7S+zqvbOTiGXHfxX4wK31ard+hoNuvkicM/2YFzlpDgABOevKSsB4G/FA==\",\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"engines\": {\n        \"node\": \">= 6\"\n      }\n    },\n    \"node_modules/postcss\": {\n      \"version\": \"8.5.6\",\n      \"resolved\": \"https://registry.npmjs.org/postcss/-/postcss-8.5.6.tgz\",\n      \"integrity\": \"sha512-3Ybi1tAuwAP9s0r1UQ2J4n5Y0G05bJkpUIO0/bI9MhwmD70S5aTWbXGBwxHrelT+XM1k6dM0pk+SwNkpTRN7Pg==\",\n      \"dev\": true,\n      \"funding\": [\n        {\n          \"type\": \"opencollective\",\n          \"url\": \"https://opencollective.com/postcss/\"\n        },\n        {\n          \"type\": \"tidelift\",\n          \"url\": \"https://tidelift.com/funding/github/npm/postcss\"\n        },\n        {\n          \"type\": \"github\",\n          \"url\": \"https://github.com/sponsors/ai\"\n        }\n      ],\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"nanoid\": \"^3.3.11\",\n        \"picocolors\": \"^1.1.1\",\n        \"source-map-js\": \"^1.2.1\"\n      },\n      \"engines\": {\n        \"node\": \"^10 || ^12 || >=14\"\n      }\n    },\n    \"node_modules/postcss-import\": {\n      \"version\": \"15.1.0\",\n      \"resolved\": \"https://registry.npmjs.org/postcss-import/-/postcss-import-15.1.0.tgz\",\n      \"integrity\": \"sha512-hpr+J05B2FVYUAXHeK1YyI267J/dDDhMU6B6civm8hSY1jYJnBXxzKDKDswzJmtLHryrjhnDjqqp/49t8FALew==\",\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"postcss-value-parser\": \"^4.0.0\",\n        \"read-cache\": \"^1.0.0\",\n        \"resolve\": \"^1.1.7\"\n      },\n      \"engines\": {\n        \"node\": \">=14.0.0\"\n      },\n      \"peerDependencies\": {\n        \"postcss\": \"^8.0.0\"\n      }\n    },\n    \"node_modules/postcss-js\": {\n      \"version\": \"4.1.0\",\n      \"resolved\": \"https://registry.npmjs.org/postcss-js/-/postcss-js-4.1.0.tgz\",\n      \"integrity\": \"sha512-oIAOTqgIo7q2EOwbhb8UalYePMvYoIeRY2YKntdpFQXNosSu3vLrniGgmH9OKs/qAkfoj5oB3le/7mINW1LCfw==\",\n      \"dev\": true,\n      \"funding\": [\n        {\n          \"type\": \"opencollective\",\n          \"url\": \"https://opencollective.com/postcss/\"\n        },\n        {\n          \"type\": \"github\",\n          \"url\": \"https://github.com/sponsors/ai\"\n        }\n      ],\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"camelcase-css\": \"^2.0.1\"\n      },\n      \"engines\": {\n        \"node\": \"^12 || ^14 || >= 16\"\n      },\n      \"peerDependencies\": {\n        \"postcss\": \"^8.4.21\"\n      }\n    },\n    \"node_modules/postcss-load-config\": {\n      \"version\": \"6.0.1\",\n      \"resolved\": \"https://registry.npmjs.org/postcss-load-config/-/postcss-load-config-6.0.1.tgz\",\n      \"integrity\": \"sha512-oPtTM4oerL+UXmx+93ytZVN82RrlY/wPUV8IeDxFrzIjXOLF1pN+EmKPLbubvKHT2HC20xXsCAH2Z+CKV6Oz/g==\",\n      \"dev\": true,\n      \"funding\": [\n        {\n          \"type\": \"opencollective\",\n          \"url\": \"https://opencollective.com/postcss/\"\n        },\n        {\n          \"type\": \"github\",\n          \"url\": \"https://github.com/sponsors/ai\"\n        }\n      ],\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"lilconfig\": \"^3.1.1\"\n      },\n      \"engines\": {\n        \"node\": \">= 18\"\n      },\n      \"peerDependencies\": {\n        \"jiti\": \">=1.21.0\",\n        \"postcss\": \">=8.0.9\",\n        \"tsx\": \"^4.8.1\",\n        \"yaml\": \"^2.4.2\"\n      },\n      \"peerDependenciesMeta\": {\n        \"jiti\": {\n          \"optional\": true\n        },\n        \"postcss\": {\n          \"optional\": true\n        },\n        \"tsx\": {\n          \"optional\": true\n        },\n        \"yaml\": {\n          \"optional\": true\n        }\n      }\n    },\n    \"node_modules/postcss-nested\": {\n      \"version\": \"6.2.0\",\n      \"resolved\": \"https://registry.npmjs.org/postcss-nested/-/postcss-nested-6.2.0.tgz\",\n      \"integrity\": \"sha512-HQbt28KulC5AJzG+cZtj9kvKB93CFCdLvog1WFLf1D+xmMvPGlBstkpTEZfK5+AN9hfJocyBFCNiqyS48bpgzQ==\",\n      \"dev\": true,\n      \"funding\": [\n        {\n          \"type\": \"opencollective\",\n          \"url\": \"https://opencollective.com/postcss/\"\n        },\n        {\n          \"type\": \"github\",\n          \"url\": \"https://github.com/sponsors/ai\"\n        }\n      ],\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"postcss-selector-parser\": \"^6.1.1\"\n      },\n      \"engines\": {\n        \"node\": \">=12.0\"\n      },\n      \"peerDependencies\": {\n        \"postcss\": \"^8.2.14\"\n      }\n    },\n    \"node_modules/postcss-selector-parser\": {\n      \"version\": \"6.1.2\",\n      \"resolved\": \"https://registry.npmjs.org/postcss-selector-parser/-/postcss-selector-parser-6.1.2.tgz\",\n      \"integrity\": \"sha512-Q8qQfPiZ+THO/3ZrOrO0cJJKfpYCagtMUkXbnEfmgUjwXg6z/WBeOyS9APBBPCTSiDV+s4SwQGu8yFsiMRIudg==\",\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"cssesc\": \"^3.0.0\",\n        \"util-deprecate\": \"^1.0.2\"\n      },\n      \"engines\": {\n        \"node\": \">=4\"\n      }\n    },\n    \"node_modules/postcss-value-parser\": {\n      \"version\": \"4.2.0\",\n      \"resolved\": \"https://registry.npmjs.org/postcss-value-parser/-/postcss-value-parser-4.2.0.tgz\",\n      \"integrity\": \"sha512-1NNCs6uurfkVbeXG4S8JFT9t19m45ICnif8zWLd5oPSZ50QnwMfK+H3jv408d4jw/7Bttv5axS5IiHoLaVNHeQ==\",\n      \"dev\": true,\n      \"license\": \"MIT\"\n    },\n    \"node_modules/queue-microtask\": {\n      \"version\": \"1.2.3\",\n      \"resolved\": \"https://registry.npmjs.org/queue-microtask/-/queue-microtask-1.2.3.tgz\",\n      \"integrity\": \"sha512-NuaNSa6flKT5JaSYQzJok04JzTL1CA6aGhv5rfLW3PgqA+M2ChpZQnAC8h8i4ZFkBS8X5RqkDBHA7r4hej3K9A==\",\n      \"dev\": true,\n      \"funding\": [\n        {\n          \"type\": \"github\",\n          \"url\": \"https://github.com/sponsors/feross\"\n        },\n        {\n          \"type\": \"patreon\",\n          \"url\": \"https://www.patreon.com/feross\"\n        },\n        {\n          \"type\": \"consulting\",\n          \"url\": \"https://feross.org/support\"\n        }\n      ],\n      \"license\": \"MIT\"\n    },\n    \"node_modules/react\": {\n      \"version\": \"18.3.1\",\n      \"resolved\": \"https://registry.npmjs.org/react/-/react-18.3.1.tgz\",\n      \"integrity\": \"sha512-wS+hAgJShR0KhEvPJArfuPVN1+Hz1t0Y6n5jLrGQbkb4urgPE/0Rve+1kMB1v/oWgHgm4WIcV+i7F2pTVj+2iQ==\",\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"loose-envify\": \"^1.1.0\"\n      },\n      \"engines\": {\n        \"node\": \">=0.10.0\"\n      }\n    },\n    \"node_modules/react-dom\": {\n      \"version\": \"18.3.1\",\n      \"resolved\": \"https://registry.npmjs.org/react-dom/-/react-dom-18.3.1.tgz\",\n      \"integrity\": \"sha512-5m4nQKp+rZRb09LNH59GM4BxTh9251/ylbKIbpe7TpGxfJ+9kv6BLkLBXIjjspbgbnIBNqlI23tRnTWT0snUIw==\",\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"loose-envify\": \"^1.1.0\",\n        \"scheduler\": \"^0.23.2\"\n      },\n      \"peerDependencies\": {\n        \"react\": \"^18.3.1\"\n      }\n    },\n    \"node_modules/read-cache\": {\n      \"version\": \"1.0.0\",\n      \"resolved\": \"https://registry.npmjs.org/read-cache/-/read-cache-1.0.0.tgz\",\n      \"integrity\": \"sha512-Owdv/Ft7IjOgm/i0xvNDZ1LrRANRfew4b2prF3OWMQLxLfu3bS8FVhCsrSCMK4lR56Y9ya+AThoTpDCTxCmpRA==\",\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"pify\": \"^2.3.0\"\n      }\n    },\n    \"node_modules/readdirp\": {\n      \"version\": \"3.6.0\",\n      \"resolved\": \"https://registry.npmjs.org/readdirp/-/readdirp-3.6.0.tgz\",\n      \"integrity\": \"sha512-hOS089on8RduqdbhvQ5Z37A0ESjsqz6qnRcffsMU3495FuTdqSm+7bhJ29JvIOsBDEEnan5DPu9t3To9VRlMzA==\",\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"picomatch\": \"^2.2.1\"\n      },\n      \"engines\": {\n        \"node\": \">=8.10.0\"\n      }\n    },\n    \"node_modules/resolve\": {\n      \"version\": \"1.22.11\",\n      \"resolved\": \"https://registry.npmjs.org/resolve/-/resolve-1.22.11.tgz\",\n      \"integrity\": \"sha512-RfqAvLnMl313r7c9oclB1HhUEAezcpLjz95wFH4LVuhk9JF/r22qmVP9AMmOU4vMX7Q8pN8jwNg/CSpdFnMjTQ==\",\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"is-core-module\": \"^2.16.1\",\n        \"path-parse\": \"^1.0.7\",\n        \"supports-preserve-symlinks-flag\": \"^1.0.0\"\n      },\n      \"bin\": {\n        \"resolve\": \"bin/resolve\"\n      },\n      \"engines\": {\n        \"node\": \">= 0.4\"\n      },\n      \"funding\": {\n        \"url\": \"https://github.com/sponsors/ljharb\"\n      }\n    },\n    \"node_modules/reusify\": {\n      \"version\": \"1.1.0\",\n      \"resolved\": \"https://registry.npmjs.org/reusify/-/reusify-1.1.0.tgz\",\n      \"integrity\": \"sha512-g6QUff04oZpHs0eG5p83rFLhHeV00ug/Yf9nZM6fLeUrPguBTkTQOdpAWWspMh55TZfVQDPaN3NQJfbVRAxdIw==\",\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"engines\": {\n        \"iojs\": \">=1.0.0\",\n        \"node\": \">=0.10.0\"\n      }\n    },\n    \"node_modules/run-parallel\": {\n      \"version\": \"1.2.0\",\n      \"resolved\": \"https://registry.npmjs.org/run-parallel/-/run-parallel-1.2.0.tgz\",\n      \"integrity\": \"sha512-5l4VyZR86LZ/lDxZTR6jqL8AFE2S0IFLMP26AbjsLVADxHdhB/c0GUsH+y39UfCi3dzz8OlQuPmnaJOMoDHQBA==\",\n      \"dev\": true,\n      \"funding\": [\n        {\n          \"type\": \"github\",\n          \"url\": \"https://github.com/sponsors/feross\"\n        },\n        {\n          \"type\": \"patreon\",\n          \"url\": \"https://www.patreon.com/feross\"\n        },\n        {\n          \"type\": \"consulting\",\n          \"url\": \"https://feross.org/support\"\n        }\n      ],\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"queue-microtask\": \"^1.2.2\"\n      }\n    },\n    \"node_modules/scheduler\": {\n      \"version\": \"0.23.2\",\n      \"resolved\": \"https://registry.npmjs.org/scheduler/-/scheduler-0.23.2.tgz\",\n      \"integrity\": \"sha512-UOShsPwz7NrMUqhR6t0hWjFduvOzbtv7toDH1/hIrfRNIDBnnBWd0CwJTGvTpngVlmwGCdP9/Zl/tVrDqcuYzQ==\",\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"loose-envify\": \"^1.1.0\"\n      }\n    },\n    \"node_modules/semver\": {\n      \"version\": \"7.7.4\",\n      \"resolved\": \"https://registry.npmjs.org/semver/-/semver-7.7.4.tgz\",\n      \"integrity\": \"sha512-vFKC2IEtQnVhpT78h1Yp8wzwrf8CM+MzKMHGJZfBtzhZNycRFnXsHk6E5TxIkkMsgNS7mdX3AGB7x2QM2di4lA==\",\n      \"license\": \"ISC\",\n      \"optional\": true,\n      \"bin\": {\n        \"semver\": \"bin/semver.js\"\n      },\n      \"engines\": {\n        \"node\": \">=10\"\n      }\n    },\n    \"node_modules/sharp\": {\n      \"version\": \"0.34.5\",\n      \"resolved\": \"https://registry.npmjs.org/sharp/-/sharp-0.34.5.tgz\",\n      \"integrity\": \"sha512-Ou9I5Ft9WNcCbXrU9cMgPBcCK8LiwLqcbywW3t4oDV37n1pzpuNLsYiAV8eODnjbtQlSDwZ2cUEeQz4E54Hltg==\",\n      \"hasInstallScript\": true,\n      \"license\": \"Apache-2.0\",\n      \"optional\": true,\n      \"dependencies\": {\n        \"@img/colour\": \"^1.0.0\",\n        \"detect-libc\": \"^2.1.2\",\n        \"semver\": \"^7.7.3\"\n      },\n      \"engines\": {\n        \"node\": \"^18.17.0 || ^20.3.0 || >=21.0.0\"\n      },\n      \"funding\": {\n        \"url\": \"https://opencollective.com/libvips\"\n      },\n      \"optionalDependencies\": {\n        \"@img/sharp-darwin-arm64\": \"0.34.5\",\n        \"@img/sharp-darwin-x64\": \"0.34.5\",\n        \"@img/sharp-libvips-darwin-arm64\": \"1.2.4\",\n        \"@img/sharp-libvips-darwin-x64\": \"1.2.4\",\n        \"@img/sharp-libvips-linux-arm\": \"1.2.4\",\n        \"@img/sharp-libvips-linux-arm64\": \"1.2.4\",\n        \"@img/sharp-libvips-linux-ppc64\": \"1.2.4\",\n        \"@img/sharp-libvips-linux-riscv64\": \"1.2.4\",\n        \"@img/sharp-libvips-linux-s390x\": \"1.2.4\",\n        \"@img/sharp-libvips-linux-x64\": \"1.2.4\",\n        \"@img/sharp-libvips-linuxmusl-arm64\": \"1.2.4\",\n        \"@img/sharp-libvips-linuxmusl-x64\": \"1.2.4\",\n        \"@img/sharp-linux-arm\": \"0.34.5\",\n        \"@img/sharp-linux-arm64\": \"0.34.5\",\n        \"@img/sharp-linux-ppc64\": \"0.34.5\",\n        \"@img/sharp-linux-riscv64\": \"0.34.5\",\n        \"@img/sharp-linux-s390x\": \"0.34.5\",\n        \"@img/sharp-linux-x64\": \"0.34.5\",\n        \"@img/sharp-linuxmusl-arm64\": \"0.34.5\",\n        \"@img/sharp-linuxmusl-x64\": \"0.34.5\",\n        \"@img/sharp-wasm32\": \"0.34.5\",\n        \"@img/sharp-win32-arm64\": \"0.34.5\",\n        \"@img/sharp-win32-ia32\": \"0.34.5\",\n        \"@img/sharp-win32-x64\": \"0.34.5\"\n      }\n    },\n    \"node_modules/source-map-js\": {\n      \"version\": \"1.2.1\",\n      \"resolved\": \"https://registry.npmjs.org/source-map-js/-/source-map-js-1.2.1.tgz\",\n      \"integrity\": \"sha512-UXWMKhLOwVKb728IUtQPXxfYU+usdybtUrK/8uGE8CQMvrhOpwvzDBwj0QhSL7MQc7vIsISBG8VQ8+IDQxpfQA==\",\n      \"license\": \"BSD-3-Clause\",\n      \"engines\": {\n        \"node\": \">=0.10.0\"\n      }\n    },\n    \"node_modules/styled-jsx\": {\n      \"version\": \"5.1.6\",\n      \"resolved\": \"https://registry.npmjs.org/styled-jsx/-/styled-jsx-5.1.6.tgz\",\n      \"integrity\": \"sha512-qSVyDTeMotdvQYoHWLNGwRFJHC+i+ZvdBRYosOFgC+Wg1vx4frN2/RG/NA7SYqqvKNLf39P2LSRA2pu6n0XYZA==\",\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"client-only\": \"0.0.1\"\n      },\n      \"engines\": {\n        \"node\": \">= 12.0.0\"\n      },\n      \"peerDependencies\": {\n        \"react\": \">= 16.8.0 || 17.x.x || ^18.0.0-0 || ^19.0.0-0\"\n      },\n      \"peerDependenciesMeta\": {\n        \"@babel/core\": {\n          \"optional\": true\n        },\n        \"babel-plugin-macros\": {\n          \"optional\": true\n        }\n      }\n    },\n    \"node_modules/sucrase\": {\n      \"version\": \"3.35.1\",\n      \"resolved\": \"https://registry.npmjs.org/sucrase/-/sucrase-3.35.1.tgz\",\n      \"integrity\": \"sha512-DhuTmvZWux4H1UOnWMB3sk0sbaCVOoQZjv8u1rDoTV0HTdGem9hkAZtl4JZy8P2z4Bg0nT+YMeOFyVr4zcG5Tw==\",\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"@jridgewell/gen-mapping\": \"^0.3.2\",\n        \"commander\": \"^4.0.0\",\n        \"lines-and-columns\": \"^1.1.6\",\n        \"mz\": \"^2.7.0\",\n        \"pirates\": \"^4.0.1\",\n        \"tinyglobby\": \"^0.2.11\",\n        \"ts-interface-checker\": \"^0.1.9\"\n      },\n      \"bin\": {\n        \"sucrase\": \"bin/sucrase\",\n        \"sucrase-node\": \"bin/sucrase-node\"\n      },\n      \"engines\": {\n        \"node\": \">=16 || 14 >=14.17\"\n      }\n    },\n    \"node_modules/supports-preserve-symlinks-flag\": {\n      \"version\": \"1.0.0\",\n      \"resolved\": \"https://registry.npmjs.org/supports-preserve-symlinks-flag/-/supports-preserve-symlinks-flag-1.0.0.tgz\",\n      \"integrity\": \"sha512-ot0WnXS9fgdkgIcePe6RHNk1WA8+muPa6cSjeR3V8K27q9BB1rTE3R1p7Hv0z1ZyAc8s6Vvv8DIyWf681MAt0w==\",\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"engines\": {\n        \"node\": \">= 0.4\"\n      },\n      \"funding\": {\n        \"url\": \"https://github.com/sponsors/ljharb\"\n      }\n    },\n    \"node_modules/tailwindcss\": {\n      \"version\": \"3.4.19\",\n      \"resolved\": \"https://registry.npmjs.org/tailwindcss/-/tailwindcss-3.4.19.tgz\",\n      \"integrity\": \"sha512-3ofp+LL8E+pK/JuPLPggVAIaEuhvIz4qNcf3nA1Xn2o/7fb7s/TYpHhwGDv1ZU3PkBluUVaF8PyCHcm48cKLWQ==\",\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"@alloc/quick-lru\": \"^5.2.0\",\n        \"arg\": \"^5.0.2\",\n        \"chokidar\": \"^3.6.0\",\n        \"didyoumean\": \"^1.2.2\",\n        \"dlv\": \"^1.1.3\",\n        \"fast-glob\": \"^3.3.2\",\n        \"glob-parent\": \"^6.0.2\",\n        \"is-glob\": \"^4.0.3\",\n        \"jiti\": \"^1.21.7\",\n        \"lilconfig\": \"^3.1.3\",\n        \"micromatch\": \"^4.0.8\",\n        \"normalize-path\": \"^3.0.0\",\n        \"object-hash\": \"^3.0.0\",\n        \"picocolors\": \"^1.1.1\",\n        \"postcss\": \"^8.4.47\",\n        \"postcss-import\": \"^15.1.0\",\n        \"postcss-js\": \"^4.0.1\",\n        \"postcss-load-config\": \"^4.0.2 || ^5.0 || ^6.0\",\n        \"postcss-nested\": \"^6.2.0\",\n        \"postcss-selector-parser\": \"^6.1.2\",\n        \"resolve\": \"^1.22.8\",\n        \"sucrase\": \"^3.35.0\"\n      },\n      \"bin\": {\n        \"tailwind\": \"lib/cli.js\",\n        \"tailwindcss\": \"lib/cli.js\"\n      },\n      \"engines\": {\n        \"node\": \">=14.0.0\"\n      }\n    },\n    \"node_modules/thenify\": {\n      \"version\": \"3.3.1\",\n      \"resolved\": \"https://registry.npmjs.org/thenify/-/thenify-3.3.1.tgz\",\n      \"integrity\": \"sha512-RVZSIV5IG10Hk3enotrhvz0T9em6cyHBLkH/YAZuKqd8hRkKhSfCGIcP2KUY0EPxndzANBmNllzWPwak+bheSw==\",\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"any-promise\": \"^1.0.0\"\n      }\n    },\n    \"node_modules/thenify-all\": {\n      \"version\": \"1.6.0\",\n      \"resolved\": \"https://registry.npmjs.org/thenify-all/-/thenify-all-1.6.0.tgz\",\n      \"integrity\": \"sha512-RNxQH/qI8/t3thXJDwcstUO4zeqo64+Uy/+sNVRBx4Xn2OX+OZ9oP+iJnNFqplFra2ZUVeKCSa2oVWi3T4uVmA==\",\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"thenify\": \">= 3.1.0 < 4\"\n      },\n      \"engines\": {\n        \"node\": \">=0.8\"\n      }\n    },\n    \"node_modules/tinyglobby\": {\n      \"version\": \"0.2.15\",\n      \"resolved\": \"https://registry.npmjs.org/tinyglobby/-/tinyglobby-0.2.15.tgz\",\n      \"integrity\": \"sha512-j2Zq4NyQYG5XMST4cbs02Ak8iJUdxRM0XI5QyxXuZOzKOINmWurp3smXu3y5wDcJrptwpSjgXHzIQxR0omXljQ==\",\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"fdir\": \"^6.5.0\",\n        \"picomatch\": \"^4.0.3\"\n      },\n      \"engines\": {\n        \"node\": \">=12.0.0\"\n      },\n      \"funding\": {\n        \"url\": \"https://github.com/sponsors/SuperchupuDev\"\n      }\n    },\n    \"node_modules/tinyglobby/node_modules/fdir\": {\n      \"version\": \"6.5.0\",\n      \"resolved\": \"https://registry.npmjs.org/fdir/-/fdir-6.5.0.tgz\",\n      \"integrity\": \"sha512-tIbYtZbucOs0BRGqPJkshJUYdL+SDH7dVM8gjy+ERp3WAUjLEFJE+02kanyHtwjWOnwrKYBiwAmM0p4kLJAnXg==\",\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"engines\": {\n        \"node\": \">=12.0.0\"\n      },\n      \"peerDependencies\": {\n        \"picomatch\": \"^3 || ^4\"\n      },\n      \"peerDependenciesMeta\": {\n        \"picomatch\": {\n          \"optional\": true\n        }\n      }\n    },\n    \"node_modules/tinyglobby/node_modules/picomatch\": {\n      \"version\": \"4.0.3\",\n      \"resolved\": \"https://registry.npmjs.org/picomatch/-/picomatch-4.0.3.tgz\",\n      \"integrity\": \"sha512-5gTmgEY/sqK6gFXLIsQNH19lWb4ebPDLA4SdLP7dsWkIXHWlG66oPuVvXSGFPppYZz8ZDZq0dYYrbHfBCVUb1Q==\",\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"engines\": {\n        \"node\": \">=12\"\n      },\n      \"funding\": {\n        \"url\": \"https://github.com/sponsors/jonschlinkert\"\n      }\n    },\n    \"node_modules/to-regex-range\": {\n      \"version\": \"5.0.1\",\n      \"resolved\": \"https://registry.npmjs.org/to-regex-range/-/to-regex-range-5.0.1.tgz\",\n      \"integrity\": \"sha512-65P7iz6X5yEr1cwcgvQxbbIw7Uk3gOy5dIdtZ4rDveLqhrdJP+Li/Hx6tyK0NEb+2GCyneCMJiGqrADCSNk8sQ==\",\n      \"dev\": true,\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"is-number\": \"^7.0.0\"\n      },\n      \"engines\": {\n        \"node\": \">=8.0\"\n      }\n    },\n    \"node_modules/ts-interface-checker\": {\n      \"version\": \"0.1.13\",\n      \"resolved\": \"https://registry.npmjs.org/ts-interface-checker/-/ts-interface-checker-0.1.13.tgz\",\n      \"integrity\": \"sha512-Y/arvbn+rrz3JCKl9C4kVNfTfSm2/mEp5FSz5EsZSANGPSlQrpRI5M4PKF+mJnE52jOO90PnPSc3Ur3bTQw0gA==\",\n      \"dev\": true,\n      \"license\": \"Apache-2.0\"\n    },\n    \"node_modules/tslib\": {\n      \"version\": \"2.8.1\",\n      \"resolved\": \"https://registry.npmjs.org/tslib/-/tslib-2.8.1.tgz\",\n      \"integrity\": \"sha512-oJFu94HQb+KVduSUQL7wnpmqnfmLsOA/nAh6b6EH0wCEoK0/mPeXU6c3wKDV83MkOuHPRHtSXKKU99IBazS/2w==\",\n      \"license\": \"0BSD\"\n    },\n    \"node_modules/typescript\": {\n      \"version\": \"5.9.3\",\n      \"resolved\": \"https://registry.npmjs.org/typescript/-/typescript-5.9.3.tgz\",\n      \"integrity\": \"sha512-jl1vZzPDinLr9eUt3J/t7V6FgNEw9QjvBPdysz9KfQDD41fQrC2Y4vKQdiaUpFT4bXlb1RHhLpp8wtm6M5TgSw==\",\n      \"dev\": true,\n      \"license\": \"Apache-2.0\",\n      \"bin\": {\n        \"tsc\": \"bin/tsc\",\n        \"tsserver\": \"bin/tsserver\"\n      },\n      \"engines\": {\n        \"node\": \">=14.17\"\n      }\n    },\n    \"node_modules/uncrypto\": {\n      \"version\": \"0.1.3\",\n      \"resolved\": \"https://registry.npmjs.org/uncrypto/-/uncrypto-0.1.3.tgz\",\n      \"integrity\": \"sha512-Ql87qFHB3s/De2ClA9e0gsnS6zXG27SkTiSJwjCc9MebbfapQfuPzumMIUMi38ezPZVNFcHI9sUIepeQfw8J8Q==\",\n      \"license\": \"MIT\"\n    },\n    \"node_modules/undici-types\": {\n      \"version\": \"6.21.0\",\n      \"resolved\": \"https://registry.npmjs.org/undici-types/-/undici-types-6.21.0.tgz\",\n      \"integrity\": \"sha512-iwDZqg0QAGrg9Rav5H4n0M64c3mkR59cJ6wQp+7C4nI0gsmExaedaYLNO44eT4AtBBwjbTiGPMlt2Md0T9H9JQ==\",\n      \"dev\": true,\n      \"license\": \"MIT\"\n    },\n    \"node_modules/update-browserslist-db\": {\n      \"version\": \"1.2.3\",\n      \"resolved\": \"https://registry.npmjs.org/update-browserslist-db/-/update-browserslist-db-1.2.3.tgz\",\n      \"integrity\": \"sha512-Js0m9cx+qOgDxo0eMiFGEueWztz+d4+M3rGlmKPT+T4IS/jP4ylw3Nwpu6cpTTP8R1MAC1kF4VbdLt3ARf209w==\",\n      \"dev\": true,\n      \"funding\": [\n        {\n          \"type\": \"opencollective\",\n          \"url\": \"https://opencollective.com/browserslist\"\n        },\n        {\n          \"type\": \"tidelift\",\n          \"url\": \"https://tidelift.com/funding/github/npm/browserslist\"\n        },\n        {\n          \"type\": \"github\",\n          \"url\": \"https://github.com/sponsors/ai\"\n        }\n      ],\n      \"license\": \"MIT\",\n      \"dependencies\": {\n        \"escalade\": \"^3.2.0\",\n        \"picocolors\": \"^1.1.1\"\n      },\n      \"bin\": {\n        \"update-browserslist-db\": \"cli.js\"\n      },\n      \"peerDependencies\": {\n        \"browserslist\": \">= 4.21.0\"\n      }\n    },\n    \"node_modules/util-deprecate\": {\n      \"version\": \"1.0.2\",\n      \"resolved\": \"https://registry.npmjs.org/util-deprecate/-/util-deprecate-1.0.2.tgz\",\n      \"integrity\": \"sha512-EPD5q1uXyFxJpCrLnCc1nHnq3gOa6DZBocAIiI2TaSCA7VCJ1UJDMagCzIkXNsUYfD1daK//LTEQ8xiIbrHtcw==\",\n      \"dev\": true,\n      \"license\": \"MIT\"\n    }\n  }\n}\n",
      "inactive/frontend/package.json": "{\n  \"name\": \"jcode-frontend\",\n  \"version\": \"0.5.3\",\n  \"private\": true,\n  \"scripts\": {\n    \"dev\": \"next dev\",\n    \"build\": \"next build\",\n    \"start\": \"next start\",\n    \"lint\": \"next lint\"\n  },\n  \"dependencies\": {\n    \"@vercel/kv\": \"^2.0.0\",\n    \"next\": \"^16.1.6\",\n    \"react\": \"^18.2.0\",\n    \"react-dom\": \"^18.2.0\"\n  },\n  \"devDependencies\": {\n    \"@types/node\": \"^20.11.0\",\n    \"@types/react\": \"^18.2.48\",\n    \"@types/react-dom\": \"^18.2.18\",\n    \"autoprefixer\": \"^10.4.17\",\n    \"postcss\": \"^8.4.33\",\n    \"tailwindcss\": \"^3.4.1\",\n    \"typescript\": \"^5.3.3\"\n  }\n}\n",
      "inactive/frontend/postcss.config.js": "module.exports = {\n  plugins: {\n    tailwindcss: {},\n    autoprefixer: {},\n  },\n}\n",
      "inactive/frontend/tailwind.config.ts": "import type { Config } from 'tailwindcss'\n\nconst config: Config = {\n  content: [\n    './pages/**/*.{js,ts,jsx,tsx,mdx}',\n    './components/**/*.{js,ts,jsx,tsx,mdx}',\n    './app/**/*.{js,ts,jsx,tsx,mdx}',\n  ],\n  darkMode: 'class',\n  theme: {\n    extend: {\n      colors: {\n        primary: {\n          DEFAULT: '#667eea',\n          dark: '#764ba2',\n        },\n        accent: {\n          DEFAULT: '#f093fb',\n          light: '#ffd6a5',\n        },\n      },\n    },\n  },\n  plugins: [],\n}\nexport default config\n",
      "inactive/frontend/tsconfig.json": "{\n  \"compilerOptions\": {\n    \"target\": \"ES2017\",\n    \"lib\": [\n      \"dom\",\n      \"dom.iterable\",\n      \"esnext\"\n    ],\n    \"allowJs\": true,\n    \"skipLibCheck\": true,\n    \"strict\": true,\n    \"noEmit\": true,\n    \"esModuleInterop\": true,\n    \"module\": \"esnext\",\n    \"moduleResolution\": \"bundler\",\n    \"resolveJsonModule\": true,\n    \"isolatedModules\": true,\n    \"jsx\": \"react-jsx\",\n    \"incremental\": true,\n    \"plugins\": [\n      {\n        \"name\": \"next\"\n      }\n    ],\n    \"paths\": {\n      \"@/*\": [\n        \"./*\"\n      ]\n    }\n  },\n  \"include\": [\n    \"next-env.d.ts\",\n    \"**/*.ts\",\n    \"**/*.tsx\",\n    \".next/types/**/*.ts\",\n    \".next/dev/types/**/*.ts\"\n  ],\n  \"exclude\": [\n    \"node_modules\"\n  ]\n}\n",
      "inactive/frontend/types/cache-life.d.ts": "// Type definitions for Next.js cacheLife configs\n\ndeclare module 'next/cache' {\n  export { unstable_cache } from 'next/dist/server/web/spec-extension/unstable-cache'\n  export {\n    updateTag,\n    revalidateTag,\n    revalidatePath,\n    refresh,\n  } from 'next/dist/server/web/spec-extension/revalidate'\n  export { unstable_noStore } from 'next/dist/server/web/spec-extension/unstable-no-store'\n\n  \n    /**\n     * Cache this `\"use cache\"` for a timespan defined by the `\"default\"` profile.\n     * ```\n     *   stale:      300 seconds (5 minutes)\n     *   revalidate: 900 seconds (15 minutes)\n     *   expire:     never\n     * ```\n     * \n     * This cache may be stale on clients for 5 minutes before checking with the server.\n     * If the server receives a new request after 15 minutes, start revalidating new values in the background.\n     * It lives for the maximum age of the server cache. If this entry has no traffic for a while, it may serve an old value the next request.\n     */\n    export function cacheLife(profile: \"default\"): void\n    \n    /**\n     * Cache this `\"use cache\"` for a timespan defined by the `\"seconds\"` profile.\n     * ```\n     *   stale:      30 seconds\n     *   revalidate: 1 seconds\n     *   expire:     60 seconds (1 minute)\n     * ```\n     * \n     * This cache may be stale on clients for 30 seconds before checking with the server.\n     * If the server receives a new request after 1 seconds, start revalidating new values in the background.\n     * If this entry has no traffic for 1 minute it will expire. The next request will recompute it.\n     */\n    export function cacheLife(profile: \"seconds\"): void\n    \n    /**\n     * Cache this `\"use cache\"` for a timespan defined by the `\"minutes\"` profile.\n     * ```\n     *   stale:      300 seconds (5 minutes)\n     *   revalidate: 60 seconds (1 minute)\n     *   expire:     3600 seconds (1 hour)\n     * ```\n     * \n     * This cache may be stale on clients for 5 minutes before checking with the server.\n     * If the server receives a new request after 1 minute, start revalidating new values in the background.\n     * If this entry has no traffic for 1 hour it will expire. The next request will recompute it.\n     */\n    export function cacheLife(profile: \"minutes\"): void\n    \n    /**\n     * Cache this `\"use cache\"` for a timespan defined by the `\"hours\"` profile.\n     * ```\n     *   stale:      300 seconds (5 minutes)\n     *   revalidate: 3600 seconds (1 hour)\n     *   expire:     86400 seconds (1 day)\n     * ```\n     * \n     * This cache may be stale on clients for 5 minutes before checking with the server.\n     * If the server receives a new request after 1 hour, start revalidating new values in the background.\n     * If this entry has no traffic for 1 day it will expire. The next request will recompute it.\n     */\n    export function cacheLife(profile: \"hours\"): void\n    \n    /**\n     * Cache this `\"use cache\"` for a timespan defined by the `\"days\"` profile.\n     * ```\n     *   stale:      300 seconds (5 minutes)\n     *   revalidate: 86400 seconds (1 day)\n     *   expire:     604800 seconds (1 week)\n     * ```\n     * \n     * This cache may be stale on clients for 5 minutes before checking with the server.\n     * If the server receives a new request after 1 day, start revalidating new values in the background.\n     * If this entry has no traffic for 1 week it will expire. The next request will recompute it.\n     */\n    export function cacheLife(profile: \"days\"): void\n    \n    /**\n     * Cache this `\"use cache\"` for a timespan defined by the `\"weeks\"` profile.\n     * ```\n     *   stale:      300 seconds (5 minutes)\n     *   revalidate: 604800 seconds (1 week)\n     *   expire:     2592000 seconds (1 month)\n     * ```\n     * \n     * This cache may be stale on clients for 5 minutes before checking with the server.\n     * If the server receives a new request after 1 week, start revalidating new values in the background.\n     * If this entry has no traffic for 1 month it will expire. The next request will recompute it.\n     */\n    export function cacheLife(profile: \"weeks\"): void\n    \n    /**\n     * Cache this `\"use cache\"` for a timespan defined by the `\"max\"` profile.\n     * ```\n     *   stale:      300 seconds (5 minutes)\n     *   revalidate: 2592000 seconds (1 month)\n     *   expire:     31536000 seconds (365 days)\n     * ```\n     * \n     * This cache may be stale on clients for 5 minutes before checking with the server.\n     * If the server receives a new request after 1 month, start revalidating new values in the background.\n     * If this entry has no traffic for 365 days it will expire. The next request will recompute it.\n     */\n    export function cacheLife(profile: \"max\"): void\n    \n    /**\n     * Cache this `\"use cache\"` using a custom timespan.\n     * ```\n     *   stale: ... // seconds\n     *   revalidate: ... // seconds\n     *   expire: ... // seconds\n     * ```\n     *\n     * This is similar to Cache-Control: max-age=`stale`,s-max-age=`revalidate`,stale-while-revalidate=`expire-revalidate`\n     *\n     * If a value is left out, the lowest of other cacheLife() calls or the default, is used instead.\n     */\n    export function cacheLife(profile: {\n      /**\n       * This cache may be stale on clients for ... seconds before checking with the server.\n       */\n      stale?: number,\n      /**\n       * If the server receives a new request after ... seconds, start revalidating new values in the background.\n       */\n      revalidate?: number,\n      /**\n       * If this entry has no traffic for ... seconds it will expire. The next request will recompute it.\n       */\n      expire?: number\n    }): void\n  \n\n  import { cacheTag } from 'next/dist/server/use-cache/cache-tag'\n  export { cacheTag }\n\n  export const unstable_cacheTag: typeof cacheTag\n  export const unstable_cacheLife: typeof cacheLife\n}\n",
      "inactive/frontend/types/routes.d.ts": "// This file is generated automatically by Next.js\n// Do not edit this file manually\n\ntype AppRoutes = never\ntype PageRoutes = never\ntype LayoutRoutes = never\ntype RedirectRoutes = never\ntype RewriteRoutes = never\ntype Routes = AppRoutes | PageRoutes | LayoutRoutes | RedirectRoutes | RewriteRoutes\n\n\ninterface ParamMap {\n}\n\n\nexport type ParamsOf<Route extends Routes> = ParamMap[Route]\n\ninterface LayoutSlotMap {\n}\n\n\nexport type { AppRoutes, PageRoutes, LayoutRoutes, RedirectRoutes, RewriteRoutes, ParamMap }\n\ndeclare global {\n  /**\n   * Props for Next.js App Router page components\n   * @example\n   * ```tsx\n   * export default function Page(props: PageProps<'/blog/[slug]'>) {\n   *   const { slug } = await props.params\n   *   return <div>Blog post: {slug}</div>\n   * }\n   * ```\n   */\n  interface PageProps<AppRoute extends AppRoutes> {\n    params: Promise<ParamMap[AppRoute]>\n    searchParams: Promise<Record<string, string | string[] | undefined>>\n  }\n\n  /**\n   * Props for Next.js App Router layout components\n   * @example\n   * ```tsx\n   * export default function Layout(props: LayoutProps<'/dashboard'>) {\n   *   return <div>{props.children}</div>\n   * }\n   * ```\n   */\n  type LayoutProps<LayoutRoute extends LayoutRoutes> = {\n    params: Promise<ParamMap[LayoutRoute]>\n    children: React.ReactNode\n  } & {\n    [K in LayoutSlotMap[LayoutRoute]]: React.ReactNode\n  }\n}\n",
      "inactive/frontend/types/validator.ts": "// This file is generated automatically by Next.js\n// Do not edit this file manually\n// This file validates that all pages and layouts export the correct types\n\n\n\n\n\n\n\n\n\n\n\n\n\n",
      "inactive/frontend/vercel.json": "{\n  \"rewrites\": [\n    { \"source\": \"/install.sh\", \"destination\": \"/api/install.sh\" },\n    { \"source\": \"/install.ps1\", \"destination\": \"/api/install.ps1\" }\n  ]\n}\n",
      "install.sh": "#!/usr/bin/env bash\n# \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n# JCode Universal Installer\n# One command. Installs everything.\n#\n# Usage:\n#   curl -fsSL https://raw.githubusercontent.com/ShakenTheCoder/JcodeAgent/main/install.sh | bash\n#\n# What it does (only if not already installed):\n#   1. Installs Python 3.12+\n#   2. Installs Ollama\n#   3. Pulls AI models (qwen2.5-coder:14b, qwen2.5-coder:7b, deepseek-r1:14b)\n#   4. Clones/updates JCode\n#   5. Creates venv + installs dependencies\n#   6. Adds 'jcode' to your PATH\n# \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\nset -euo pipefail\n\n# \u2500\u2500 Colors \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\nRED='\\033[0;31m'\nGREEN='\\033[0;32m'\nYELLOW='\\033[1;33m'\nBLUE='\\033[0;34m'\nCYAN='\\033[0;36m'\nBOLD='\\033[1m'\nDIM='\\033[2m'\nNC='\\033[0m'\n\n# \u2500\u2500 Globals \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n# Models: coding (qwen2.5-coder) + reasoning (deepseek-r1) for multi-model routing\nJCODE_HOME=\"${JCODE_HOME:-$HOME/JcodeAgent}\"\nJCODE_REPO=\"https://github.com/ShakenTheCoder/JcodeAgent.git\"\nMIN_PYTHON=\"3.10\"\nMODELS=(\"qwen2.5-coder:14b\" \"qwen2.5-coder:7b\" \"deepseek-r1:14b\")\n\n# \u2500\u2500 Spinner \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n_spinner_pid=\"\"\n\nspin_start() {\n    local msg=\"$1\"\n    local frames=(\"\u280b\" \"\u2819\" \"\u2839\" \"\u2838\" \"\u283c\" \"\u2834\" \"\u2826\" \"\u2827\" \"\u2807\" \"\u280f\")\n    (\n        while true; do\n            for f in \"${frames[@]}\"; do\n                printf \"\\r  ${CYAN}%s${NC} ${DIM}%s${NC}\" \"$f\" \"$msg\"\n                sleep 0.08\n            done\n        done\n    ) &\n    _spinner_pid=$!\n    disown \"$_spinner_pid\" 2>/dev/null\n}\n\nspin_stop() {\n    if [[ -n \"$_spinner_pid\" ]]; then\n        kill \"$_spinner_pid\" 2>/dev/null\n        wait \"$_spinner_pid\" 2>/dev/null || true\n        _spinner_pid=\"\"\n        printf \"\\r\\033[2K\"\n    fi\n}\n\n# \u2500\u2500 Helpers \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\nok()      { echo -e \"  ${GREEN}\u2713${NC} $*\"; }\ninfo()    { echo -e \"  ${DIM}$*${NC}\"; }\nwarn()    { echo -e \"  ${YELLOW}!${NC} $*\"; }\nfail()    { spin_stop; echo -e \"  ${RED}\u2717${NC} $*\"; exit 1; }\nsection() { echo -e \"\\n  ${BOLD}${CYAN}$*${NC}\\n\"; }\n\ncommand_exists() { command -v \"$1\" &>/dev/null; }\n\nversion_gte() {\n    printf '%s\\n%s' \"$2\" \"$1\" | sort -V -C\n}\n\ndetect_os() {\n    case \"$(uname -s)\" in\n        Darwin*)  echo \"macos\"  ;;\n        Linux*)   echo \"linux\"  ;;\n        MINGW*|MSYS*|CYGWIN*) echo \"windows\" ;;\n        *)        echo \"unknown\" ;;\n    esac\n}\n\ndetect_arch() {\n    case \"$(uname -m)\" in\n        x86_64|amd64)  echo \"amd64\" ;;\n        arm64|aarch64) echo \"arm64\" ;;\n        *)             echo \"$(uname -m)\" ;;\n    esac\n}\n\n# \u2500\u2500 Progress bar \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\nprogress_bar() {\n    local current=$1 total=$2 label=$3\n    local width=30\n    local pct=$((current * 100 / total))\n    local filled=$((current * width / total))\n    local empty=$((width - filled))\n    local bar=\"\"\n    for ((i=0; i<filled; i++)); do bar+=\"\u2588\"; done\n    for ((i=0; i<empty; i++)); do bar+=\"\u2591\"; done\n    printf \"\\r  ${DIM}%s${NC} ${CYAN}%s${NC} ${DIM}%d%%${NC}\" \"$label\" \"$bar\" \"$pct\"\n}\n\n# \u2500\u2500 Banner \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\nbanner() {\n    echo \"\"\n    echo -e \"${BOLD}${CYAN}\"\n    cat << 'EOF'\n     \u2588\u2588\u2557 \u2588\u2588\u2588\u2588\u2588\u2588\u2557 \u2588\u2588\u2588\u2588\u2588\u2588\u2557 \u2588\u2588\u2588\u2588\u2588\u2588\u2557 \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2557\n     \u2588\u2588\u2551\u2588\u2588\u2554\u2550\u2550\u2550\u2550\u255d\u2588\u2588\u2554\u2550\u2550\u2550\u2588\u2588\u2557\u2588\u2588\u2554\u2550\u2550\u2588\u2588\u2557\u2588\u2588\u2554\u2550\u2550\u2550\u2550\u255d\n     \u2588\u2588\u2551\u2588\u2588\u2551     \u2588\u2588\u2551   \u2588\u2588\u2551\u2588\u2588\u2551  \u2588\u2588\u2551\u2588\u2588\u2588\u2588\u2588\u2557\n\u2588\u2588   \u2588\u2588\u2551\u2588\u2588\u2551     \u2588\u2588\u2551   \u2588\u2588\u2551\u2588\u2588\u2551  \u2588\u2588\u2551\u2588\u2588\u2554\u2550\u2550\u255d\n\u255a\u2588\u2588\u2588\u2588\u2588\u2554\u255d\u255a\u2588\u2588\u2588\u2588\u2588\u2588\u2557\u255a\u2588\u2588\u2588\u2588\u2588\u2588\u2554\u255d\u2588\u2588\u2588\u2588\u2588\u2588\u2554\u255d\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2557\n \u255a\u2550\u2550\u2550\u2550\u255d  \u255a\u2550\u2550\u2550\u2550\u2550\u255d \u255a\u2550\u2550\u2550\u2550\u2550\u255d \u255a\u2550\u2550\u2550\u2550\u2550\u255d \u255a\u2550\u2550\u2550\u2550\u2550\u2550\u255d\nEOF\n    echo -e \"${NC}\"\n    echo -e \"  ${DIM}Your local, unlimited & private software engineer${NC}\"\n    echo -e \"  ${DIM}One command. Everything you need.${NC}\"\n    echo \"\"\n    echo -e \"  ${DIM}\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500${NC}\"\n    echo \"\"\n}\n\n# \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n# Step 1: Python\n# \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\ninstall_python() {\n    section \"Python\"\n\n    local python_cmd=\"\"\n\n    for cmd in python3 python python3.12 python3.11 python3.10; do\n        if command_exists \"$cmd\"; then\n            local ver\n            ver=$(\"$cmd\" --version 2>&1 | grep -oE '[0-9]+\\.[0-9]+\\.[0-9]+' | head -1)\n            local major_minor\n            major_minor=$(echo \"$ver\" | cut -d. -f1-2)\n            if version_gte \"$major_minor\" \"$MIN_PYTHON\"; then\n                python_cmd=\"$cmd\"\n                ok \"Python $ver\"\n                break\n            fi\n        fi\n    done\n\n    if [[ -z \"$python_cmd\" ]]; then\n        warn \"Python $MIN_PYTHON+ not found. Installing...\"\n\n        local os\n        os=$(detect_os)\n\n        case \"$os\" in\n            macos)\n                if command_exists brew; then\n                    spin_start \"Installing Python via Homebrew...\"\n                    brew install python@3.12 &>/dev/null\n                    spin_stop\n                else\n                    spin_start \"Installing Homebrew...\"\n                    /bin/bash -c \"$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)\" &>/dev/null\n                    spin_stop\n                    if [[ -f \"/opt/homebrew/bin/brew\" ]]; then\n                        eval \"$(/opt/homebrew/bin/brew shellenv)\"\n                    elif [[ -f \"/usr/local/bin/brew\" ]]; then\n                        eval \"$(/usr/local/bin/brew shellenv)\"\n                    fi\n                    spin_start \"Installing Python via Homebrew...\"\n                    brew install python@3.12 &>/dev/null\n                    spin_stop\n                fi\n                python_cmd=\"python3\"\n                ;;\n            linux)\n                if command_exists apt-get; then\n                    spin_start \"Installing Python via apt...\"\n                    sudo apt-get update -qq &>/dev/null\n                    sudo apt-get install -y -qq python3 python3-venv python3-pip &>/dev/null\n                    spin_stop\n                elif command_exists dnf; then\n                    spin_start \"Installing Python via dnf...\"\n                    sudo dnf install -y python3 python3-pip &>/dev/null\n                    spin_stop\n                elif command_exists pacman; then\n                    spin_start \"Installing Python via pacman...\"\n                    sudo pacman -Sy --noconfirm python python-pip &>/dev/null\n                    spin_stop\n                elif command_exists apk; then\n                    spin_start \"Installing Python via apk...\"\n                    sudo apk add python3 py3-pip &>/dev/null\n                    spin_stop\n                else\n                    fail \"Could not detect package manager. Install Python $MIN_PYTHON+ manually: https://www.python.org/downloads/\"\n                fi\n                python_cmd=\"python3\"\n                ;;\n            *)\n                fail \"Unsupported OS. Install Python $MIN_PYTHON+ manually: https://www.python.org/downloads/\"\n                ;;\n        esac\n\n        if ! command_exists \"$python_cmd\"; then\n            fail \"Python installation failed. Install manually: https://www.python.org/downloads/\"\n        fi\n        ok \"Python installed: $($python_cmd --version 2>&1 | grep -oE '[0-9]+\\.[0-9]+')\"\n    fi\n\n    PYTHON_CMD=\"$python_cmd\"\n}\n\n# \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n# Step 2: Ollama\n# \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\ninstall_ollama() {\n    section \"Ollama\"\n\n    if command_exists ollama; then\n        ok \"Ollama $(ollama --version 2>/dev/null | grep -oE '[0-9]+\\.[0-9]+\\.[0-9]+' || echo 'installed')\"\n    else\n        warn \"Ollama not found. Installing...\"\n\n        local os\n        os=$(detect_os)\n\n        case \"$os\" in\n            macos)\n                if command_exists brew; then\n                    spin_start \"Installing Ollama via Homebrew...\"\n                    brew install ollama &>/dev/null\n                    spin_stop\n                else\n                    spin_start \"Downloading Ollama...\"\n                    curl -fsSL https://ollama.ai/install.sh | sh &>/dev/null\n                    spin_stop\n                fi\n                ;;\n            linux)\n                spin_start \"Downloading Ollama...\"\n                curl -fsSL https://ollama.ai/install.sh | sh &>/dev/null\n                spin_stop\n                ;;\n            *)\n                fail \"Please install Ollama manually: https://ollama.ai/download\"\n                ;;\n        esac\n\n        if ! command_exists ollama; then\n            fail \"Ollama installation failed. Install manually: https://ollama.ai/download\"\n        fi\n        ok \"Ollama installed\"\n    fi\n}\n\n# \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n# Step 3: Start Ollama & pull models\n# \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\nsetup_models() {\n    section \"AI Models\"\n\n    # Make sure Ollama is running\n    if ! curl -sf http://localhost:11434/api/tags &>/dev/null; then\n        spin_start \"Starting Ollama server...\"\n        ollama serve &>/dev/null &\n        OLLAMA_PID=$!\n\n        local retries=0\n        while ! curl -sf http://localhost:11434/api/tags &>/dev/null; do\n            retries=$((retries + 1))\n            if [[ $retries -gt 30 ]]; then\n                spin_stop\n                fail \"Ollama failed to start. Try running 'ollama serve' manually.\"\n            fi\n            sleep 1\n        done\n        spin_stop\n        ok \"Ollama server started\"\n    else\n        ok \"Ollama server running\"\n    fi\n\n    # Pull each model\n    local installed_models\n    installed_models=$(ollama list 2>/dev/null | tail -n +2 | awk '{print $1}' || echo \"\")\n\n    local total=${#MODELS[@]}\n    local current=0\n\n    for model in \"${MODELS[@]}\"; do\n        current=$((current + 1))\n        if echo \"$installed_models\" | grep -q \"^${model}\"; then\n            ok \"$model\"\n        else\n            spin_start \"Downloading $model... (this may take 10-15 min)\"\n            ollama pull \"$model\" &>/dev/null\n            spin_stop\n            ok \"$model downloaded\"\n        fi\n    done\n}\n\n# \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n# Step 4: JCode\n# \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\ninstall_jcode() {\n    section \"JCode\"\n\n    # Clone or update\n    if [[ -d \"$JCODE_HOME\" ]]; then\n        if [[ -d \"$JCODE_HOME/.git\" ]]; then\n            spin_start \"Updating JCode...\"\n            cd \"$JCODE_HOME\"\n            git pull --ff-only &>/dev/null 2>&1 || true\n            spin_stop\n            ok \"Updated to latest\"\n        else\n            ok \"JCode directory exists\"\n        fi\n    else\n        spin_start \"Downloading JCode...\"\n        if command_exists git; then\n            git clone \"$JCODE_REPO\" \"$JCODE_HOME\" &>/dev/null 2>&1\n        else\n            local zip_url=\"${JCODE_REPO%.git}/archive/refs/heads/main.zip\"\n            local tmp_zip=\"/tmp/jcode_download.zip\"\n            curl -fsSL \"$zip_url\" -o \"$tmp_zip\"\n            unzip -qo \"$tmp_zip\" -d /tmp/jcode_extract\n            mv /tmp/jcode_extract/JcodeAgent-main \"$JCODE_HOME\"\n            rm -rf \"$tmp_zip\" /tmp/jcode_extract\n        fi\n        spin_stop\n        ok \"Downloaded to $JCODE_HOME\"\n    fi\n\n    cd \"$JCODE_HOME\"\n\n    # Virtual environment\n    if [[ ! -d \"$JCODE_HOME/.venv\" ]]; then\n        spin_start \"Creating Python virtual environment...\"\n        \"$PYTHON_CMD\" -m venv .venv\n        spin_stop\n        ok \"Virtual environment created\"\n    else\n        ok \"Virtual environment exists\"\n    fi\n\n    # Install\n    # shellcheck disable=SC1091\n    source \"$JCODE_HOME/.venv/bin/activate\"\n\n    spin_start \"Installing dependencies...\"\n    pip install --upgrade pip -q &>/dev/null\n    pip install -e . -q &>/dev/null\n    spin_stop\n    ok \"JCode installed\"\n}\n\n# \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n# Step 5: Add to PATH\n# \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\nsetup_path() {\n    section \"PATH\"\n\n    local venv_bin=\"$JCODE_HOME/.venv/bin\"\n    local shell_rc=\"\"\n\n    case \"$(basename \"${SHELL:-/bin/bash}\")\" in\n        zsh)  shell_rc=\"$HOME/.zshrc\" ;;\n        bash)\n            if [[ -f \"$HOME/.bash_profile\" ]]; then\n                shell_rc=\"$HOME/.bash_profile\"\n            else\n                shell_rc=\"$HOME/.bashrc\"\n            fi\n            ;;\n        fish) shell_rc=\"$HOME/.config/fish/config.fish\" ;;\n        *)    shell_rc=\"$HOME/.profile\" ;;\n    esac\n\n    local path_line=\"export PATH=\\\"$venv_bin:\\$PATH\\\"\"\n\n    if [[ -f \"$shell_rc\" ]] && grep -qF \"$venv_bin\" \"$shell_rc\" 2>/dev/null; then\n        ok \"PATH configured in $shell_rc\"\n    else\n        {\n            echo \"\"\n            echo \"# JCode \u2014 Local AI Coding Agent\"\n            echo \"$path_line\"\n        } >> \"$shell_rc\"\n        ok \"Added to PATH in $shell_rc\"\n    fi\n\n    export PATH=\"$venv_bin:$PATH\"\n}\n\n# \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n# Summary\n# \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\nprint_summary() {\n    local py_ver\n    py_ver=$(${PYTHON_CMD} --version 2>&1 | grep -oE '[0-9]+\\.[0-9]+\\.[0-9]+')\n    local ollama_ver\n    ollama_ver=$(ollama --version 2>/dev/null | grep -oE '[0-9]+\\.[0-9]+\\.[0-9]+' || echo 'installed')\n\n    echo \"\"\n    echo -e \"  ${DIM}\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500${NC}\"\n    echo \"\"\n    echo -e \"  ${BOLD}${GREEN}Installation complete.${NC}\"\n    echo \"\"\n    echo -e \"  ${DIM}Python${NC}    ${CYAN}${py_ver}${NC}\"\n    echo -e \"  ${DIM}Ollama${NC}    ${CYAN}${ollama_ver}${NC}\"\n    echo -e \"  ${DIM}Models${NC}    ${CYAN}${MODELS[*]}${NC}\"\n    echo -e \"  ${DIM}Location${NC}  ${CYAN}${JCODE_HOME}${NC}\"\n    echo \"\"\n    echo -e \"  ${DIM}\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500${NC}\"\n    echo \"\"\n    echo -e \"  ${BOLD}Get started:${NC}\"\n    echo \"\"\n    echo -e \"    ${CYAN}\\$ jcode${NC}\"\n    echo -e \"    ${DIM}jcode>${NC} build a todo list web app\"\n    echo \"\"\n    echo -e \"  ${DIM}If 'jcode' isn't found, open a new terminal or run:${NC}\"\n    echo -e \"  ${DIM}source ~/.zshrc  (or ~/.bashrc)${NC}\"\n    echo \"\"\n}\n\n# \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n# Main\n# \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\nmain() {\n    banner\n\n    local os arch\n    os=$(detect_os)\n    arch=$(detect_arch)\n    info \"System: $os ($arch)\"\n\n    install_python\n    install_ollama\n    setup_models\n    install_jcode\n    setup_path\n    print_summary\n}\n\nmain \"$@\"\n",
      "jcode/__init__.py": "\"\"\"JCode \u2014 A local AI coding agent powered by Ollama.\"\"\"\n\n__version__ = \"0.9.9\"\n",
      "jcode/__main__.py": "\"\"\"Allow running JCode as a module: python -m jcode\"\"\"\n\nfrom jcode.cli import main\n\nmain()\n",
      "jcode/analyzer.py": "\"\"\"\nAnalyzer module \u2014 parses errors/stack traces into actionable fixes.\n\nInstead of blindly feeding raw errors back to the coder,\nthe analyzer distills them into precise fix instructions.\n\"\"\"\n\nfrom __future__ import annotations\n\nimport json\nimport re\n\nfrom rich.console import Console\n\nfrom jcode.ollama_client import call_analyzer\nfrom jcode.prompts import ANALYZER_SYSTEM, ANALYZER_TASK\nfrom jcode.context import ContextManager\n\nconsole = Console()\n\n\ndef _extract_json(text: str) -> dict:\n    \"\"\"Extract JSON from analyzer output.\"\"\"\n    text = re.sub(r\"<think>.*?</think>\", \"\", text, flags=re.DOTALL)\n    fence = re.search(r\"```(?:json)?\\s*\\n?(.*?)```\", text, re.DOTALL)\n    if fence:\n        text = fence.group(1).strip()\n\n    depth = 0\n    start = None\n    for i, ch in enumerate(text):\n        if ch == \"{\":\n            if depth == 0:\n                start = i\n            depth += 1\n        elif ch == \"}\":\n            depth -= 1\n            if depth == 0 and start is not None:\n                try:\n                    return json.loads(text[start : i + 1])\n                except json.JSONDecodeError:\n                    continue\n\n    return {\n        \"root_cause\": \"Could not parse analysis\",\n        \"affected_file\": \"\",\n        \"affected_function\": None,\n        \"fix_strategy\": text[:500],\n        \"is_dependency_issue\": False,\n        \"severity\": \"warning\",\n    }\n\n\ndef analyze_error(\n    file_path: str,\n    error_output: str,\n    ctx: ContextManager,\n) -> dict:\n    \"\"\"\n    Analyze an error and return a structured diagnosis.\n\n    Returns:\n        {\n            \"root_cause\": str,\n            \"affected_file\": str,\n            \"affected_function\": str | None,\n            \"fix_strategy\": str,\n            \"is_dependency_issue\": bool,\n            \"severity\": \"critical\" | \"warning\" | \"info\"\n        }\n    \"\"\"\n    file_content = ctx.state.files.get(file_path, \"\")\n    previous_fixes = ctx.get_failure_log_str(file_path)\n\n    ctx.reset_channel(\"analyzer\")\n    ctx.add_message(\"analyzer\", \"system\", ANALYZER_SYSTEM)\n\n    prompt = ANALYZER_TASK.format(\n        architecture=ctx.get_architecture(),\n        error_output=error_output[-2000:],  # Last 2k chars of error\n        file_path=file_path,\n        file_content=file_content[:8000],\n        previous_fixes=previous_fixes,\n    )\n    ctx.add_message(\"analyzer\", \"user\", prompt)\n\n    console.print(f\"  [dim]Analyzing error in[/dim] [cyan]{file_path}[/cyan]\")\n\n    planner_ctx, _ = ctx.get_context_sizes()\n    complexity = ctx.get_complexity()\n    size = ctx.get_size()\n    raw = call_analyzer(\n        ctx.get_messages(\"analyzer\"),\n        stream=False,  # Analysis doesn't need streaming\n        num_ctx=planner_ctx,\n        complexity=complexity,\n        size=size,\n    )\n\n    result = _extract_json(raw)\n\n    # Display analysis\n    console.print(f\"    [dim]Root cause:[/dim] {result.get('root_cause', 'Unknown')}\")\n    console.print(f\"    [dim]Fix:[/dim] {result.get('fix_strategy', '')}\")\n\n    return result\n",
      "jcode/cli.py": "\"\"\"\nJCode CLI v0.9.8 \u2014 Intelligent multi-model orchestrator.\n\nJCode lives inside your project directory. Two modes:\n  AGENTIC (default) \u2014 every message triggers autonomous action:\n    classify \u2192 research \u2192 plan \u2192 generate \u2192 auto-run \u2192 auto-fix \u2192 commit\n  CHAT \u2014 conversational: reasoning, websearch, explanations \u2014 no file changes\n\nSwitch modes with /agentic or /chat.\nSlash commands (/help, /run, /commit, etc.) work in both modes.\n\"\"\"\n\nfrom __future__ import annotations\n\nimport json\nimport os\nimport re\nimport shutil\nimport subprocess\nimport sys\nfrom datetime import datetime\nfrom pathlib import Path\n\nfrom rich.console import Console\nfrom rich.panel import Panel\nfrom rich.table import Table\nfrom rich.markdown import Markdown\n\nfrom prompt_toolkit import prompt as pt_prompt\nfrom prompt_toolkit.history import InMemoryHistory\n\nfrom jcode import __version__\nfrom jcode.config import (\n    ProjectState, classify_task, get_model_for_role, get_all_required_models,\n    describe_model_plan, detect_complexity,\n)\nfrom jcode.context import ContextManager\nfrom jcode.planner import create_plan\nfrom jcode.iteration import execute_plan\nfrom jcode.file_manager import print_tree\nfrom jcode.ollama_client import check_ollama_running, call_model, ensure_models_for_complexity, list_available_models\nfrom jcode.settings import SettingsManager\nfrom jcode.executor import set_autonomous\nfrom jcode.web import set_internet_access, web_search, fetch_page, search_and_summarize, research_task, is_internet_allowed\nfrom jcode.prompts import (\n    CHAT_SYSTEM, CHAT_CONTEXT, AGENTIC_SYSTEM, AGENTIC_TASK,\n    RESEARCH_SYSTEM, RESEARCH_TASK, PLANNER_RESEARCH_CONTEXT,\n)\nfrom jcode.intent import _BUILD_PATTERNS\nfrom jcode.scanner import scan_project, detect_project_type, scan_files\nfrom jcode import git_manager\n\nconsole = Console()\n\n# \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n# ASCII Art\n# \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n\nBANNER = r\"\"\"\n     \u2588\u2588\u2557 \u2588\u2588\u2588\u2588\u2588\u2588\u2557 \u2588\u2588\u2588\u2588\u2588\u2588\u2557 \u2588\u2588\u2588\u2588\u2588\u2588\u2557 \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2557\n     \u2588\u2588\u2551\u2588\u2588\u2554\u2550\u2550\u2550\u2550\u255d\u2588\u2588\u2554\u2550\u2550\u2550\u2588\u2588\u2557\u2588\u2588\u2554\u2550\u2550\u2588\u2588\u2557\u2588\u2588\u2554\u2550\u2550\u2550\u2550\u255d\n     \u2588\u2588\u2551\u2588\u2588\u2551     \u2588\u2588\u2551   \u2588\u2588\u2551\u2588\u2588\u2551  \u2588\u2588\u2551\u2588\u2588\u2588\u2588\u2588\u2557\n\u2588\u2588   \u2588\u2588\u2551\u2588\u2588\u2551     \u2588\u2588\u2551   \u2588\u2588\u2551\u2588\u2588\u2551  \u2588\u2588\u2551\u2588\u2588\u2554\u2550\u2550\u255d\n\u255a\u2588\u2588\u2588\u2588\u2588\u2554\u255d\u255a\u2588\u2588\u2588\u2588\u2588\u2588\u2557\u255a\u2588\u2588\u2588\u2588\u2588\u2588\u2554\u255d\u2588\u2588\u2588\u2588\u2588\u2588\u2554\u255d\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2557\n \u255a\u2550\u2550\u2550\u2550\u255d  \u255a\u2550\u2550\u2550\u2550\u2550\u255d \u255a\u2550\u2550\u2550\u2550\u2550\u255d \u255a\u2550\u2550\u2550\u2550\u2550\u255d \u255a\u2550\u2550\u2550\u2550\u2550\u2550\u255d\"\"\"\n\nHELP_TEXT = \"\"\"\n[bold white]JCode \u2014 Two Modes[/bold white]\n\n  [bold cyan]\u26a1 Agentic[/bold cyan] (default)  Every message triggers autonomous action.\n                       JCode classifies, plans, generates code, runs it,\n                       and auto-fixes errors \u2014 fully autonomous.\n\n  [bold cyan]\ud83d\udcac Chat[/bold cyan]               Conversational mode. JCode reasons, searches\n                       the web, explains \u2014 but does NOT modify files.\n\n[bold white]Slash Commands[/bold white]  (work in both modes)\n\n  [bold cyan]Modes[/bold cyan]\n  [cyan]/agentic[/cyan]           Switch to agentic mode\n  [cyan]/chat[/cyan]              Switch to chat mode\n\n  [bold cyan]Project[/bold cyan]\n  [cyan]/run[/cyan]               Detect and run the project\n  [cyan]/test[/cyan]              Run project tests\n  [cyan]/files[/cyan]             List all project files\n  [cyan]/tree[/cyan]              Show directory tree\n  [cyan]/plan[/cyan]              Show current build plan\n  [cyan]/models[/cyan]            Show available models and routing\n\n  [bold cyan]Git[/bold cyan]\n  [cyan]/commit[/cyan] [message]  Stage all changes and commit\n  [cyan]/push[/cyan]              Push to remote\n  [cyan]/pull[/cyan]              Pull from remote\n  [cyan]/status[/cyan]            Show git status\n  [cyan]/log[/cyan]               Show recent commits\n  [cyan]/diff[/cyan]              Show uncommitted changes\n  [cyan]/remote[/cyan] <url>      Set up GitHub remote\n\n  [bold cyan]Utility[/bold cyan]\n  [cyan]/version[/cyan]           Show JCode version\n  [cyan]/update[/cyan]            Update JCode to latest version\n  [cyan]/clear[/cyan]             Clear the terminal\n  [cyan]/help[/cyan]              Show this help\n  [cyan]/quit[/cyan]              Exit\n\"\"\"\n\n\n# \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n# Interactive selectors\n# \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n\ndef _select_one(title: str, options: list[str]) -> int | None:\n    \"\"\"Arrow keys to move, enter to confirm. Returns 0-based index or None.\"\"\"\n    try:\n        import tty, termios\n        fd = sys.stdin.fileno()\n        old = termios.tcgetattr(fd)\n    except Exception:\n        return _select_one_fallback(title, options)\n\n    selected = 0\n\n    def _render():\n        for _ in range(len(options) + 1):\n            sys.stdout.write(\"\\033[A\\033[2K\")\n        sys.stdout.write(f\"  {title}\\n\")\n        for i, opt in enumerate(options):\n            marker = \"[cyan]>[/cyan] \" if i == selected else \"  \"\n            style = \"bold white\" if i == selected else \"dim\"\n            console.print(f\"    {marker}[{style}]{opt}[/{style}]\", highlight=False)\n        sys.stdout.flush()\n\n    console.print(f\"  {title}\")\n    for i, opt in enumerate(options):\n        marker = \"[cyan]>[/cyan] \" if i == selected else \"  \"\n        style = \"bold white\" if i == selected else \"dim\"\n        console.print(f\"    {marker}[{style}]{opt}[/{style}]\", highlight=False)\n\n    try:\n        tty.setraw(fd)\n        while True:\n            ch = sys.stdin.read(1)\n            if ch == \"\\r\" or ch == \"\\n\":\n                break\n            if ch == \"\\x03\":\n                selected = None\n                break\n            if ch == \"\\x1b\":\n                seq = sys.stdin.read(2)\n                if seq == \"[A\":\n                    selected = (selected - 1) % len(options)\n                elif seq == \"[B\":\n                    selected = (selected + 1) % len(options)\n            _render()\n    finally:\n        termios.tcsetattr(fd, termios.TCSADRAIN, old)\n\n    console.print()\n    return selected\n\n\ndef _select_one_fallback(title: str, options: list[str]) -> int | None:\n    \"\"\"Simple numbered fallback for non-TTY.\"\"\"\n    console.print(f\"\\n  {title}\\n\")\n    for i, opt in enumerate(options, 1):\n        console.print(f\"    [cyan]{i}[/cyan]  {opt}\")\n    console.print()\n    pick = pt_prompt(\"  > \").strip()\n    try:\n        idx = int(pick) - 1\n        if 0 <= idx < len(options):\n            return idx\n    except ValueError:\n        pass\n    return 0\n\n\n# \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n# Logging helper\n# \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n\ndef _log(tag: str, message: str) -> None:\n    \"\"\"Structured log line: [HH:MM:SS] TAG  message\"\"\"\n    ts = datetime.now().strftime(\"%H:%M:%S\")\n    console.print(f\"  [dim]{ts}[/dim]  [cyan]{tag:<10}[/cyan]  {message}\")\n\n\n# \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n# Main entry point\n# \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n\ndef main():\n    \"\"\"Entry point for the JCode CLI \u2014 CWD-aware, single REPL.\"\"\"\n    settings_mgr = SettingsManager()\n    history = InMemoryHistory()\n\n    # -- First-run: create config dir\n    if settings_mgr.is_first_run():\n        settings_mgr.config_dir.mkdir(parents=True, exist_ok=True)\n        settings_mgr.save_settings()\n\n    # -- Banner\n    console.print(BANNER, style=\"bold cyan\", highlight=False)\n    console.print(\n        f\"  v{__version__}  |  your local, unlimited & private software engineer\",\n        style=\"dim white\",\n    )\n    console.print()\n\n    # -- Check Ollama\n    if not check_ollama_running():\n        console.print(\"  [dim]Ollama is not running.[/dim]\")\n        console.print(\"  [dim]Start it with:[/dim]  [cyan]ollama serve[/cyan]\")\n        console.print(\n            \"  [dim]Then pull models:[/dim]  [cyan]ollama pull qwen2.5-coder:14b && ollama pull qwen2.5-coder:7b[/cyan]\",\n        )\n        sys.exit(1)\n    console.print(\"  [cyan]Ollama connected[/cyan]\")\n\n    # Show available models\n    available = list_available_models()\n    model_count = len([m for m in available if m])\n    console.print(f\"  [dim]Multi-model routing enabled \u2014 {model_count} model(s) available[/dim]\")\n\n    # -- Detect project directory (CWD)\n    project_dir = Path.cwd().resolve()\n    console.print(f\"  [cyan]Project directory:[/cyan] {project_dir}\")\n\n    # -- Git check\n    if git_manager.git_available():\n        if git_manager.is_git_repo(project_dir):\n            branch = git_manager.get_current_branch(project_dir)\n            remote = git_manager.get_remote_url(project_dir)\n            console.print(f\"  [cyan]Git:[/cyan] {branch}\" + (f\" \u2192 {remote}\" if remote else \"\"))\n        else:\n            console.print(f\"  [dim]Git: not initialized (use 'commit' to auto-init)[/dim]\")\n    else:\n        console.print(f\"  [dim]Git: not installed[/dim]\")\n\n    # -- Permissions (only ask if never asked before)\n    console.print()\n    _check_permissions(settings_mgr)\n\n    # -- Scan project\n    has_files = any(True for p in project_dir.iterdir() if not p.name.startswith(\".\"))\n    if has_files:\n        ctx = scan_project(project_dir)\n        # Try to load existing session\n        session_file = project_dir / \".jcode_session.json\"\n        if session_file.exists():\n            try:\n                ctx = ContextManager.load_session(session_file)\n                ctx.state.output_dir = project_dir\n                _scan_project_files(ctx, project_dir)\n                console.print(f\"  [dim]Resumed previous session[/dim]\")\n            except Exception:\n                pass\n    else:\n        state = ProjectState(\n            name=project_dir.name,\n            description=\"New project\",\n            output_dir=project_dir,\n        )\n        ctx = ContextManager(state)\n        console.print(f\"  [dim]Empty directory \u2014 ready to build[/dim]\")\n\n    # -- Mode\n    mode = settings_mgr.settings.default_mode\n    # Normalize legacy \"agentic\" to \"agent\"\n    if mode == \"agentic\":\n        mode = \"agent\"\n    console.print(f\"  [cyan]Mode:[/cyan] {mode}  [dim](/agentic or /chat to switch)[/dim]\")\n\n    # -- Hint\n    console.print()\n    console.print(\n        \"  Type naturally or use [cyan]/help[/cyan] for commands.\\n\"\n    )\n\n    # -- Main REPL\n    _repl(ctx, project_dir, settings_mgr, mode, history)\n\n\n# \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n# Permissions (persisted \u2014 asked once, remembered forever)\n# \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n\ndef _check_permissions(settings_mgr: SettingsManager) -> None:\n    \"\"\"Ask for autonomy + internet permissions if not already granted.\"\"\"\n\n    # -- Autonomy\n    if settings_mgr.settings.autonomous_access is None:\n        console.print(\n            \"  [bold white]JCode needs permission to install packages and run[/bold white]\"\n        )\n        console.print(\n            \"  [bold white]terminal commands on your behalf for full autonomy.[/bold white]\"\n        )\n        console.print()\n\n        choice = _select_one(\"Grant autonomous access?\", [\n            \"Yes \u2014 install packages and run commands automatically\",\n            \"No  \u2014 ask me before each action\",\n        ])\n        settings_mgr.settings.autonomous_access = (choice == 0)\n        settings_mgr.save_settings()\n\n    set_autonomous(settings_mgr.settings.autonomous_access)\n\n    if settings_mgr.settings.autonomous_access:\n        console.print(\"  [cyan]Autonomous mode: on[/cyan]\")\n    else:\n        console.print(\"  [dim]Autonomous mode: off (will ask before actions)[/dim]\")\n\n    # -- Internet\n    if settings_mgr.settings.internet_access is None:\n        console.print()\n        console.print(\n            \"  [bold white]JCode can search the web and read documentation[/bold white]\"\n        )\n        console.print(\n            \"  [bold white]to build better projects using real-world knowledge.[/bold white]\"\n        )\n        console.print()\n\n        choice = _select_one(\"Grant internet access?\", [\n            \"Yes \u2014 search the web and read documentation\",\n            \"No  \u2014 work offline only\",\n        ])\n        settings_mgr.settings.internet_access = (choice == 0)\n        settings_mgr.save_settings()\n\n    set_internet_access(settings_mgr.settings.internet_access)\n\n    if settings_mgr.settings.internet_access:\n        console.print(\"  [cyan]Internet access: on[/cyan]\")\n    else:\n        console.print(\"  [dim]Internet access: off[/dim]\")\n    console.print()\n\n\n# \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n# Build-detection heuristic for agentic mode\n# \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n\ndef _looks_like_build(user_input: str) -> bool:\n    \"\"\"Detect if user wants to build a full project from scratch.\n\n    When True, agentic mode routes to the full build pipeline\n    (classify \u2192 research \u2192 plan \u2192 generate \u2192 review \u2192 verify \u2192 fix \u2192 run).\n    \"\"\"\n    lower = user_input.lower().strip()\n\n    # Standard build patterns from intent module\n    for pattern in _BUILD_PATTERNS:\n        if re.search(pattern, lower):\n            return True\n\n    # App-type names strongly imply building from scratch\n    _APP_SIGNALS = [\n        r\"\\b(?:tinder|uber|airbnb|instagram|twitter|whatsapp|spotify|netflix|\"\n        r\"amazon|slack|discord|reddit|youtube|facebook|linkedin|trello|notion|\"\n        r\"shopify|etsy|doordash|grubhub|venmo|paypal)\\b.*\\b(?:for|like|clone)\\b\",\n        r\"\\b(?:for|like|clone)\\b.*\\b(?:tinder|uber|airbnb|instagram|twitter|\"\n        r\"whatsapp|spotify|netflix|amazon|slack|discord|reddit|youtube|facebook|\"\n        r\"linkedin|trello|notion|shopify|etsy|doordash|grubhub|venmo|paypal)\\b\",\n        r\"\\b(?:dating|ride.?sharing|food.?delivery|social.?media|e.?commerce|\"\n        r\"marketplace|messaging|streaming)\\s+(?:app|platform|site|website|service)\\b\",\n    ]\n    for pattern in _APP_SIGNALS:\n        if re.search(pattern, lower):\n            return True\n\n    return False\n\n\n# \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n# Main REPL \u2014 two modes, slash commands\n# \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n\ndef _repl(\n    ctx: ContextManager,\n    project_dir: Path,\n    settings_mgr: SettingsManager,\n    mode: str,\n    history: InMemoryHistory,\n) -> None:\n    \"\"\"Two-mode REPL: agentic (default) acts on every message, chat reasons without changes.\n\n    Slash commands (/help, /run, /commit, etc.) work identically in both modes.\n    Everything else is routed to the active mode handler.\n    \"\"\"\n    proj_name = ctx.state.name or project_dir.name\n\n    while True:\n        try:\n            mode_indicator = \"\u26a1\" if mode == \"agent\" else \"\ud83d\udcac\"\n            user_input = pt_prompt(\n                f\"{mode_indicator} {proj_name}> \", history=history,\n            ).strip()\n        except (EOFError, KeyboardInterrupt):\n            console.print(\"\\n[dim]Goodbye.[/dim]\")\n            _auto_save(ctx, project_dir)\n            break\n\n        if not user_input:\n            continue\n\n        # \u2500\u2500 Slash commands (work in both modes) \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n        if user_input.startswith(\"/\"):\n            cmd = user_input[1:].strip()\n            lower_cmd = cmd.lower()\n\n            # Mode switching\n            if lower_cmd in (\"agentic\", \"agent\"):\n                mode = \"agent\"\n                settings_mgr.settings.default_mode = mode\n                settings_mgr.save_settings()\n                console.print(\"  \u26a1 [cyan]Switched to agentic mode[/cyan]\")\n                continue\n            elif lower_cmd == \"chat\":\n                mode = \"chat\"\n                settings_mgr.settings.default_mode = mode\n                settings_mgr.save_settings()\n                console.print(\"  \ud83d\udcac [cyan]Switched to chat mode[/cyan]\")\n                continue\n\n            # Quit\n            elif lower_cmd in (\"quit\", \"exit\", \"q\"):\n                _auto_save(ctx, project_dir)\n                console.print(\"  [dim]Goodbye.[/dim]\\n\")\n                break\n\n            # Project commands\n            elif lower_cmd == \"run\":\n                _cmd_run(ctx, project_dir, settings_mgr)\n                continue\n            elif lower_cmd in (\"test\", \"tests\"):\n                _cmd_test(project_dir, ctx)\n                continue\n            elif lower_cmd == \"rebuild\":\n                _log(\"REBUILD\", \"Re-running build pipeline\")\n                execute_plan(ctx, project_dir)\n                _auto_save(ctx, project_dir)\n                _git_auto_commit(project_dir, settings_mgr, \"rebuild project\")\n                continue\n            elif lower_cmd == \"files\":\n                _cmd_files(project_dir)\n                continue\n            elif lower_cmd == \"tree\":\n                _cmd_tree(ctx, project_dir)\n                continue\n            elif lower_cmd == \"plan\":\n                _cmd_plan(ctx)\n                continue\n            elif lower_cmd == \"models\":\n                _cmd_models()\n                continue\n\n            # Git commands\n            elif lower_cmd in (\"commit\", \"save\"):\n                _ensure_git_repo(project_dir)\n                ok, result = git_manager.auto_commit(project_dir)\n                if ok:\n                    _log(\"GIT\", f\"Committed: {result}\")\n                else:\n                    console.print(f\"  [dim]{result}[/dim]\")\n                continue\n            elif lower_cmd.startswith(\"commit \"):\n                _ensure_git_repo(project_dir)\n                message = cmd.split(None, 1)[1].strip() if \" \" in cmd else \"update\"\n                ok, result = git_manager.commit(project_dir, message)\n                if ok:\n                    _log(\"GIT\", f\"Committed ({result}): {message}\")\n                else:\n                    console.print(f\"  [dim]{result}[/dim]\")\n                continue\n            elif lower_cmd == \"push\":\n                _ensure_git_repo(project_dir)\n                ok, result = git_manager.push(project_dir)\n                if ok:\n                    _log(\"GIT\", result)\n                else:\n                    console.print(f\"  [yellow]{result}[/yellow]\")\n                    if \"No configured push destination\" in result or \"no upstream\" in result.lower():\n                        console.print(\"  [dim]Set a remote: /remote <github-url>[/dim]\")\n                continue\n            elif lower_cmd == \"pull\":\n                _ensure_git_repo(project_dir)\n                ok, result = git_manager.pull(project_dir)\n                if ok:\n                    _log(\"GIT\", f\"Pulled: {result}\")\n                    _scan_project_files(ctx, project_dir)\n                else:\n                    console.print(f\"  [yellow]{result}[/yellow]\")\n                continue\n            elif lower_cmd == \"status\":\n                git_manager.print_status(project_dir)\n                continue\n            elif lower_cmd == \"log\":\n                _ensure_git_repo(project_dir)\n                git_manager.print_log(project_dir)\n                continue\n            elif lower_cmd == \"diff\":\n                _ensure_git_repo(project_dir)\n                diff_output = git_manager.diff(project_dir)\n                if diff_output:\n                    console.print(Panel(diff_output, title=\"Git Diff\", border_style=\"dim\"))\n                else:\n                    console.print(\"  [dim]No uncommitted changes[/dim]\")\n                continue\n            elif lower_cmd.startswith(\"remote \"):\n                _ensure_git_repo(project_dir)\n                url = cmd.split(None, 1)[1].strip()\n                if git_manager.setup_github_remote(project_dir, url):\n                    _log(\"GIT\", f\"Remote set to: {url}\")\n                continue\n\n            # Utility\n            elif lower_cmd == \"help\":\n                console.print(HELP_TEXT, highlight=False)\n                continue\n            elif lower_cmd == \"clear\":\n                console.clear()\n                continue\n            elif lower_cmd == \"version\":\n                console.print(f\"\\n  [bold cyan]JCode[/bold cyan] [white]v{__version__}[/white]\")\n                console.print(f\"  [dim]https://github.com/ShakenTheCoder/JcodeAgent[/dim]\\n\")\n                continue\n            elif lower_cmd == \"update\":\n                _cmd_update()\n                continue\n            elif lower_cmd == \"uninstall\":\n                _cmd_uninstall(settings_mgr)\n                continue\n            else:\n                console.print(f\"  [dim]Unknown command: /{lower_cmd}[/dim]\")\n                console.print(f\"  [dim]Type /help for available commands[/dim]\")\n                continue\n\n        # \u2500\u2500 Mode-based routing (non-slash input) \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n        try:\n            if mode == \"agent\":\n                # Agentic mode: every message triggers action\n                if _looks_like_build(user_input):\n                    # Full build pipeline for new-project requests\n                    ctx, project_dir = _cmd_build(user_input, ctx, project_dir, settings_mgr)\n                    proj_name = ctx.state.name or project_dir.name\n                else:\n                    # Autonomous modify/create/fix/run\n                    _cmd_agentic(ctx, project_dir, user_input, settings_mgr)\n            else:\n                # Chat mode: reason, explain, search \u2014 no file changes\n                _cmd_chat(ctx, project_dir, user_input)\n        except KeyboardInterrupt:\n            console.print(\"\\n[yellow]\u26a0 Interrupted[/yellow]\")\n            continue\n        except Exception as exc:\n            console.print(f\"\\n[red]\u2717 Error: {exc}[/red]\")\n            console.print(\"[dim]  You can try again or use /help for commands.[/dim]\")\n            continue\n\n\ndef _ensure_git_repo(project_dir: Path) -> None:\n    \"\"\"Ensure git is available and the project has a repo.\"\"\"\n    if not git_manager.ensure_git():\n        return\n    if not git_manager.is_git_repo(project_dir):\n        _log(\"GIT\", \"Initializing git repository\")\n        git_manager.init_repo(project_dir, initial_commit=True)\n\n\ndef _git_auto_commit(\n    project_dir: Path,\n    settings_mgr: SettingsManager,\n    description: str = \"\",\n) -> None:\n    \"\"\"Auto-commit if enabled in settings.\"\"\"\n    if not settings_mgr.settings.git_auto_commit:\n        return\n    if not git_manager.git_available():\n        return\n\n    # Initialize repo if needed\n    if not git_manager.is_git_repo(project_dir):\n        git_manager.init_repo(project_dir, initial_commit=False)\n\n    ok, result = git_manager.auto_commit(project_dir, description)\n    if ok and result != \"nothing to commit\":\n        _log(\"GIT\", f\"Auto-committed: {result}\")\n\n    # Auto-push if enabled\n    if settings_mgr.settings.git_auto_push and ok:\n        remote = git_manager.get_remote_url(project_dir)\n        if remote:\n            push_ok, push_result = git_manager.push(project_dir)\n            if push_ok:\n                _log(\"GIT\", f\"Auto-pushed\")\n\n\n# \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n# Build command \u2014 full autonomous pipeline\n# \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n\ndef _cmd_build(\n    prompt: str,\n    ctx: ContextManager,\n    project_dir: Path,\n    settings_mgr: SettingsManager,\n) -> tuple[ContextManager, Path]:\n    \"\"\"Full autonomous pipeline: classify \u2192 research \u2192 plan \u2192 generate \u2192 review \u2192 verify \u2192 fix.\n    Operates inside the current project directory (CWD).\"\"\"\n\n    console.print(f\"\\n  [dim]Building in:[/dim] [cyan]{project_dir}[/cyan]\")\n\n    # Classify the task (complexity \u00d7 size)\n    classification = classify_task(prompt=prompt)\n    console.print(f\"  [dim]Classification:[/dim] [bold]{classification.label}[/bold]\"\n                  f\"  [dim](complexity={classification.complexity.value}, size={classification.size.value})[/dim]\")\n\n    # Show model routing for this classification\n    model_plan = describe_model_plan(classification.complexity.value, classification.size.value)\n    console.print(f\"  [dim]Models:[/dim]\")\n    for role, model in model_plan.items():\n        console.print(f\"    [dim]{role:>8}:[/dim]  [cyan]{model}[/cyan]\")\n\n    if classification.skip_review:\n        console.print(f\"  [dim]Review:[/dim] [yellow]skipped[/yellow] (simple task)\")\n    if not classification.skip_research:\n        console.print(f\"  [dim]Research:[/dim] [green]enabled[/green] (heavy task)\")\n\n    # Pre-check models\n    complexity_str = classification.complexity.value\n    size_str = classification.size.value\n    _log(\"MODELS\", f\"Ensuring models for '{classification.label}'...\")\n    ensure_models_for_complexity(complexity_str, size_str)\n\n    slug = _slugify(prompt[:40])\n    state = ProjectState(\n        name=slug,\n        description=prompt,\n        output_dir=project_dir,\n        complexity=complexity_str,\n        size=size_str,\n    )\n    ctx = ContextManager(state)\n\n    # -- Phase 0: Research (heavy tasks only)\n    research_brief = \"\"\n    if not classification.skip_research and is_internet_allowed():\n        console.print()\n        _log(\"PHASE 0\", \"Researching \u2014 web search, docs, best practices\")\n        research_brief = research_task(prompt)\n        if research_brief and not research_brief.startswith(\"[\"):\n            # Summarize research using a reasoning model if available\n            _log(\"RESEARCH\", f\"Gathered {len(research_brief)} chars of research context\")\n\n    # -- Phase 1: Planning\n    console.print()\n    _log(\"PHASE 1\", \"Planning project architecture\")\n\n    # For heavy tasks with research, augment the planning prompt\n    plan_prompt = prompt\n    if research_brief and not research_brief.startswith(\"[\"):\n        plan_prompt = prompt + PLANNER_RESEARCH_CONTEXT.format(research_brief=research_brief[:8000])\n\n    plan = create_plan(plan_prompt, ctx)\n    ctx.set_plan(plan)\n\n    # Re-classify with full plan for more accurate routing\n    refined = classify_task(plan=plan)\n    if refined.label != classification.label:\n        console.print(f\"  [dim]Refined classification:[/dim] [bold]{refined.label}[/bold]\")\n        classification = refined\n        ctx.state.complexity = classification.complexity.value\n        ctx.state.size = classification.size.value\n\n    task_count = len(plan.get(\"tasks\", []))\n    _log(\"PLAN\", f\"{task_count} task(s) created\")\n\n    for t in plan.get(\"tasks\", []):\n        deps = f\" [dim](after {t.get('depends_on', [])})[/dim]\" if t.get(\"depends_on\") else \"\"\n        console.print(f\"          {t.get('id', '?')}. [white]{t.get('file', '')}[/white]{deps}\")\n\n    # -- Phase 2: Building\n    console.print()\n    _log(\"PHASE 2\", \"Building \u2014 generate, review, verify, fix\")\n    success = execute_plan(ctx, project_dir)\n\n    # -- Save metadata\n    settings_mgr.save_project_metadata({\n        \"name\": plan.get(\"project_name\", slug),\n        \"prompt\": prompt,\n        \"output_dir\": str(project_dir),\n        \"last_modified\": datetime.now().isoformat(),\n        \"completed\": success,\n        \"classification\": classification.label,\n    })\n\n    # -- Final status\n    console.print()\n    if success:\n        _log(\"DONE\", \"Build complete \u2014 all files verified\")\n    else:\n        _log(\"DONE\", \"Build finished with issues \u2014 type 'plan' to inspect\")\n\n    _auto_save(ctx, project_dir)\n\n    # -- Phase 3: Post-build runtime verification\n    if success:\n        run_cmd, run_cwd = _detect_run_command(project_dir)\n        if run_cmd:\n            console.print()\n            _log(\"PHASE 3\", \"Runtime verification -- running the project to check for errors\")\n            _install_deps_if_needed(project_dir)\n\n            exit_code, run_output = _run_and_capture(run_cmd, run_cwd)\n\n            if exit_code not in (0, -2) and run_output.strip():\n                _log(\"VERIFY\", f\"Runtime error detected (exit code {exit_code})\")\n                MAX_POST_BUILD_FIXES = 3\n                for fix_attempt in range(1, MAX_POST_BUILD_FIXES + 1):\n                    _log(\"FIX\", f\"Post-build fix {fix_attempt}/{MAX_POST_BUILD_FIXES}\")\n                    error_msg = run_output[-3000:]\n                    fix_prompt = (\n                        f\"The project was just built but fails to run. \"\n                        f\"EXACT error output:\\n\\n```\\n{error_msg}\\n```\\n\\n\"\n                        f\"Command: {' '.join(run_cmd)}\\n\"\n                        f\"Fix the code. Output corrected files with ===FILE:=== format.\"\n                    )\n                    _run_fix_prompt(ctx, project_dir, fix_prompt)\n                    _install_deps_if_needed(project_dir)\n\n                    exit_code, run_output = _run_and_capture(run_cmd, run_cwd)\n                    if exit_code in (0, -2):\n                        _log(\"VERIFY\", \"Runtime verification passed after fix\")\n                        break\n                else:\n                    _log(\"VERIFY\", \"Could not auto-fix runtime errors -- you can fix manually in chat\")\n            elif exit_code in (0, -2):\n                _log(\"VERIFY\", \"Runtime verification passed\")\n\n    # -- Git auto-commit\n    _git_auto_commit(project_dir, settings_mgr, f\"build: {prompt[:60]}\")\n\n    return ctx, project_dir\n\n\n# \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n# Agentic mode \u2014 autonomous modify-in-place\n# \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n\ndef _cmd_agentic(\n    ctx: ContextManager,\n    project_dir: Path,\n    user_request: str,\n    settings_mgr: SettingsManager,\n) -> None:\n    \"\"\"Autonomous modification: classify \u2192 scan \u2192 reason \u2192 modify files \u2192 auto-run \u2192 auto-fix \u2192 commit.\"\"\"\n\n    # \u2500\u2500 Step 1: Classify the task so we use the right models \u2500\u2500\n    classification = classify_task(prompt=user_request)\n    complexity_str = classification.complexity.value\n    size_str = classification.size.value\n\n    console.print(f\"\\n  [dim]Classification:[/dim] [bold]{classification.label}[/bold]\"\n                  f\"  [dim](complexity={complexity_str}, size={size_str})[/dim]\")\n\n    model_plan = describe_model_plan(complexity_str, size_str)\n    console.print(f\"  [dim]Models:[/dim]\")\n    for role, model in model_plan.items():\n        console.print(f\"    [dim]{role:>8}:[/dim]  [cyan]{model}[/cyan]\")\n\n    # Pre-check models are available (offer to pull if missing)\n    ensure_models_for_complexity(complexity_str, size_str)\n\n    # \u2500\u2500 Step 2: Refresh context from disk \u2500\u2500\n    _scan_project_files(ctx, project_dir)\n\n    # Build file contents string\n    file_parts = []\n    for path, content in sorted(ctx.state.files.items()):\n        trimmed = content[:6000]\n        file_parts.append(f\"### {path}\\n```\\n{trimmed}\\n```\")\n    file_contents = \"\\n\\n\".join(file_parts) if file_parts else \"(no files yet)\"\n\n    # Project summary\n    project_summary = ctx.get_project_summary_for_chat()\n\n    # Git status\n    git_status = \"\"\n    if git_manager.git_available() and git_manager.is_git_repo(project_dir):\n        changed = git_manager.changed_files(project_dir)\n        if changed:\n            git_status = f\"Modified files: {', '.join(changed[:20])}\"\n        else:\n            git_status = \"Clean working tree\"\n\n    # \u2500\u2500 Step 3: Build prompt and call model with proper routing \u2500\u2500\n    full_prompt = AGENTIC_TASK.format(\n        project_summary=project_summary,\n        file_contents=file_contents,\n        user_request=user_request,\n        git_status=git_status,\n    )\n\n    ctx.add_chat(\"user\", user_request)\n\n    _log(\"AGENTIC\", \"Analyzing and modifying project...\")\n    messages = [\n        {\"role\": \"system\", \"content\": AGENTIC_SYSTEM},\n        {\"role\": \"user\", \"content\": full_prompt},\n    ]\n\n    response = call_model(\n        \"coder\", messages, stream=True,\n        complexity=complexity_str, size=size_str,\n    )\n\n    # \u2500\u2500 Step 4: Apply file changes (files before commands) \u2500\u2500\n    files_written = _apply_file_changes(response, project_dir, ctx)\n\n    # Execute any ===RUN:=== or ===BACKGROUND:=== commands\n    commands_run = _apply_run_commands(response, project_dir)\n\n    # \u2500\u2500 Build clean display text: always strip file/command blocks \u2500\u2500\n    # We strip regardless of files_written count \u2014 prevents raw code spilling into panel\n    # even when the parser matched a different format from what the stripper expects.\n    display_text = response\n    # Remove ===FILE:...===END=== blocks\n    display_text = re.sub(r\"===FILE:.*?===END===\", \"\", display_text, flags=re.DOTALL)\n    # Remove ===FILE: path=== + ``` block\n    display_text = re.sub(\n        r\"===FILE:\\s*.+?\\s*===[ \\t]*\\n```\\w*[ \\t]*\\n.*?\\n```\",\n        \"\", display_text, flags=re.DOTALL\n    )\n    # Remove remaining ===FILE: path=== blocks (raw content fallback)\n    display_text = re.sub(\n        r\"===FILE:\\s*.+?\\s*===[ \\t]*\\n.*?(?=\\n===(?:FILE|RUN|BACKGROUND)|$)\",\n        \"\", display_text, flags=re.DOTALL\n    )\n    # Remove markdown headings that are just file paths (### FILE: path)\n    display_text = re.sub(\n        r\"\\n#{1,4}\\s+(?:FILE[:\\s]+)?[a-zA-Z0-9_/. -]+\\.[a-zA-Z0-9]+[ \\t]*\\n```\\w*[ \\t]*\\n.*?\\n```\",\n        \"\", display_text, flags=re.DOTALL\n    )\n    # Remove ===RUN:=== and ===BACKGROUND:=== lines\n    display_text = re.sub(r\"===(RUN|BACKGROUND):\\s*.+?===\", \"\", display_text, flags=re.IGNORECASE)\n    # Collapse multiple blank lines\n    display_text = re.sub(r\"\\n{3,}\", \"\\n\\n\", display_text).strip()\n\n    if files_written > 0:\n        _log(\"APPLIED\", f\"Modified {files_written} file(s)\")\n    if commands_run > 0:\n        _log(\"APPLIED\", f\"Executed {commands_run} command(s)\")\n\n    if display_text:\n        console.print()\n        try:\n            console.print(Panel(Markdown(display_text), border_style=\"cyan\", padding=(1, 2)))\n        except Exception:\n            console.print(Panel(display_text, border_style=\"cyan\", padding=(1, 2)))\n\n    ctx.add_chat(\"assistant\", response[:3000])\n    _auto_save(ctx, project_dir)\n\n    # \u2500\u2500 Step 5: Auto-run the project after code changes \u2500\u2500\n    if files_written > 0:\n        _agentic_auto_run(ctx, project_dir, settings_mgr, user_request,\n                          complexity_str, size_str)\n\n    # Auto-commit after agentic changes\n    if files_written > 0:\n        _git_auto_commit(project_dir, settings_mgr, user_request[:60])\n\n    console.print()\n\n\ndef _agentic_auto_run(\n    ctx: ContextManager,\n    project_dir: Path,\n    settings_mgr: SettingsManager,\n    user_request: str,\n    complexity: str,\n    size: str,\n) -> None:\n    \"\"\"Auto-run after agentic code generation: install deps \u2192 detect \u2192 run \u2192 auto-fix loop.\"\"\"\n    console.print()\n    _log(\"AUTO-RUN\", \"Attempting to run the project after code changes...\")\n\n    # Install dependencies first\n    _install_deps_if_needed(project_dir)\n\n    # Detect how to run\n    run_cmd, run_cwd = _detect_run_command(project_dir)\n    if not run_cmd:\n        _log(\"AUTO-RUN\", \"Could not detect run command \u2014 skipping auto-run\")\n        return\n\n    MAX_AUTO_FIX = 3\n    for attempt in range(1, MAX_AUTO_FIX + 1):\n        _log(\"AUTO-RUN\", f\"{' '.join(run_cmd)} (in {run_cwd.name})\")\n        exit_code, output = _run_and_capture(run_cmd, run_cwd)\n\n        if exit_code == 0:\n            _log(\"AUTO-RUN\", \"Project ran successfully \u2713\")\n            return\n\n        if exit_code == -2:\n            # User pressed Ctrl+C \u2014 don't auto-fix, just return\n            return\n\n        _log(\"AUTO-RUN\", f\"Process exited with code {exit_code}\")\n\n        if attempt >= MAX_AUTO_FIX:\n            _log(\"AUTO-FIX\", f\"Could not auto-fix after {MAX_AUTO_FIX} attempts\")\n            console.print(\"  [dim]You can describe the issue and JCode will help fix it.[/dim]\")\n            return\n\n        # Auto-fix: feed the error back to the model\n        _log(\"AUTO-FIX\", f\"Attempt {attempt}/{MAX_AUTO_FIX} \u2014 analyzing runtime error...\")\n        error_msg = output[-3000:] if len(output) > 3000 else output\n\n        fix_prompt = (\n            f\"The project failed to run after your last changes.\\n\\n\"\n            f\"EXACT error output:\\n```\\n{error_msg}\\n```\\n\\n\"\n            f\"Command: {' '.join(run_cmd)}\\n\"\n            f\"Working directory: {run_cwd}\\n\\n\"\n            f\"Read the error carefully. Find and fix the broken file(s). \"\n            f\"Output COMPLETE corrected files using ===FILE: path=== ... ===END=== format. \"\n            f\"If dependencies are missing, add ===RUN: npm install xyz=== or similar.\\n\"\n            f\"Do NOT give advice \u2014 just fix the code.\"\n        )\n\n        _run_fix_prompt(ctx, project_dir, fix_prompt)\n\n        # Re-install deps in case fix added new packages\n        _install_deps_if_needed(project_dir)\n\n        _log(\"AUTO-FIX\", \"Re-running after fix...\")\n\n\ndef _scan_project_files(ctx: ContextManager, project_dir: Path) -> None:\n    \"\"\"Scan project directory and load file contents into context.\"\"\"\n    if not project_dir.exists():\n        return\n    skip_dirs = {\".git\", \"node_modules\", \".venv\", \"__pycache__\", \".next\", \"dist\", \"build\"}\n    for f in project_dir.rglob(\"*\"):\n        if f.is_file() and not f.name.startswith(\".\"):\n            if any(part in skip_dirs for part in f.relative_to(project_dir).parts):\n                continue\n            try:\n                rel = str(f.relative_to(project_dir))\n                content = f.read_text(errors=\"replace\")\n                ctx.record_file(rel, content)\n            except Exception:\n                pass\n\n\n# \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n# Fix prompt helper \u2014 used by /run auto-fix and agentic auto-fix\n# \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n\ndef _run_fix_prompt(ctx: ContextManager, project_dir: Path, fix_prompt: str) -> int:\n    \"\"\"Call the model with a fix prompt and apply file changes + run commands.\n\n    Returns number of files written. Used internally by auto-fix loops \u2014\n    this DOES modify files (unlike _cmd_chat which is read-only).\n    \"\"\"\n    _scan_project_files(ctx, project_dir)\n\n    file_parts = []\n    for path, content in sorted(ctx.state.files.items()):\n        trimmed = content[:6000]\n        file_parts.append(f\"### {path}\\n```\\n{trimmed}\\n```\")\n    file_contents = \"\\n\\n\".join(file_parts) if file_parts else \"(no files yet)\"\n\n    full_prompt = f\"{fix_prompt}\\n\\n## All Project Files\\n{file_contents}\"\n\n    _log(\"FIX\", \"Generating fix...\")\n    messages = [\n        {\"role\": \"system\", \"content\": AGENTIC_SYSTEM},\n        {\"role\": \"user\", \"content\": full_prompt},\n    ]\n    response = call_model(\"coder\", messages, stream=True)\n\n    files_written = _apply_file_changes(response, project_dir, ctx)\n    cmds_run = _apply_run_commands(response, project_dir)\n\n    if files_written > 0:\n        _log(\"FIX\", f\"Fixed {files_written} file(s)\")\n    if cmds_run > 0:\n        _log(\"FIX\", f\"Ran {cmds_run} command(s)\")\n\n    return files_written\n\n\n# \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n# Chat \u2014 conversational mode (read-only)\n# \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n\ndef _cmd_chat(ctx: ContextManager, project_dir: Path, user_message: str) -> None:\n    \"\"\"\n    Chat mode: reasoning, explanations, web search \u2014 but NO file modifications.\n    The model can see all project files for context but cannot change them.\n    \"\"\"\n\n    # Refresh file contents from disk (read-only context)\n    _scan_project_files(ctx, project_dir)\n\n    # Build file contents string (all files, capped per file)\n    file_parts = []\n    for path, content in sorted(ctx.state.files.items()):\n        trimmed = content[:6000]\n        file_parts.append(f\"### {path}\\n```\\n{trimmed}\\n```\")\n    file_contents = \"\\n\\n\".join(file_parts) if file_parts else \"(no files yet)\"\n\n    # Build chat history string (last 20 messages)\n    chat_lines = []\n    for msg in ctx.chat_history[-20:]:\n        role = msg[\"role\"].upper()\n        chat_lines.append(f\"{role}: {msg['content'][:800]}\")\n    chat_history_str = \"\\n\".join(chat_lines) if chat_lines else \"(start of conversation)\"\n\n    # Build the prompt\n    project_summary = ctx.get_project_summary_for_chat()\n    full_prompt = CHAT_CONTEXT.format(\n        project_summary=project_summary,\n        file_contents=file_contents,\n        chat_history=chat_history_str,\n        user_message=user_message,\n    )\n\n    # Record user message\n    ctx.add_chat(\"user\", user_message)\n\n    # Call the model\n    _log(\"THINKING\", \"Processing your request...\")\n    messages = [\n        {\"role\": \"system\", \"content\": CHAT_SYSTEM},\n        {\"role\": \"user\", \"content\": full_prompt},\n    ]\n\n    response = call_model(\"coder\", messages, stream=True)\n\n    # Display the response (strip any ===FILE:=== or ===RUN:=== blocks \u2014 chat mode is read-only)\n    display_text = re.sub(\n        r\"===FILE:.*?===END===\", \"\", response, flags=re.DOTALL\n    ).strip()\n    display_text = re.sub(\n        r\"===(RUN|BACKGROUND):\\s*.+?===\", \"\", display_text, flags=re.IGNORECASE\n    ).strip()\n\n    if display_text:\n        console.print()\n        try:\n            console.print(Panel(Markdown(display_text), border_style=\"dim\", padding=(1, 2)))\n        except Exception:\n            console.print(Panel(display_text, border_style=\"dim\", padding=(1, 2)))\n\n    # Record assistant response\n    ctx.add_chat(\"assistant\", response[:3000])\n    _auto_save(ctx, project_dir)\n    console.print()\n\n\ndef _strip_content_fences(content: str) -> str:\n    \"\"\"Strip markdown code fences from file content.\n\n    Models often wrap file content in ```lang ... ``` despite instructions.\n    This removes them so the raw content gets written to disk.\n    \"\"\"\n    content = content.strip()\n    # Strip opening fence: ```json, ```javascript, ```python, ```, etc.\n    content = re.sub(r\"^```\\w*\\s*\\n?\", \"\", content)\n    # Strip closing fence (at end)\n    content = re.sub(r\"\\n?```\\s*$\", \"\", content)\n    return content.strip()\n\n\ndef _apply_file_changes(response: str, project_dir: Path, ctx: ContextManager) -> int:\n    \"\"\"\n    Parse file blocks from model response and write files.\n    Handles every format that local models produce:\n\n    FORMAT 1 (ideal):    ===FILE: path=== ... ===END===\n    FORMAT 2 (common):   ===FILE: path=== ```lang ... ```  (no ===END===)\n    FORMAT 4 (fallback): ===FILE: path=== raw content until next marker\n    FORMAT 3 (heading):  ### path  OR  ### FILE: path  OR  **path**  + code block\n    FORMAT 5 (#### FILE):  #### FILE: path  OR  #### path  + code block\n\n    Returns count of files written.\n    \"\"\"\n    files_written = 0\n    written_paths: set[str] = set()\n\n    # \u2500\u2500 Pre-process: normalise ===END=== that ended up inside a ``` block \u2500\u2500\n    # The model sometimes wraps the entire file block in a markdown fence, so you get:\n    # ```\\n===FILE: x===\\ncontent\\n===END===\\n```\n    # Strip the outer fence, keep the inner markers.\n    response = re.sub(r\"^```\\w*\\s*\\n(===(?:FILE|END))\", r\"\\1\", response, flags=re.MULTILINE)\n    response = re.sub(r\"\\n===END===\\n```\", \"\\n===END===\", response)\n\n    # \u2500\u2500 Helper: write one file \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n    def _write(rel_path: str, content: str) -> bool:\n        rel_path = rel_path.strip().lstrip(\"/\")\n        content = _strip_content_fences(content)\n        # Remove stray ===END=== lines that leaked into content\n        content = re.sub(r\"^===END===$\", \"\", content, flags=re.MULTILINE).strip()\n        if not rel_path or not content:\n            return False\n        if rel_path in written_paths:\n            return False\n        # Sanity: must look like a valid file path\n        if len(rel_path) > 200 or \"\\n\" in rel_path:\n            return False\n        full_path = project_dir / rel_path\n        full_path.parent.mkdir(parents=True, exist_ok=True)\n        full_path.write_text(content)\n        ctx.record_file(rel_path, content)\n        console.print(f\"           [dim]wrote[/dim] [white]{rel_path}[/white]\")\n        written_paths.add(rel_path)\n        return True\n\n    # \u2500\u2500 FORMAT 1: ===FILE: path=== ... ===END=== \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n    for rel_path, content in re.findall(\n        r\"===FILE:\\s*(.+?)\\s*===[ \\t]*\\n(.*?)===END===\",\n        response, re.DOTALL\n    ):\n        if _write(rel_path, content):\n            files_written += 1\n\n    # \u2500\u2500 FORMAT 2: ===FILE: path=== followed by ``` block \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n    fmt2 = re.compile(\n        r\"===FILE:\\s*(.+?)\\s*===[ \\t]*\\n\"\n        r\"```\\w*[ \\t]*\\n\"\n        r\"(.*?)\"\n        r\"\\n```\",\n        re.DOTALL,\n    )\n    for m in fmt2.finditer(response):\n        if _write(m.group(1), m.group(2)):\n            files_written += 1\n\n    # \u2500\u2500 FORMAT 4: ===FILE: path=== + raw content (ultimate fallback) \u2500\n    if not written_paths:\n        markers = list(re.finditer(r\"===FILE:\\s*(.+?)\\s*===[ \\t]*\\n\", response))\n        for i, m in enumerate(markers):\n            start = m.end()\n            if i + 1 < len(markers):\n                end = markers[i + 1].start()\n            else:\n                nxt = re.search(r\"\\n===(RUN|BACKGROUND):\", response[start:])\n                end = start + nxt.start() if nxt else len(response)\n            if _write(m.group(1), response[start:end]):\n                files_written += 1\n\n    # \u2500\u2500 FORMAT 3 & 5: Markdown headings + code block \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n    # Catches:\n    #   ### main.py          (plain heading)\n    #   ### FILE: main.py    (FILE: prefix)\n    #   #### FILE: main.py\n    #   **main.py**\n    #   ### Updated `main.py`\n    fmt35 = re.compile(\n        r\"(?:^|\\n)\"\n        # heading variants: ###/####/## with optional label words + optional backticks\n        r\"(?:#{1,4}\\s+(?:(?:FILE|Updated|Modified|File)[:\\s]+)?\"\n        r\"[`'\\\"]?([a-zA-Z0-9_/.\\\\ -]+\\.[a-zA-Z0-9]+)[`'\\\"]?\"\n        # OR bold **filename**\n        r\"|\\*\\*([a-zA-Z0-9_/.\\\\ -]+\\.[a-zA-Z0-9]+)\\*\\*)\"\n        r\"[ \\t]*\\n+\"\n        r\"```\\w*[ \\t]*\\n\"\n        r\"(.*?)\"\n        r\"\\n```\",\n        re.DOTALL,\n    )\n    for m in fmt35.finditer(response):\n        rel_path = (m.group(1) or m.group(2) or \"\").strip()\n        content = m.group(3)\n        if rel_path and \".\" in rel_path and len(content.strip()) > 5:\n            if _write(rel_path, content):\n                files_written += 1\n\n    if files_written > 0:\n        console.print(f\"           [green]\u2713 {files_written} file(s) written to disk[/green]\")\n    return files_written\n\n\ndef _apply_run_commands(response: str, project_dir: Path) -> int:\n    \"\"\"\n    Parse ===RUN: command=== and ===BACKGROUND: command=== blocks and execute them.\n    Returns count of commands executed.\n\n    ===RUN: command=== \u2014 runs synchronously, waits for completion\n    ===BACKGROUND: command=== \u2014 runs in background (for servers/watchers)\n    \"\"\"\n    commands_run = 0\n\n    # Find all ===RUN:=== and ===BACKGROUND:=== blocks in order\n    pattern = re.compile(r\"===(RUN|BACKGROUND):\\s*(.+?)\\s*===\", re.IGNORECASE)\n    matches = list(pattern.finditer(response))\n\n    if not matches:\n        return 0\n\n    _log(\"EXEC\", f\"Running {len(matches)} command(s)\")\n\n    for m in matches:\n        cmd_type = m.group(1).upper()\n        cmd = m.group(2).strip()\n\n        if not cmd:\n            continue\n\n        # Safety: skip obviously dangerous commands\n        dangerous = (\"rm -rf /\", \"rm -rf ~\", \"sudo rm\", \":(){\", \"mkfs\", \"dd if=\")\n        if any(d in cmd.lower() for d in dangerous):\n            _log(\"EXEC\", f\"  \u26a0 Skipped dangerous command: {cmd}\")\n            continue\n\n        # Skip commands that would launch interactive/blocking programs.\n        # The user can run those manually with /run or by typing the command.\n        _interactive_signals = (\n            \"python3 main.py\", \"python main.py\",\n            \"node index.js\", \"node app.js\", \"node server.js\",\n            \"npm start\", \"yarn start\", \"cargo run\", \"go run\",\n            \"ruby \", \"php -S\",\n        )\n        if any(cmd.lower().startswith(s) for s in _interactive_signals) and cmd_type == \"RUN\":\n            _log(\"EXEC\", f\"  \u21b7 Skipped interactive program (use /run to launch): {cmd}\")\n            continue\n\n        if cmd_type == \"BACKGROUND\":\n            _log(\"EXEC\", f\"  \u26a1 [background] {cmd}\")\n            try:\n                subprocess.Popen(\n                    cmd,\n                    shell=True,\n                    cwd=project_dir,\n                    stdout=subprocess.DEVNULL,\n                    stderr=subprocess.DEVNULL,\n                    start_new_session=True,\n                )\n                commands_run += 1\n                console.print(f\"           [dim]started in background[/dim]\")\n            except Exception as e:\n                _log(\"EXEC\", f\"  \u2717 Failed: {e}\")\n        else:\n            _log(\"EXEC\", f\"  \u25b6 {cmd}\")\n            try:\n                result = subprocess.run(\n                    cmd,\n                    shell=True,\n                    cwd=project_dir,\n                    capture_output=True,\n                    text=True,\n                    timeout=120,\n                )\n                commands_run += 1\n                if result.stdout.strip():\n                    # Show first 20 lines of output\n                    lines = result.stdout.strip().split(\"\\n\")\n                    for line in lines[:20]:\n                        console.print(f\"           [dim]{line}[/dim]\")\n                    if len(lines) > 20:\n                        console.print(f\"           [dim]... ({len(lines) - 20} more lines)[/dim]\")\n                if result.returncode != 0:\n                    err = result.stderr.strip()[:500] if result.stderr else \"\"\n                    if err:\n                        _log(\"EXEC\", f\"  \u26a0 exit {result.returncode}: {err[:200]}\")\n                    else:\n                        _log(\"EXEC\", f\"  \u26a0 exit {result.returncode}\")\n                    # Stop executing remaining commands on failure\n                    _log(\"EXEC\", \"  Stopping \u2014 fix the error before continuing\")\n                    break\n            except subprocess.TimeoutExpired:\n                _log(\"EXEC\", f\"  \u26a0 Timed out (120s): {cmd}\")\n                break\n            except Exception as e:\n                _log(\"EXEC\", f\"  \u2717 Failed: {e}\")\n                break\n\n    return commands_run\n\n\n# \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n# Run command \u2014 smart detection with dep install\n# \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n\ndef _cmd_run(ctx: ContextManager, project_dir: Path, settings_mgr: SettingsManager) -> None:\n    \"\"\"Auto-detect and run the project. If it fails, auto-fix and retry.\"\"\"\n    if not project_dir or not project_dir.exists():\n        console.print(\"  [dim]No project directory.[/dim]\")\n        return\n\n    _log(\"RUN\", f\"Detecting how to run {project_dir.name}\")\n\n    # Install dependencies first if needed\n    _install_deps_if_needed(project_dir)\n\n    # Find the run command\n    run_cmd, run_cwd = _detect_run_command(project_dir)\n    if not run_cmd:\n        console.print(\"  [dim]Could not detect how to run this project.[/dim]\")\n        console.print(\"  [dim]Ask JCode: 'how do I run this project?'[/dim]\")\n        return\n\n    MAX_RUN_FIX_ATTEMPTS = 5\n    for attempt in range(1, MAX_RUN_FIX_ATTEMPTS + 1):\n        _log(\"RUN\", f\"{' '.join(run_cmd)} (in {run_cwd.name})\")\n\n        exit_code, output = _run_and_capture(run_cmd, run_cwd)\n\n        if exit_code == 0:\n            _log(\"RUN\", \"Process exited successfully\")\n            return\n\n        if exit_code == -2:\n            return\n\n        _log(\"RUN\", f\"Process exited with code {exit_code}\")\n\n        if attempt >= MAX_RUN_FIX_ATTEMPTS:\n            _log(\"RUN\", f\"Failed after {MAX_RUN_FIX_ATTEMPTS} fix attempts\")\n            console.print(\n                \"  [dim]Auto-fix could not resolve the issue. Try fixing manually:[/dim]\"\n            )\n            console.print(f\"  [dim]Tell JCode what you see and it will help.[/dim]\")\n            return\n\n        _log(\"FIX\", f\"Attempt {attempt}/{MAX_RUN_FIX_ATTEMPTS} -- auto-fixing runtime error\")\n        error_msg = output[-3000:] if len(output) > 3000 else output\n\n        fix_prompt = (\n            f\"The project failed to run. Here is the EXACT error output:\\n\\n\"\n            f\"```\\n{error_msg}\\n```\\n\\n\"\n            f\"Command: {' '.join(run_cmd)}\\n\"\n            f\"Working directory: {run_cwd}\\n\\n\"\n            f\"Read the error, find the affected file(s) in the project, and fix them. \"\n            f\"Output the corrected files using ===FILE:=== format. \"\n            f\"Do NOT give advice or suggestions \u2014 just fix the code.\"\n        )\n        _run_fix_prompt(ctx, project_dir, fix_prompt)\n\n        _install_deps_if_needed(project_dir)\n\n        _log(\"FIX\", \"Re-running after fix...\")\n\n\ndef _cmd_test(project_dir: Path, ctx: ContextManager) -> None:\n    \"\"\"Detect and run project tests.\"\"\"\n    if not project_dir.exists():\n        console.print(\"  [dim]No project directory.[/dim]\")\n        return\n\n    _log(\"TEST\", \"Detecting test runner...\")\n\n    # Python: pytest or unittest\n    if (project_dir / \"pytest.ini\").exists() or (project_dir / \"setup.cfg\").exists() or \\\n       list(project_dir.rglob(\"test_*.py\")) or list(project_dir.rglob(\"*_test.py\")):\n        _log(\"TEST\", \"Running pytest\")\n        exit_code, output = _run_and_capture([\"python3\", \"-m\", \"pytest\", \"-v\"], project_dir)\n        return\n\n    # Node: npm test\n    pkg_json = project_dir / \"package.json\"\n    if pkg_json.exists():\n        try:\n            pkg = json.loads(pkg_json.read_text())\n            if \"test\" in pkg.get(\"scripts\", {}):\n                _log(\"TEST\", \"Running npm test\")\n                exit_code, output = _run_and_capture([\"npm\", \"test\"], project_dir)\n                return\n        except Exception:\n            pass\n\n    console.print(\"  [dim]No test runner detected.[/dim]\")\n    console.print(\"  [dim]Supported: pytest, npm test[/dim]\")\n\n\ndef _detect_run_command(project_dir: Path) -> tuple[list[str] | None, Path | None]:\n    \"\"\"Detect the command needed to run this project. Returns (cmd, cwd) or (None, None).\"\"\"\n    # 1. Python: look for main entry points\n    for entry in (\"main.py\", \"app.py\", \"manage.py\", \"server.py\", \"run.py\"):\n        candidate = project_dir / entry\n        if candidate.exists():\n            return [\"python3\", str(candidate)], project_dir\n        for subdir in (\"backend\", \"src\", \"server\", \"api\"):\n            candidate = project_dir / subdir / entry\n            if candidate.exists():\n                return [\"python3\", str(candidate)], project_dir / subdir\n\n    # 2. Node: package.json with start/dev script (search root + common subdirs)\n    node_search_dirs = [project_dir] + [\n        project_dir / d for d in (\"backend\", \"server\", \"api\", \"frontend\", \"client\", \"app\")\n    ]\n    for search_dir in node_search_dirs:\n        pkg_json = search_dir / \"package.json\"\n        if pkg_json.exists():\n            try:\n                pkg = json.loads(pkg_json.read_text())\n                scripts = pkg.get(\"scripts\", {})\n                if \"start\" in scripts:\n                    return [\"npm\", \"start\"], search_dir\n                elif \"dev\" in scripts:\n                    return [\"npm\", \"run\", \"dev\"], search_dir\n            except json.JSONDecodeError:\n                _log(\"RUN\", f\"\u26a0 {pkg_json} has invalid JSON \u2014 cannot detect run command\")\n            except Exception:\n                pass\n\n    # 3. Node.js: common entry files in root and subdirs\n    #    (fallback when package.json has no scripts or doesn't exist)\n    node_entries = (\"app.js\", \"index.js\", \"server.js\", \"main.js\")\n    for entry in node_entries:\n        candidate = project_dir / entry\n        if candidate.exists():\n            return [\"node\", str(candidate)], project_dir\n    for subdir in (\"server\", \"backend\", \"src\", \"api\"):\n        sub_path = project_dir / subdir\n        if sub_path.is_dir():\n            for entry in node_entries:\n                candidate = sub_path / entry\n                if candidate.exists():\n                    return [\"node\", str(candidate)], sub_path\n\n    # 4. HTML: look for index.html\n    for loc in [project_dir, project_dir / \"public\", project_dir / \"frontend\",\n                project_dir / \"client\", project_dir / \"dist\"]:\n        index_html = loc / \"index.html\"\n        if index_html.exists():\n            return [\"open\", str(index_html)], loc\n\n    # 5. package.json exists but has NO scripts \u2014 try `node` on main field\n    for search_dir in node_search_dirs:\n        pkg_json = search_dir / \"package.json\"\n        if pkg_json.exists():\n            try:\n                pkg = json.loads(pkg_json.read_text())\n                main_file = pkg.get(\"main\")\n                if main_file and (search_dir / main_file).exists():\n                    return [\"node\", str(search_dir / main_file)], search_dir\n            except Exception:\n                pass\n\n    # 6. Any .py file\n    py_files = list(project_dir.glob(\"*.py\"))\n    if py_files:\n        return [\"python3\", str(py_files[0])], project_dir\n\n    return None, None\n\n\ndef _run_and_capture(cmd: list[str], cwd: Path) -> tuple[int, str]:\n    \"\"\"\n    Run a subprocess, stream output to console AND capture it.\n    Returns (exit_code, captured_output).\n    exit_code -2 means user interrupted (Ctrl+C).\n    \"\"\"\n    console.print(f\"  [dim]Running: {' '.join(cmd)}[/dim]\")\n    console.print(f\"  [dim]Press Ctrl+C to stop[/dim]\\n\")\n\n    captured_lines = []\n    try:\n        process = subprocess.Popen(\n            cmd,\n            cwd=cwd,\n            stdout=subprocess.PIPE,\n            stderr=subprocess.STDOUT,\n            text=True,\n            bufsize=1,\n        )\n        for line in iter(process.stdout.readline, \"\"):\n            console.print(f\"  {line.rstrip()}\")\n            captured_lines.append(line)\n        process.wait()\n        return process.returncode, \"\".join(captured_lines)\n    except KeyboardInterrupt:\n        process.terminate()\n        console.print(\"\\n  [dim]Process stopped.[/dim]\")\n        return -2, \"\".join(captured_lines)\n    except FileNotFoundError:\n        msg = f\"Command not found: {cmd[0]}\"\n        console.print(f\"  [dim]{msg}[/dim]\")\n        return 1, msg\n    except Exception as e:\n        msg = f\"Error: {e}\"\n        console.print(f\"  [dim]{msg}[/dim]\")\n        return 1, msg\n\n\ndef _install_deps_if_needed(project_dir: Path) -> None:\n    \"\"\"Install project dependencies if package manager files exist.\"\"\"\n    # Node: package.json without node_modules\n    for search_dir in [project_dir] + [project_dir / d for d in (\"backend\", \"server\", \"frontend\", \"client\")]:\n        pkg_json = search_dir / \"package.json\"\n        node_modules = search_dir / \"node_modules\"\n        if pkg_json.exists() and not node_modules.exists():\n            _log(\"DEPS\", f\"Installing npm packages in {search_dir.name}/...\")\n            try:\n                subprocess.run(\n                    [\"npm\", \"install\"],\n                    cwd=search_dir,\n                    capture_output=True,\n                    text=True,\n                    timeout=120,\n                )\n                _log(\"DEPS\", \"npm install complete\")\n            except Exception as e:\n                console.print(f\"  [dim]npm install failed: {e}[/dim]\")\n\n    # Python: requirements.txt\n    req_txt = project_dir / \"requirements.txt\"\n    if req_txt.exists():\n        _log(\"DEPS\", \"Installing Python requirements...\")\n        try:\n            subprocess.run(\n                [\"python3\", \"-m\", \"pip\", \"install\", \"-r\", str(req_txt), \"-q\"],\n                cwd=project_dir,\n                capture_output=True,\n                text=True,\n                timeout=120,\n            )\n            _log(\"DEPS\", \"pip install complete\")\n        except Exception as e:\n            console.print(f\"  [dim]pip install failed: {e}[/dim]\")\n\n\n# \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n# Project info commands\n# \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n\ndef _cmd_models() -> None:\n    \"\"\"Show available models and how they're routed.\"\"\"\n    from jcode.config import MODEL_REGISTRY, _is_model_local, describe_model_plan\n\n    console.print()\n    console.print(\"  [bold white]Installed Models & Routing[/bold white]\\n\")\n\n    # Show installed models grouped by category\n    categories: dict[str, list] = {}\n    for spec in MODEL_REGISTRY:\n        if _is_model_local(spec.name):\n            categories.setdefault(spec.category, []).append(spec)\n\n    if not categories:\n        console.print(\"  [yellow]No registered models found locally.[/yellow]\")\n        console.print(\"  [dim]Install models with: ollama pull <model>[/dim]\")\n        console.print(\"  [dim]Recommended: ollama pull qwen2.5-coder:14b[/dim]\")\n        console.print()\n        return\n\n    table = Table(show_header=True, header_style=\"bold cyan\", border_style=\"dim\")\n    table.add_column(\"Model\", style=\"white\")\n    table.add_column(\"Category\", style=\"cyan\")\n    table.add_column(\"Size\", justify=\"center\")\n    table.add_column(\"Thinking\", justify=\"center\")\n    table.add_column(\"Tools\", justify=\"center\")\n\n    for cat in (\"coding\", \"reasoning\", \"agentic\", \"fast\", \"general\"):\n        specs = categories.get(cat, [])\n        for spec in sorted(specs, key=lambda s: s.priority):\n            table.add_row(\n                spec.name,\n                spec.category,\n                spec.size_class,\n                \"\u2713\" if spec.supports_thinking else \"\",\n                \"\u2713\" if spec.supports_tools else \"\",\n            )\n\n    console.print(table)\n    console.print()\n\n    # Show routing for each classification level\n    console.print(\"  [bold white]Model Routing by Classification[/bold white]\\n\")\n    for label in (\"simple/small\", \"medium/medium\", \"heavy/large\"):\n        parts = label.split(\"/\")\n        plan = describe_model_plan(parts[0], parts[1])\n        console.print(f\"  [dim]{label:>12}:[/dim]  \"\n                      f\"planner=[cyan]{plan['planner']}[/cyan]  \"\n                      f\"coder=[cyan]{plan['coder']}[/cyan]  \"\n                      f\"reviewer=[cyan]{plan['reviewer']}[/cyan]\")\n    console.print()\n\n\n# \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n# Project info commands\n# \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n\ndef _cmd_plan(ctx: ContextManager | None) -> None:\n    \"\"\"Show the current plan.\"\"\"\n    if not ctx or not ctx.state.plan:\n        console.print(\"  [dim]No active plan.[/dim]\")\n        return\n\n    plan = ctx.state.plan\n    console.print(\n        Panel(\n            f\"[bold white]{plan.get('project_name', 'Project')}[/bold white]\\n\"\n            f\"[dim]{plan.get('architecture_summary', '')}[/dim]\",\n            title=\"Plan\",\n            border_style=\"cyan\",\n        )\n    )\n\n    summary = ctx.get_task_summary()\n    if summary:\n        console.print(summary)\n\n\ndef _cmd_files(project_dir: Path | None) -> None:\n    \"\"\"List all project files.\"\"\"\n    if not project_dir or not project_dir.exists():\n        console.print(\"  [dim]No project directory yet.[/dim]\")\n        return\n\n    skip_dirs = {\".git\", \"node_modules\", \".venv\", \"__pycache__\", \".next\", \"dist\", \"build\"}\n    files = []\n    for f in project_dir.rglob(\"*\"):\n        if f.is_file() and not f.name.startswith(\".\"):\n            if not any(part in skip_dirs for part in f.relative_to(project_dir).parts):\n                files.append(f)\n\n    if not files:\n        console.print(\"  [dim]No files yet.[/dim]\")\n        return\n\n    table = Table(show_header=True, header_style=\"bold cyan\", border_style=\"dim\")\n    table.add_column(\"File\", style=\"white\")\n    table.add_column(\"Size\", justify=\"right\", style=\"dim\")\n\n    for f in sorted(files):\n        rel = f.relative_to(project_dir)\n        table.add_row(str(rel), _format_size(f.stat().st_size))\n\n    console.print(table)\n\n\ndef _cmd_tree(ctx: ContextManager | None, project_dir: Path | None) -> None:\n    \"\"\"Show the project tree.\"\"\"\n    if not project_dir or not project_dir.exists():\n        console.print(\"  [dim]No project directory yet.[/dim]\")\n        return\n    name = project_dir.name\n    if ctx and ctx.state.plan:\n        name = ctx.state.plan.get(\"project_name\", project_dir.name)\n    print_tree(project_dir, name)\n\n\n# \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n# Update / Uninstall\n# \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n\ndef _cmd_update() -> None:\n    \"\"\"Self-update JCode from git.\"\"\"\n    jcode_root = Path(__file__).resolve().parent.parent\n\n    _log(\"UPDATE\", f\"Installed at {jcode_root}\")\n    console.print(f\"  [dim]Current version: v{__version__}[/dim]\")\n\n    if not (jcode_root / \".git\").exists():\n        console.print(\"  [dim]Not a git install. Cannot auto-update.[/dim]\")\n        return\n\n    _log(\"UPDATE\", \"Pulling latest changes\")\n    try:\n        result = subprocess.run(\n            [\"git\", \"-C\", str(jcode_root), \"pull\", \"--ff-only\"],\n            capture_output=True, text=True, timeout=30,\n        )\n        if result.returncode != 0:\n            console.print(f\"  [dim]Git pull failed: {result.stderr.strip()}[/dim]\")\n            return\n        if \"Already up to date\" in result.stdout:\n            console.print(\"  [cyan]Already on the latest version.[/cyan]\")\n            return\n        console.print(f\"  [dim]{result.stdout.strip()}[/dim]\")\n    except FileNotFoundError:\n        console.print(\"  [dim]Git is not installed.[/dim]\")\n        return\n    except subprocess.TimeoutExpired:\n        console.print(\"  [dim]Git pull timed out.[/dim]\")\n        return\n\n    _log(\"UPDATE\", \"Re-installing dependencies\")\n    try:\n        subprocess.run(\n            [sys.executable, \"-m\", \"pip\", \"install\", \"-e\", str(jcode_root), \"-q\"],\n            check=True, capture_output=True, text=True,\n        )\n    except subprocess.CalledProcessError as e:\n        console.print(f\"  [dim]pip install failed: {e.stderr.strip()}[/dim]\")\n        return\n\n    try:\n        result = subprocess.run(\n            [sys.executable, \"-c\", \"from jcode import __version__; print(__version__)\"],\n            capture_output=True, text=True,\n        )\n        new_version = result.stdout.strip()\n    except Exception:\n        new_version = \"unknown\"\n\n    _log(\"UPDATE\", f\"Updated to v{new_version}\")\n    console.print(\"  [dim]Restart JCode to use the new version.[/dim]\")\n\n\ndef _cmd_uninstall(settings_mgr: SettingsManager) -> None:\n    \"\"\"Uninstall JCode: remove package + config.\"\"\"\n    console.print()\n    console.print(\"  [bold white]Uninstall JCode[/bold white]\")\n    console.print()\n\n    jcode_root = Path(__file__).resolve().parent.parent\n    config_dir = Path.home() / \".jcode\"\n\n    console.print(\"  [dim]This will:[/dim]\")\n    console.print(\"    [dim]1. Uninstall the jcode package[/dim]\")\n    console.print(f\"    [dim]2. Remove config at[/dim] [cyan]{config_dir}[/cyan]\")\n    console.print(\"    [dim]Your project files will NOT be deleted.[/dim]\")\n    console.print()\n\n    choice = _select_one(\"Proceed with uninstall?\", [\n        \"Yes -- uninstall JCode\",\n        \"No  -- cancel\",\n    ])\n\n    if choice != 0:\n        console.print(\"  [dim]Cancelled.[/dim]\")\n        return\n\n    _log(\"UNINSTALL\", \"Removing jcode package\")\n    subprocess.run(\n        [sys.executable, \"-m\", \"pip\", \"uninstall\", \"jcode\", \"-y\"],\n        capture_output=True, text=True,\n    )\n\n    if config_dir.exists():\n        _log(\"UNINSTALL\", \"Removing config directory\")\n        shutil.rmtree(config_dir, ignore_errors=True)\n\n    _log(\"UNINSTALL\", \"Done\")\n    console.print(f\"\\n  [dim]To remove the source code:[/dim] [cyan]rm -rf {jcode_root}[/cyan]\\n\")\n    sys.exit(0)\n\n\n# \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n# Helpers\n# \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n\ndef _auto_save(ctx: ContextManager | None, project_dir: Path | None) -> None:\n    \"\"\"Auto-save session if applicable.\"\"\"\n    if ctx and project_dir and project_dir.exists():\n        try:\n            session_file = project_dir / \".jcode_session.json\"\n            ctx.save_session(session_file)\n        except Exception:\n            pass\n\n\ndef _slugify(text: str) -> str:\n    \"\"\"Convert text to a filesystem-safe slug.\"\"\"\n    slug = \"\".join(c if c.isalnum() or c in \" _-\" else \"\" for c in text)\n    slug = slug.strip().replace(\" \", \"_\").lower()\n    return slug[:50] or \"project\"\n\n\ndef _format_size(size: int) -> str:\n    \"\"\"Format bytes into human-readable size.\"\"\"\n    for unit in (\"B\", \"KB\", \"MB\"):\n        if size < 1024:\n            return f\"{size:.0f} {unit}\"\n        size /= 1024\n    return f\"{size:.1f} GB\"\n\n\nif __name__ == \"__main__\":\n    main()\n",
      "jcode/coder.py": "\"\"\"\nCoder module \u2014 generates files and applies targeted patches.\nUses structured memory (architecture + file index) instead of raw plan dumps.\n\nv2.0 \u2014 Supports parallel generation via silent mode for WorkerPool.\n\"\"\"\n\nfrom __future__ import annotations\n\nimport re\n\nfrom rich.console import Console\n\nfrom jcode.ollama_client import call_coder, call_model_silent\nfrom jcode.prompts import CODER_SYSTEM, CODER_TASK, CODER_PATCH\nfrom jcode.context import ContextManager\n\nconsole = Console()\n\n\ndef _strip_fences(text: str) -> str:\n    \"\"\"Remove markdown code fences if the model wrapped output.\n    Handles models that add explanations before/after the code block.\"\"\"\n    text = text.strip()\n    # Strip <think> blocks\n    text = re.sub(r\"<think>.*?</think>\", \"\", text, flags=re.DOTALL).strip()\n\n    # Try 1: entire text is a single fenced block\n    m = re.match(r\"^```\\w*\\n(.*?)```\\s*$\", text, re.DOTALL)\n    if m:\n        return m.group(1).strip()\n\n    # Try 2: text has explanation + one fenced block \u2014 extract the block\n    m = re.search(r\"```\\w*\\n(.*?)```\", text, re.DOTALL)\n    if m and len(m.group(1).strip()) > len(text) * 0.3:\n        # Only use extracted block if it's a substantial portion of the text\n        return m.group(1).strip()\n\n    return text\n\n\ndef generate_file(task: dict, ctx: ContextManager, parallel: bool = False) -> str:\n    \"\"\"\n    Generate complete file content from a task.\n    Uses architecture summary + file index instead of full plan JSON.\n\n    Args:\n        task: Task dict with 'file', 'description', 'depends_on' keys.\n        ctx: The ContextManager for structured memory access.\n        parallel: If True, use silent (non-streaming) generation for thread safety.\n    \"\"\"\n    file_path = task[\"file\"]\n    description = task[\"description\"]\n\n    # Gather dependency context (sliced, not everything)\n    dep_files = ctx.get_related_files(task)\n    existing_context = \"\"\n    if dep_files:\n        existing_context = f\"## Related Files\\n{ctx.get_file_context(dep_files)}\"\n\n    # Augment with RAG-retrieved context (files related by semantics, not just deps)\n    rag_context = ctx.memory.get_relevant_context(\n        f\"{file_path}: {description}\",\n        ctx.state.files,\n        top_k=3,\n        max_chars=4000,\n    )\n    if rag_context:\n        existing_context += f\"\\n\\n## Semantically Related (from memory)\\n{rag_context}\"\n\n    # Build messages with structured memory\n    messages = [\n        {\"role\": \"system\", \"content\": CODER_SYSTEM},\n    ]\n\n    prompt = CODER_TASK.format(\n        architecture=ctx.get_architecture(),\n        file_index=ctx.get_file_index_str(),\n        spec_details=ctx.get_spec_details(),\n        file_path=file_path,\n        task_description=description,\n        existing_context=existing_context,\n    )\n    messages.append({\"role\": \"user\", \"content\": prompt})\n\n    _, coder_ctx = ctx.get_context_sizes()\n    complexity = ctx.get_complexity()\n    size = ctx.get_size()\n\n    if parallel:\n        # Silent mode for parallel workers \u2014 no streaming, no coder_history mutation\n        console.print(f\"  [dim]\u26a1 Generating[/dim] [cyan]{file_path}[/cyan]\")\n        raw = call_model_silent(\"coder\", messages, num_ctx=coder_ctx, complexity=complexity, size=size)\n    else:\n        # Sequential mode with streaming\n        ctx.reset_coder_history()\n        ctx.add_coder_message(\"system\", CODER_SYSTEM)\n        ctx.add_coder_message(\"user\", prompt)\n        console.print(f\"\\n  [dim]Generating[/dim] [cyan]{file_path}[/cyan]\\n\")\n        raw = call_coder(ctx.get_coder_messages(), stream=True, num_ctx=coder_ctx, complexity=complexity, size=size)\n        ctx.add_coder_message(\"assistant\", raw)\n\n    content = _strip_fences(raw)\n    ctx.record_file(file_path, content)\n    return content\n\n\ndef patch_file(\n    file_path: str,\n    error: str,\n    review_feedback: str,\n    ctx: ContextManager,\n    parallel: bool = False,\n) -> str:\n    \"\"\"\n    Apply a targeted, minimal patch to an existing file.\n    This is the key differentiator \u2014 small diffs, not full rewrites.\n\n    Args:\n        parallel: If True, use silent (non-streaming) generation.\n    \"\"\"\n    file_content = ctx.state.files.get(file_path, \"\")\n\n    prompt = CODER_PATCH.format(\n        architecture=ctx.get_architecture(),\n        file_path=file_path,\n        file_content=file_content,\n        error=error,\n        review_feedback=review_feedback or \"(no reviewer feedback)\",\n    )\n\n    _, coder_ctx = ctx.get_context_sizes()\n    complexity = ctx.get_complexity()\n    size = ctx.get_size()\n\n    if parallel:\n        messages = [\n            {\"role\": \"system\", \"content\": CODER_SYSTEM},\n            {\"role\": \"user\", \"content\": prompt},\n        ]\n        console.print(f\"  [dim]\u26a1 Patching[/dim] [cyan]{file_path}[/cyan]\")\n        raw = call_model_silent(\"coder\", messages, num_ctx=coder_ctx, complexity=complexity, size=size)\n    else:\n        ctx.reset_coder_history()\n        ctx.add_coder_message(\"system\", CODER_SYSTEM)\n        ctx.add_coder_message(\"user\", prompt)\n        console.print(f\"\\n  [dim]Patching[/dim] [cyan]{file_path}[/cyan]\\n\")\n        raw = call_coder(ctx.get_coder_messages(), stream=True, num_ctx=coder_ctx, complexity=complexity, size=size)\n        ctx.add_coder_message(\"assistant\", raw)\n\n    content = _strip_fences(raw)\n    ctx.record_file(file_path, content)\n    return content\n",
      "jcode/config.py": "\"\"\"\nJCode configuration \u2014 multi-model orchestration engine.\n\nv0.9.0 \u2014 Intelligent multi-model routing.\n\nDesign philosophy:\n  1. NEVER pull models during builds \u2014 only use what's locally installed.\n  2. Different models for different jobs \u2014 the RIGHT model for each role.\n  3. Task classification: complexity (heavy/medium/simple) \u00d7 size (large/medium/small).\n  4. Model categories: coding, reasoning, agentic, fast.\n  5. For SIMPLE tasks \u2192 be FAST (small models, skip review).\n  6. For HEAVY tasks \u2192 deep research, reasoning, multiple passes.\n  7. Graceful fallback \u2014 always degrade to what's available locally.\n\nModel Registry (2025/2026 Ollama ecosystem):\n  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n  \u2502 Category            \u2502 Role      \u2502 Best Models (in preference order)   \u2502\n  \u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n  \u2502 coding              \u2502 coder     \u2502 qwen3-coder, devstral, qwen2.5-c.  \u2502\n  \u2502 reasoning           \u2502 planner   \u2502 deepseek-r1, qwen3, magistral      \u2502\n  \u2502 agentic             \u2502 orchestr. \u2502 gpt-oss, qwen3, glm-4.7            \u2502\n  \u2502 fast                \u2502 reviewer  \u2502 qwen2.5-coder:7b, glm-4.7-flash   \u2502\n  \u2502 embedding           \u2502 memory    \u2502 all-minilm, nomic-embed-text       \u2502\n  \u2502 summarizer          \u2502 compress  \u2502 phi4, gemma3:4b                    \u2502\n  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n\"\"\"\n\nfrom __future__ import annotations\n\nimport json\nimport re\nfrom pathlib import Path\nfrom dataclasses import dataclass, field\nfrom enum import Enum\n\n\n# \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n# Model Registry \u2014 multi-model, multi-category\n# \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n#\n# Each model is registered with its category and size class.\n# The router picks the best LOCAL model for each role + classification.\n\n@dataclass(frozen=True)\nclass ModelSpec:\n    \"\"\"A model in the registry with its capabilities.\"\"\"\n    name: str               # e.g. \"devstral:24b\"\n    category: str           # coding | reasoning | agentic | fast | general | embedding | summarizer\n    size_class: str         # small (\u22648b) | medium (9-20b) | large (21b+)\n    priority: int = 50      # Lower = preferred (within same category+size)\n    supports_tools: bool = False\n    supports_thinking: bool = False\n    context_window: int = 32768\n    is_embedding: bool = False\n\n\n# \u2500\u2500 Full Model Registry \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n# Models are ordered by preference within each category.\n# JCode will pick the FIRST locally-available model that fits.\n\nMODEL_REGISTRY: list[ModelSpec] = [\n    # \u2500\u2500 CODING models (for file generation, patching) \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n    # Prefer qwen3-coder (2026) > devstral > qwen2.5-coder > deepseek-coder\n    ModelSpec(\"qwen3-coder:30b\",      \"coding\",    \"large\",  5),\n    ModelSpec(\"devstral:24b\",          \"coding\",    \"large\",  10, supports_tools=True),\n    ModelSpec(\"devstral-small:24b\",    \"coding\",    \"large\",  15, supports_tools=True),\n    ModelSpec(\"qwen2.5-coder:32b\",    \"coding\",    \"large\",  20),\n    ModelSpec(\"deepseek-coder:33b\",    \"coding\",    \"large\",  25),\n    ModelSpec(\"qwen2.5-coder:14b\",    \"coding\",    \"medium\", 10),\n    ModelSpec(\"deepcoder:14b\",         \"coding\",    \"medium\", 15),\n    ModelSpec(\"qwen2.5-coder:7b\",     \"coding\",    \"small\",  10),\n    ModelSpec(\"deepseek-coder:6.7b\",   \"coding\",    \"small\",  12),\n\n    # \u2500\u2500 REASONING models (for planning, analysis, deep thinking) \u2500\u2500\u2500\n    # DeepSeek-R1 is the strongest local reasoning model\n    ModelSpec(\"deepseek-r1:70b\",      \"reasoning\", \"large\",  5,  supports_thinking=True),\n    ModelSpec(\"deepseek-r1:32b\",      \"reasoning\", \"large\",  10, supports_thinking=True),\n    ModelSpec(\"deepseek-r1:14b\",      \"reasoning\", \"medium\", 10, supports_thinking=True),\n    ModelSpec(\"magistral:24b\",         \"reasoning\", \"large\",  15, supports_thinking=True),\n    ModelSpec(\"phi4-reasoning:14b\",    \"reasoning\", \"medium\", 20, supports_thinking=True),\n    ModelSpec(\"qwen3:14b\",            \"reasoning\", \"medium\", 25, supports_tools=True, supports_thinking=True),\n    ModelSpec(\"qwen3:8b\",             \"reasoning\", \"small\",  10, supports_tools=True, supports_thinking=True),\n    ModelSpec(\"deepseek-r1:8b\",       \"reasoning\", \"small\",  15, supports_thinking=True),\n    ModelSpec(\"deepseek-r1:1.5b\",     \"reasoning\", \"small\",  30, supports_thinking=True),\n\n    # \u2500\u2500 AGENTIC models (for autonomous orchestration, tool use) \u2500\u2500\u2500\u2500\n    ModelSpec(\"gpt-oss:20b\",          \"agentic\",   \"medium\", 10, supports_tools=True),\n    ModelSpec(\"qwen3:14b\",            \"agentic\",   \"medium\", 15, supports_tools=True, supports_thinking=True),\n    ModelSpec(\"glm-4.7:30b\",          \"agentic\",   \"large\",  15, supports_tools=True, supports_thinking=True),\n    ModelSpec(\"qwen3:8b\",             \"agentic\",   \"small\",  10, supports_tools=True, supports_thinking=True),\n\n    # \u2500\u2500 FAST models (for review, quick checks, simple tasks) \u2500\u2500\u2500\u2500\u2500\u2500\u2500\n    ModelSpec(\"glm-4.7-flash:30b\",    \"fast\",      \"large\",  10, supports_tools=True, supports_thinking=True),\n    ModelSpec(\"qwen2.5-coder:7b\",     \"fast\",      \"small\",  10),\n    ModelSpec(\"qwen3:4b\",             \"fast\",      \"small\",  15, supports_tools=True),\n    ModelSpec(\"qwen3:1.7b\",           \"fast\",      \"small\",  25, supports_tools=True),\n\n    # \u2500\u2500 SUMMARIZER models (for memory compression, context summaries) \u2500\u2500\n    ModelSpec(\"phi4:14b\",             \"summarizer\", \"medium\", 10),\n    ModelSpec(\"phi3.5:latest\",        \"summarizer\", \"small\",  15),\n    ModelSpec(\"gemma3:4b\",            \"summarizer\", \"small\",  20),\n\n    # \u2500\u2500 EMBEDDING models (for vector memory / RAG retrieval) \u2500\u2500\u2500\u2500\u2500\u2500\u2500\n    ModelSpec(\"all-minilm:latest\",    \"embedding\", \"small\",  10, is_embedding=True),\n    ModelSpec(\"nomic-embed-text:latest\", \"embedding\", \"small\", 15, is_embedding=True),\n\n    # \u2500\u2500 GENERAL models (fallback for any role) \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n    ModelSpec(\"llama3.3:latest\",      \"general\",   \"small\",  40),\n    ModelSpec(\"llama3.1:latest\",      \"general\",   \"small\",  45),\n    ModelSpec(\"llama3:latest\",        \"general\",   \"small\",  50),\n    ModelSpec(\"qwen3:8b\",             \"general\",   \"small\",  30, supports_tools=True, supports_thinking=True),\n    ModelSpec(\"qwen3:14b\",            \"general\",   \"medium\", 30, supports_tools=True, supports_thinking=True),\n]\n\n\n# \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n# Task Classification \u2014 complexity \u00d7 size\n# \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n#\n# complexity: how HARD is the task (algorithmic depth, system design)\n#   heavy  \u2192 databases, auth, microservices, real-time, complex logic\n#   medium \u2192 typical web apps, CRUD, API integrations\n#   simple \u2192 static sites, scripts, single-purpose tools\n#\n# size: how BIG is the output (number of files, total LOC)\n#   large  \u2192 15+ files, full-stack apps\n#   medium \u2192 5-15 files, standard apps\n#   small  \u2192 1-4 files, quick projects\n\nclass Complexity(str, Enum):\n    HEAVY  = \"heavy\"\n    MEDIUM = \"medium\"\n    SIMPLE = \"simple\"\n\nclass Size(str, Enum):\n    LARGE  = \"large\"\n    MEDIUM = \"medium\"\n    SMALL  = \"small\"\n\n@dataclass\nclass TaskClassification:\n    \"\"\"The full classification of a task.\"\"\"\n    complexity: Complexity\n    size: Size\n    skip_review: bool = False\n    skip_research: bool = True\n    needs_reasoning: bool = False\n\n    @property\n    def label(self) -> str:\n        return f\"{self.complexity.value}/{self.size.value}\"\n\n    @property\n    def is_simple(self) -> bool:\n        return self.complexity == Complexity.SIMPLE and self.size == Size.SMALL\n\n    @property\n    def is_heavy(self) -> bool:\n        return self.complexity == Complexity.HEAVY\n\n\n# \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n# Role \u2192 Category Mapping per Classification\n# \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n#\n# This 9-cell matrix maps (complexity \u00d7 size) \u2192 model category per role.\n# The model router uses this to pick the right model.\n#\n#   Classification    \u2502 Planner       \u2502 Coder        \u2502 Reviewer     \u2502 Analyzer\n#   \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n#   simple/small      \u2502 fast          \u2502 coding/small \u2502 (skipped)    \u2502 fast\n#   simple/medium     \u2502 fast          \u2502 coding/med   \u2502 fast         \u2502 fast\n#   simple/large      \u2502 coding/med    \u2502 coding/med   \u2502 fast         \u2502 fast\n#   \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n#   medium/small      \u2502 coding/med    \u2502 coding/med   \u2502 fast         \u2502 coding/small\n#   medium/medium     \u2502 coding/med    \u2502 coding/med   \u2502 coding/small \u2502 coding/small\n#   medium/large      \u2502 reasoning/med \u2502 coding/large \u2502 coding/small \u2502 coding/med\n#   \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n#   heavy/small       \u2502 reasoning/med \u2502 coding/med   \u2502 coding/small \u2502 reasoning/small\n#   heavy/medium      \u2502 reasoning/med \u2502 coding/large \u2502 coding/med   \u2502 reasoning/med\n#   heavy/large       \u2502 reasoning/lrg \u2502 coding/large \u2502 coding/med   \u2502 reasoning/med\n\n@dataclass(frozen=True)\nclass ModelRequirement:\n    \"\"\"What category + size to look for.\"\"\"\n    category: str           # coding | reasoning | agentic | fast | general\n    size_class: str         # small | medium | large\n\n\nROLE_ROUTING: dict[str, dict[str, ModelRequirement]] = {\n    # \u2500\u2500 SIMPLE \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n    \"simple/small\": {\n        \"planner\":  ModelRequirement(\"fast\",      \"small\"),\n        \"coder\":    ModelRequirement(\"coding\",    \"small\"),\n        \"reviewer\": ModelRequirement(\"fast\",      \"small\"),   # skipped anyway\n        \"analyzer\": ModelRequirement(\"fast\",      \"small\"),\n    },\n    \"simple/medium\": {\n        \"planner\":  ModelRequirement(\"fast\",      \"small\"),\n        \"coder\":    ModelRequirement(\"coding\",    \"medium\"),\n        \"reviewer\": ModelRequirement(\"fast\",      \"small\"),\n        \"analyzer\": ModelRequirement(\"fast\",      \"small\"),\n    },\n    \"simple/large\": {\n        \"planner\":  ModelRequirement(\"coding\",    \"medium\"),\n        \"coder\":    ModelRequirement(\"coding\",    \"medium\"),\n        \"reviewer\": ModelRequirement(\"fast\",      \"small\"),\n        \"analyzer\": ModelRequirement(\"fast\",      \"small\"),\n    },\n    # \u2500\u2500 MEDIUM \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n    \"medium/small\": {\n        \"planner\":  ModelRequirement(\"coding\",    \"medium\"),\n        \"coder\":    ModelRequirement(\"coding\",    \"medium\"),\n        \"reviewer\": ModelRequirement(\"fast\",      \"small\"),\n        \"analyzer\": ModelRequirement(\"coding\",    \"small\"),\n    },\n    \"medium/medium\": {\n        \"planner\":  ModelRequirement(\"coding\",    \"medium\"),\n        \"coder\":    ModelRequirement(\"coding\",    \"medium\"),\n        \"reviewer\": ModelRequirement(\"coding\",    \"small\"),\n        \"analyzer\": ModelRequirement(\"coding\",    \"small\"),\n    },\n    \"medium/large\": {\n        \"planner\":  ModelRequirement(\"reasoning\", \"medium\"),\n        \"coder\":    ModelRequirement(\"coding\",    \"large\"),\n        \"reviewer\": ModelRequirement(\"coding\",    \"small\"),\n        \"analyzer\": ModelRequirement(\"coding\",    \"medium\"),\n    },\n    # \u2500\u2500 HEAVY \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n    \"heavy/small\": {\n        \"planner\":  ModelRequirement(\"reasoning\", \"medium\"),\n        \"coder\":    ModelRequirement(\"coding\",    \"medium\"),\n        \"reviewer\": ModelRequirement(\"coding\",    \"small\"),\n        \"analyzer\": ModelRequirement(\"reasoning\", \"small\"),\n    },\n    \"heavy/medium\": {\n        \"planner\":  ModelRequirement(\"reasoning\", \"medium\"),\n        \"coder\":    ModelRequirement(\"coding\",    \"large\"),\n        \"reviewer\": ModelRequirement(\"coding\",    \"medium\"),\n        \"analyzer\": ModelRequirement(\"reasoning\", \"medium\"),\n    },\n    \"heavy/large\": {\n        \"planner\":  ModelRequirement(\"reasoning\", \"large\"),\n        \"coder\":    ModelRequirement(\"coding\",    \"large\"),\n        \"reviewer\": ModelRequirement(\"coding\",    \"medium\"),\n        \"analyzer\": ModelRequirement(\"reasoning\", \"medium\"),\n    },\n}\n\n\n# \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n# Model Resolution Engine\n# \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n\n# Locally installed models cache\n_local_models: set[str] | None = None\n_local_models_full: dict[str, dict] | None = None\n\n\ndef _get_local_models() -> set[str]:\n    \"\"\"Return the set of model names installed locally. Cached.\"\"\"\n    global _local_models\n    if _local_models is not None:\n        return _local_models\n    try:\n        import ollama as _ollama\n        response = _ollama.list()\n        models = response.get(\"models\", []) if isinstance(response, dict) else []\n        if not models and hasattr(response, \"models\"):\n            models = response.models or []\n        names = set()\n        for m in models:\n            name = m.get(\"name\", \"\") if isinstance(m, dict) else getattr(m, \"model\", \"\")\n            if name:\n                # Normalize quantization suffixes\n                base = name.split(\"-q\")[0] if \"-q\" in name else name\n                names.add(base)\n                # Also add without :latest for matching\n                if \":latest\" in base:\n                    names.add(base.replace(\":latest\", \"\"))\n        _local_models = names\n    except Exception:\n        _local_models = set()\n    return _local_models\n\n\ndef refresh_local_models() -> set[str]:\n    \"\"\"Force-refresh the local models cache.\"\"\"\n    global _local_models\n    _local_models = None\n    return _get_local_models()\n\n\ndef pull_model(model_name: str) -> bool:\n    \"\"\"Pull a model from Ollama registry.\n    \n    Returns:\n        True if successful, False if failed or cancelled.\n    \"\"\"\n    try:\n        import ollama as _ollama\n        from rich.console import Console\n        from rich.live import Live\n        from rich.progress import Progress, SpinnerColumn, TextColumn, BarColumn, DownloadColumn, TransferSpeedColumn\n        \n        console = Console()\n        \n        progress = Progress(\n            SpinnerColumn(),\n            TextColumn(\"[bold blue]{task.description}\"),\n            BarColumn(),\n            DownloadColumn(),\n            TransferSpeedColumn(),\n            console=console,\n        )\n        \n        task = progress.add_task(f\"Pulling {model_name}...\", total=None)\n        \n        try:\n            with Live(progress, console=console, refresh_per_second=10):\n                last_status = \"\"\n                for resp in _ollama.pull(model_name, stream=True):\n                    if isinstance(resp, dict):\n                        status = resp.get(\"status\", \"\")\n                        \n                        # Update status text if changed\n                        if status and status != last_status:\n                            last_status = status\n                            progress.update(task, description=f\"[bold blue]{model_name}[/bold blue] - {status}\")\n                        \n                        # Update progress if available\n                        if \"completed\" in resp and \"total\" in resp:\n                            completed = resp.get(\"completed\", 0)\n                            total = resp.get(\"total\", 1)\n                            if total > 0:\n                                progress.update(task, completed=completed, total=total)\n            \n            console.print(f\"[green]\u2713 Pulled {model_name}[/green]\")\n            refresh_local_models()\n            return True\n            \n        except KeyboardInterrupt:\n            console.print(f\"\\n[yellow]\u26a0 Cancelled pulling {model_name}[/yellow]\")\n            return False\n        \n    except KeyboardInterrupt:\n        from rich.console import Console\n        Console().print(f\"\\n[yellow]\u26a0 Cancelled pulling {model_name}[/yellow]\")\n        return False\n    except Exception as e:\n        from rich.console import Console\n        Console().print(f\"[red]\u2717 Failed to pull {model_name}: {e}[/red]\")\n        return False\n\n\ndef _is_model_local(model: str) -> bool:\n    \"\"\"Check if a model is installed locally.\"\"\"\n    local = _get_local_models()\n    \n    # Exact match (with or without :latest normalization)\n    if model in local:\n        return True\n    \n    # Normalize :latest \u2014 \"model\" and \"model:latest\" are the same\n    model_normalized = model if \":\" in model else f\"{model}:latest\"\n    model_without_latest = model.replace(\":latest\", \"\") if model.endswith(\":latest\") else model\n    \n    if model_normalized in local or model_without_latest in local:\n        return True\n    \n    return False\n\n\ndef _find_best_model(\n    category: str,\n    size_class: str,\n) -> str | None:\n    \"\"\"Find the best locally-available model matching category + size.\n\n    Search strategy:\n    1. Exact category + exact size \u2192 best priority\n    2. Exact category + any size (prefer larger) \u2192 fallback\n    3. Any category that can do the job \u2192 last resort\n    \"\"\"\n    local = _get_local_models()\n\n    # Phase 1: Exact match\n    candidates = [\n        spec for spec in MODEL_REGISTRY\n        if spec.category == category\n        and spec.size_class == size_class\n        and _is_model_local(spec.name)\n    ]\n    if candidates:\n        return min(candidates, key=lambda s: s.priority).name\n\n    # Phase 2: Same category, any size (prefer \u2265 requested size)\n    size_order = {\"small\": 0, \"medium\": 1, \"large\": 2}\n    req_size = size_order.get(size_class, 1)\n\n    candidates = [\n        spec for spec in MODEL_REGISTRY\n        if spec.category == category\n        and _is_model_local(spec.name)\n    ]\n    if candidates:\n        # Prefer models >= requested size, then by priority\n        candidates.sort(key=lambda s: (\n            0 if size_order.get(s.size_class, 1) >= req_size else 1,\n            s.priority,\n        ))\n        return candidates[0].name\n\n    # Phase 3: Cross-category fallback\n    # coding/reasoning/agentic can substitute for each other in a pinch\n    fallback_map = {\n        \"coding\":    [\"coding\", \"general\", \"agentic\", \"fast\"],\n        \"reasoning\": [\"reasoning\", \"coding\", \"general\", \"agentic\"],\n        \"agentic\":   [\"agentic\", \"reasoning\", \"coding\", \"general\"],\n        \"fast\":      [\"fast\", \"coding\", \"general\"],\n        \"general\":   [\"general\", \"coding\", \"fast\"],\n    }\n    for alt_cat in fallback_map.get(category, [\"general\"]):\n        if alt_cat == category:\n            continue\n        candidates = [\n            spec for spec in MODEL_REGISTRY\n            if spec.category == alt_cat\n            and _is_model_local(spec.name)\n        ]\n        if candidates:\n            return min(candidates, key=lambda s: s.priority).name\n\n    return None\n\n\ndef get_model_for_role(\n    role: str,\n    complexity: str = \"medium\",\n    size: str = \"medium\",\n) -> str:\n    \"\"\"Resolve the best locally-available model for a role + classification.\n\n    This is the main entry point for the model routing system.\n    Falls back gracefully \u2014 always returns SOMETHING.\n    \"\"\"\n    classification_key = f\"{complexity}/{size}\"\n    routing = ROLE_ROUTING.get(classification_key, ROLE_ROUTING[\"medium/medium\"])\n    req = routing.get(role, ModelRequirement(\"coding\", \"medium\"))\n\n    model = _find_best_model(req.category, req.size_class)\n    if model:\n        return model\n\n    # Absolute last resort: return first available model\n    local = _get_local_models()\n    if local:\n        return next(iter(local))\n\n    # Nothing installed \u2014 return a common default (will fail gracefully)\n    return \"qwen2.5-coder:7b\"\n\n\ndef get_escalation_model(role: str) -> str | None:\n    \"\"\"Get a stronger model for escalation when fixes fail.\n\n    For analyzer/planner: prefer reasoning models (deep thinking).\n    For coder: prefer large coding models.\n    \"\"\"\n    if role in (\"analyzer\", \"planner\"):\n        # Try reasoning models first (large \u2192 medium)\n        for size in (\"large\", \"medium\"):\n            model = _find_best_model(\"reasoning\", size)\n            if model:\n                return model\n        # Then large coding\n        model = _find_best_model(\"coding\", \"large\")\n        if model:\n            return model\n    else:\n        # For coder/reviewer: try large coding first\n        model = _find_best_model(\"coding\", \"large\")\n        if model:\n            return model\n        # Then reasoning\n        model = _find_best_model(\"reasoning\", \"large\")\n        if model:\n            return model\n\n    return None\n\n\ndef get_all_required_models(\n    complexity: str = \"medium\",\n    size: str = \"medium\",\n) -> list[str]:\n    \"\"\"Return the unique set of models needed for a classification.\n    Only returns models that are locally installed.\"\"\"\n    classification_key = f\"{complexity}/{size}\"\n    routing = ROLE_ROUTING.get(classification_key, ROLE_ROUTING[\"medium/medium\"])\n    models = set()\n    for role, req in routing.items():\n        model = _find_best_model(req.category, req.size_class)\n        if model:\n            models.add(model)\n    return sorted(models)\n\n\ndef get_ideal_and_actual_models(\n    complexity: str = \"medium\",\n    size: str = \"medium\",\n) -> dict[str, tuple[str, str, bool]]:\n    \"\"\"Return role \u2192 (ideal_model, actual_model, is_fallback) mapping.\n    \n    For each role, returns:\n    - ideal_model: The best model for the role according to ROLE_ROUTING\n    - actual_model: The model that will actually be used (may be fallback)\n    - is_fallback: True if actual_model != ideal_model\n    \"\"\"\n    classification_key = f\"{complexity}/{size}\"\n    routing = ROLE_ROUTING.get(classification_key, ROLE_ROUTING[\"medium/medium\"])\n    result = {}\n    \n    for role, req in routing.items():\n        # Find the ideal model (highest priority for this category/size)\n        ideal_candidates = [\n            spec for spec in MODEL_REGISTRY\n            if spec.category == req.category\n            and spec.size_class == req.size_class\n        ]\n        ideal_model = min(ideal_candidates, key=lambda s: s.priority).name if ideal_candidates else None\n        \n        # Find the actual model that will be used\n        actual_model = _find_best_model(req.category, req.size_class)\n        \n        # Determine if it's a fallback\n        is_fallback = (actual_model != ideal_model) if ideal_model else False\n        \n        result[role] = (ideal_model or \"none\", actual_model or \"none\", is_fallback)\n    \n    return result\n\n\ndef get_missing_ideal_models(\n    complexity: str = \"medium\",\n    size: str = \"medium\",\n) -> list[tuple[str, str]]:\n    \"\"\"Return list of (model_name, roles) tuples for ideal models that aren't installed.\n    \n    Groups missing models by name so we can show which roles would benefit.\n    Returns: [(model_name, \"planner, coder\"), ...]\n    \"\"\"\n    ideal_actual = get_ideal_and_actual_models(complexity, size)\n    \n    # Group roles by missing ideal model\n    missing = {}\n    for role, (ideal, actual, is_fallback) in ideal_actual.items():\n        if is_fallback and ideal != \"none\":\n            if ideal not in missing:\n                missing[ideal] = []\n            missing[ideal].append(role)\n    \n    # Convert to list of tuples\n    return [(model, \", \".join(roles)) for model, roles in sorted(missing.items())]\n\n\ndef get_model_spec(model_name: str) -> ModelSpec | None:\n    \"\"\"Look up the spec for a model by name.\"\"\"\n    for spec in MODEL_REGISTRY:\n        if spec.name == model_name:\n            return spec\n    return None\n\n\ndef describe_model_plan(\n    complexity: str = \"medium\",\n    size: str = \"medium\",\n) -> dict[str, str]:\n    \"\"\"Return a role \u2192 model name mapping for display purposes.\"\"\"\n    result = {}\n    for role in (\"planner\", \"coder\", \"reviewer\", \"analyzer\"):\n        model = get_model_for_role(role, complexity, size)\n        result[role] = model\n    return result\n\n\ndef get_embedding_model() -> str | None:\n    \"\"\"Return the best locally-available embedding model, or None.\"\"\"\n    for spec in MODEL_REGISTRY:\n        if spec.is_embedding and _is_model_local(spec.name):\n            return spec.name\n    return None\n\n\ndef get_summarizer_model() -> str | None:\n    \"\"\"Return the best locally-available summarizer model for memory compression.\"\"\"\n    model = _find_best_model(\"summarizer\", \"small\")\n    if model:\n        return model\n    model = _find_best_model(\"summarizer\", \"medium\")\n    if model:\n        return model\n    # Fallback: fast coding model can summarize too\n    return _find_best_model(\"fast\", \"small\")\n\n\n# \u2500\u2500 Legacy constants (backward compat \u2014 resolved dynamically) \u2500\u2500\u2500\u2500\u2500\nPLANNER_MODEL = \"qwen2.5-coder:14b\"\nCODER_MODEL = \"qwen2.5-coder:14b\"\nREVIEWER_MODEL = \"qwen2.5-coder:7b\"\nANALYZER_MODEL = \"qwen2.5-coder:14b\"\n\n\n# \u2500\u2500 Generation Parameters \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\nBASE_PLANNER_CTX = 8192\nBASE_CODER_CTX = 8192\n\nPLANNER_OPTIONS = {\n    \"temperature\": 0.3,       # Low temp \u2192 reliable JSON output\n    \"top_p\": 0.9,\n    \"num_ctx\": BASE_PLANNER_CTX,\n}\n\nCODER_OPTIONS = {\n    \"temperature\": 0.15,      # Very low \u2192 deterministic code\n    \"top_p\": 0.95,\n    \"num_ctx\": BASE_CODER_CTX,\n}\n\nREVIEWER_OPTIONS = {\n    \"temperature\": 0.3,\n    \"top_p\": 0.9,\n    \"num_ctx\": 4096,\n}\n\nANALYZER_OPTIONS = {\n    \"temperature\": 0.2,\n    \"top_p\": 0.9,\n    \"num_ctx\": 4096,\n}\n\n# Special options for reasoning models (allow longer output for thinking)\nREASONING_OPTIONS = {\n    \"temperature\": 0.4,\n    \"top_p\": 0.95,\n    \"num_ctx\": 16384,\n}\n\n# Special options for agentic models\nAGENTIC_OPTIONS = {\n    \"temperature\": 0.3,\n    \"top_p\": 0.9,\n    \"num_ctx\": 16384,\n}\n\n# Context window scaling by classification\nCOMPLEXITY_SCALING = {\n    \"simple\": 1.0,      # 8k\n    \"medium\": 1.5,      # 12k\n    \"heavy\":  2.5,       # 20k\n}\n\nSIZE_SCALING = {\n    \"small\":  1.0,\n    \"medium\": 1.5,\n    \"large\":  2.5,\n}\n\n# \u2500\u2500 Worker Pool Settings \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\nMAX_WORKERS = 4\nMIN_WORKERS = 1\nCPU_HIGH_THRESHOLD = 85.0\nCPU_LOW_THRESHOLD = 50.0\nWORKER_POLL_INTERVAL = 2.0\n\n# \u2500\u2500 Limits \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\nMAX_ITERATIONS = 10\nMAX_FILE_READ_CHARS = 12000\nMAX_TASK_FAILURES = 5\nMAX_DIFF_LINES = 80\n\n# \u2500\u2500 Project Defaults \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\nDEFAULT_OUTPUT_DIR = Path.cwd()\n\n\n# \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n# Task State Machine (unchanged from v0.8.x)\n# \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n\nclass TaskStatus(str, Enum):\n    PENDING = \"pending\"\n    IN_PROGRESS = \"in_progress\"\n    GENERATED = \"generated\"\n    REVIEWING = \"reviewing\"\n    NEEDS_FIX = \"needs_fix\"\n    VERIFIED = \"verified\"\n    FAILED = \"failed\"\n    SKIPPED = \"skipped\"\n\n\n@dataclass\nclass TaskNode:\n    \"\"\"A single task in the DAG.\"\"\"\n    id: int\n    file: str\n    description: str\n    depends_on: list[int] = field(default_factory=list)\n    status: TaskStatus = TaskStatus.PENDING\n    failure_count: int = 0\n    review_feedback: str = \"\"\n    error_summary: str = \"\"\n\n    @property\n    def is_terminal(self) -> bool:\n        return self.status in (TaskStatus.VERIFIED, TaskStatus.FAILED, TaskStatus.SKIPPED)\n\n    def to_dict(self) -> dict:\n        return {\n            \"id\": self.id,\n            \"file\": self.file,\n            \"description\": self.description,\n            \"depends_on\": self.depends_on,\n            \"status\": self.status.value,\n            \"failure_count\": self.failure_count,\n            \"review_feedback\": self.review_feedback,\n            \"error_summary\": self.error_summary,\n        }\n\n    @classmethod\n    def from_dict(cls, d: dict) -> \"TaskNode\":\n        return cls(\n            id=d[\"id\"],\n            file=d[\"file\"],\n            description=d[\"description\"],\n            depends_on=d.get(\"depends_on\", []),\n            status=TaskStatus(d.get(\"status\", \"pending\")),\n            failure_count=d.get(\"failure_count\", 0),\n            review_feedback=d.get(\"review_feedback\", \"\"),\n            error_summary=d.get(\"error_summary\", \"\"),\n        )\n\n\n@dataclass\nclass ProjectState:\n    \"\"\"Full project state with structured memory.\"\"\"\n    name: str = \"\"\n    description: str = \"\"\n    tech_stack: list[str] = field(default_factory=list)\n    output_dir: Path = DEFAULT_OUTPUT_DIR\n    plan: dict | None = None\n    files: dict[str, str] = field(default_factory=dict)\n    errors: list[str] = field(default_factory=list)\n    iteration: int = 0\n    completed: bool = False\n    complexity: str = \"medium\"\n    size: str = \"medium\"\n    created_at: str = \"\"\n    last_modified: str = \"\"\n\n    # \u2500\u2500 Structured Memory \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n    architecture_summary: str = \"\"\n    file_index: dict[str, str] = field(default_factory=dict)\n    dependency_graph: dict[str, list[str]] = field(default_factory=dict)\n    failure_log: list[dict] = field(default_factory=list)\n\n    # \u2500\u2500 Task DAG \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n    task_nodes: list[dict] = field(default_factory=list)\n\n\n# \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n# Task Classification Engine\n# \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n\n# Keyword signals for complexity detection\n_HEAVY_SIGNALS = [\n    \"database\", \"postgres\", \"mongo\", \"mysql\", \"redis\", \"sqlite\", \"supabase\",\n    \"auth\", \"jwt\", \"oauth\", \"login\", \"signup\", \"session\", \"password\",\n    \"docker\", \"ci/cd\", \"deploy\", \"kubernetes\", \"microservice\", \"k8s\",\n    \"graphql\", \"grpc\", \"websocket\", \"real-time\", \"streaming\",\n    \"machine learning\", \"neural\", \"tensorflow\", \"pytorch\", \"ai model\",\n    \"payment\", \"stripe\", \"billing\", \"subscription\",\n    \"multi-tenant\", \"rbac\", \"permission\", \"role-based\",\n    # App-type signals \u2014 short prompts that imply complex full-stack apps\n    \"like tinder\", \"like uber\", \"like airbnb\", \"like twitter\", \"like instagram\",\n    \"like spotify\", \"like slack\", \"like discord\", \"like shopify\", \"like amazon\",\n    \"like linkedin\", \"like facebook\", \"like reddit\", \"like youtube\", \"like tiktok\",\n    \"like whatsapp\", \"like netflix\", \"like doordash\", \"like lyft\",\n    \"tinder for\", \"uber for\", \"airbnb for\", \"twitter for\", \"instagram for\",\n    \"spotify for\", \"slack for\", \"discord for\", \"shopify for\",\n    \"a tinder\", \"an uber\", \"an airbnb\", \"a twitter\", \"an instagram\",\n    \"a spotify\", \"a slack\", \"a discord\", \"a shopify\",\n    # Domain signals \u2014 imply complex architecture\n    \"social network\", \"social media\", \"marketplace\", \"e-commerce\", \"ecommerce\",\n    \"dating app\", \"matching system\", \"recommendation engine\",\n    \"real-time chat\", \"messaging app\", \"live stream\",\n    \"booking system\", \"reservation\", \"scheduling platform\",\n    \"fintech\", \"banking\", \"trading platform\", \"crypto\",\n    \"saas\", \"multi-user\", \"collaboration tool\",\n]\n\n_MEDIUM_SIGNALS = [\n    \"api\", \"rest\", \"crud\", \"backend\", \"server\", \"endpoint\",\n    \"react\", \"next\", \"vue\", \"angular\", \"svelte\", \"frontend\",\n    \"full-stack\", \"fullstack\", \"backend and frontend\",\n    \"dashboard\", \"admin panel\", \"cms\",\n    \"upload\", \"file system\", \"storage\",\n    \"email\", \"notification\", \"queue\",\n    \"testing\", \"test suite\", \"e2e\",\n    # Domain signals \u2014 imply moderate complexity\n    \"web app\", \"webapp\", \"mobile app\", \"desktop app\",\n    \"portfolio\", \"blog with\", \"forum\", \"wiki\",\n    \"game\", \"multiplayer\", \"leaderboard\",\n    \"search\", \"filter\", \"pagination\",\n    \"profile\", \"user profile\", \"account\",\n    \"analytics\", \"tracking\", \"metrics\",\n]\n\n_SIMPLE_SIGNALS = [\n    \"simple\", \"basic\", \"minimal\", \"small\", \"quick\", \"tiny\",\n    \"hello world\", \"calculator\", \"todo\", \"counter\", \"timer\",\n    \"landing page\", \"static\", \"single page\",\n    \"script\", \"utility\", \"tool\", \"cli tool\",\n]\n\n\ndef classify_task(prompt: str | None = None, plan: dict | None = None) -> TaskClassification:\n    \"\"\"Classify a task by complexity and size.\n\n    Can be called with a string prompt (pre-plan) or a dict plan (post-plan).\n    Returns a TaskClassification with all routing decisions.\n    \"\"\"\n    if plan:\n        return _classify_from_plan(plan)\n    if prompt:\n        return _classify_from_prompt(prompt)\n    return TaskClassification(Complexity.SIMPLE, Size.SMALL, skip_review=True, skip_research=True)\n\n\n# \u2500\u2500 LLM-based pre-classification \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n_CLASSIFY_PROMPT = \"\"\"\\\nYou are a task classifier for a coding agent. Given a user's build request, \\\nclassify the task's COMPLEXITY and SIZE.\n\nCOMPLEXITY:\n- simple: trivial scripts, hello world, calculators, static pages, single-file utilities\n- medium: CRUD apps, REST APIs, dashboards, single-framework frontends, CLI tools with multiple commands\n- heavy: full-stack apps with auth/database/real-time, social networks, marketplaces, \\\napps that clone major platforms (tinder, uber, airbnb, etc.), microservices, ML pipelines\n\nSIZE:\n- small: 1-4 files, can be done quickly\n- medium: 5-14 files, moderate scope\n- large: 15+ files, extensive scope\n\nIMPORTANT: When someone says \"build a tinder for X\" or \"build an uber for Y\", \\\nthat implies a FULL application with matching/swiping/profiles/auth/database \u2014 \\\nthat is ALWAYS heavy/large.\n\nRespond with ONLY a JSON object, no other text:\n{\"complexity\": \"simple|medium|heavy\", \"size\": \"small|medium|large\"}\n\"\"\"\n\n\ndef _llm_classify(prompt: str) -> tuple[Complexity, Size] | None:\n    \"\"\"Use the fastest available model to classify task complexity.\n\n    Returns (Complexity, Size) or None if LLM classification fails/unavailable.\n    This adds ~1-3s but prevents catastrophic misclassification of short prompts\n    like \"build a tinder for linkedin\" \u2192 simple/small.\n    \"\"\"\n    try:\n        # Use the fastest available model for classification\n        model = _find_best_model(\"fast\", \"small\")\n        if not model:\n            model = _find_best_model(\"coding\", \"small\")\n        if not model:\n            # Try any available model\n            local = _get_local_models()\n            if local:\n                model = next(iter(local))\n            else:\n                return None\n\n        import ollama as _ollama\n        resp = _ollama.chat(\n            model=model,\n            messages=[\n                {\"role\": \"system\", \"content\": _CLASSIFY_PROMPT},\n                {\"role\": \"user\", \"content\": prompt},\n            ],\n            options={\"temperature\": 0.0, \"num_ctx\": 1024, \"num_predict\": 80},\n        )\n        text = resp[\"message\"][\"content\"].strip()\n\n        # Strip <think> blocks from reasoning models\n        text = re.sub(r\"<think>.*?</think>\", \"\", text, flags=re.DOTALL).strip()\n\n        # Extract JSON from response (model might wrap in ```json ... ```)\n        json_match = re.search(r'\\{[^}]+\\}', text)\n        if not json_match:\n            return None\n        data = json.loads(json_match.group())\n\n        complexity_str = data.get(\"complexity\", \"\").lower()\n        size_str = data.get(\"size\", \"\").lower()\n\n        complexity_map = {\"simple\": Complexity.SIMPLE, \"medium\": Complexity.MEDIUM, \"heavy\": Complexity.HEAVY}\n        size_map = {\"small\": Size.SMALL, \"medium\": Size.MEDIUM, \"large\": Size.LARGE}\n\n        c = complexity_map.get(complexity_str)\n        s = size_map.get(size_str)\n        if c and s:\n            return (c, s)\n        return None\n    except Exception:\n        return None\n\n\ndef _classify_from_prompt(prompt: str) -> TaskClassification:\n    \"\"\"Classify from user prompt (before planning).\n\n    Uses a 2-phase approach:\n    1. LLM reasoning (fast model) \u2014 understands semantic meaning\n    2. Keyword scoring \u2014 validates and can override LLM\n    Falls back to keyword-only if LLM unavailable.\n    \"\"\"\n    lower = prompt.lower()\n    heavy_score = sum(1 for kw in _HEAVY_SIGNALS if kw in lower)\n    medium_score = sum(1 for kw in _MEDIUM_SIGNALS if kw in lower)\n    simple_score = sum(1 for kw in _SIMPLE_SIGNALS if kw in lower)\n\n    # Phase 1: Try LLM classification (semantic understanding)\n    llm_result = _llm_classify(prompt)\n\n    # Phase 2: Keyword scoring + LLM fusion\n    if llm_result:\n        llm_complexity, llm_size = llm_result\n\n        # If keywords strongly disagree with LLM, use the HIGHER classification\n        # (err on the side of giving the task more resources)\n        if heavy_score >= 2 or (heavy_score >= 1 and medium_score >= 2):\n            kw_complexity = Complexity.HEAVY\n        elif medium_score >= 2 or heavy_score >= 1:\n            kw_complexity = Complexity.MEDIUM\n        elif simple_score > 0 and heavy_score == 0 and medium_score == 0:\n            kw_complexity = Complexity.SIMPLE\n        else:\n            kw_complexity = None  # No keyword opinion\n\n        # Take the higher of LLM vs keyword complexity\n        complexity_order = {Complexity.SIMPLE: 0, Complexity.MEDIUM: 1, Complexity.HEAVY: 2}\n        if kw_complexity is not None:\n            complexity = max(llm_complexity, kw_complexity, key=lambda c: complexity_order[c])\n        else:\n            complexity = llm_complexity\n\n        size = llm_size\n    else:\n        # LLM unavailable \u2014 pure keyword scoring (improved defaults)\n        if heavy_score >= 2 or (heavy_score >= 1 and medium_score >= 2):\n            complexity = Complexity.HEAVY\n        elif medium_score >= 2 or heavy_score >= 1:\n            complexity = Complexity.MEDIUM\n        elif simple_score > 0 and heavy_score == 0 and medium_score == 0:\n            complexity = Complexity.SIMPLE\n        else:\n            # Default: MEDIUM (not SIMPLE) \u2014 err on the side of caution\n            # Only classify as SIMPLE when explicit simple signals are present\n            complexity = Complexity.MEDIUM\n\n        # Estimate size from prompt (rough \u2014 will be refined after planning)\n        word_count = len(prompt.split())\n        if word_count > 80 or \"full\" in lower or \"complete\" in lower or \"entire\" in lower:\n            size = Size.LARGE\n        elif word_count > 30 or complexity == Complexity.HEAVY:\n            size = Size.MEDIUM\n        else:\n            # Default to MEDIUM for ambiguous prompts (not SMALL)\n            size = Size.MEDIUM if complexity != Complexity.SIMPLE else Size.SMALL\n\n    return TaskClassification(\n        complexity=complexity,\n        size=size,\n        skip_review=(complexity == Complexity.SIMPLE and size == Size.SMALL),\n        skip_research=(complexity != Complexity.HEAVY),\n        needs_reasoning=(complexity == Complexity.HEAVY),\n    )\n\n\ndef _classify_from_plan(plan: dict) -> TaskClassification:\n    \"\"\"Classify from a completed plan (more accurate).\"\"\"\n    file_count = len(plan.get(\"structure\", {}))\n    tech_stack = \" \".join(t.lower() for t in plan.get(\"tech_stack\", []))\n    description = plan.get(\"description\", \"\").lower()\n\n    # Size from file count\n    if file_count <= 4:\n        size = Size.SMALL\n    elif file_count <= 14:\n        size = Size.MEDIUM\n    else:\n        size = Size.LARGE\n\n    # Complexity from tech stack + description\n    heavy_score = sum(1 for kw in _HEAVY_SIGNALS if kw in tech_stack or kw in description)\n    medium_score = sum(1 for kw in _MEDIUM_SIGNALS if kw in tech_stack or kw in description)\n\n    if heavy_score >= 2:\n        complexity = Complexity.HEAVY\n    elif heavy_score >= 1 or medium_score >= 2 or file_count > 12:\n        complexity = Complexity.MEDIUM\n    else:\n        complexity = Complexity.SIMPLE\n\n    return TaskClassification(\n        complexity=complexity,\n        size=size,\n        skip_review=(complexity == Complexity.SIMPLE and size == Size.SMALL),\n        skip_research=(complexity != Complexity.HEAVY),\n        needs_reasoning=(complexity == Complexity.HEAVY),\n    )\n\n\n# \u2500\u2500 Legacy compatibility wrapper \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\ndef detect_complexity(plan) -> str:\n    \"\"\"Legacy wrapper \u2014 returns old-style complexity string.\n    Maps: heavy\u2192complex, medium\u2192medium, simple\u2192simple.\n    \"\"\"\n    tc = classify_task(prompt=plan if isinstance(plan, str) else None,\n                       plan=plan if isinstance(plan, dict) else None)\n    # Map to old-style strings for backward compat\n    if tc.complexity == Complexity.HEAVY:\n        return \"complex\"\n    return tc.complexity.value\n\n\ndef get_context_size(\n    complexity: str,\n    size: str = \"medium\",\n    is_planner: bool = True,\n) -> int:\n    \"\"\"Calculate context window size based on classification.\"\"\"\n    base = BASE_PLANNER_CTX if is_planner else BASE_CODER_CTX\n    c_mult = COMPLEXITY_SCALING.get(complexity, 1.5)\n    s_mult = SIZE_SCALING.get(size, 1.0)\n    # Combined multiplier (capped at 4x to avoid OOM)\n    return min(int(base * c_mult * s_mult), 65536)\n",
      "jcode/context.py": "\"\"\"\nStructured memory engine \u2014 replaces raw context dumps with\norganized, sliced knowledge about the project.\n\nThis is what lets a 14B model compete with 200k-context frontier models.\nInstead of \"dump everything\", we inject only what's relevant.\n\nv2.0 \u2014 Thread-safe file recording for parallel generation.\n\"\"\"\n\nfrom __future__ import annotations\n\nimport json\nimport threading\nfrom pathlib import Path\nfrom datetime import datetime\n\nfrom jcode.config import (\n    ProjectState, TaskNode, TaskStatus,\n    MAX_FILE_READ_CHARS, detect_complexity, get_context_size,\n)\nfrom jcode.memory import ProjectMemory\n\n# Thread lock for state mutations (file recording, failure logging)\n_state_lock = threading.Lock()\n\n\nclass ContextManager:\n    \"\"\"\n    Maintains structured project memory and conversation history.\n\n    Memory layers:\n    1. Architecture summary \u2014 what the system does\n    2. File index \u2014 every file and its purpose\n    3. Dependency graph \u2014 who imports whom\n    4. Task DAG \u2014 ordered tasks with status\n    5. Failure log \u2014 what broke and how it was fixed\n    6. Conversation history per role (planner, coder)\n    7. Vector memory \u2014 embedding-based retrieval (optional, via ProjectMemory)\n\n    Thread-safety:\n    - record_file() and record_failure() are thread-safe\n    - Per-file memory isolation: each file's content is independent\n    - Global summary memory: architecture + file_index are read-only during generation\n    \"\"\"\n\n    def __init__(self, state: ProjectState | None = None) -> None:\n        self.state = state or ProjectState()\n        self.planner_history: list[dict[str, str]] = []\n        self.coder_history: list[dict[str, str]] = []\n        self.reviewer_history: list[dict[str, str]] = []\n        self.analyzer_history: list[dict[str, str]] = []\n        self.chat_history: list[dict[str, str]] = []    # per-project chat\n        self._task_dag: list[TaskNode] = []\n        self.memory: ProjectMemory = ProjectMemory()\n\n    # \u2500\u2500 Plan & State \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n    def set_plan(self, plan: dict) -> None:\n        self.state.plan = plan\n        self.state.name = plan.get(\"project_name\", \"project\")\n        self.state.description = plan.get(\"description\", \"\")\n        self.state.tech_stack = plan.get(\"tech_stack\", [])\n        self.state.architecture_summary = plan.get(\"architecture_summary\", \"\")\n        self.state.complexity = detect_complexity(plan)\n\n        # Build file index\n        self.state.file_index = plan.get(\"structure\", {})\n\n        # Build task DAG\n        self._task_dag = []\n        for t in plan.get(\"tasks\", []):\n            node = TaskNode(\n                id=t[\"id\"],\n                file=t[\"file\"],\n                description=t[\"description\"],\n                depends_on=t.get(\"depends_on\", []),\n            )\n            self._task_dag.append(node)\n\n        # Timestamps\n        if not self.state.created_at:\n            self.state.created_at = datetime.now().isoformat()\n        self.state.last_modified = datetime.now().isoformat()\n\n    # \u2500\u2500 Task DAG \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n    def get_task_dag(self) -> list[TaskNode]:\n        return self._task_dag\n\n    def get_ready_tasks(self) -> list[TaskNode]:\n        \"\"\"Return tasks whose dependencies are all satisfied.\"\"\"\n        verified_ids = {\n            t.id for t in self._task_dag\n            if t.status in (TaskStatus.VERIFIED, TaskStatus.SKIPPED)\n        }\n        return [\n            t for t in self._task_dag\n            if t.status == TaskStatus.PENDING\n            and all(dep in verified_ids for dep in t.depends_on)\n        ]\n\n    def get_task_by_id(self, task_id: int) -> TaskNode | None:\n        for t in self._task_dag:\n            if t.id == task_id:\n                return t\n        return None\n\n    def all_tasks_terminal(self) -> bool:\n        return all(t.is_terminal for t in self._task_dag)\n\n    def get_task_summary(self) -> str:\n        \"\"\"Human-readable task status summary.\"\"\"\n        lines = []\n        for t in self._task_dag:\n            icon = {\n                TaskStatus.PENDING: \"[ ]\",\n                TaskStatus.IN_PROGRESS: \"[~]\",\n                TaskStatus.GENERATED: \"[w]\",\n                TaskStatus.REVIEWING: \"[?]\",\n                TaskStatus.NEEDS_FIX: \"[!]\",\n                TaskStatus.VERIFIED: \"[x]\",\n                TaskStatus.FAILED: \"[-]\",\n                TaskStatus.SKIPPED: \"[>]\",\n            }.get(t.status, \"[.]\")\n            fails = f\" (fails: {t.failure_count})\" if t.failure_count else \"\"\n            lines.append(f\"  {icon} Task {t.id}: {t.file} -- {t.description}{fails}\")\n        return \"\\n\".join(lines)\n\n    # \u2500\u2500 Structured Memory Accessors \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n    def get_architecture(self) -> str:\n        \"\"\"Return the architecture summary for injection into prompts.\"\"\"\n        return self.state.architecture_summary or \"(no architecture defined)\"\n\n    def get_file_index_str(self) -> str:\n        \"\"\"Return formatted file index.\"\"\"\n        if not self.state.file_index:\n            return \"(empty)\"\n        lines = [f\"- `{path}`: {purpose}\" for path, purpose in self.state.file_index.items()]\n        return \"\\n\".join(lines)\n\n    def get_spec_details(self) -> str:\n        \"\"\"Return the planner's spec contract details (schema, API, auth, deploy).\n\n        These are injected into the coder prompt so the builder follows the\n        architectural spec exactly \u2014 no stack drift.\n        \"\"\"\n        plan = self.state.plan\n        if not plan:\n            return \"(no spec)\"\n\n        parts: list[str] = []\n\n        # Database schema\n        schema = plan.get(\"database_schema\")\n        if schema:\n            parts.append(\"### Database Schema\")\n            for table, info in schema.items():\n                cols = info.get(\"columns\", {})\n                col_lines = \", \".join(f\"{c}: {t}\" for c, t in cols.items())\n                parts.append(f\"- **{table}**: {col_lines}\")\n                for rel in info.get(\"relationships\", []):\n                    parts.append(f\"  - {rel}\")\n\n        # API surface\n        api = plan.get(\"api_surface\")\n        if api:\n            parts.append(\"### API Surface\")\n            for endpoint in api:\n                parts.append(f\"- {endpoint.get('method', '?')} {endpoint.get('path', '?')} \u2014 {endpoint.get('description', '')}\")\n\n        # Auth flow\n        auth = plan.get(\"auth_flow\")\n        if auth and auth != \"none\":\n            parts.append(f\"### Auth Flow\\n{auth}\")\n\n        # Deployment\n        deploy = plan.get(\"deployment\")\n        if deploy:\n            parts.append(f\"### Deployment\\n{deploy}\")\n\n        return \"\\n\\n\".join(parts) if parts else \"(simple project \u2014 no formal spec)\"\n\n    def get_dependency_context(self, file_path: str) -> str:\n        \"\"\"Get contents of files that the given file depends on.\"\"\"\n        deps = self.state.dependency_graph.get(file_path, [])\n        return self.get_file_context(deps)\n\n    def record_file(self, rel_path: str, content: str) -> None:\n        \"\"\"Thread-safe: record a generated file's content and update memory index.\"\"\"\n        with _state_lock:\n            self.state.files[rel_path] = content\n            self.state.last_modified = datetime.now().isoformat()\n\n    def index_memory(self) -> int:\n        \"\"\"Index all current files into the vector memory store.\n        Returns number of files indexed (0 if embedding not available).\"\"\"\n        return self.memory.index_files(self.state.files, self.state.file_index)\n\n    def get_relevant_files(self, query: str, top_k: int = 5) -> str:\n        \"\"\"Use RAG to retrieve the most relevant file contents for a query.\n        Falls back to empty string if embedding is not available.\"\"\"\n        return self.memory.get_relevant_context(\n            query, self.state.files, top_k=top_k\n        )\n\n    def record_failure(self, file_path: str, error: str, fix: str, iteration: int) -> None:\n        \"\"\"Thread-safe: log a failure for the structured failure memory.\"\"\"\n        entry = {\n            \"file\": file_path,\n            \"error\": error[:500],\n            \"fix_applied\": fix[:200],\n            \"iteration\": iteration,\n            \"timestamp\": datetime.now().isoformat(),\n        }\n        with _state_lock:\n            self.state.failure_log.append(entry)\n\n    def get_failure_log_str(self, file_path: str | None = None) -> str:\n        \"\"\"Get formatted failure log, optionally filtered by file.\"\"\"\n        log = self.state.failure_log\n        if file_path:\n            log = [e for e in log if e[\"file\"] == file_path]\n        if not log:\n            return \"(no previous failures)\"\n        lines = []\n        for e in log[-5:]:  # Last 5 entries\n            lines.append(f\"- [{e['file']}] {e['error'][:100]}\")\n        return \"\\n\".join(lines)\n\n    def record_error(self, error: str) -> None:\n        self.state.errors.append(error)\n\n    def clear_errors(self) -> None:\n        self.state.errors.clear()\n\n    def bump_iteration(self) -> int:\n        self.state.iteration += 1\n        return self.state.iteration\n\n    def get_complexity(self) -> str:\n        return self.state.complexity\n\n    def get_size(self) -> str:\n        return getattr(self.state, \"size\", \"medium\")\n\n    def get_context_sizes(self) -> tuple[int, int]:\n        c = self.state.complexity\n        s = self.get_size()\n        return get_context_size(c, s, True), get_context_size(c, s, False)\n\n    # \u2500\u2500 Conversation management \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n    def add_message(self, role_channel: str, role: str, content: str) -> None:\n        \"\"\"Add a message to a role's history.\"\"\"\n        msg = {\"role\": role, \"content\": content}\n        getattr(self, f\"{role_channel}_history\").append(msg)\n\n    def get_messages(self, role_channel: str) -> list[dict[str, str]]:\n        return list(getattr(self, f\"{role_channel}_history\"))\n\n    def reset_channel(self, role_channel: str) -> None:\n        getattr(self, f\"{role_channel}_history\").clear()\n\n    # Legacy aliases\n    def add_planner_message(self, role, content):\n        self.add_message(\"planner\", role, content)\n    def add_coder_message(self, role, content):\n        self.add_message(\"coder\", role, content)\n    def get_planner_messages(self):\n        return self.get_messages(\"planner\")\n    def get_coder_messages(self):\n        return self.get_messages(\"coder\")\n    def reset_coder_history(self):\n        self.reset_channel(\"coder\")\n\n    # \u2500\u2500 Chat history (per-project conversation) \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n    def add_chat(self, role: str, content: str) -> None:\n        \"\"\"Add a message to the project chat history.\"\"\"\n        self.chat_history.append({\"role\": role, \"content\": content})\n\n    def get_chat_messages(self) -> list[dict[str, str]]:\n        \"\"\"Return the full chat history for this project.\"\"\"\n        return list(self.chat_history)\n\n    def get_project_summary_for_chat(self) -> str:\n        \"\"\"Build a context string describing the project for chat interactions.\"\"\"\n        parts = [\n            f\"Project: {self.state.name}\",\n            f\"Description: {self.state.description}\",\n            f\"Tech stack: {', '.join(self.state.tech_stack)}\",\n            f\"Architecture: {self.state.architecture_summary or 'N/A'}\",\n            \"\",\n            \"Files:\",\n        ]\n        for path, purpose in (self.state.file_index or {}).items():\n            parts.append(f\"  - {path}: {purpose}\")\n\n        return \"\\n\".join(parts)\n\n    # \u2500\u2500 File context (sliced, not dumped) \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n    def get_file_context(self, rel_paths: list[str]) -> str:\n        \"\"\"Return formatted contents of specific files \u2014 sliced, not all.\"\"\"\n        parts: list[str] = []\n        for p in rel_paths:\n            content = self.state.files.get(p)\n            if content:\n                trimmed = content[:MAX_FILE_READ_CHARS]\n                parts.append(f\"### {p}\\n```\\n{trimmed}\\n```\")\n        return \"\\n\\n\".join(parts) if parts else \"(no existing files)\"\n\n    def get_related_files(self, task: dict) -> list[str]:\n        \"\"\"Resolve which files a task depends on.\"\"\"\n        depends = task.get(\"depends_on\", [])\n        if not depends:\n            return []\n        id_to_file = {t.id: t.file for t in self._task_dag}\n        return [id_to_file[d] for d in depends if d in id_to_file]\n\n    def get_plan_json(self) -> str:\n        if self.state.plan:\n            return json.dumps(self.state.plan, indent=2)\n        return \"{}\"\n\n    # \u2500\u2500 Metadata \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n    def to_metadata(self) -> dict:\n        return {\n            \"name\": self.state.name,\n            \"description\": self.state.description,\n            \"tech_stack\": self.state.tech_stack,\n            \"output_dir\": str(self.state.output_dir),\n            \"complexity\": self.state.complexity,\n            \"file_count\": len(self.state.files),\n            \"completed\": self.state.completed,\n            \"created_at\": self.state.created_at,\n            \"last_modified\": self.state.last_modified,\n        }\n\n    # \u2500\u2500 Serialization \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n    def save_session(self, path: Path) -> None:\n        data = {\n            \"state\": {\n                \"name\": self.state.name,\n                \"description\": self.state.description,\n                \"tech_stack\": self.state.tech_stack,\n                \"output_dir\": str(self.state.output_dir),\n                \"plan\": self.state.plan,\n                \"files\": self.state.files,\n                \"errors\": self.state.errors,\n                \"iteration\": self.state.iteration,\n                \"completed\": self.state.completed,\n                \"complexity\": self.state.complexity,\n                \"size\": self.state.size,\n                \"created_at\": self.state.created_at,\n                \"last_modified\": datetime.now().isoformat(),\n                \"architecture_summary\": self.state.architecture_summary,\n                \"file_index\": self.state.file_index,\n                \"dependency_graph\": self.state.dependency_graph,\n                \"failure_log\": self.state.failure_log,\n                \"task_nodes\": [t.to_dict() for t in self._task_dag],\n            },\n            \"planner_history\": self.planner_history,\n            \"coder_history\": self.coder_history,\n            \"chat_history\": self.chat_history,\n            \"memory\": self.memory.to_dict(),\n        }\n        path.write_text(json.dumps(data, indent=2))\n\n    @classmethod\n    def load_session(cls, path: Path) -> \"ContextManager\":\n        data = json.loads(path.read_text())\n        s = data[\"state\"]\n        state = ProjectState(\n            name=s[\"name\"],\n            description=s[\"description\"],\n            tech_stack=s[\"tech_stack\"],\n            output_dir=Path(s[\"output_dir\"]),\n            plan=s[\"plan\"],\n            files=s[\"files\"],\n            errors=s[\"errors\"],\n            iteration=s[\"iteration\"],\n            completed=s[\"completed\"],\n            complexity=s.get(\"complexity\", \"medium\"),\n            size=s.get(\"size\", \"medium\"),\n            created_at=s.get(\"created_at\", \"\"),\n            last_modified=s.get(\"last_modified\", \"\"),\n            architecture_summary=s.get(\"architecture_summary\", \"\"),\n            file_index=s.get(\"file_index\", {}),\n            dependency_graph=s.get(\"dependency_graph\", {}),\n            failure_log=s.get(\"failure_log\", []),\n            task_nodes=s.get(\"task_nodes\", []),\n        )\n        ctx = cls(state)\n        # Rebuild DAG\n        ctx._task_dag = [TaskNode.from_dict(d) for d in s.get(\"task_nodes\", [])]\n        ctx.planner_history = data.get(\"planner_history\", [])\n        ctx.coder_history = data.get(\"coder_history\", [])\n        ctx.chat_history = data.get(\"chat_history\", [])\n        # Restore vector memory\n        if \"memory\" in data:\n            ctx.memory = ProjectMemory.from_dict(data[\"memory\"])\n        return ctx\n",
      "jcode/executor.py": "\"\"\"\nExecution & verification pipeline \u2014 the quality gate that makes JCode reliable.\n\nCapabilities:\n  1. Run any shell command (with autonomy check)\n  2. Install any package (pip, npm, etc.)\n  3. Syntax check (language-specific)\n  4. Lint / format check\n  5. Type check (if applicable)\n  6. Import validation\n  7. Test execution (if tests exist)\n\nOnly code that passes ALL gates is accepted.\n\"\"\"\n\nfrom __future__ import annotations\n\nimport subprocess\nimport shutil\nimport json\nfrom pathlib import Path\nfrom dataclasses import dataclass\n\nfrom rich.console import Console\nfrom rich.prompt import Confirm\n\nconsole = Console()\n\n# \u2500\u2500 Global autonomy flag (set by cli.py at startup) \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n_autonomous: bool = False\n\n\ndef set_autonomous(value: bool) -> None:\n    \"\"\"Set whether the agent may run commands without asking.\"\"\"\n    global _autonomous\n    _autonomous = value\n\n\ndef is_autonomous() -> bool:\n    \"\"\"Check the current autonomy setting.\"\"\"\n    return _autonomous\n\n\n# \u2500\u2500 Data classes \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n@dataclass\nclass ExecResult:\n    \"\"\"Result of a command execution.\"\"\"\n    command: str\n    return_code: int\n    stdout: str\n    stderr: str\n\n    @property\n    def success(self) -> bool:\n        return self.return_code == 0\n\n    @property\n    def error_summary(self) -> str:\n        err = self.stderr.strip() or self.stdout.strip()\n        return err[-3000:] if len(err) > 3000 else err\n\n\n@dataclass\nclass VerificationResult:\n    \"\"\"Aggregated result of all verification checks.\"\"\"\n    passed: bool\n    checks: list[dict]  # [{\"name\": str, \"passed\": bool, \"output\": str}]\n\n    @property\n    def summary(self) -> str:\n        failed = [c for c in self.checks if not c[\"passed\"]]\n        if not failed:\n            return \"All checks passed\"\n        return \"; \".join(f\"{c['name']}: {c['output'][:200]}\" for c in failed)\n\n    @property\n    def failed_checks(self) -> list[dict]:\n        return [c for c in self.checks if not c[\"passed\"]]\n\n    @property\n    def structured_errors(self) -> list[dict]:\n        \"\"\"Parse error output into structured error objects.\n\n        Returns list of:\n        {\n            \"file\": str,       # affected file path\n            \"line\": int|None,  # line number if available\n            \"category\": str,   # syntax|lint|import|type|runtime\n            \"message\": str,    # human-readable error\n        }\n        \"\"\"\n        import re as _re\n        errors = []\n        for check in self.failed_checks:\n            output = check.get(\"output\", \"\")\n            name = check.get(\"name\", \"\")\n\n            # Determine category from check name\n            if \"syntax\" in name:\n                category = \"syntax\"\n            elif \"lint\" in name:\n                category = \"lint\"\n            elif \"import\" in name:\n                category = \"import\"\n            elif \"type\" in name:\n                category = \"type\"\n            else:\n                category = \"runtime\"\n\n            matched = False\n\n            # Try to parse file:line patterns\n            # Python: File \"path\", line N\n            for m in _re.finditer(r'File \"(.+?)\", line (\\d+)', output):\n                matched = True\n                errors.append({\n                    \"file\": m.group(1),\n                    \"line\": int(m.group(2)),\n                    \"category\": category,\n                    \"message\": output.strip()[:300],\n                })\n\n            # JS/TS/ruff: path:line:col: message\n            if not matched:\n                for m in _re.finditer(r'([^\\s:]+\\.\\w+):(\\d+):\\d*:?\\s*(.+)', output):\n                    matched = True\n                    errors.append({\n                        \"file\": m.group(1),\n                        \"line\": int(m.group(2)),\n                        \"category\": category,\n                        \"message\": m.group(3).strip()[:300],\n                    })\n\n            # If no patterns matched, add a generic entry\n            if not matched:\n                errors.append({\n                    \"file\": \"\",\n                    \"line\": None,\n                    \"category\": category,\n                    \"message\": output.strip()[:300],\n                })\n\n        return errors\n\n\n# \u2500\u2500 Shell command execution \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\ndef run_command(\n    command: str | list[str],\n    cwd: Path | None = None,\n    timeout: int = 60,\n) -> ExecResult:\n    \"\"\"Run a shell command and capture output.\"\"\"\n    if isinstance(command, str):\n        shell = True\n        cmd = command\n    else:\n        shell = False\n        cmd = command\n\n    try:\n        result = subprocess.run(\n            cmd, cwd=cwd, shell=shell,\n            capture_output=True, text=True, timeout=timeout,\n        )\n        return ExecResult(\n            command=cmd if isinstance(cmd, str) else \" \".join(cmd),\n            return_code=result.returncode,\n            stdout=result.stdout,\n            stderr=result.stderr,\n        )\n    except subprocess.TimeoutExpired:\n        return ExecResult(cmd if isinstance(cmd, str) else \" \".join(cmd), -1, \"\", f\"Timed out after {timeout}s\")\n    except FileNotFoundError as e:\n        return ExecResult(cmd if isinstance(cmd, str) else \" \".join(cmd), -1, \"\", str(e))\n\n\ndef shell_exec(\n    command: str,\n    cwd: Path | None = None,\n    timeout: int = 120,\n    reason: str = \"\",\n) -> ExecResult:\n    \"\"\"Run an arbitrary shell command on behalf of the agent.\n    Checks the autonomy flag \u2014 if not autonomous, asks the user first.\"\"\"\n    from datetime import datetime\n    ts = datetime.now().strftime(\"%H:%M:%S\")\n\n    if not _autonomous:\n        console.print(f\"\\n  [dim]{ts}[/dim]  [cyan]EXEC[/cyan]      {command}\")\n        if reason:\n            console.print(f\"  [dim]Reason: {reason}[/dim]\")\n        if not Confirm.ask(\"  Allow?\", default=True):\n            return ExecResult(command, -1, \"\", \"User declined\")\n\n    console.print(f\"  [dim]{ts}[/dim]  [cyan]EXEC[/cyan]      {command}\")\n    result = run_command(command, cwd=cwd, timeout=timeout)\n    if not result.success and result.error_summary:\n        console.print(f\"  [dim]  stderr: {result.error_summary[:200]}[/dim]\")\n    return result\n\n\ndef install_package(\n    package: str,\n    manager: str = \"pip\",\n    cwd: Path | None = None,\n) -> ExecResult:\n    \"\"\"Install a package using pip, npm, or any other manager.\n    Checks the autonomy flag \u2014 if not autonomous, asks the user first.\"\"\"\n    from datetime import datetime\n    ts = datetime.now().strftime(\"%H:%M:%S\")\n\n    if manager == \"pip\":\n        cmd = f\"pip install {package}\"\n    elif manager == \"npm\":\n        cmd = f\"npm install {package}\"\n    elif manager == \"pip3\":\n        cmd = f\"pip3 install {package}\"\n    else:\n        cmd = f\"{manager} install {package}\"\n\n    if not _autonomous:\n        console.print(f\"\\n  [dim]{ts}[/dim]  [cyan]INSTALL[/cyan]   {cmd}\")\n        if not Confirm.ask(\"  Allow?\", default=True):\n            return ExecResult(cmd, -1, \"\", \"User declined\")\n\n    console.print(f\"  [dim]{ts}[/dim]  [cyan]INSTALL[/cyan]   {cmd}\")\n    return run_command(cmd, cwd=cwd, timeout=120)\n\n\n# \u2500\u2500 Verification pipeline \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\ndef verify_file(file_path: Path, project_dir: Path) -> VerificationResult:\n    \"\"\"\n    Run all applicable verification checks on a single file.\n    Returns a VerificationResult with pass/fail per check.\n    \"\"\"\n    checks: list[dict] = []\n\n    suffix = file_path.suffix.lower()\n\n    if suffix == \".py\":\n        checks.extend(_verify_python(file_path, project_dir))\n    elif suffix in (\".js\", \".jsx\", \".ts\", \".tsx\"):\n        checks.extend(_verify_javascript(file_path, project_dir))\n    elif suffix in (\".html\",):\n        checks.append({\"name\": \"html-exists\", \"passed\": True, \"output\": \"OK\"})\n    elif suffix in (\".css\", \".scss\"):\n        checks.append({\"name\": \"css-exists\", \"passed\": True, \"output\": \"OK\"})\n    elif suffix in (\".json\",):\n        checks.extend(_verify_json(file_path))\n    else:\n        checks.append({\"name\": \"file-exists\", \"passed\": file_path.exists(), \"output\": \"OK\"})\n\n    passed = all(c[\"passed\"] for c in checks)\n    return VerificationResult(passed=passed, checks=checks)\n\n\ndef _verify_python(file_path: Path, project_dir: Path) -> list[dict]:\n    \"\"\"Python verification: syntax > imports > type check.\"\"\"\n    checks = []\n\n    # 1. Syntax check\n    result = run_command([\"python3\", \"-m\", \"py_compile\", str(file_path)])\n    checks.append({\n        \"name\": \"python-syntax\",\n        \"passed\": result.success,\n        \"output\": result.error_summary if not result.success else \"OK\",\n    })\n\n    if not result.success:\n        return checks\n\n    # 2. Basic lint (if ruff or flake8 available)\n    ruff = shutil.which(\"ruff\")\n    if ruff:\n        result = run_command([ruff, \"check\", \"--select=E,F\", \"--no-fix\", str(file_path)])\n        checks.append({\n            \"name\": \"python-lint\",\n            \"passed\": result.success,\n            \"output\": result.error_summary if not result.success else \"OK\",\n        })\n    else:\n        flake8 = shutil.which(\"flake8\")\n        if flake8:\n            result = run_command([flake8, \"--select=E,F\", str(file_path)])\n            checks.append({\n                \"name\": \"python-lint\",\n                \"passed\": result.success,\n                \"output\": result.error_summary if not result.success else \"OK\",\n            })\n\n    return checks\n\n\ndef _verify_javascript(file_path: Path, project_dir: Path) -> list[dict]:\n    \"\"\"JavaScript/TypeScript verification.\"\"\"\n    checks = []\n\n    node = shutil.which(\"node\")\n    if node and file_path.suffix in (\".js\", \".jsx\"):\n        result = run_command([node, \"--check\", str(file_path)])\n        checks.append({\n            \"name\": \"js-syntax\",\n            \"passed\": result.success,\n            \"output\": result.error_summary if not result.success else \"OK\",\n        })\n    else:\n        checks.append({\"name\": \"js-exists\", \"passed\": file_path.exists(), \"output\": \"OK\"})\n\n    return checks\n\n\ndef _verify_json(file_path: Path) -> list[dict]:\n    \"\"\"Verify JSON is parseable.\"\"\"\n    try:\n        json.loads(file_path.read_text())\n        return [{\"name\": \"json-valid\", \"passed\": True, \"output\": \"OK\"}]\n    except Exception as e:\n        return [{\"name\": \"json-valid\", \"passed\": False, \"output\": str(e)}]\n\n\n# \u2500\u2500 Dependency installation \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\ndef install_dependencies(project_dir: Path, tech_stack: list[str] | None = None) -> list[ExecResult]:\n    \"\"\"Auto-install project dependencies (requirements.txt / package.json).\"\"\"\n    results: list[ExecResult] = []\n    from datetime import datetime\n\n    req_file = project_dir / \"requirements.txt\"\n    if req_file.exists():\n        results.append(\n            install_package(f\"-r {req_file}\", manager=\"pip\", cwd=project_dir)\n        )\n\n    pkg_file = project_dir / \"package.json\"\n    if pkg_file.exists() and shutil.which(\"npm\"):\n        results.append(\n            shell_exec(\"npm install\", cwd=project_dir, reason=\"Install Node.js dependencies\")\n        )\n\n    return results\n\n\n# \u2500\u2500 Test execution \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\ndef run_tests(project_dir: Path, tech_stack: list[str] | None = None) -> ExecResult:\n    \"\"\"Run the project test suite.\"\"\"\n    tech = tech_stack or []\n    if any(\"python\" in t.lower() for t in tech):\n        if shutil.which(\"pytest\"):\n            return run_command(\"pytest --tb=short -q\", cwd=project_dir, timeout=60)\n        return run_command(\"python3 -m pytest --tb=short -q\", cwd=project_dir, timeout=60)\n\n    pkg = project_dir / \"package.json\"\n    if pkg.exists():\n        return run_command(\"npm test\", cwd=project_dir, timeout=60)\n\n    return ExecResult(\"(no tests)\", 0, \"No test runner detected.\", \"\")\n",
      "jcode/file_manager.py": "\"\"\"\nFile system manager \u2014 creates project directories and writes files to disk.\n\"\"\"\n\nfrom __future__ import annotations\n\nfrom pathlib import Path\n\nfrom rich.console import Console\nfrom rich.tree import Tree\n\nconsole = Console()\n\n\ndef ensure_project_dir(base: Path) -> Path:\n    \"\"\"Create the output directory if it doesn't exist. Return the path.\"\"\"\n    base.mkdir(parents=True, exist_ok=True)\n    return base\n\n\ndef write_file(base: Path, rel_path: str, content: str) -> Path:\n    \"\"\"\n    Write content to a file inside the project directory.\n    Creates parent directories as needed.\n    Returns the absolute path of the written file.\n    \"\"\"\n    full = base / rel_path\n    full.parent.mkdir(parents=True, exist_ok=True)\n    full.write_text(content, encoding=\"utf-8\")\n    return full\n\n\ndef read_file(base: Path, rel_path: str) -> str | None:\n    \"\"\"Read a file from the project directory. Returns None if not found.\"\"\"\n    full = base / rel_path\n    if full.is_file():\n        return full.read_text(encoding=\"utf-8\")\n    return None\n\n\ndef print_tree(base: Path, title: str | None = None) -> None:\n    \"\"\"Pretty-print the project directory tree using Rich.\"\"\"\n    label = title or base.name\n    tree = Tree(f\"\ud83d\udcc1 [bold cyan]{label}[/bold cyan]\")\n    _build_tree(base, tree)\n    console.print(tree)\n\n\ndef _build_tree(directory: Path, tree: Tree) -> None:\n    \"\"\"Recursively build a Rich Tree from a directory.\"\"\"\n    # Sort: directories first, then files\n    entries = sorted(\n        directory.iterdir(),\n        key=lambda p: (not p.is_dir(), p.name.lower()),\n    )\n    for entry in entries:\n        if entry.name.startswith(\".\") or entry.name == \"__pycache__\":\n            continue\n        if entry.is_dir():\n            branch = tree.add(f\"\ud83d\udcc1 [bold]{entry.name}[/bold]\")\n            _build_tree(entry, branch)\n        else:\n            icon = _file_icon(entry.suffix)\n            tree.add(f\"{icon} {entry.name}\")\n\n\ndef _file_icon(suffix: str) -> str:\n    \"\"\"Return a short tag based on file extension.\"\"\"\n    icons = {\n        \".py\": \"py\",\n        \".js\": \"js\",\n        \".ts\": \"ts\",\n        \".jsx\": \"jsx\",\n        \".tsx\": \"tsx\",\n        \".html\": \"html\",\n        \".css\": \"css\",\n        \".json\": \"json\",\n        \".toml\": \"toml\",\n        \".yaml\": \"yaml\",\n        \".yml\": \"yml\",\n        \".md\": \"md\",\n        \".txt\": \"txt\",\n        \".sql\": \"sql\",\n        \".sh\": \"sh\",\n        \".env\": \"env\",\n    }\n    return icons.get(suffix, \"--\")\n",
      "jcode/git_manager.py": "\"\"\"\nGit integration for JCode \u2014 version control, commits, push, GitHub.\n\nCapabilities:\n  1. Detect & auto-install git\n  2. Init repos, create .gitignore\n  3. Stage, commit, status, log, diff\n  4. Remote management (GitHub)\n  5. Push / pull\n  6. Clone repos into CWD\n\nv0.7.0 \u2014 JCode lives inside your project.\n\"\"\"\n\nfrom __future__ import annotations\n\nimport os\nimport re\nimport subprocess\nimport shutil\nimport sys\nfrom pathlib import Path\n\nfrom rich.console import Console\nfrom rich.table import Table\n\nconsole = Console()\n\n\n# \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n# Git availability\n# \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n\ndef git_available() -> bool:\n    \"\"\"Check if git is installed and accessible.\"\"\"\n    return shutil.which(\"git\") is not None\n\n\ndef ensure_git() -> bool:\n    \"\"\"\n    Ensure git is installed. If not, attempt to install it.\n    Returns True if git is available after the check.\n    \"\"\"\n    if git_available():\n        return True\n\n    console.print(\"  [yellow]Git is not installed.[/yellow]\")\n    console.print(\"  [dim]Attempting to install git...[/dim]\")\n\n    if sys.platform == \"darwin\":\n        # macOS: xcode-select installs git\n        result = _run_git_cmd([\"xcode-select\", \"--install\"], cwd=None, raw=True)\n        if result is None:\n            console.print(\"  [dim]Please complete the Xcode command-line tools installation and restart JCode.[/dim]\")\n            return False\n    elif sys.platform.startswith(\"linux\"):\n        # Try common package managers\n        for mgr_cmd in [\n            [\"sudo\", \"apt-get\", \"install\", \"-y\", \"git\"],\n            [\"sudo\", \"dnf\", \"install\", \"-y\", \"git\"],\n            [\"sudo\", \"pacman\", \"-S\", \"--noconfirm\", \"git\"],\n            [\"sudo\", \"apk\", \"add\", \"git\"],\n        ]:\n            try:\n                subprocess.run(mgr_cmd, capture_output=True, timeout=120)\n                if git_available():\n                    console.print(\"  [cyan]Git installed successfully.[/cyan]\")\n                    return True\n            except (FileNotFoundError, subprocess.TimeoutExpired):\n                continue\n    elif sys.platform == \"win32\":\n        console.print(\"  [dim]Please install git from https://git-scm.com/downloads[/dim]\")\n        return False\n\n    if git_available():\n        console.print(\"  [cyan]Git is now available.[/cyan]\")\n        return True\n\n    console.print(\"  [yellow]Could not install git automatically.[/yellow]\")\n    console.print(\"  [dim]Install manually: https://git-scm.com/downloads[/dim]\")\n    return False\n\n\n# \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n# Low-level git command runner\n# \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n\ndef _run_git_cmd(\n    args: list[str],\n    cwd: Path | str | None,\n    raw: bool = False,\n    timeout: int = 30,\n) -> str | None:\n    \"\"\"\n    Run a git (or arbitrary) command and return stdout.\n    Returns None on failure.\n    \"\"\"\n    try:\n        result = subprocess.run(\n            args,\n            cwd=str(cwd) if cwd else None,\n            capture_output=True,\n            text=True,\n            timeout=timeout,\n        )\n        if raw:\n            return result.stdout + result.stderr\n        if result.returncode != 0:\n            return None\n        return result.stdout.strip()\n    except (subprocess.TimeoutExpired, FileNotFoundError, OSError):\n        return None\n\n\ndef _run_git(args: list[str], cwd: Path | str) -> tuple[bool, str]:\n    \"\"\"\n    Run a git command. Returns (success, output).\n    \"\"\"\n    try:\n        result = subprocess.run(\n            [\"git\"] + args,\n            cwd=str(cwd),\n            capture_output=True,\n            text=True,\n            timeout=60,\n        )\n        output = result.stdout.strip()\n        if result.returncode != 0:\n            err = result.stderr.strip()\n            return False, err or output\n        return True, output\n    except subprocess.TimeoutExpired:\n        return False, \"Command timed out\"\n    except FileNotFoundError:\n        return False, \"Git not found\"\n    except OSError as e:\n        return False, str(e)\n\n\n# \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n# Repository detection\n# \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n\ndef is_git_repo(path: Path) -> bool:\n    \"\"\"Check if the given path is inside a git repository.\"\"\"\n    ok, _ = _run_git([\"rev-parse\", \"--is-inside-work-tree\"], path)\n    return ok\n\n\ndef get_repo_root(path: Path) -> Path | None:\n    \"\"\"Get the root of the git repository containing path.\"\"\"\n    ok, out = _run_git([\"rev-parse\", \"--show-toplevel\"], path)\n    if ok and out:\n        return Path(out)\n    return None\n\n\ndef get_current_branch(path: Path) -> str:\n    \"\"\"Get the current branch name.\"\"\"\n    ok, out = _run_git([\"branch\", \"--show-current\"], path)\n    return out if ok else \"unknown\"\n\n\ndef get_remote_url(path: Path) -> str | None:\n    \"\"\"Get the remote origin URL.\"\"\"\n    ok, out = _run_git([\"remote\", \"get-url\", \"origin\"], path)\n    return out if ok else None\n\n\n# \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n# Init & .gitignore\n# \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n\n# Standard .gitignore entries for common project types\n_GITIGNORE_TEMPLATE = \"\"\"\\\n# Dependencies\nnode_modules/\n.venv/\nvenv/\n__pycache__/\n*.pyc\n\n# Build outputs\ndist/\nbuild/\n.next/\nout/\n*.egg-info/\n\n# Environment & secrets\n.env\n.env.local\n.env.*.local\n\n# IDE\n.vscode/\n.idea/\n*.swp\n*.swo\n*~\n\n# OS\n.DS_Store\nThumbs.db\n\n# Logs\n*.log\nnpm-debug.log*\n\n# JCode session\n.jcode_session.json\n\"\"\"\n\n\ndef init_repo(path: Path, initial_commit: bool = True) -> bool:\n    \"\"\"\n    Initialize a new git repository at the given path.\n    Creates a .gitignore and optionally makes an initial commit.\n    Returns True on success.\n    \"\"\"\n    if is_git_repo(path):\n        return True  # Already a repo\n\n    ok, out = _run_git([\"init\"], path)\n    if not ok:\n        console.print(f\"  [yellow]git init failed: {out}[/yellow]\")\n        return False\n\n    console.print(f\"  [cyan]Initialized git repository[/cyan]\")\n\n    # Create .gitignore if it doesn't exist\n    gitignore = path / \".gitignore\"\n    if not gitignore.exists():\n        gitignore.write_text(_GITIGNORE_TEMPLATE)\n        console.print(f\"  [dim]Created .gitignore[/dim]\")\n\n    if initial_commit:\n        # Stage everything and make initial commit\n        _run_git([\"add\", \"-A\"], path)\n        ok, out = _run_git([\"commit\", \"-m\", \"Initial commit by JCode\"], path)\n        if ok:\n            console.print(f\"  [dim]Created initial commit[/dim]\")\n\n    return True\n\n\n# \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n# Stage, Commit, Status\n# \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n\ndef stage_all(path: Path) -> bool:\n    \"\"\"Stage all changes (git add -A).\"\"\"\n    ok, _ = _run_git([\"add\", \"-A\"], path)\n    return ok\n\n\ndef stage_files(path: Path, files: list[str]) -> bool:\n    \"\"\"Stage specific files.\"\"\"\n    ok, _ = _run_git([\"add\", \"--\"] + files, path)\n    return ok\n\n\ndef commit(path: Path, message: str) -> tuple[bool, str]:\n    \"\"\"\n    Create a commit with the given message.\n    Auto-stages all changes first.\n    Returns (success, commit_hash_or_error).\n    \"\"\"\n    stage_all(path)\n\n    # Check if there's anything to commit\n    ok, status = _run_git([\"status\", \"--porcelain\"], path)\n    if ok and not status.strip():\n        return True, \"nothing to commit\"\n\n    ok, out = _run_git([\"commit\", \"-m\", message], path)\n    if ok:\n        # Extract short hash\n        hash_ok, hash_out = _run_git([\"rev-parse\", \"--short\", \"HEAD\"], path)\n        commit_hash = hash_out if hash_ok else \"?\"\n        return True, commit_hash\n    return False, out\n\n\ndef auto_commit(path: Path, description: str = \"\") -> tuple[bool, str]:\n    \"\"\"\n    Create an automatic commit with a descriptive message.\n    Used after JCode generates or modifies files.\n    \"\"\"\n    # Build a meaningful commit message\n    ok, status_out = _run_git([\"status\", \"--porcelain\"], path)\n    if not ok or not status_out.strip():\n        return True, \"nothing to commit\"\n\n    lines = status_out.strip().split(\"\\n\")\n    added = [l for l in lines if l.startswith(\"?\") or l.startswith(\"A\")]\n    modified = [l for l in lines if l.startswith(\"M\") or l.startswith(\" M\")]\n    deleted = [l for l in lines if l.startswith(\"D\") or l.startswith(\" D\")]\n\n    parts = []\n    if added:\n        parts.append(f\"add {len(added)} file(s)\")\n    if modified:\n        parts.append(f\"update {len(modified)} file(s)\")\n    if deleted:\n        parts.append(f\"remove {len(deleted)} file(s)\")\n\n    change_summary = \", \".join(parts) if parts else \"update project\"\n\n    if description:\n        msg = f\"jcode: {description} \u2014 {change_summary}\"\n    else:\n        msg = f\"jcode: {change_summary}\"\n\n    # Truncate to 72 chars for git convention\n    if len(msg) > 72:\n        msg = msg[:69] + \"...\"\n\n    return commit(path, msg)\n\n\n# \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n# Status, Log, Diff\n# \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n\ndef status(path: Path) -> str:\n    \"\"\"Get git status output.\"\"\"\n    ok, out = _run_git([\"status\", \"--short\"], path)\n    return out if ok else \"(not a git repo)\"\n\n\ndef log(path: Path, n: int = 10) -> str:\n    \"\"\"Get recent git log.\"\"\"\n    ok, out = _run_git(\n        [\"log\", f\"-{n}\", \"--oneline\", \"--decorate\", \"--graph\"],\n        path,\n    )\n    return out if ok else \"(no commits)\"\n\n\ndef diff(path: Path, staged: bool = False) -> str:\n    \"\"\"Get git diff output.\"\"\"\n    args = [\"diff\"]\n    if staged:\n        args.append(\"--staged\")\n    ok, out = _run_git(args, path)\n    return out if ok else \"\"\n\n\ndef changed_files(path: Path) -> list[str]:\n    \"\"\"Get list of changed files (modified + untracked).\"\"\"\n    ok, out = _run_git([\"status\", \"--porcelain\"], path)\n    if not ok or not out:\n        return []\n    files = []\n    for line in out.split(\"\\n\"):\n        if line.strip():\n            # Format: \"XY filename\" \u2014 extract filename\n            fname = line[3:].strip()\n            if fname:\n                files.append(fname)\n    return files\n\n\n# \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n# Remote & Push\n# \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n\ndef add_remote(path: Path, url: str, name: str = \"origin\") -> bool:\n    \"\"\"Add a remote to the repository.\"\"\"\n    # Check if remote already exists\n    existing = get_remote_url(path)\n    if existing:\n        if existing == url:\n            return True\n        # Update existing remote\n        ok, _ = _run_git([\"remote\", \"set-url\", name, url], path)\n        return ok\n\n    ok, _ = _run_git([\"remote\", \"add\", name, url], path)\n    return ok\n\n\ndef push(path: Path, remote: str = \"origin\", branch: str | None = None) -> tuple[bool, str]:\n    \"\"\"\n    Push to remote. If branch is None, pushes current branch.\n    Sets upstream on first push.\n    \"\"\"\n    if not branch:\n        branch = get_current_branch(path)\n\n    # Try push with upstream set\n    ok, out = _run_git([\"push\", \"-u\", remote, branch], path)\n    if ok:\n        return True, f\"Pushed to {remote}/{branch}\"\n    return False, out\n\n\ndef pull(path: Path, remote: str = \"origin\", branch: str | None = None) -> tuple[bool, str]:\n    \"\"\"Pull from remote.\"\"\"\n    args = [\"pull\", remote]\n    if branch:\n        args.append(branch)\n    ok, out = _run_git(args, path)\n    if ok:\n        return True, out\n    return False, out\n\n\n# \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n# Clone\n# \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n\ndef clone(url: str, target_dir: Path | None = None) -> tuple[bool, Path | None]:\n    \"\"\"\n    Clone a repository. Returns (success, cloned_path).\n    If target_dir is None, clones into CWD with repo name.\n    \"\"\"\n    args = [\"clone\", url]\n    cwd = Path.cwd()\n\n    if target_dir:\n        args.append(str(target_dir))\n        cwd = target_dir.parent\n        cwd.mkdir(parents=True, exist_ok=True)\n\n    ok, out = _run_git(args, cwd)\n    if not ok:\n        return False, None\n\n    # Determine cloned directory\n    if target_dir:\n        return True, target_dir\n\n    # Extract from URL: https://github.com/user/repo.git -> repo\n    repo_name = url.rstrip(\"/\").split(\"/\")[-1]\n    if repo_name.endswith(\".git\"):\n        repo_name = repo_name[:-4]\n\n    cloned_path = cwd / repo_name\n    return True, cloned_path\n\n\n# \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n# GitHub helpers\n# \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n\ndef build_github_url(owner: str, repo: str, use_ssh: bool = False) -> str:\n    \"\"\"Build a GitHub URL from owner/repo.\"\"\"\n    if use_ssh:\n        return f\"git@github.com:{owner}/{repo}.git\"\n    return f\"https://github.com/{owner}/{repo}.git\"\n\n\ndef parse_github_url(url: str) -> tuple[str, str] | None:\n    \"\"\"Parse owner/repo from a GitHub URL. Returns (owner, repo) or None.\"\"\"\n    patterns = [\n        r\"github\\.com[:/]([^/]+)/([^/\\s.]+?)(?:\\.git)?$\",\n        r\"^([^/\\s]+)/([^/\\s]+)$\",  # owner/repo shorthand\n    ]\n    for pat in patterns:\n        m = re.search(pat, url)\n        if m:\n            return m.group(1), m.group(2)\n    return None\n\n\ndef setup_github_remote(\n    path: Path,\n    repo_url: str,\n) -> bool:\n    \"\"\"\n    Set up a GitHub remote for the project.\n    Accepts full URL or owner/repo shorthand.\n    \"\"\"\n    # Parse shorthand like \"user/repo\" into full URL\n    parsed = parse_github_url(repo_url)\n    if parsed and \"/\" not in repo_url.replace(\"github.com\", \"\"):\n        owner, repo = parsed\n        repo_url = build_github_url(owner, repo)\n\n    return add_remote(path, repo_url)\n\n\n# \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n# Display helpers\n# \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n\ndef print_status(path: Path) -> None:\n    \"\"\"Pretty-print git status.\"\"\"\n    if not is_git_repo(path):\n        console.print(\"  [dim]Not a git repository[/dim]\")\n        return\n\n    branch = get_current_branch(path)\n    remote = get_remote_url(path)\n\n    console.print(f\"  [cyan]Branch:[/cyan] {branch}\")\n    if remote:\n        console.print(f\"  [cyan]Remote:[/cyan] {remote}\")\n\n    st = status(path)\n    if st:\n        console.print(f\"  [cyan]Changes:[/cyan]\")\n        for line in st.split(\"\\n\"):\n            if line.strip():\n                console.print(f\"    {line}\")\n    else:\n        console.print(\"  [dim]Working tree clean[/dim]\")\n\n\ndef print_log(path: Path, n: int = 10) -> None:\n    \"\"\"Pretty-print git log.\"\"\"\n    if not is_git_repo(path):\n        console.print(\"  [dim]Not a git repository[/dim]\")\n        return\n\n    log_output = log(path, n)\n    if log_output:\n        console.print(f\"  [cyan]Recent commits:[/cyan]\")\n        for line in log_output.split(\"\\n\"):\n            console.print(f\"    {line}\")\n    else:\n        console.print(\"  [dim]No commits yet[/dim]\")\n",
      "jcode/intent.py": "\"\"\"\nIntent router \u2014 lightweight classifier for user input.\n\nDetermines what the user wants to do WITHOUT calling the LLM\nfor obvious commands. Falls back to LLM for ambiguous input.\n\nIntents:\n  BUILD     \u2014 create a new project from scratch\n  MODIFY    \u2014 change/fix/add to existing code (agent mode)\n  CHAT      \u2014 ask questions, discuss, explain (chat mode)\n  GIT       \u2014 version control operations\n  RUN       \u2014 run/start/test the project\n  NAVIGATE  \u2014 utility commands (files, tree, plan, help, etc.)\n  MODE      \u2014 switch between agent/chat mode\n  QUIT      \u2014 exit/back\n\nv0.9.0 \u2014 Simplified mode switching: just type \"agent\" or \"chat\".\n\"\"\"\n\nfrom __future__ import annotations\n\nimport re\nfrom enum import Enum\n\n\nclass Intent(str, Enum):\n    \"\"\"User intent categories.\"\"\"\n    BUILD    = \"build\"      # Create new project from scratch\n    MODIFY   = \"modify\"     # Change/fix/add code (agent mode)\n    CHAT     = \"chat\"       # Discussion, questions, explain\n    GIT      = \"git\"        # Version control\n    RUN      = \"run\"        # Run/start/test project\n    NAVIGATE = \"navigate\"   # Utility: files, tree, plan, help\n    MODE     = \"mode\"       # Switch agent/chat mode\n    QUIT     = \"quit\"       # Exit/back\n\n\n# \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n# Pattern-based intent classification\n# \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n\n# Exact-match commands (case-insensitive)\n_EXACT_COMMANDS: dict[str, Intent] = {\n    # Quit\n    \"quit\": Intent.QUIT,\n    \"exit\": Intent.QUIT,\n    \"q\": Intent.QUIT,\n    \"back\": Intent.QUIT,\n    \"home\": Intent.QUIT,\n\n    # Mode switching \u2014 just type \"agent\" or \"chat\"\n    \"agent\": Intent.MODE,\n    \"chat\": Intent.MODE,\n    \"agentic\": Intent.MODE,\n\n    # Navigate\n    \"help\": Intent.NAVIGATE,\n    \"files\": Intent.NAVIGATE,\n    \"tree\": Intent.NAVIGATE,\n    \"plan\": Intent.NAVIGATE,\n    \"clear\": Intent.NAVIGATE,\n    \"status\": Intent.NAVIGATE,\n    \"version\": Intent.NAVIGATE,\n    \"update\": Intent.NAVIGATE,\n    \"uninstall\": Intent.NAVIGATE,\n    \"models\": Intent.NAVIGATE,\n\n    # Run\n    \"run\": Intent.RUN,\n    \"start\": Intent.RUN,\n    \"test\": Intent.RUN,\n    \"tests\": Intent.RUN,\n    \"dev\": Intent.RUN,\n    \"serve\": Intent.RUN,\n    \"rebuild\": Intent.RUN,\n\n    # Git (single-word)\n    \"commit\": Intent.GIT,\n    \"push\": Intent.GIT,\n    \"pull\": Intent.GIT,\n    \"diff\": Intent.GIT,\n    \"log\": Intent.GIT,\n}\n\n# Prefix-match commands\n_PREFIX_COMMANDS: list[tuple[str, Intent]] = [\n    (\"build \", Intent.BUILD),\n    (\"create \", Intent.BUILD),\n    (\"new project\", Intent.BUILD),\n    (\"make \", Intent.BUILD),\n    (\"scaffold \", Intent.BUILD),\n    (\"generate project\", Intent.BUILD),\n\n    # Git prefix commands\n    (\"git \", Intent.GIT),\n    (\"commit \", Intent.GIT),\n    (\"push to\", Intent.GIT),\n    (\"push \", Intent.GIT),\n    (\"pull \", Intent.GIT),\n    (\"clone \", Intent.GIT),\n    (\"branch \", Intent.GIT),\n\n    # Mode switch (legacy \"mode\" prefix also works)\n    (\"mode \", Intent.MODE),\n    (\"switch to \", Intent.MODE),\n    (\"switch \", Intent.MODE),\n]\n\n# Keyword patterns for intent detection\n_BUILD_PATTERNS: list[str] = [\n    r\"\\bbuild\\b.*\\b(?:app|application|project|website|site|page|tool|game|program|system|platform|service|dashboard)\\b\",\n    r\"\\b(?:app|application|project|website|site|tool|game|program|system|platform|service|dashboard)\\b.*\\bbuild\\b\",\n    r\"\\bcreate\\b.*\\b(?:app|application|project|website|site|page|tool|game|program|system|platform|service|dashboard)\\b\",\n    r\"\\bmake\\b.*\\b(?:app|application|project|website|site|page|tool|game|program|system|platform|service|dashboard)\\b\",\n    r\"\\b(?:i\\s+)?want\\s+(?:you\\s+)?(?:to\\s+)?(?:build|create|make|develop|code|write)\\b\",\n    r\"\\b(?:develop|code|write)\\b.*\\b(?:app|application|project|website|site|tool|game|program|system|platform|service|dashboard)\\b\",\n    r\"\\b(?:build|create|make)\\s+(?:a|an|the|me|my)\\b\",\n    r\"\\b(?:new|from\\s+scratch)\\b.*\\b(?:app|project|website|tool|game|program)\\b\",\n    r\"\\bscaffold\\b\", r\"\\bbootstrap\\b\",\n    r\"\\bgenerate\\s+(?:a|an|the)\\b\",\n    r\"\\bset\\s*up\\s+(?:a|an|the|new)\\b.*\\b(?:app|project|website|tool)\\b\",\n    r\"\\bstart\\s+(?:a|an)\\s+(?:new\\s+)?(?:app|project|website|tool)\\b\",\n]\n\n_MODIFY_PATTERNS: list[str] = [\n    r\"\\bfix\\b\", r\"\\bbug\\b\", r\"\\berror\\b\", r\"\\bcrash\\b\",\n    r\"\\badd\\b.*\\b(?:feature|function|component|page|route|endpoint|button|form)\\b\",\n    r\"\\bimplement\\b\", r\"\\brefactor\\b\", r\"\\brewrite\\b\", r\"\\bupdate\\b\",\n    r\"\\bchange\\b\", r\"\\bmodify\\b\", r\"\\breplace\\b\", r\"\\bremove\\b\",\n    r\"\\bdelete\\b\", r\"\\brename\\b\", r\"\\bmove\\b\",\n    r\"\\binstall\\b\", r\"\\bupgrade\\b\", r\"\\bmigrate\\b\",\n    r\"\\badd\\s+\", r\"\\bcreate\\s+a?\\s*(?:file|page|component|module)\\b\",\n    r\"\\bset\\s*up\\b\", r\"\\bconfigure\\b\", r\"\\benable\\b\", r\"\\bdisable\\b\",\n    r\"\\boptimize\\b\", r\"\\bimprove\\b\", r\"\\benhance\\b\",\n    r\"\\bdark\\s*mode\\b\", r\"\\bresponsive\\b\", r\"\\bstyle\\b\",\n    r\"\\bthe\\s+\\w+\\s+(?:is|are|isn't|doesn't|won't|can't)\\b.*\\b(?:work|broken|wrong|fail)\\b\",\n    r\"\\bnot\\s+working\\b\", r\"\\bdoesn't\\s+work\\b\", r\"\\bwon't\\s+(?:start|run|compile|build)\\b\",\n    r\"\\bmissing\\b\", r\"\\bundefined\\b\", r\"\\bnull\\b\",\n]\n\n_CHAT_PATTERNS: list[str] = [\n    r\"^(?:how|what|why|when|where|who|which|explain|describe|tell me|can you)\\b\",\n    r\"\\bhow\\s+(?:does|do|did|is|are|can|could|should|would|to)\\b\",\n    r\"\\bwhat\\s+(?:is|are|does|do|did|should|would|happened)\\b\",\n    r\"\\bwhy\\s+(?:is|are|does|do|did|should|would)\\b\",\n    r\"\\bexplain\\b\", r\"\\bdescribe\\b\", r\"\\bsummar\",\n    r\"\\bunderstand\\b\", r\"\\bmeaning\\b\",\n    r\"\\bsuggest\\b\", r\"\\brecommend\\b\", r\"\\bideas?\\b\",\n    r\"\\bcompare\\b\", r\"\\bdifference\\b\", r\"\\bbetter\\b\",\n    r\"\\bhelp me understand\\b\",\n    r\"\\bshow me\\b\", r\"\\bwalk me through\\b\",\n    r\"\\btell me about\\b\",\n    r\"\\bwhat (?:technologies|tech|stack|frameworks?)\\b\",\n    r\"^is\\s+(?:there|it|this)\\b\",\n    r\"\\?$\",  # Ends with question mark\n]\n\n_GIT_PATTERNS: list[str] = [\n    r\"\\bgit\\b\", r\"\\bcommit\\b\", r\"\\bpush\\b\", r\"\\bpull\\b\",\n    r\"\\bmerge\\b\", r\"\\bbranch\\b\", r\"\\bclone\\b\",\n    r\"\\bgithub\\b\", r\"\\brepository\\b\", r\"\\brepo\\b\",\n    r\"\\bversion\\s*control\\b\", r\"\\bsave\\s+(?:to|my)\\s+(?:changes|progress|work)\\b\",\n    r\"\\bstage\\b\", r\"\\bunstage\\b\",\n]\n\n_RUN_PATTERNS: list[str] = [\n    r\"^run\\b\", r\"\\brun\\s+(?:the|this|my|it)\\b\",\n    r\"\\bstart\\s+(?:the|this|my)\\b\", r\"\\blaunch\\b\",\n    r\"\\bexecute\\b\", r\"\\btest\\s+(?:the|this|my|it)\\b\",\n    r\"\\bnpm\\s+(?:start|run|test)\\b\",\n    r\"\\bget\\s+(?:the\\s+)?(?:project|app|it)\\s+running\\b\",\n    r\"\\bauto\\s*run\\b\",\n    r\"\\brun\\s+(?:the\\s+)?(?:necessary|required|needed)\\s+commands\\b\",\n    r\"\\binstall\\s+(?:and\\s+)?run\\b\",\n    r\"\\bstart\\s+(?:the\\s+)?(?:project|app|server|application)\\b\",\n    r\"\\bpython\\b.*\\brun\\b\",\n    r\"\\bdeploy\\b\",\n    r\"\\bhelp\\s+(?:me\\s+)?run\\b\",\n    r\"\\brun\\s+(?:the\\s+)?(?:project|app|server|application|code)\\b\",\n    r\"\\brun\\s+(?:this|it)\\s+(?:project|app|for me)?\\b\",\n    r\"\\bcan\\s+you\\s+run\\b\",\n    r\"\\bplease\\s+run\\b\",\n    r\"\\brun\\s+(?:this|it)\\s+for\\s+me\\b\",\n]\n\n\n# \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n# Main classifier\n# \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n\ndef classify_intent(user_input: str) -> tuple[Intent, str]:\n    \"\"\"\n    Classify user input into an intent.\n\n    Returns:\n        (intent, cleaned_input) \u2014 the intent enum and the input\n        with any command prefix stripped.\n\n    The classifier uses a priority cascade:\n    1. Exact command match (highest confidence)\n    2. Prefix command match\n    3. Keyword pattern match (scored)\n    4. Default: CHAT (lowest confidence \u2014 let the LLM handle it)\n    \"\"\"\n    raw = user_input.strip()\n    if not raw:\n        return Intent.NAVIGATE, \"\"\n\n    lower = raw.lower().strip()\n\n    # 1. Exact match\n    if lower in _EXACT_COMMANDS:\n        return _EXACT_COMMANDS[lower], raw\n\n    # 2. Prefix match\n    for prefix, intent in _PREFIX_COMMANDS:\n        if lower.startswith(prefix):\n            # Strip the command prefix to get the actual content\n            remainder = raw[len(prefix):].strip()\n            return intent, remainder or raw\n\n    # 3. Pattern scoring\n    scores: dict[Intent, float] = {\n        Intent.BUILD: 0,\n        Intent.MODIFY: 0,\n        Intent.CHAT: 0,\n        Intent.GIT: 0,\n        Intent.RUN: 0,\n    }\n\n    for pattern in _BUILD_PATTERNS:\n        if re.search(pattern, lower):\n            scores[Intent.BUILD] += 1.5  # BUILD gets a boost \u2014 building is the primary action\n\n    for pattern in _MODIFY_PATTERNS:\n        if re.search(pattern, lower):\n            scores[Intent.MODIFY] += 1\n\n    for pattern in _CHAT_PATTERNS:\n        if re.search(pattern, lower):\n            scores[Intent.CHAT] += 1\n\n    for pattern in _GIT_PATTERNS:\n        if re.search(pattern, lower):\n            scores[Intent.GIT] += 1\n\n    for pattern in _RUN_PATTERNS:\n        if re.search(pattern, lower):\n            scores[Intent.RUN] += 1\n\n    # Get the winner\n    max_score = max(scores.values())\n    if max_score > 0:\n        # Find winning intent\n        winner = max(scores, key=scores.get)\n\n        # BUILD always wins over CHAT \u2014 \"build me an app\" is a build, not a chat\n        if scores[Intent.BUILD] > 0 and winner == Intent.CHAT:\n            return Intent.BUILD, raw\n\n        # If modify and chat are tied or close, check context clues\n        if scores[Intent.MODIFY] > 0 and scores[Intent.CHAT] > 0:\n            # If there's a question mark, lean chat\n            if raw.endswith(\"?\"):\n                return Intent.CHAT, raw\n            # If there are action verbs, lean modify\n            if re.search(r\"\\b(?:fix|add|change|update|remove|create|implement|refactor)\\b\", lower):\n                return Intent.MODIFY, raw\n            # Default to highest score\n            return winner, raw\n\n        return winner, raw\n\n    # 4. Default: CHAT (let the LLM figure it out)\n    return Intent.CHAT, raw\n\n\ndef intent_label(intent: Intent) -> str:\n    \"\"\"Human-readable label for display.\"\"\"\n    labels = {\n        Intent.BUILD:    \"\ud83d\udd28 Build\",\n        Intent.MODIFY:   \"\u26a1 Modify\",\n        Intent.CHAT:     \"\ud83d\udcac Chat\",\n        Intent.GIT:      \"\ud83d\udce6 Git\",\n        Intent.RUN:      \"\u25b6\ufe0f  Run\",\n        Intent.NAVIGATE: \"\ud83d\udcc2 Navigate\",\n        Intent.MODE:     \"\ud83d\udd04 Mode\",\n        Intent.QUIT:     \"\ud83d\udc4b Quit\",\n    }\n    return labels.get(intent, str(intent))\n",
      "jcode/iteration.py": "\"\"\"\nIteration engine v5.0 \u2014 Parallel DAG-based task execution.\n\nArchitecture:\n  1. Compute execution waves from the task DAG\n  2. For each wave, run ALL tasks in parallel via WorkerPool\n  3. Each task pipeline: GENERATE \u2192 REVIEW \u2192 VERIFY \u2192 FIX\n  4. Within a wave, generate all in parallel, review all in parallel\n  5. Fix only failures (sequentially per task, with escalation)\n\nPipeline per wave:\n  Phase A: Generate all files in the wave concurrently\n  Phase B: Review all generated files concurrently\n  Phase C: Verify all files (static analysis)\n  Phase D: Fix only failures (multi-strategy, sequential)\n\nWorker Pool:\n  - Max 6 concurrent workers\n  - CPU-aware adaptive concurrency\n  - Thread-safe model calls via silent mode\n\"\"\"\n\nfrom __future__ import annotations\n\nimport time\nfrom datetime import datetime\nfrom pathlib import Path\n\nfrom rich.console import Console\nfrom rich.panel import Panel\nfrom rich.table import Table\nfrom rich.prompt import Prompt\n\nfrom jcode.config import MAX_ITERATIONS, MAX_TASK_FAILURES, TaskStatus, get_model_for_role\nfrom jcode.context import ContextManager\nfrom jcode.coder import generate_file, patch_file\nfrom jcode.reviewer import review_file\nfrom jcode.analyzer import analyze_error\nfrom jcode.planner import refine_plan\nfrom jcode.file_manager import ensure_project_dir, write_file, print_tree\nfrom jcode.executor import verify_file, install_dependencies, shell_exec, run_tests\nfrom jcode.worker_pool import WorkerPool\nfrom jcode.task_graph import compute_waves, get_ready_wave, get_dag_stats\n\nconsole = Console()\n\n\ndef _log(tag: str, message: str) -> None:\n    \"\"\"Timestamped log line matching cli.py format.\"\"\"\n    ts = datetime.now().strftime(\"%H:%M:%S\")\n    console.print(f\"  [dim]{ts}[/dim]  [cyan]{tag:<10}[/cyan]  {message}\")\n\n\ndef execute_plan(ctx: ContextManager, output_dir: Path) -> bool:\n    \"\"\"\n    Execute the full plan using parallel wave-based DAG processing.\n\n    Strategy:\n      1. Compute waves (topological layers of the DAG)\n      2. For each wave:\n         a. Generate ALL files in parallel\n         b. Review (only for medium+ complexity)\n         c. Verify ALL files\n         d. Fix only failures (sequentially)\n\n    Simple projects skip review entirely for speed.\n    \"\"\"\n    ctx.state.output_dir = output_dir\n    ensure_project_dir(output_dir)\n\n    plan = ctx.state.plan\n    if not plan:\n        _log(\"ERROR\", \"No plan to execute\")\n        return False\n\n    dag = ctx.get_task_dag()\n    if not dag:\n        _log(\"ERROR\", \"Plan has no tasks\")\n        return False\n\n    # Show model tiering info\n    complexity = ctx.get_complexity()\n    size = ctx.get_size()\n    skip_review = complexity == \"simple\"\n\n    _log(\"ENGINE\", f\"Classification: [bold]{complexity}/{size}[/bold]\")\n    _log(\"ENGINE\", f\"Coder model:    {get_model_for_role('coder', complexity, size)}\")\n    if not skip_review:\n        _log(\"ENGINE\", f\"Reviewer model: {get_model_for_role('reviewer', complexity, size)}\")\n\n    # Compute waves for display\n    try:\n        all_waves = compute_waves(dag)\n        _log(\"ENGINE\", f\"{len(dag)} task(s) in {len(all_waves)} wave(s) \u2014 parallel execution enabled\")\n        for i, wave in enumerate(all_waves):\n            files = \", \".join(t.file for t in wave)\n            _log(\"WAVE\", f\"  {i}: [{len(wave)} task(s)] {files}\")\n    except ValueError as e:\n        _log(\"WARNING\", f\"DAG issue: {e} \u2014 falling back to sequential\")\n        all_waves = [[t] for t in dag]\n\n    if skip_review:\n        _log(\"ENGINE\", \"Pipeline: Generate \u2016 \u2192 Verify \u2192 Fix (review skipped for simple)\")\n    else:\n        _log(\"ENGINE\", \"Pipeline: Generate \u2016 \u2192 Review \u2016 \u2192 Verify \u2192 Fix failures\")\n\n    # -- Install deps before building\n    install_dependencies(output_dir, ctx.state.tech_stack)\n\n    # -- Index existing project files into vector memory (for RAG)\n    ctx.index_memory()\n\n    # -- Create worker pool\n    pool = WorkerPool()\n    start_time = time.monotonic()\n\n    try:\n        # -- Wave execution loop\n        global_iteration = 0\n\n        while not ctx.all_tasks_terminal() and global_iteration < MAX_ITERATIONS:\n            global_iteration += 1\n            ready = get_ready_wave(dag)\n\n            if not ready:\n                pending = [t for t in dag if not t.is_terminal]\n                if pending:\n                    _log(\"DEADLOCK\", \"No tasks ready -- possible dependency issue\")\n                    for t in pending:\n                        t.status = TaskStatus.SKIPPED\n                        _log(\"SKIP\", f\"Task {t.id}: {t.file}\")\n                break\n\n            wave_num = global_iteration\n            _log(\"WAVE\", f\"\u2500\u2500 Wave {wave_num}: {len(ready)} task(s) \u2500\u2500\")\n\n            # Phase A: Generate all files in parallel\n            _log(\"PHASE A\", f\"Generating {len(ready)} file(s) in parallel\")\n            _parallel_generate(ready, ctx, output_dir, pool)\n\n            # Phase B: Review (skip for simple projects \u2014 just verify)\n            if not skip_review:\n                generated = [t for t in ready if t.status == TaskStatus.GENERATED]\n                if generated:\n                    _log(\"PHASE B\", f\"Reviewing {len(generated)} file(s) in parallel\")\n                    _parallel_review(generated, ctx, output_dir, pool)\n\n            # Phase C: Verify all files\n            _log(\"PHASE C\", \"Verifying files (static analysis)\")\n            _parallel_verify(ready, ctx, output_dir)\n\n            # Phase D: Fix only failures (sequential per task)\n            needs_fix = [t for t in ready if t.status == TaskStatus.NEEDS_FIX]\n            if needs_fix:\n                _log(\"PHASE D\", f\"Fixing {len(needs_fix)} failed file(s)\")\n                for task_node in needs_fix:\n                    file_path = output_dir / task_node.file\n                    verification = verify_file(file_path, output_dir)\n                    _multi_strategy_fix(task_node, ctx, output_dir, verification)\n\n            _show_task_progress(ctx)\n            _auto_save_session(ctx, output_dir)\n\n            # Re-index vector memory with newly generated files\n            ctx.index_memory()\n\n    finally:\n        pool.shutdown(wait=True)\n\n    elapsed = time.monotonic() - start_time\n\n    # -- Post-build: install deps again (new files may have added some)\n    install_dependencies(output_dir, ctx.state.tech_stack)\n\n    # -- Run tests if they exist\n    _log(\"TEST\", \"Checking for test suite...\")\n    test_result = run_tests(output_dir, ctx.state.tech_stack)\n    if test_result.command != \"(no tests)\":\n        if test_result.success:\n            _log(\"TEST\", \"[cyan]All tests passed[/cyan]\")\n        else:\n            _log(\"TEST\", f\"Tests failed: {test_result.error_summary[:200]}\")\n    else:\n        _log(\"TEST\", \"No test runner detected -- skipping\")\n\n    # -- Final summary\n    console.print()\n    print_tree(output_dir, plan.get(\"project_name\", \"project\"))\n\n    verified = sum(1 for t in dag if t.status == TaskStatus.VERIFIED)\n    failed = sum(1 for t in dag if t.status == TaskStatus.FAILED)\n    skipped = sum(1 for t in dag if t.status == TaskStatus.SKIPPED)\n\n    ctx.state.completed = (failed == 0 and skipped == 0)\n\n    console.print()\n    _log(\"RESULT\", f\"Verified: {verified}  |  Failed: {failed}  |  Skipped: {skipped}\")\n    _log(\"RESULT\", f\"Total time: {elapsed:.1f}s  |  Iterations: {global_iteration}\")\n\n    _auto_save_session(ctx, output_dir)\n    return ctx.state.completed\n\n\n# =====================================================================\n# Parallel Phase A: Generate all files in a wave concurrently\n# =====================================================================\n\ndef _parallel_generate(\n    wave: list,\n    ctx: ContextManager,\n    output_dir: Path,\n    pool: WorkerPool,\n) -> None:\n    \"\"\"Generate all files in the wave concurrently via WorkerPool.\"\"\"\n\n    def _gen_worker(task_node) -> str:\n        \"\"\"Worker function for a single file generation.\"\"\"\n        task_dict = {\n            \"id\": task_node.id,\n            \"file\": task_node.file,\n            \"description\": task_node.description,\n            \"depends_on\": task_node.depends_on,\n        }\n        task_node.status = TaskStatus.IN_PROGRESS\n        content = generate_file(task_dict, ctx, parallel=True)\n        write_file(output_dir, task_node.file, content)\n        task_node.status = TaskStatus.GENERATED\n        return content\n\n    if len(wave) == 1:\n        # Single task \u2014 use streaming for better UX\n        task_node = wave[0]\n        task_dict = {\n            \"id\": task_node.id,\n            \"file\": task_node.file,\n            \"description\": task_node.description,\n            \"depends_on\": task_node.depends_on,\n        }\n        task_node.status = TaskStatus.IN_PROGRESS\n        _log(\"GENERATE\", task_node.file)\n        content = generate_file(task_dict, ctx, parallel=False)\n        write_file(output_dir, task_node.file, content)\n        task_node.status = TaskStatus.GENERATED\n        return\n\n    # Multiple tasks \u2014 parallel silent generation\n    futures = []\n    for node in wave:\n        _log(\"GENERATE\", f\"\u26a1 {node.file}\")\n        future = pool.submit(_gen_worker, node, task_id=node.id)\n        futures.append(future)\n\n    results = pool.collect(futures)\n    for r in results:\n        if not r.success:\n            _log(\"GENERATE\", f\"  \u26a0 Task {r.task_id} failed: {r.error[:100]}\")\n        else:\n            _log(\"GENERATE\", f\"  \u2713 Task {r.task_id} done ({r.duration_ms}ms)\")\n\n\n# =====================================================================\n# Parallel Phase B: Review all generated files concurrently\n# =====================================================================\n\ndef _parallel_review(\n    wave: list,\n    ctx: ContextManager,\n    output_dir: Path,\n    pool: WorkerPool,\n) -> None:\n    \"\"\"Review all generated files in the wave concurrently.\"\"\"\n\n    def _review_worker(task_node) -> dict:\n        \"\"\"Worker function for reviewing a single file.\"\"\"\n        task_node.status = TaskStatus.REVIEWING\n        review = review_file(task_node.file, ctx, parallel=True)\n\n        if review.get(\"approved\", True):\n            return review\n\n        issues = review.get(\"issues\", [])\n        critical_issues = [\n            i for i in issues\n            if i.get(\"severity\") in (\"critical\", \"warning\")\n        ]\n        if not critical_issues:\n            return review\n\n        # Apply a patch for critical issues\n        feedback = \"\\n\".join(\n            f\"- [{i['severity']}] {i['description']}\" for i in critical_issues\n        )\n        task_node.review_feedback = feedback\n        task_node.status = TaskStatus.NEEDS_FIX\n\n        content = patch_file(\n            task_node.file,\n            error=\"Reviewer found issues before execution\",\n            review_feedback=feedback,\n            ctx=ctx,\n            parallel=True,\n        )\n        write_file(output_dir, task_node.file, content)\n        task_node.status = TaskStatus.GENERATED\n        return review\n\n    if len(wave) == 1:\n        # Single file \u2014 use sequential review\n        task_node = wave[0]\n        _review_and_patch(task_node, ctx, output_dir)\n        return\n\n    # Multiple files \u2014 parallel review\n    futures = []\n    for node in wave:\n        _log(\"REVIEW\", f\"\u26a1 {node.file}\")\n        future = pool.submit(_review_worker, node, task_id=node.id)\n        futures.append(future)\n\n    results = pool.collect(futures)\n    for r in results:\n        if not r.success:\n            _log(\"REVIEW\", f\"  \u26a0 Task {r.task_id} error: {r.error[:100]}\")\n        else:\n            _log(\"REVIEW\", f\"  \u2713 Task {r.task_id} reviewed ({r.duration_ms}ms)\")\n\n\n# =====================================================================\n# Phase C: Verify all files (fast \u2014 runs locally, no model calls)\n# =====================================================================\n\ndef _parallel_verify(\n    wave: list,\n    ctx: ContextManager,\n    output_dir: Path,\n) -> None:\n    \"\"\"Verify all files in the wave. Sets status to VERIFIED or NEEDS_FIX.\"\"\"\n    for task_node in wave:\n        if task_node.is_terminal:\n            continue\n        file_path = output_dir / task_node.file\n        _log(\"VERIFY\", task_node.file)\n        verification = verify_file(file_path, output_dir)\n\n        if verification.passed:\n            task_node.status = TaskStatus.VERIFIED\n            _log(\"VERIFY\", \"  [cyan]passed[/cyan]\")\n        else:\n            task_node.status = TaskStatus.NEEDS_FIX\n            _log(\"VERIFY\", f\"  failed: {verification.summary[:120]}\")\n\n\n# =====================================================================\n# Sequential review (for single-file waves)\n# =====================================================================\n\ndef _review_and_patch(task_node, ctx: ContextManager, output_dir: Path) -> None:\n    \"\"\"Review the file, patch if needed, then re-review once to confirm.\"\"\"\n    max_review_rounds = 2\n\n    for review_round in range(max_review_rounds):\n        round_label = f\"(round {review_round + 1})\" if review_round > 0 else \"\"\n        _log(\"REVIEW\", f\"{task_node.file} {round_label}\")\n        task_node.status = TaskStatus.REVIEWING\n        review = review_file(task_node.file, ctx)\n\n        if review.get(\"approved\", True):\n            _log(\"REVIEW\", \"  Approved\")\n            return\n\n        issues = review.get(\"issues\", [])\n        critical_issues = [\n            i for i in issues\n            if i.get(\"severity\") in (\"critical\", \"warning\")\n        ]\n\n        if not critical_issues:\n            _log(\"REVIEW\", \"  Approved (suggestions only)\")\n            return\n\n        feedback = \"\\n\".join(\n            f\"- [{i['severity']}] {i['description']}\" for i in critical_issues\n        )\n        task_node.review_feedback = feedback\n        task_node.status = TaskStatus.NEEDS_FIX\n        _log(\"REVIEW\", f\"  {len(critical_issues)} issue(s) found -- patching\")\n\n        content = patch_file(\n            task_node.file,\n            error=\"Reviewer found issues before execution\",\n            review_feedback=feedback,\n            ctx=ctx,\n        )\n        write_file(output_dir, task_node.file, content)\n        task_node.status = TaskStatus.GENERATED\n\n    _log(\"REVIEW\", \"  Accepted after review patches\")\n\n\n# =====================================================================\n# Multi-strategy fix loop \u2014 the heart of resilience\n# =====================================================================\n\ndef _multi_strategy_fix(\n    task_node,\n    ctx: ContextManager,\n    output_dir: Path,\n    initial_verification,\n) -> None:\n    \"\"\"\n    Try up to MAX_TASK_FAILURES fix strategies, escalating in complexity:\n\n    Attempts 1-3: Targeted patch (cheapest \u2014 just fix what is broken)\n    Attempt 4:    Deep analysis with cross-file context\n    Attempt 5:    Deep analysis + dependency re-check\n    Attempt 6:    Full regeneration from scratch with error history\n    Attempt 7:    Simplified/minimal version\n    Attempt 8:    Research-based fix (analyze error class, apply known pattern)\n\n    Each attempt: Analyze > Fix > Verify\n    \"\"\"\n    verification = initial_verification\n\n    while task_node.failure_count < MAX_TASK_FAILURES:\n        task_node.failure_count += 1\n        attempt = task_node.failure_count\n        task_node.status = TaskStatus.NEEDS_FIX\n        file_path = output_dir / task_node.file\n\n        error_output = verification.summary\n\n        # Choose strategy based on attempt number\n        if attempt <= 3:\n            # -- Strategy A: Targeted patch\n            _log(\"FIX\", f\"  Attempt {attempt}/{MAX_TASK_FAILURES} [dim](targeted patch)[/dim]\")\n            verification = _strategy_targeted_patch(\n                task_node, ctx, output_dir, error_output\n            )\n\n        elif attempt <= 5:\n            # -- Strategy B: Deep analysis with cross-file context\n            _log(\"FIX\", f\"  Attempt {attempt}/{MAX_TASK_FAILURES} [dim](deep analysis)[/dim]\")\n            verification = _strategy_deep_analysis(\n                task_node, ctx, output_dir, error_output\n            )\n\n        elif attempt == 6:\n            # -- Strategy C: Full regeneration from scratch\n            _log(\"FIX\", f\"  Attempt {attempt}/{MAX_TASK_FAILURES} [dim](full regeneration)[/dim]\")\n            verification = _strategy_regenerate(\n                task_node, ctx, output_dir, error_output\n            )\n\n        elif attempt == 7:\n            # -- Strategy D: Simplified/minimal version\n            _log(\"FIX\", f\"  Attempt {attempt}/{MAX_TASK_FAILURES} [dim](simplified build)[/dim]\")\n            verification = _strategy_simplify(\n                task_node, ctx, output_dir, error_output\n            )\n\n        else:\n            # -- Strategy E: Research-based fix (last resort)\n            _log(\"FIX\", f\"  Attempt {attempt}/{MAX_TASK_FAILURES} [dim](research fix)[/dim]\")\n            verification = _strategy_research_fix(\n                task_node, ctx, output_dir, error_output\n            )\n\n        if verification.passed:\n            task_node.status = TaskStatus.VERIFIED\n            _log(\"VERIFY\", f\"  [cyan]passed[/cyan] after {attempt} attempt(s)\")\n            return\n\n        _log(\"VERIFY\", f\"  still failing: {verification.summary[:100]}\")\n\n    # Exhausted ALL fix attempts -- escalate\n    _escalate_failed_task(task_node, ctx, output_dir)\n\n\n# =====================================================================\n# Fix strategies\n# =====================================================================\n\ndef _strategy_targeted_patch(task_node, ctx, output_dir, error_output):\n    \"\"\"Strategy A: Simple analyze > patch > verify.\"\"\"\n    analysis = analyze_error(task_node.file, error_output, ctx)\n    task_node.error_summary = analysis.get(\"root_cause\", error_output)\n\n    ctx.record_failure(\n        file_path=task_node.file,\n        error=task_node.error_summary,\n        fix=analysis.get(\"fix_strategy\", \"\"),\n        iteration=ctx.state.iteration,\n    )\n    ctx.bump_iteration()\n\n    _log(\"PATCH\", task_node.file)\n    content = patch_file(\n        task_node.file,\n        error=task_node.error_summary,\n        review_feedback=analysis.get(\"fix_strategy\", \"\"),\n        ctx=ctx,\n    )\n    write_file(output_dir, task_node.file, content)\n\n    file_path = output_dir / task_node.file\n    _log(\"VERIFY\", task_node.file)\n    return verify_file(file_path, output_dir)\n\n\ndef _strategy_deep_analysis(task_node, ctx, output_dir, error_output):\n    \"\"\"\n    Strategy B: Deep analysis with cross-file dependency context.\n    Feeds the analyzer not just the broken file, but also its dependencies.\n    \"\"\"\n    # Gather dependency file contents for richer analysis\n    dep_files = ctx.state.dependency_graph.get(task_node.file, [])\n    cross_file_context = \"\"\n    for dep_path in dep_files[:5]:\n        dep_content = ctx.state.files.get(dep_path, \"\")\n        if dep_content:\n            cross_file_context += f\"\\n\\n--- {dep_path} ---\\n{dep_content[:3000]}\"\n\n    # Also look at files that import this file (reverse deps)\n    importers = []\n    for fpath, deps in ctx.state.dependency_graph.items():\n        if task_node.file in deps:\n            importers.append(fpath)\n    for imp_path in importers[:3]:\n        imp_content = ctx.state.files.get(imp_path, \"\")\n        if imp_content:\n            cross_file_context += f\"\\n\\n--- {imp_path} (imports this file) ---\\n{imp_content[:2000]}\"\n\n    # Build enriched error context\n    all_failures = ctx.get_failure_log_str(task_node.file)\n    enriched_error = (\n        f\"ERROR: {error_output}\\n\\n\"\n        f\"PREVIOUS FIX ATTEMPTS:\\n{all_failures}\\n\\n\"\n        f\"CROSS-FILE CONTEXT:\\n{cross_file_context}\\n\\n\"\n        f\"NOTE: Previous targeted patches failed. Think deeper about the root cause. \"\n        f\"The issue may be in how this file interacts with its dependencies.\"\n    )\n\n    analysis = analyze_error(task_node.file, enriched_error, ctx)\n    task_node.error_summary = analysis.get(\"root_cause\", error_output)\n\n    # Check if the analyzer says it is a dependency issue\n    if analysis.get(\"is_dependency_issue\"):\n        affected = analysis.get(\"affected_file\", \"\")\n        if affected and affected != task_node.file and affected in ctx.state.files:\n            _log(\"FIX\", f\"  Dependency issue detected -- also patching {affected}\")\n            dep_content = patch_file(\n                affected,\n                error=f\"Downstream file {task_node.file} fails because of this file: {task_node.error_summary}\",\n                review_feedback=analysis.get(\"fix_strategy\", \"\"),\n                ctx=ctx,\n            )\n            write_file(output_dir, affected, dep_content)\n\n    ctx.record_failure(\n        file_path=task_node.file,\n        error=task_node.error_summary,\n        fix=f\"[deep] {analysis.get('fix_strategy', '')}\",\n        iteration=ctx.state.iteration,\n    )\n    ctx.bump_iteration()\n\n    _log(\"PATCH\", f\"{task_node.file} (deep)\")\n    content = patch_file(\n        task_node.file,\n        error=task_node.error_summary,\n        review_feedback=(\n            f\"DEEP ANALYSIS:\\n{analysis.get('fix_strategy', '')}\\n\\n\"\n            f\"Cross-file context was considered. \"\n            f\"All previous fix attempts failed, so try a fundamentally different approach.\"\n        ),\n        ctx=ctx,\n    )\n    write_file(output_dir, task_node.file, content)\n\n    file_path = output_dir / task_node.file\n    _log(\"VERIFY\", task_node.file)\n\n    # Re-install deps in case the fix added new requirements\n    install_dependencies(output_dir, ctx.state.tech_stack)\n\n    return verify_file(file_path, output_dir)\n\n\ndef _strategy_regenerate(task_node, ctx, output_dir, error_output):\n    \"\"\"\n    Strategy C: Throw away the file and regenerate from scratch,\n    but with full knowledge of what went wrong.\n    \"\"\"\n    _log(\"REGEN\", f\"Task {task_node.id}: fresh generation with error history\")\n\n    all_failures = ctx.get_failure_log_str(task_node.file)\n\n    # Build an enriched task description\n    enriched_task = {\n        \"id\": task_node.id,\n        \"file\": task_node.file,\n        \"description\": (\n            f\"{task_node.description}\\n\\n\"\n            f\"CRITICAL: This file has been generated before but failed verification \"\n            f\"after {task_node.failure_count} attempts.\\n\\n\"\n            f\"Previous errors:\\n{all_failures}\\n\\n\"\n            f\"Last error: {error_output[:500]}\\n\\n\"\n            f\"Requirements:\\n\"\n            f\"1. Write clean, correct code that will pass syntax checks and linting.\\n\"\n            f\"2. Include ALL necessary imports.\\n\"\n            f\"3. Make sure all function signatures match what other files expect.\\n\"\n            f\"4. DO NOT repeat the same mistakes.\\n\"\n            f\"5. If unsure about an API, use the simplest correct approach.\"\n        ),\n        \"depends_on\": task_node.depends_on,\n    }\n\n    content = generate_file(enriched_task, ctx)\n    write_file(output_dir, task_node.file, content)\n\n    ctx.record_failure(\n        file_path=task_node.file,\n        error=error_output,\n        fix=\"[regen] Full regeneration from scratch with error history\",\n        iteration=ctx.state.iteration,\n    )\n    ctx.bump_iteration()\n\n    file_path = output_dir / task_node.file\n    _log(\"VERIFY\", task_node.file)\n    return verify_file(file_path, output_dir)\n\n\ndef _strategy_simplify(task_node, ctx, output_dir, error_output):\n    \"\"\"\n    Strategy D: Generate a minimal, simplified version that\n    definitely compiles. Sacrifice features for correctness.\n    \"\"\"\n    _log(\"SIMPLIFY\", f\"Task {task_node.id}: generating minimal version\")\n\n    simplified_task = {\n        \"id\": task_node.id,\n        \"file\": task_node.file,\n        \"description\": (\n            f\"{task_node.description}\\n\\n\"\n            f\"IMPORTANT: All previous attempts to generate this file failed.\\n\"\n            f\"Last error: {error_output[:300]}\\n\\n\"\n            f\"Generate a MINIMAL, simplified version that DEFINITELY compiles.\\n\"\n            f\"Rules for this attempt:\\n\"\n            f\"1. Use ONLY standard library imports (no third-party packages).\\n\"\n            f\"2. Keep the implementation as simple as possible.\\n\"\n            f\"3. Add TODO comments for any complex parts you are skipping.\\n\"\n            f\"4. Make sure every function has a proper return value.\\n\"\n            f\"5. Use placeholder data instead of complex logic if needed.\\n\"\n            f\"6. Prioritize CORRECTNESS over completeness.\\n\"\n            f\"7. Test-compile the code mentally before outputting it.\"\n        ),\n        \"depends_on\": task_node.depends_on,\n    }\n\n    content = generate_file(simplified_task, ctx)\n    write_file(output_dir, task_node.file, content)\n\n    ctx.record_failure(\n        file_path=task_node.file,\n        error=error_output,\n        fix=\"[simplify] Minimal version with stdlib only\",\n        iteration=ctx.state.iteration,\n    )\n    ctx.bump_iteration()\n\n    file_path = output_dir / task_node.file\n    _log(\"VERIFY\", task_node.file)\n    return verify_file(file_path, output_dir)\n\n\ndef _strategy_research_fix(task_node, ctx, output_dir, error_output):\n    \"\"\"\n    Strategy E (last resort): Analyze the error class/pattern and apply\n    known fix patterns. Feed the coder extremely explicit instructions.\n    \"\"\"\n    _log(\"RESEARCH\", f\"Task {task_node.id}: analyzing error patterns\")\n\n    # Classify the error type\n    error_lower = error_output.lower()\n    fix_hints = []\n\n    if \"import\" in error_lower or \"modulenotfounderror\" in error_lower:\n        fix_hints.append(\"This is an import error. Remove the broken import or replace it with a correct one.\")\n        fix_hints.append(\"Check: is the module name spelled correctly? Is it installed? Is it a relative vs absolute import issue?\")\n    if \"syntax\" in error_lower or \"syntaxerror\" in error_lower:\n        fix_hints.append(\"This is a syntax error. Check for missing colons, brackets, parentheses, or indentation issues.\")\n        fix_hints.append(\"Common causes: unclosed string literals, missing commas in lists/dicts, incorrect indentation.\")\n    if \"indentation\" in error_lower:\n        fix_hints.append(\"Indentation error. Make sure all blocks use consistent indentation (4 spaces, no tabs).\")\n    if \"undefined\" in error_lower or \"undeclared\" in error_lower or \"is not defined\" in error_lower:\n        fix_hints.append(\"A variable or function is used before it is defined. Check imports and declaration order.\")\n    if \"type\" in error_lower and \"error\" in error_lower:\n        fix_hints.append(\"Type error. Check function arguments, return types, and variable assignments.\")\n    if \"attribute\" in error_lower:\n        fix_hints.append(\"AttributeError. The object does not have the property/method you are accessing. Check the API docs.\")\n    if \"key\" in error_lower and \"error\" in error_lower:\n        fix_hints.append(\"KeyError. A dictionary key does not exist. Use .get() with a default value.\")\n    if \"cannot find module\" in error_lower or \"module not found\" in error_lower:\n        fix_hints.append(\"Node.js module not found. Check package.json dependencies and import paths.\")\n    if \"jsx\" in error_lower or \"react\" in error_lower:\n        fix_hints.append(\"React/JSX error. Make sure React is imported and JSX syntax is correct.\")\n    if \"unexpected token\" in error_lower:\n        fix_hints.append(\"JavaScript syntax error. Check for missing semicolons, brackets, or ES module syntax issues.\")\n\n    if not fix_hints:\n        fix_hints.append(\"Analyze the error message carefully and fix the exact issue it describes.\")\n        fix_hints.append(\"If the error is unclear, rewrite the problematic section from scratch using the simplest correct approach.\")\n\n    hint_text = \"\\n\".join(f\"- {h}\" for h in fix_hints)\n\n    all_failures = ctx.get_failure_log_str(task_node.file)\n\n    content = patch_file(\n        task_node.file,\n        error=error_output,\n        review_feedback=(\n            f\"LAST RESORT FIX -- attempt {task_node.failure_count}/{MAX_TASK_FAILURES}\\n\\n\"\n            f\"Error pattern analysis:\\n{hint_text}\\n\\n\"\n            f\"Previous fix attempts (ALL FAILED):\\n{all_failures}\\n\\n\"\n            f\"INSTRUCTIONS:\\n\"\n            f\"1. Read the error message VERY carefully.\\n\"\n            f\"2. Apply the specific fix hints above.\\n\"\n            f\"3. Do NOT repeat any previous fix attempts.\\n\"\n            f\"4. If a section of code keeps breaking, REWRITE IT completely.\\n\"\n            f\"5. Use the simplest possible approach that solves the problem.\\n\"\n            f\"6. Double-check every import statement.\\n\"\n            f\"7. Output the COMPLETE corrected file.\"\n        ),\n        ctx=ctx,\n    )\n    write_file(output_dir, task_node.file, content)\n\n    ctx.record_failure(\n        file_path=task_node.file,\n        error=error_output,\n        fix=f\"[research] Pattern-based fix: {fix_hints[0][:100]}\",\n        iteration=ctx.state.iteration,\n    )\n    ctx.bump_iteration()\n\n    file_path = output_dir / task_node.file\n    _log(\"VERIFY\", task_node.file)\n    return verify_file(file_path, output_dir)\n\n\n# =====================================================================\n# Escalation \u2014 when ALL strategies fail\n# =====================================================================\n\ndef _escalate_failed_task(task_node, ctx: ContextManager, output_dir: Path) -> None:\n    \"\"\"\n    Handle a task that failed ALL fix attempts.\n    At this point, 8 attempts with 5 strategies have been tried.\n    \"\"\"\n    _log(\"ESCALATE\", f\"Task {task_node.id} failed after {MAX_TASK_FAILURES} attempts\")\n    _log(\"ESCALATE\", f\"  Strategies tried: targeted patch, deep analysis, regeneration, simplify, research\")\n    _log(\"ESCALATE\", f\"  Last error: {task_node.error_summary[:150]}\")\n    console.print()\n\n    console.print(\"    [cyan]1[/cyan]  Try again (reset counter, another round of fixes)\")\n    console.print(\"    [cyan]2[/cyan]  Provide guidance (tell the AI exactly what to fix)\")\n    console.print(\"    [cyan]3[/cyan]  Skip this task and continue\")\n    console.print(\"    [cyan]4[/cyan]  Pause -- let me edit the file manually\")\n    console.print()\n\n    choice = Prompt.ask(\"  Choose\", choices=[\"1\", \"2\", \"3\", \"4\"], default=\"2\")\n\n    if choice == \"1\":\n        _escalate_retry(task_node, ctx, output_dir)\n    elif choice == \"2\":\n        _escalate_guided_fix(task_node, ctx, output_dir)\n    elif choice == \"3\":\n        task_node.status = TaskStatus.SKIPPED\n        _log(\"SKIP\", f\"Task {task_node.id}: {task_node.file}\")\n    elif choice == \"4\":\n        _escalate_pause(task_node, ctx, output_dir)\n\n\ndef _escalate_retry(task_node, ctx: ContextManager, output_dir: Path) -> None:\n    \"\"\"Reset failure counter and run the full fix loop again.\"\"\"\n    _log(\"RETRY\", f\"Task {task_node.id}: resetting counter for another round\")\n    task_node.failure_count = 0\n    task_node.status = TaskStatus.NEEDS_FIX\n\n    file_path = output_dir / task_node.file\n    verification = verify_file(file_path, output_dir)\n\n    if verification.passed:\n        task_node.status = TaskStatus.VERIFIED\n        _log(\"VERIFY\", \"  [cyan]passed[/cyan]\")\n        return\n\n    _multi_strategy_fix(task_node, ctx, output_dir, verification)\n\n\ndef _escalate_guided_fix(task_node, ctx: ContextManager, output_dir: Path) -> None:\n    \"\"\"Let the user tell the AI exactly what to fix.\"\"\"\n    console.print()\n    _log(\"GUIDE\", f\"Current error: {task_node.error_summary[:200]}\")\n    console.print()\n    guidance = Prompt.ask(\"  What should the AI fix?\")\n\n    # Apply the user guidance with a focused patch\n    content = patch_file(\n        task_node.file,\n        error=task_node.error_summary,\n        review_feedback=f\"USER GUIDANCE (highest priority): {guidance}\",\n        ctx=ctx,\n    )\n    write_file(output_dir, task_node.file, content)\n\n    file_path = output_dir / task_node.file\n    verification = verify_file(file_path, output_dir)\n\n    if verification.passed:\n        task_node.status = TaskStatus.VERIFIED\n        _log(\"VERIFY\", \"  [cyan]passed[/cyan] with user guidance\")\n    else:\n        _log(\"VERIFY\", f\"  Still failing: {verification.summary[:200]}\")\n        console.print()\n        console.print(\"    [cyan]1[/cyan]  Give more guidance\")\n        console.print(\"    [cyan]2[/cyan]  Skip this task\")\n        console.print(\"    [cyan]3[/cyan]  Pause and edit manually\")\n        console.print()\n        choice = Prompt.ask(\"  Choose\", choices=[\"1\", \"2\", \"3\"], default=\"1\")\n\n        if choice == \"1\":\n            _escalate_guided_fix(task_node, ctx, output_dir)\n        elif choice == \"2\":\n            task_node.status = TaskStatus.SKIPPED\n            _log(\"SKIP\", f\"Task {task_node.id}\")\n        elif choice == \"3\":\n            _escalate_pause(task_node, ctx, output_dir)\n\n\ndef _escalate_pause(task_node, ctx: ContextManager, output_dir: Path) -> None:\n    \"\"\"Pause and let the user inspect/edit the file.\"\"\"\n    file_path = output_dir / task_node.file\n\n    console.print()\n    _log(\"PAUSED\", f\"Task {task_node.id}: {task_node.file}\")\n    _log(\"PAUSED\", f\"  Error: {task_node.error_summary[:300]}\")\n    _log(\"PAUSED\", f\"  File:  {file_path}\")\n    console.print()\n    console.print(\"  [dim]Edit the file in your editor, then choose:[/dim]\")\n    console.print()\n\n    console.print(\"    [cyan]1[/cyan]  Re-verify (after manual edit)\")\n    console.print(\"    [cyan]2[/cyan]  Skip this task\")\n    console.print()\n\n    choice = Prompt.ask(\"  Choose\", choices=[\"1\", \"2\"], default=\"1\")\n\n    if choice == \"1\":\n        # Re-read the file from disk (user may have edited it)\n        try:\n            content = file_path.read_text()\n            ctx.record_file(task_node.file, content)\n        except Exception:\n            pass\n\n        verification = verify_file(file_path, output_dir)\n        if verification.passed:\n            task_node.status = TaskStatus.VERIFIED\n            _log(\"VERIFY\", \"  [cyan]passed[/cyan] after manual edit\")\n        else:\n            _log(\"VERIFY\", f\"  Still failing: {verification.summary[:200]}\")\n            task_node.status = TaskStatus.FAILED\n    elif choice == \"2\":\n        task_node.status = TaskStatus.SKIPPED\n        _log(\"SKIP\", f\"Task {task_node.id}\")\n\n\n# =====================================================================\n# Progress display\n# =====================================================================\n\ndef _show_task_progress(ctx: ContextManager) -> None:\n    \"\"\"Show a compact task status table.\"\"\"\n    dag = ctx.get_task_dag()\n    console.print()\n    for t in dag:\n        status_label = {\n            TaskStatus.PENDING:     \"[dim]pending[/dim]\",\n            TaskStatus.IN_PROGRESS: \"[white]working[/white]\",\n            TaskStatus.GENERATED:   \"[white]generated[/white]\",\n            TaskStatus.REVIEWING:   \"[white]reviewing[/white]\",\n            TaskStatus.NEEDS_FIX:   \"[white]fixing[/white]\",\n            TaskStatus.VERIFIED:    \"[cyan]verified[/cyan]\",\n            TaskStatus.FAILED:      \"[red]failed[/red]\",\n            TaskStatus.SKIPPED:     \"[dim]skipped[/dim]\",\n        }.get(t.status, \"[dim]?[/dim]\")\n        fails = f\" [dim]({t.failure_count} fixes)[/dim]\" if t.failure_count > 0 else \"\"\n        console.print(f\"  {status_label:>30}  {t.id}. {t.file}{fails}\")\n    console.print()\n\n\ndef _auto_save_session(ctx: ContextManager, output_dir: Path) -> None:\n    \"\"\"Auto-save session to project directory.\"\"\"\n    try:\n        session_file = output_dir / \".jcode_session.json\"\n        ctx.save_session(session_file)\n    except Exception:\n        pass\n",
      "jcode/memory.py": "\"\"\"\nProject memory engine \u2014 vector-based retrieval-augmented generation (RAG).\n\nThis is what lets smaller models compete with frontier models.\nInstead of dumping the entire codebase into context, we:\n  1. Embed every file using all-minilm (or similar embedding model)\n  2. Store embeddings in-memory (per project session)\n  3. At generation time, retrieve ONLY the most relevant context\n  4. Optional: summarize project state using a lightweight model\n\nThis module is OPTIONAL \u2014 if no embedding model is installed,\nJCode falls back to the existing sliced-context approach in context.py.\n\nv0.9.1 \u2014 Initial implementation.\n\"\"\"\n\nfrom __future__ import annotations\n\nimport json\nimport threading\nfrom pathlib import Path\nfrom dataclasses import dataclass, field\n\nfrom rich.console import Console\n\nconsole = Console()\n\n# Thread lock for embedding operations\n_embed_lock = threading.Lock()\n\n\n@dataclass\nclass FileEmbedding:\n    \"\"\"A file with its embedding vector and metadata.\"\"\"\n    path: str                    # relative file path\n    content_hash: str            # hash of content (detect changes)\n    summary: str                 # one-line summary of file purpose\n    embedding: list[float] = field(default_factory=list)\n\n\nclass ProjectMemory:\n    \"\"\"\n    In-memory vector store for project files.\n\n    Backed by Ollama embedding models (all-minilm, nomic-embed-text).\n    Falls back gracefully if no embedding model is available.\n\n    Usage:\n        memory = ProjectMemory()\n        memory.index_files(ctx.state.files, ctx.state.file_index)\n        relevant = memory.retrieve(\"implement user authentication\", top_k=5)\n    \"\"\"\n\n    def __init__(self) -> None:\n        self._embeddings: dict[str, FileEmbedding] = {}\n        self._model: str | None = None\n        self._available: bool | None = None  # tri-state: None=unknown\n\n    @property\n    def is_available(self) -> bool:\n        \"\"\"Check if embedding is available (lazy init).\"\"\"\n        if self._available is not None:\n            return self._available\n\n        from jcode.config import get_embedding_model\n        model = get_embedding_model()\n        if model:\n            self._model = model\n            self._available = True\n            console.print(f\"  [dim]Memory: embedding via {model}[/dim]\")\n        else:\n            self._available = False\n        return self._available\n\n    def _embed(self, text: str) -> list[float]:\n        \"\"\"Generate embedding vector for text using Ollama.\"\"\"\n        if not self._model:\n            return []\n        try:\n            import ollama\n            response = ollama.embed(model=self._model, input=text)\n            # Handle different response formats\n            if isinstance(response, dict):\n                embeddings = response.get(\"embeddings\", [])\n                if embeddings:\n                    return embeddings[0]\n                return response.get(\"embedding\", [])\n            return []\n        except Exception as e:\n            console.print(f\"  [dim]Embedding error: {e}[/dim]\")\n            return []\n\n    def _content_hash(self, content: str) -> str:\n        \"\"\"Fast hash for change detection.\"\"\"\n        import hashlib\n        return hashlib.md5(content.encode()[:4096]).hexdigest()\n\n    def index_files(\n        self,\n        files: dict[str, str],\n        file_index: dict[str, str] | None = None,\n    ) -> int:\n        \"\"\"Index all project files into the vector store.\n\n        Args:\n            files: dict of {relative_path: file_content}\n            file_index: dict of {relative_path: description} from planner\n\n        Returns:\n            Number of files indexed.\n        \"\"\"\n        if not self.is_available:\n            return 0\n\n        indexed = 0\n        file_index = file_index or {}\n\n        with _embed_lock:\n            for path, content in files.items():\n                if not content or not content.strip():\n                    continue\n\n                content_hash = self._content_hash(content)\n\n                # Skip if already indexed with same content\n                existing = self._embeddings.get(path)\n                if existing and existing.content_hash == content_hash:\n                    continue\n\n                # Build embedding text: summary + first 1000 chars of content\n                summary = file_index.get(path, \"\")\n                embed_text = f\"File: {path}\\nPurpose: {summary}\\n\\n{content[:1500]}\"\n\n                embedding = self._embed(embed_text)\n                if embedding:\n                    self._embeddings[path] = FileEmbedding(\n                        path=path,\n                        content_hash=content_hash,\n                        summary=summary,\n                        embedding=embedding,\n                    )\n                    indexed += 1\n\n        return indexed\n\n    def retrieve(\n        self,\n        query: str,\n        top_k: int = 5,\n        exclude: list[str] | None = None,\n    ) -> list[str]:\n        \"\"\"Retrieve the most relevant file paths for a query.\n\n        Args:\n            query: The task description or search query.\n            top_k: Number of results to return.\n            exclude: File paths to exclude from results.\n\n        Returns:\n            List of file paths, ordered by relevance (most relevant first).\n        \"\"\"\n        if not self.is_available or not self._embeddings:\n            return []\n\n        exclude = set(exclude or [])\n        query_embedding = self._embed(query)\n        if not query_embedding:\n            return []\n\n        # Compute cosine similarity\n        scored: list[tuple[float, str]] = []\n        for path, fe in self._embeddings.items():\n            if path in exclude or not fe.embedding:\n                continue\n            sim = self._cosine_similarity(query_embedding, fe.embedding)\n            scored.append((sim, path))\n\n        # Sort by similarity (descending)\n        scored.sort(key=lambda x: x[0], reverse=True)\n        return [path for _, path in scored[:top_k]]\n\n    def get_relevant_context(\n        self,\n        query: str,\n        files: dict[str, str],\n        top_k: int = 5,\n        max_chars: int = 8000,\n    ) -> str:\n        \"\"\"Retrieve and format the most relevant file contents for a query.\n\n        This is the main entry point for RAG-enhanced generation.\n        Returns formatted file contents ready for prompt injection.\n        \"\"\"\n        relevant_paths = self.retrieve(query, top_k=top_k)\n        if not relevant_paths:\n            return \"\"\n\n        parts: list[str] = []\n        total_chars = 0\n        for path in relevant_paths:\n            content = files.get(path, \"\")\n            if not content:\n                continue\n            # Trim to fit budget\n            remaining = max_chars - total_chars\n            if remaining <= 0:\n                break\n            trimmed = content[:remaining]\n            parts.append(f\"### {path}\\n```\\n{trimmed}\\n```\")\n            total_chars += len(trimmed)\n\n        return \"\\n\\n\".join(parts) if parts else \"\"\n\n    @staticmethod\n    def _cosine_similarity(a: list[float], b: list[float]) -> float:\n        \"\"\"Compute cosine similarity between two vectors.\"\"\"\n        if len(a) != len(b) or not a:\n            return 0.0\n        dot = sum(x * y for x, y in zip(a, b))\n        norm_a = sum(x * x for x in a) ** 0.5\n        norm_b = sum(x * x for x in b) ** 0.5\n        if norm_a == 0 or norm_b == 0:\n            return 0.0\n        return dot / (norm_a * norm_b)\n\n    def clear(self) -> None:\n        \"\"\"Clear all embeddings.\"\"\"\n        with _embed_lock:\n            self._embeddings.clear()\n\n    @property\n    def size(self) -> int:\n        \"\"\"Number of indexed files.\"\"\"\n        return len(self._embeddings)\n\n    def to_dict(self) -> dict:\n        \"\"\"Serialize for session save.\"\"\"\n        return {\n            \"model\": self._model,\n            \"embeddings\": {\n                path: {\n                    \"path\": fe.path,\n                    \"content_hash\": fe.content_hash,\n                    \"summary\": fe.summary,\n                    \"embedding\": fe.embedding,\n                }\n                for path, fe in self._embeddings.items()\n            },\n        }\n\n    @classmethod\n    def from_dict(cls, data: dict) -> \"ProjectMemory\":\n        \"\"\"Restore from session data.\"\"\"\n        mem = cls()\n        mem._model = data.get(\"model\")\n        mem._available = bool(mem._model)\n        for path, fe_data in data.get(\"embeddings\", {}).items():\n            mem._embeddings[path] = FileEmbedding(\n                path=fe_data[\"path\"],\n                content_hash=fe_data[\"content_hash\"],\n                summary=fe_data.get(\"summary\", \"\"),\n                embedding=fe_data.get(\"embedding\", []),\n            )\n        return mem\n",
      "jcode/ollama_client.py": "\"\"\"\nOllama client wrapper \u2014 talks to the local Ollama server.\n\nv4.0 \u2014 Multi-model intelligent routing.\n\nKey rules:\n  1. Only use locally installed models \u2014 NEVER pull.\n  2. Route each role to the best available model via config.get_model_for_role().\n  3. Handle reasoning models (deepseek-r1, qwen3 /think) \u2014 filter <think> blocks.\n  4. Handle Ollama being busy (concurrent instances) with retry logic.\n  5. Thread-safe parallel generation for wave-based execution.\n  6. Model-aware options (reasoning models get higher ctx, different temps).\n\"\"\"\n\nfrom __future__ import annotations\n\nimport re\nimport threading\n\nimport ollama\nfrom rich.console import Console\n\nfrom jcode.config import (\n    PLANNER_MODEL, CODER_MODEL, REVIEWER_MODEL, ANALYZER_MODEL,\n    PLANNER_OPTIONS, CODER_OPTIONS, REVIEWER_OPTIONS, ANALYZER_OPTIONS,\n    REASONING_OPTIONS, AGENTIC_OPTIONS,\n    get_model_for_role, get_all_required_models, _is_model_local,\n    get_model_spec,\n)\n\nconsole = Console()\n\n# Cache of models we've already verified exist (thread-safe)\n_verified_models: set[str] = set()\n_verified_lock = threading.Lock()\n\n# Lock for streaming output (only one stream at a time to console)\n_stream_lock = threading.Lock()\n\n\ndef _ensure_model(model: str) -> None:\n    \"\"\"Check that the model is available. NEVER pulls \u2014 warns and falls back.\"\"\"\n    with _verified_lock:\n        if model in _verified_models:\n            return\n\n    try:\n        ollama.show(model)\n        with _verified_lock:\n            _verified_models.add(model)\n        return\n    except ollama.ResponseError:\n        pass\n\n    console.print(f\"[yellow]\u26a0 Model {model} not installed. Using fallback.[/yellow]\")\n    with _verified_lock:\n        _verified_models.add(model)\n\n\ndef _is_reasoning_model(model: str) -> bool:\n    \"\"\"Check if a model is a reasoning model (produces <think> blocks).\"\"\"\n    spec = get_model_spec(model)\n    if spec and spec.supports_thinking:\n        return True\n    # Heuristic fallback for models not in registry\n    lower = model.lower()\n    return any(kw in lower for kw in (\"deepseek-r1\", \"qwen3\", \"magistral\", \"phi4-reasoning\", \"glm-4\"))\n\n\ndef _get_options_for_model(\n    model: str,\n    role: str,\n    base_options: dict,\n    num_ctx_override: int | None = None,\n) -> dict:\n    \"\"\"Get generation options tuned for the specific model being used.\n\n    Reasoning models get different temperatures and larger context.\n    Agentic models get agentic options.\n    \"\"\"\n    spec = get_model_spec(model)\n\n    # Start with role-specific base\n    options = base_options.copy()\n\n    # Override with model-category-specific settings\n    if spec:\n        if spec.category == \"reasoning\":\n            # Reasoning models need higher temp for exploration, bigger context\n            options[\"temperature\"] = max(options.get(\"temperature\", 0.3), 0.35)\n            options[\"num_ctx\"] = max(options.get(\"num_ctx\", 8192), REASONING_OPTIONS[\"num_ctx\"])\n        elif spec.category == \"agentic\":\n            options[\"num_ctx\"] = max(options.get(\"num_ctx\", 8192), AGENTIC_OPTIONS[\"num_ctx\"])\n    elif _is_reasoning_model(model):\n        # Fallback for unregistered reasoning models\n        options[\"num_ctx\"] = max(options.get(\"num_ctx\", 8192), 16384)\n\n    if num_ctx_override:\n        options[\"num_ctx\"] = num_ctx_override\n\n    return options\n\n\ndef ensure_models_for_complexity(\n    complexity: str,\n    size: str = \"medium\",\n) -> None:\n    \"\"\"Check if ideal models are available, offer to pull if missing.\n    \n    If ideal models aren't installed:\n    1. Show what's missing and what fallbacks will be used\n    2. Ask user permission to pull missing models\n    3. Pull if approved, or continue with fallbacks if declined\n    \"\"\"\n    from jcode.config import (\n        get_missing_ideal_models,\n        get_ideal_and_actual_models,\n        pull_model,\n        refresh_local_models,\n    )\n    \n    missing = get_missing_ideal_models(complexity, size)\n    \n    if not missing:\n        # All ideal models are installed\n        return\n    \n    # Show what's missing\n    console.print()\n    console.print(\"[yellow]\u26a0 Some ideal models are not installed:[/yellow]\")\n    \n    ideal_actual = get_ideal_and_actual_models(complexity, size)\n    \n    # Build a table showing ideal vs. fallback\n    from rich.table import Table\n    table = Table(show_header=True, header_style=\"bold cyan\", box=None, padding=(0, 2))\n    table.add_column(\"Role\", style=\"dim\")\n    table.add_column(\"Ideal Model\", style=\"green\")\n    table.add_column(\"Will Use\", style=\"yellow\")\n    table.add_column(\"Status\")\n    \n    for role in (\"planner\", \"coder\", \"reviewer\", \"analyzer\"):\n        ideal, actual, is_fallback = ideal_actual[role]\n        if is_fallback:\n            status = \"[red]fallback[/red]\"\n            table.add_row(role, ideal, actual, status)\n        else:\n            status = \"[green]\u2713[/green]\"\n            table.add_row(role, ideal, actual, status)\n    \n    console.print(table)\n    console.print()\n    \n    # Calculate total size to download (improved estimates based on model sizes)\n    model_names = [model for model, _ in missing]\n    size_estimate = 0\n    for model_name in model_names:\n        # Rough size estimates based on common models\n        if \"70b\" in model_name or \"72b\" in model_name:\n            size_estimate += 40  # 70B models ~40GB\n        elif \"32b\" in model_name or \"30b\" in model_name:\n            size_estimate += 20  # 32B models ~20GB\n        elif \"20b\" in model_name or \"24b\" in model_name:\n            size_estimate += 12  # 20B models ~12GB\n        elif \"14b\" in model_name:\n            size_estimate += 9   # 14B models ~9GB\n        elif \"7b\" in model_name or \"8b\" in model_name:\n            size_estimate += 5   # 7B models ~5GB\n        else:\n            size_estimate += 10  # Default estimate\n    \n    console.print(f\"  [dim]Missing models: {', '.join(model_names)}[/dim]\")\n    console.print(f\"  [dim]Estimated download: ~{size_estimate}GB (may take 10-30min per model)[/dim]\")\n    console.print(f\"  [dim]Tip: Press Ctrl+C during download to skip a model[/dim]\")\n    console.print()\n    \n    # Ask permission\n    from rich.prompt import Confirm\n    should_pull = Confirm.ask(\n        \"[bold cyan]Pull missing models now?[/bold cyan] (if no, will use fallback models)\",\n        default=False,\n    )\n    \n    if should_pull:\n        console.print()\n        success_count = 0\n        for model_name, roles in missing:\n            console.print(f\"[bold]Pulling {model_name}[/bold] [dim](for {roles})[/dim]\")\n            if pull_model(model_name):\n                success_count += 1\n            else:\n                console.print(f\"[yellow]  Skipped \u2014 will use fallback for {roles}[/yellow]\")\n        \n        if success_count > 0:\n            console.print(f\"\\n[green]\u2713 Pulled {success_count}/{len(missing)} model(s)[/green]\")\n            refresh_local_models()\n        elif success_count == 0:\n            console.print(\"\\n[yellow]No models were pulled. Continuing with fallbacks.[/yellow]\")\n    else:\n        console.print(\"[dim]Continuing with fallback models...[/dim]\")\n    \n    console.print()\n\n\ndef check_ollama_running() -> bool:\n    \"\"\"Return True if the Ollama server is reachable.\"\"\"\n    try:\n        ollama.list()\n        return True\n    except Exception:\n        return False\n\n\ndef list_available_models() -> list[str]:\n    \"\"\"Return a list of model names available locally.\"\"\"\n    try:\n        response = ollama.list()\n        models = response.get(\"models\", []) if isinstance(response, dict) else []\n        if not models and hasattr(response, \"models\"):\n            models = response.models or []\n        return [\n            (m.get(\"name\", \"\") if isinstance(m, dict) else getattr(m, \"model\", \"\"))\n            for m in models\n        ]\n    except Exception:\n        return []\n\n\n# \u2500\u2500 Unified generation function \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\ndef call_model(\n    role: str,\n    messages: list[dict[str, str]],\n    stream: bool = True,\n    num_ctx: int | None = None,\n    complexity: str = \"medium\",\n    size: str = \"medium\",\n    model_override: str | None = None,\n) -> str:\n    \"\"\"\n    Send messages to the best available model for role + classification.\n\n    Args:\n        role: One of 'planner', 'coder', 'reviewer', 'analyzer', 'chat'.\n        messages: Chat messages.\n        stream: Whether to stream output to console.\n        num_ctx: Override context window size.\n        complexity: Task complexity for model routing.\n        size: Task size for model routing.\n        model_override: Force a specific model (bypasses routing).\n    \"\"\"\n    # Resolve model\n    if model_override:\n        model = model_override\n    else:\n        model = get_model_for_role(role, complexity, size)\n\n    # Get role-specific base options\n    options_map = {\n        \"planner\": PLANNER_OPTIONS,\n        \"coder\": CODER_OPTIONS,\n        \"reviewer\": REVIEWER_OPTIONS,\n        \"analyzer\": ANALYZER_OPTIONS,\n        \"chat\": CODER_OPTIONS,       # Chat uses coder defaults\n    }\n    base_options = options_map.get(role, CODER_OPTIONS)\n\n    _ensure_model(model)\n\n    # Build final options (model-aware)\n    options = _get_options_for_model(model, role, base_options, num_ctx)\n\n    try:\n        if stream:\n            return _stream(model, messages, options)\n        else:\n            return _generate_silent(model, messages, options)\n    except KeyboardInterrupt:\n        console.print(\"\\n[yellow]\u26a0 Interrupted[/yellow]\")\n        return \"\"\n    except Exception as e:\n        err_str = str(e).lower()\n        if \"busy\" in err_str or \"timeout\" in err_str or \"connection\" in err_str:\n            console.print(f\"\\n[yellow]\u26a0 Ollama busy. Retrying in 3s...[/yellow]\")\n            import time\n            time.sleep(3)\n            try:\n                if stream:\n                    return _stream(model, messages, options)\n                else:\n                    return _generate_silent(model, messages, options)\n            except Exception as retry_err:\n                console.print(f\"\\n[red]\u2717 Ollama error: {retry_err}[/red]\")\n                console.print(\"[dim]  Is another JCode instance running?[/dim]\")\n                return \"\"\n        raise\n\n\ndef call_model_silent(\n    role: str,\n    messages: list[dict[str, str]],\n    num_ctx: int | None = None,\n    complexity: str = \"medium\",\n    size: str = \"medium\",\n    model_override: str | None = None,\n) -> str:\n    \"\"\"Thread-safe silent generation (no streaming). Used by parallel workers.\"\"\"\n    return call_model(\n        role, messages, stream=False, num_ctx=num_ctx,\n        complexity=complexity, size=size, model_override=model_override,\n    )\n\n\n# Legacy convenience wrappers (backward compat)\n\ndef call_planner(messages, stream=True, num_ctx=None, complexity=\"medium\", size=\"medium\") -> str:\n    return call_model(\"planner\", messages, stream, num_ctx, complexity, size)\n\ndef call_coder(messages, stream=True, num_ctx=None, complexity=\"medium\", size=\"medium\") -> str:\n    return call_model(\"coder\", messages, stream, num_ctx, complexity, size)\n\ndef call_reviewer(messages, stream=True, num_ctx=None, complexity=\"medium\", size=\"medium\") -> str:\n    return call_model(\"reviewer\", messages, stream, num_ctx, complexity, size)\n\ndef call_analyzer(messages, stream=True, num_ctx=None, complexity=\"medium\", size=\"medium\") -> str:\n    return call_model(\"analyzer\", messages, stream, num_ctx, complexity, size)\n\n\ndef _generate_silent(model: str, messages: list[dict], options: dict) -> str:\n    \"\"\"Non-streaming generation. Thread-safe.\"\"\"\n    resp = ollama.chat(\n        model=model,\n        messages=messages,\n        options=options,\n    )\n    text = resp[\"message\"][\"content\"]\n    # Strip <think> blocks from reasoning models\n    text = re.sub(r\"<think>.*?</think>\", \"\", text, flags=re.DOTALL).strip()\n    return text\n\n\ndef _stream(model: str, messages: list[dict], options: dict) -> str:\n    \"\"\"Stream tokens to the console and return the full text.\n    Filters out <think>...</think> blocks from reasoning models.\n    Uses a lock so parallel streams don't interleave.\n    Handles Ctrl+C gracefully \u2014 returns partial text instead of crashing.\"\"\"\n    chunks: list[str] = []\n    in_think = False\n    is_reasoning = _is_reasoning_model(model)\n    interrupted = False\n\n    with _stream_lock:\n        try:\n            for chunk in ollama.chat(\n                model=model,\n                messages=messages,\n                options=options,\n                stream=True,\n            ):\n                token = chunk[\"message\"][\"content\"]\n                chunks.append(token)\n\n                # Filter <think> blocks from reasoning models\n                if is_reasoning:\n                    if \"<think>\" in token:\n                        in_think = True\n                        continue\n                    if \"</think>\" in token:\n                        in_think = False\n                        continue\n                    if in_think:\n                        continue\n\n                console.print(token, end=\"\", highlight=False)\n        except KeyboardInterrupt:\n            interrupted = True\n            console.print(\"\\n[yellow]\u26a0 Generation interrupted by user[/yellow]\")\n        except Exception:\n            if not chunks:\n                raise\n            # If we already have partial output, return it rather than crashing\n            interrupted = True\n            console.print(\"\\n[yellow]\u26a0 Stream interrupted[/yellow]\")\n        finally:\n            console.print()  # newline after stream\n\n    full_text = \"\".join(chunks)\n    # Also strip any complete <think> blocks from the final text\n    full_text = re.sub(r\"<think>.*?</think>\", \"\", full_text, flags=re.DOTALL).strip()\n\n    if interrupted and full_text:\n        console.print(f\"[dim]  (partial output: {len(full_text)} chars)[/dim]\")\n\n    return full_text\n",
      "jcode/planner.py": "\"\"\"\nPlanner module \u2014 uses the reasoning model to understand requests,\ndesign project structure, and create execution plans as a DAG.\n\"\"\"\n\nfrom __future__ import annotations\n\nimport json\nimport re\n\nfrom rich.console import Console\n\nfrom jcode.ollama_client import call_planner\nfrom jcode.prompts import PLANNER_SYSTEM, PLANNER_REFINE\nfrom jcode.context import ContextManager\n\nconsole = Console()\n\n\ndef _extract_json(text: str) -> dict:\n    \"\"\"\n    Extract the first JSON object from model output.\n    Handles markdown fences and DeepSeek-R1 think tags.\n    \"\"\"\n    # Strip <think>...</think> blocks from DeepSeek-R1\n    text = re.sub(r\"<think>.*?</think>\", \"\", text, flags=re.DOTALL)\n\n    # Try code fences\n    fence_match = re.search(r\"```(?:json)?\\s*\\n?(.*?)```\", text, re.DOTALL)\n    if fence_match:\n        text = fence_match.group(1).strip()\n\n    # Find first { \u2026 } block\n    depth = 0\n    start = None\n    for i, ch in enumerate(text):\n        if ch == \"{\":\n            if depth == 0:\n                start = i\n            depth += 1\n        elif ch == \"}\":\n            depth -= 1\n            if depth == 0 and start is not None:\n                try:\n                    return json.loads(text[start : i + 1])\n                except json.JSONDecodeError:\n                    continue\n    raise ValueError(\"No valid JSON object found in model output.\")\n\n\ndef create_plan(user_prompt: str, ctx: ContextManager) -> dict:\n    \"\"\"\n    Ask the planner to produce a project plan from a user prompt.\n    Returns the parsed plan dict and initializes the task DAG.\n    \"\"\"\n    ctx.add_planner_message(\"system\", PLANNER_SYSTEM)\n    ctx.add_planner_message(\"user\", user_prompt)\n\n    console.print(\"\\n  [dim]Planning project architecture...[/dim]\\n\")\n\n    complexity = ctx.get_complexity()\n    size = ctx.get_size()\n    raw = call_planner(ctx.get_planner_messages(), stream=True, complexity=complexity, size=size)\n    ctx.add_planner_message(\"assistant\", raw)\n\n    plan = _extract_json(raw)\n    ctx.set_plan(plan)\n\n    planner_ctx, coder_ctx = ctx.get_context_sizes()\n    console.print(\n        f\"\\n[dim]Classification: [bold]{ctx.get_complexity()}/{ctx.get_size()}[/bold] \"\n        f\"\u2502 Planner ctx: {planner_ctx:,} \u2502 Coder ctx: {coder_ctx:,}[/dim]\"\n    )\n\n    return plan\n\n\ndef refine_plan(ctx: ContextManager) -> dict:\n    \"\"\"\n    Ask the planner to revise its plan based on accumulated errors.\n    \"\"\"\n    errors_text = \"\\n\".join(f\"- {e}\" for e in ctx.state.errors)\n    failure_log = ctx.get_failure_log_str()\n    architecture = ctx.get_architecture()\n\n    prompt = PLANNER_REFINE.format(\n        errors=errors_text,\n        failure_log=failure_log,\n        architecture=architecture,\n    )\n    ctx.add_planner_message(\"user\", prompt)\n\n    console.print(\"\\n  [dim]Revising plan based on errors...[/dim]\\n\")\n\n    planner_ctx, _ = ctx.get_context_sizes()\n    complexity = ctx.get_complexity()\n    size = ctx.get_size()\n    raw = call_planner(ctx.get_planner_messages(), stream=True, num_ctx=planner_ctx, complexity=complexity, size=size)\n    ctx.add_planner_message(\"assistant\", raw)\n\n    plan = _extract_json(raw)\n    ctx.set_plan(plan)\n    ctx.clear_errors()\n    return plan\n",
      "jcode/prompts.py": "\"\"\"\nPrompt templates for all roles + modes:\n  1. Planner  \u2014 architecture & task decomposition\n  2. Coder    \u2014 implementation (full file or patch)\n  3. Reviewer \u2014 code critic, finds issues before execution\n  4. Analyzer \u2014 error parser, distills stack traces into fixes\n  5. Chat     \u2014 project-aware conversation\n  6. Agent    \u2014 autonomous modify-in-place\n  7. Research \u2014 web research + doc fetching for heavy tasks\n\nv0.9.0 \u2014 Multi-model prompts with classification-aware strategies.\n\nRole isolation is critical \u2014 each role only sees what it needs.\n\"\"\"\n\n# \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n#  PLANNER (reasoning model)\n# \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n\nPLANNER_SYSTEM = \"\"\"\\\nYou are **JCode Planner**, an expert software architect.\n\nYour job:\n1. Deeply understand the user's request.\n2. Choose the optimal tech stack.\n3. Design a clear project structure with files and folders.\n4. Decompose implementation into a dependency-ordered task DAG.\n5. Write a brief architecture summary.\n6. Define database schema (if applicable).\n7. Define API surface (if applicable).\n8. Define auth flow (if applicable).\n9. Define deployment strategy (if applicable).\n\nRULES:\n- Respond with valid JSON only. No markdown fences around it.\n- Use this EXACT schema:\n\n{\n  \"project_name\": \"string\",\n  \"description\": \"one-line summary\",\n  \"tech_stack\": [\"lang/framework\", ...],\n  \"architecture_summary\": \"2-3 sentence high-level description of how the system works\",\n  \"database_schema\": {\n    \"table_name\": {\n      \"columns\": {\"col_name\": \"type + constraints\"},\n      \"relationships\": [\"description of FK/references\"]\n    }\n  },\n  \"api_surface\": [\n    {\"method\": \"GET/POST/etc\", \"path\": \"/api/...\", \"description\": \"what it does\"}\n  ],\n  \"auth_flow\": \"description of authentication/authorization strategy, or 'none'\",\n  \"deployment\": \"Docker/Vercel/static/etc \u2014 how to run and deploy this\",\n  \"structure\": {\n    \"path/to/file.ext\": \"brief description of this file's purpose\"\n  },\n  \"tasks\": [\n    {\n      \"id\": 1,\n      \"file\": \"path/to/file.ext\",\n      \"description\": \"what to implement in this file\",\n      \"depends_on\": []\n    }\n  ]\n}\n\n- \"database_schema\", \"api_surface\", \"auth_flow\", \"deployment\" may be empty/null \\\n  for simple projects that don't need them. Include them when relevant.\n- Order tasks by dependency (independent first).\n- Each file should appear in exactly ONE task.\n- Include config files (package.json, requirements.txt, etc.).\n- Keep it practical \u2014 don't over-engineer.\n- depends_on uses task IDs (integers), not file names.\n- The spec is a CONTRACT \u2014 the builder must follow it exactly. No stack drift.\n\nARCHITECTURE RULES (CRITICAL \u2014 follow strictly):\n- Use FREE, no-signup APIs when possible: open-meteo.com for weather, \\\n  restcountries.com for countries, jsonplaceholder.typicode.com for test data, \\\n  api.dictionaryapi.dev for definitions, wttr.in for weather.\n- NEVER create a config.json or .env file with API key placeholders for simple \\\n  projects. If a free API exists, use it directly.\n- NEVER create separate config files for simple projects. Inline configuration.\n- For frontend-only projects (HTML/CSS/JS), put ALL JavaScript in a single file \\\n  unless the project is complex.\n- MINIMIZE file count. A simple project should have 1-3 files max. Don't create \\\n  unnecessary files.\n- Minimize dependencies between tasks. If files are independent, set depends_on=[].\n- For web apps: prefer a single index.html with inline CSS and JS for simple \\\n  projects. Only split into separate files for medium+ complexity.\n- For complex projects: define CLEAR module boundaries. Each module should have \\\n  a single responsibility. API routes in one place, database models in another, \\\n  business logic separate from presentation.\n\"\"\"\n\nPLANNER_REFINE = \"\"\"\\\nThe previous implementation produced errors. Here is the feedback:\n\n{errors}\n\nPrevious failure log:\n{failure_log}\n\nCurrent architecture context:\n{architecture}\n\nPlease output a REVISED JSON plan that fixes these issues.\nSame JSON schema as before. Focus on the broken parts only.\n\"\"\"\n\n\n# \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n#  CODER (coding model \u2014 full file generation)\n# \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n\nCODER_SYSTEM = \"\"\"\\\nYou are **JCode Coder**, an expert software developer.\n\nYou will receive:\n- A project architecture summary (the SPEC \u2014 you must follow it exactly)\n- A file index showing every file and its purpose\n- Database schema, API surface, auth flow (if applicable)\n- A specific task describing what to implement\n- Relevant existing file contents\n\nRULES:\n- Output ONLY the complete file content. No explanations, no markdown fences.\n- Write clean, production-quality, well-commented code.\n- Follow the tech stack and conventions described in the spec.\n- Include all necessary imports.\n- If fixing an existing file, output the FULL corrected file.\n- You are a BUILDER \u2014 you implement EXACTLY what the planner specified.\n- NO STACK DRIFT: if the spec says React, don't use Vue. If it says PostgreSQL, \\\n  don't use SQLite. Follow the spec as a contract.\n\nQUALITY RULES (CRITICAL):\n- Code MUST work out of the box. No placeholder API keys, no TODO stubs.\n- Use FREE APIs that require no signup: open-meteo.com, wttr.in, \\\n  restcountries.com, jsonplaceholder.typicode.com, api.dictionaryapi.dev.\n- NEVER use localStorage to read config files. Use fetch() for JSON files \\\n  or inline the configuration.\n- NEVER output placeholder values like 'YOUR_API_KEY_HERE' or empty strings \\\n  for API endpoints.\n- All fetch calls MUST have error handling (try/catch or .catch).\n- All UI must show loading states and error states.\n- For HTML: include the title matching the project name, proper meta tags.\n- For CSS: use modern CSS (flexbox/grid), make it responsive, use a clean \\\n  color scheme.\n- For JS: use async/await, handle all error cases, update DOM with real data.\n- Test the code mentally before outputting. Trace through it. Will it work?\n- If a database schema is defined, your SQL/ORM must match it exactly.\n- If an API surface is defined, your routes must match it exactly.\n\"\"\"\n\nCODER_TASK = \"\"\"\\\n## Architecture\n{architecture}\n\n## File Index\n{file_index}\n\n## Spec Contract\n{spec_details}\n\n## Current Task\nFile: `{file_path}`\nDescription: {task_description}\n\n{existing_context}\n\nWrite the complete content for `{file_path}`. Output ONLY the raw file content.\n\"\"\"\n\n\n# \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n#  CODER \u2014 PATCH MODE (function-level targeted fix)\n# \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n\nCODER_PATCH = \"\"\"\\\n## Architecture\n{architecture}\n\n## File to Patch\n`{file_path}`\n\n## Current Content\n```\n{file_content}\n```\n\n## Problem\n{error}\n\n## Reviewer Feedback\n{review_feedback}\n\nApply a MINIMAL, TARGETED fix. Rules:\n1. Output the FULL corrected file.\n2. Only change what is necessary \u2014 do NOT rewrite unrelated code.\n3. Preserve all existing comments, formatting, and structure.\n4. If adding imports, add them in the correct location.\n\nOutput ONLY the corrected file content, nothing else.\n\"\"\"\n\n\n# \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n#  REVIEWER (code critic \u2014 uses coding model with different prompt)\n# \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n\nREVIEWER_SYSTEM = \"\"\"\\\nYou are **JCode Reviewer**, a strict senior code reviewer.\n\nYour job is to review generated code BEFORE it is executed.\nYou catch bugs that compilers and linters miss:\n- Logic errors\n- Missing error handling\n- Security issues (hardcoded secrets, SQL injection, XSS)\n- Missing imports or undefined variables\n- API misuse or wrong function signatures\n- Race conditions, resource leaks\n- Incomplete implementations (TODO, placeholder, pass)\n\nRULES:\n- Be concise and specific.\n- Output valid JSON only:\n\n{\n  \"approved\": true/false,\n  \"issues\": [\n    {\n      \"file\": \"path/to/file\",\n      \"line_hint\": \"approximate location or function name\",\n      \"severity\": \"critical|warning|suggestion\",\n      \"description\": \"what's wrong and how to fix it\"\n    }\n  ],\n  \"summary\": \"one-line overall assessment\"\n}\n\n- Only mark approved=false for critical or warning issues.\n- Suggestions alone should still approve.\n- Be practical \u2014 don't flag style preferences as issues.\n\"\"\"\n\nREVIEWER_TASK = \"\"\"\\\n## Architecture\n{architecture}\n\n## File to Review\n`{file_path}` \u2014 {file_purpose}\n\n## File Content\n```\n{file_content}\n```\n\n## Related Files (for context)\n{related_context}\n\nReview this file. Output JSON only.\n\"\"\"\n\n\n# \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n#  ANALYZER (error parser \u2014 uses reasoning model)\n# \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n\nANALYZER_SYSTEM = \"\"\"\\\nYou are **JCode Analyzer**, an expert debugger.\n\nYou receive raw error output (stack traces, lint errors, test failures).\nYour job is to produce a precise, actionable diagnosis.\n\nRULES:\n- Output valid JSON only:\n\n{\n  \"root_cause\": \"one-line explanation of what went wrong\",\n  \"affected_file\": \"path/to/file.ext\",\n  \"affected_function\": \"function_name or null\",\n  \"fix_strategy\": \"specific instructions for the coder on how to fix this\",\n  \"is_dependency_issue\": true/false,\n  \"severity\": \"critical|warning|info\"\n}\n\n- Be specific. Don't say \"fix the error\" \u2014 say exactly what to change.\n- If multiple files are affected, focus on the ROOT cause.\n- Distinguish between code bugs and missing dependencies.\n\"\"\"\n\nANALYZER_TASK = \"\"\"\\\n## Project Architecture\n{architecture}\n\n## Error Output\n```\n{error_output}\n```\n\n## File That Caused the Error\n`{file_path}`\n\n## File Content\n```\n{file_content}\n```\n\n## Previous Fix Attempts (if any)\n{previous_fixes}\n\nAnalyze this error. Output JSON only.\n\"\"\"\n\n\n# \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n#  CHAT (project-aware conversation / modification agent)\n# \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n\nCHAT_SYSTEM = \"\"\"\\\nYou are **JCode**, an expert software engineer embedded inside a coding project.\nYou have FULL CONTEXT of ALL project files below. You can see every line of code.\nYou are NOT a chatbot giving generic advice \u2014 you are an agent that reads the \\\nactual code and makes precise, targeted fixes.\n\nCRITICAL RULES:\n- You already have ALL project files in context below. READ THEM.\n- NEVER say \"I need more details\" or \"please provide the error\". You have everything.\n- NEVER give generic checklists like \"make sure MongoDB is running\" or \"try npm install\".\n- When fixing errors, you MUST read the actual file contents provided, find the \\\n  exact bug, and output the corrected file.\n- When an error message is provided, trace it through the actual code in context \\\n  to find the root cause. The files are RIGHT THERE.\n\n**MODE 1 \u2014 ACTION (fix, change, add, create, refactor, debug):**\nOutput the complete fixed/modified files using EXACTLY this format:\n\n===FILE: path/to/file.ext===\n(complete file content \u2014 every single line, raw code, NO markdown fences)\n===END===\n\nRules:\n- MANDATORY: use ===FILE: ...=== / ===END=== for ANY file change.\n- MANDATORY: every ===FILE: block MUST end with ===END=== on its own line.\n- NEVER wrap file content in markdown code fences (``` or ```python etc).\n  Write raw code between ===FILE: and ===END=== markers.\n- Output the COMPLETE file \u2014 not diffs, not patches, not snippets.\n- The path must match the existing file path exactly as shown in the project.\n- For multiple files, output multiple ===FILE:=== ... ===END=== blocks.\n- You may include a 1-2 sentence explanation, but the file blocks are the priority.\n- If an error says \"Cannot find module '../models/Todo'\", look at the project \\\n  files \u2014 if models/Todo.js is missing, CREATE it. If the path is wrong, FIX \\\n  the require/import statement. Actually trace the error.\n\n**MODE 2 \u2014 DISCUSSION (questions, explanations, brainstorming):**\nRespond in plain conversational text referencing the ACTUAL code you can see. \\\nNo ===FILE:=== blocks. Be specific \u2014 quote function names, line references, \\\nactual variable names from the code.\n\n**MODE 3 \u2014 RUN / DEPLOY:**\nWhen the user asks you to run something, install packages, or execute commands, \\\nuse ===RUN:=== blocks instead of showing them commands to copy-paste:\n\n===RUN: npm install===\n===RUN: npm start===\n\nFor long-running processes (servers): ===BACKGROUND: npm start===\nOne command per block. Files are applied before commands run.\nNEVER tell the user to run commands manually \u2014 emit ===RUN:=== blocks instead.\n\n**Mode detection:**\n- \"fix the errors\", \"the app crashes\", \"add dark mode\" -> ACTION (output files)\n- \"how does auth work?\", \"explain the API\" -> DISCUSSION\n- \"how do I run this?\", \"deploy to vercel\" -> RUN / DEPLOY\n\n**When you receive a RUNTIME ERROR:**\n1. Read the error message carefully \u2014 it tells you the exact file and line.\n2. Look at that file in the project files below.\n3. Trace the root cause (missing file? wrong import path? undefined variable?).\n4. Output the fixed file(s) using ===FILE:=== format.\n5. If a file is missing entirely, CREATE it with ===FILE:===.\nNEVER respond to a runtime error with \"tips\" or \"suggestions\". FIX IT.\n\nBe concise, precise, no fluff. You are a senior engineer shipping code.\n\"\"\"\n\nCHAT_CONTEXT = \"\"\"\\\n## Project Summary\n{project_summary}\n\n## All Project Files\n{file_contents}\n\n## Recent Conversation\n{chat_history}\n\n## User Message\n{user_message}\n\nRemember: If the user wants changes, you MUST use ===FILE: path=== ... ===END=== format. \\\nIf they just want to talk, respond in plain text. Decide based on their intent above.\n\"\"\"\n\n\n# \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n#  AGENTIC MODE \u2014 autonomous modification of existing projects\n# \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n\nAGENTIC_SYSTEM = \"\"\"\\\nYou are **JCode**, an autonomous software engineer operating INSIDE a real project.\n\nYou have been given a REQUEST and the FULL codebase.\nYour job is to fulfill the request completely and autonomously \u2014 write files, \\\nrun commands, install packages, whatever is needed.\n\n\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n FILE OUTPUT FORMAT \u2014 MANDATORY\n\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n\nYou MUST output files in EXACTLY this format:\n\n===FILE: path/to/file.ext===\n<complete file content here \u2014 raw code, NO markdown fences>\n===END===\n\nCORRECT EXAMPLE:\n===FILE: main.py===\nimport sys\n\ndef main():\n    print(\"Hello!\")\n\nif __name__ == \"__main__\":\n    main()\n===END===\n\nWRONG \u2014 DO NOT use markdown headings to label files:\n### FILE: main.py        \u2190 WRONG \u2014 use ===FILE: main.py=== instead\n### main.py              \u2190 WRONG\n#### FILE: main.py       \u2190 WRONG\n\nWRONG \u2014 DO NOT wrap file content in fences:\n===FILE: main.py===\n```python           \u2190 WRONG\nprint(\"hello\")\n```                 \u2190 WRONG\n===END===\n\nCORRECT \u2014 raw code only between the markers:\n===FILE: main.py===\nprint(\"hello\")\n===END===\n\nABSOLUTE RULES:\n1. Start every file block with ===FILE: path=== (no heading, no label before it).\n2. End every file block with ===END=== on its own line.\n3. Write raw code between the markers \u2014 NEVER use ```fences``` inside file blocks.\n4. Output COMPLETE file content \u2014 no diffs, no snippets, no \"... rest unchanged\".\n5. Path must match the existing file path exactly, or be a new path for new files.\n6. ===FILE: and ===END=== must each be alone on their line.\n\n\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n COMMANDS\n\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n\n===RUN: command===   \u2014 run a shell command (install, build, compile, migrate)\n===BACKGROUND: command===  \u2014 start a long-running process (server, watcher)\n\nExamples:\n===RUN: npm install express===\n===RUN: pip install flask===\n===RUN: npm run build===\n===BACKGROUND: npm start===\n\nRULES:\n- One command per block.\n- Files are applied BEFORE commands run.\n- NEVER emit ===RUN: python main.py=== or any interactive script.\n  Interactive programs are launched by the user separately.\n- ===RUN:=== is for: package installs, builds, compiles, migrations only.\n\n\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n GENERAL RULES\n\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n\n1. Read ALL project files in context before making changes.\n2. Only modify what is needed. Preserve code style and conventions.\n3. Fix Python scoping: do not shadow global constants with local variables of the same name.\n4. Write a brief 1-2 sentence summary BEFORE the ===FILE:=== blocks.\n\nYou are shipping production code. Be precise. Be complete. Be autonomous.\n\"\"\"\n\nAGENTIC_TASK = \"\"\"\\\n## Project\n{project_summary}\n\n## All Files\n{file_contents}\n\n## Request\n{user_request}\n\n## Git Status\n{git_status}\n\nYou are in AUTONOMOUS mode. Fulfill the request completely:\n- Create/modify files using ===FILE: path=== ... ===END=== format\n- Run commands using ===RUN: command=== format\n- Start servers using ===BACKGROUND: command=== format\n- Install dependencies BEFORE running the project\nDo NOT tell the user to run commands \u2014 YOU run them with ===RUN:=== blocks.\n\"\"\"\n\n\n# \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n#  GIT \u2014 commit message generation\n# \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n\nGIT_COMMIT_MSG_SYSTEM = \"\"\"\\\nYou are a git commit message generator. Given a diff or description of changes, \\\noutput a concise, conventional commit message. Format: type(scope): description\n\nTypes: feat, fix, refactor, docs, style, test, chore, perf\n\nRules:\n- Max 72 characters for the subject line\n- Be specific about what changed\n- Output ONLY the commit message, nothing else\n\"\"\"\n\n\n# \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n#  RESEARCH \u2014 web research summarization for heavy tasks\n# \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n\nRESEARCH_SYSTEM = \"\"\"\\\nYou are **JCode Researcher**, an expert technical analyst.\n\nYou have been given web search results and documentation excerpts\nrelated to a coding task. Your job is to extract the most useful\ntechnical information for the implementation.\n\nOutput a concise technical brief covering:\n1. Best practices and recommended approaches\n2. Key API endpoints, function signatures, or configuration patterns\n3. Common pitfalls and how to avoid them\n4. Required dependencies and their versions\n5. Code patterns or examples that are directly relevant\n\nRULES:\n- Be concise and actionable \u2014 this brief feeds directly into planning.\n- Focus on IMPLEMENTATION details, not general concepts.\n- If the search results are irrelevant, say so and suggest what to search for.\n- Output plain text, not JSON.\n- Max 500 words.\n\"\"\"\n\nRESEARCH_TASK = \"\"\"\\\n## Task Description\n{task_description}\n\n## Technologies Involved\n{technologies}\n\n## Search Results\n{search_results}\n\nSummarize the most relevant technical information for implementing this task.\n\"\"\"\n\n\n# \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n#  PLANNER \u2014 enhanced for heavy tasks (with research context)\n# \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n\nPLANNER_RESEARCH_CONTEXT = \"\"\"\\\n\n## Research Brief\nThe following technical research was conducted for this task:\n\n{research_brief}\n\nUse this information to make better architectural decisions. Prefer the\napproaches, APIs, and patterns described in the research.\n\"\"\"\n\n",
      "jcode/reviewer.py": "\"\"\"\nReviewer module \u2014 code critic that catches bugs BEFORE execution.\n\nv2.0 \u2014 Supports parallel review via silent mode for WorkerPool.\n\nThis is one of the key differentiators: frontier models generate and hope.\nJCode generates, reviews, THEN executes. Verification > intelligence.\n\"\"\"\n\nfrom __future__ import annotations\n\nimport json\nimport re\n\nfrom rich.console import Console\n\nfrom jcode.ollama_client import call_reviewer, call_model_silent\nfrom jcode.prompts import REVIEWER_SYSTEM, REVIEWER_TASK\nfrom jcode.context import ContextManager\n\nconsole = Console()\n\n\ndef _extract_json(text: str) -> dict:\n    \"\"\"Extract JSON from reviewer output.\"\"\"\n    text = re.sub(r\"<think>.*?</think>\", \"\", text, flags=re.DOTALL)\n    fence = re.search(r\"```(?:json)?\\s*\\n?(.*?)```\", text, re.DOTALL)\n    if fence:\n        text = fence.group(1).strip()\n\n    depth = 0\n    start = None\n    for i, ch in enumerate(text):\n        if ch == \"{\":\n            if depth == 0:\n                start = i\n            depth += 1\n        elif ch == \"}\":\n            depth -= 1\n            if depth == 0 and start is not None:\n                try:\n                    return json.loads(text[start : i + 1])\n                except json.JSONDecodeError:\n                    continue\n\n    # Fallback: if we can't parse, assume approval\n    return {\"approved\": True, \"issues\": [], \"summary\": \"Could not parse review\"}\n\n\ndef review_file(file_path: str, ctx: ContextManager, parallel: bool = False) -> dict:\n    \"\"\"\n    Review a generated file before accepting it.\n\n    Args:\n        file_path: Relative path to the file in the project.\n        ctx: ContextManager for structured memory.\n        parallel: If True, use silent mode (thread-safe, no streaming).\n\n    Returns:\n        {\n            \"approved\": bool,\n            \"issues\": [{\"file\", \"line_hint\", \"severity\", \"description\"}],\n            \"summary\": str\n        }\n    \"\"\"\n    file_content = ctx.state.files.get(file_path, \"\")\n    file_purpose = ctx.state.file_index.get(file_path, \"unknown purpose\")\n\n    if not file_content.strip():\n        return {\"approved\": False, \"issues\": [{\"file\": file_path, \"line_hint\": \"entire file\", \"severity\": \"critical\", \"description\": \"File is empty\"}], \"summary\": \"Empty file\"}\n\n    # Get related files for context\n    related_paths = []\n    deps = ctx.state.dependency_graph.get(file_path, [])\n    related_paths.extend(deps)\n    related_context = ctx.get_file_context(related_paths[:3]) if related_paths else \"(none)\"\n\n    prompt = REVIEWER_TASK.format(\n        architecture=ctx.get_architecture(),\n        file_path=file_path,\n        file_purpose=file_purpose,\n        file_content=file_content[:MAX_REVIEW_CHARS],\n        related_context=related_context,\n    )\n\n    _, coder_ctx = ctx.get_context_sizes()\n    complexity = ctx.get_complexity()\n    size = ctx.get_size()\n\n    if parallel:\n        # Thread-safe silent mode \u2014 build messages locally\n        messages = [\n            {\"role\": \"system\", \"content\": REVIEWER_SYSTEM},\n            {\"role\": \"user\", \"content\": prompt},\n        ]\n        console.print(f\"  [dim]\u26a1 Reviewing[/dim] [cyan]{file_path}[/cyan]\")\n        raw = call_model_silent(\"reviewer\", messages, num_ctx=coder_ctx, complexity=complexity, size=size)\n    else:\n        ctx.reset_channel(\"reviewer\")\n        ctx.add_message(\"reviewer\", \"system\", REVIEWER_SYSTEM)\n        ctx.add_message(\"reviewer\", \"user\", prompt)\n        console.print(f\"  [dim]Reviewing[/dim] [cyan]{file_path}[/cyan]\")\n        raw = call_reviewer(\n            ctx.get_messages(\"reviewer\"),\n            stream=False,  # Reviews don't need streaming\n            num_ctx=coder_ctx,\n            complexity=complexity,\n            size=size,\n        )\n\n    result = _extract_json(raw)\n\n    # Display review summary\n    if result.get(\"approved\"):\n        console.print(f\"    [cyan]approved[/cyan] \u2014 {result.get('summary', '')}\")\n    else:\n        issues = result.get(\"issues\", [])\n        critical = [i for i in issues if i.get(\"severity\") == \"critical\"]\n        warnings = [i for i in issues if i.get(\"severity\") == \"warning\"]\n        console.print(f\"    [dim]issues found[/dim] \u2014 {len(critical)} critical, {len(warnings)} warnings\")\n        for issue in issues:\n            console.print(f\"      [dim]-[/dim] {issue.get('description', '')}\")\n\n    return result\n\n\n# Max chars to include in review context\nMAX_REVIEW_CHARS = 10000\n",
      "jcode/scanner.py": "\"\"\"\nProject scanner \u2014 reads an existing project directory and builds\nstructured context for JCode to understand the codebase.\n\nCapabilities:\n  1. Detect project type (Python, Node, React, etc.)\n  2. Detect tech stack from config files\n  3. Read all source files into context\n  4. Build dependency graph from imports\n  5. Generate architecture summary\n\nv0.7.0 \u2014 JCode lives inside your project.\n\"\"\"\n\nfrom __future__ import annotations\n\nimport json\nimport re\nfrom pathlib import Path\n\nfrom rich.console import Console\n\nfrom jcode.config import ProjectState\nfrom jcode.context import ContextManager\n\nconsole = Console()\n\n# Directories to always skip\nSKIP_DIRS = {\n    \".git\", \"node_modules\", \".venv\", \"venv\", \"__pycache__\",\n    \".next\", \"dist\", \"build\", \".mypy_cache\", \".pytest_cache\",\n    \".tox\", \"egg-info\", \".eggs\", \"coverage\", \".nyc_output\",\n    \".turbo\", \".cache\", \".parcel-cache\", \"target\", \"vendor\",\n}\n\n# File extensions we consider source code\nSOURCE_EXTENSIONS = {\n    \".py\", \".js\", \".jsx\", \".ts\", \".tsx\", \".html\", \".css\", \".scss\",\n    \".json\", \".yaml\", \".yml\", \".toml\", \".md\", \".txt\", \".sql\",\n    \".sh\", \".bash\", \".env\", \".cfg\", \".ini\", \".xml\", \".graphql\",\n    \".prisma\", \".svelte\", \".vue\", \".go\", \".rs\", \".java\", \".kt\",\n    \".rb\", \".php\", \".c\", \".cpp\", \".h\", \".hpp\", \".cs\", \".swift\",\n    \".r\", \".R\", \".jl\", \".lua\", \".ex\", \".exs\", \".erl\",\n}\n\n# Max file size to read (skip binaries and huge files)\nMAX_FILE_SIZE = 100_000  # 100KB\n\n\n# \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n# Project type detection\n# \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n\ndef detect_project_type(project_dir: Path) -> str:\n    \"\"\"\n    Detect the primary project type from files present.\n    Returns a human-readable label.\n    \"\"\"\n    markers = {\n        \"package.json\":     \"Node.js\",\n        \"next.config.js\":   \"Next.js\",\n        \"next.config.mjs\":  \"Next.js\",\n        \"next.config.ts\":   \"Next.js\",\n        \"vite.config.ts\":   \"Vite\",\n        \"vite.config.js\":   \"Vite\",\n        \"nuxt.config.ts\":   \"Nuxt\",\n        \"svelte.config.js\": \"SvelteKit\",\n        \"angular.json\":     \"Angular\",\n        \"requirements.txt\": \"Python\",\n        \"pyproject.toml\":   \"Python\",\n        \"setup.py\":         \"Python\",\n        \"Pipfile\":          \"Python\",\n        \"Cargo.toml\":       \"Rust\",\n        \"go.mod\":           \"Go\",\n        \"pom.xml\":          \"Java (Maven)\",\n        \"build.gradle\":     \"Java (Gradle)\",\n        \"Gemfile\":          \"Ruby\",\n        \"composer.json\":    \"PHP\",\n        \"Dockerfile\":       \"Docker\",\n        \"docker-compose.yml\": \"Docker Compose\",\n        \"docker-compose.yaml\": \"Docker Compose\",\n    }\n\n    # Check specific markers (order matters \u2014 more specific first)\n    for marker, ptype in markers.items():\n        if (project_dir / marker).exists():\n            # Refine Node.js detection\n            if ptype == \"Node.js\":\n                pkg = project_dir / \"package.json\"\n                try:\n                    data = json.loads(pkg.read_text())\n                    deps = {\n                        **data.get(\"dependencies\", {}),\n                        **data.get(\"devDependencies\", {}),\n                    }\n                    if \"next\" in deps:\n                        return \"Next.js\"\n                    if \"react\" in deps and \"vite\" in deps:\n                        return \"React + Vite\"\n                    if \"react\" in deps:\n                        return \"React\"\n                    if \"vue\" in deps:\n                        return \"Vue\"\n                    if \"svelte\" in deps:\n                        return \"Svelte\"\n                    if \"express\" in deps:\n                        return \"Express.js\"\n                    if \"fastify\" in deps:\n                        return \"Fastify\"\n                except Exception:\n                    pass\n            return ptype\n\n    # Fallback: check for common file patterns\n    if list(project_dir.glob(\"*.py\")):\n        return \"Python\"\n    if list(project_dir.glob(\"*.html\")):\n        return \"HTML/CSS\"\n    if list(project_dir.glob(\"*.js\")):\n        return \"JavaScript\"\n\n    return \"Unknown\"\n\n\ndef detect_tech_stack(project_dir: Path) -> list[str]:\n    \"\"\"\n    Detect the tech stack from project configuration files.\n    Returns a list of technologies.\n    \"\"\"\n    stack: list[str] = []\n\n    # Python\n    req = project_dir / \"requirements.txt\"\n    if req.exists():\n        try:\n            content = req.read_text()\n            known = {\n                \"flask\": \"Flask\", \"django\": \"Django\", \"fastapi\": \"FastAPI\",\n                \"sqlalchemy\": \"SQLAlchemy\", \"pandas\": \"Pandas\",\n                \"numpy\": \"NumPy\", \"pytest\": \"pytest\", \"celery\": \"Celery\",\n                \"redis\": \"Redis\", \"psycopg2\": \"PostgreSQL\",\n                \"pymongo\": \"MongoDB\", \"requests\": \"Requests\",\n                \"beautifulsoup4\": \"BeautifulSoup\", \"scrapy\": \"Scrapy\",\n            }\n            for line in content.split(\"\\n\"):\n                pkg = line.strip().split(\"==\")[0].split(\">=\")[0].split(\"<=\")[0].lower()\n                if pkg in known:\n                    stack.append(known[pkg])\n        except Exception:\n            pass\n\n    pyproject = project_dir / \"pyproject.toml\"\n    if pyproject.exists():\n        stack.append(\"Python\")\n\n    # Node.js\n    pkg_json = project_dir / \"package.json\"\n    if pkg_json.exists():\n        try:\n            data = json.loads(pkg_json.read_text())\n            deps = {\n                **data.get(\"dependencies\", {}),\n                **data.get(\"devDependencies\", {}),\n            }\n            known_node = {\n                \"react\": \"React\", \"next\": \"Next.js\", \"vue\": \"Vue\",\n                \"svelte\": \"Svelte\", \"angular\": \"Angular\",\n                \"express\": \"Express\", \"fastify\": \"Fastify\",\n                \"tailwindcss\": \"Tailwind CSS\", \"typescript\": \"TypeScript\",\n                \"prisma\": \"Prisma\", \"mongoose\": \"Mongoose\",\n                \"socket.io\": \"Socket.IO\", \"jest\": \"Jest\",\n                \"vitest\": \"Vitest\", \"vite\": \"Vite\",\n                \"three\": \"Three.js\", \"d3\": \"D3.js\",\n            }\n            for dep, label in known_node.items():\n                if dep in deps:\n                    stack.append(label)\n        except Exception:\n            pass\n\n    # Docker\n    if (project_dir / \"Dockerfile\").exists():\n        stack.append(\"Docker\")\n    if (project_dir / \"docker-compose.yml\").exists() or (project_dir / \"docker-compose.yaml\").exists():\n        stack.append(\"Docker Compose\")\n\n    # TypeScript\n    if (project_dir / \"tsconfig.json\").exists():\n        if \"TypeScript\" not in stack:\n            stack.append(\"TypeScript\")\n\n    # Dedup while preserving order\n    seen = set()\n    deduped = []\n    for item in stack:\n        if item not in seen:\n            seen.add(item)\n            deduped.append(item)\n    return deduped\n\n\n# \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n# File scanning\n# \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n\ndef scan_files(project_dir: Path) -> dict[str, str]:\n    \"\"\"\n    Scan all source files in the project directory.\n    Returns a dict of {relative_path: content}.\n    Skips binaries, huge files, and ignored directories.\n    \"\"\"\n    files: dict[str, str] = {}\n\n    if not project_dir.exists():\n        return files\n\n    for f in sorted(project_dir.rglob(\"*\")):\n        if not f.is_file():\n            continue\n\n        # Skip hidden files\n        if f.name.startswith(\".\") and f.name != \".env\":\n            continue\n\n        # Skip ignored directories\n        try:\n            rel_parts = f.relative_to(project_dir).parts\n        except ValueError:\n            continue\n\n        if any(part in SKIP_DIRS for part in rel_parts):\n            continue\n\n        # Skip non-source files\n        if f.suffix.lower() not in SOURCE_EXTENSIONS:\n            continue\n\n        # Skip huge files\n        try:\n            if f.stat().st_size > MAX_FILE_SIZE:\n                continue\n        except OSError:\n            continue\n\n        # Read file\n        try:\n            rel_path = str(f.relative_to(project_dir))\n            content = f.read_text(encoding=\"utf-8\", errors=\"replace\")\n            files[rel_path] = content\n        except Exception:\n            continue\n\n    return files\n\n\ndef build_file_index(files: dict[str, str]) -> dict[str, str]:\n    \"\"\"\n    Build a file index: {path: brief_description}.\n    Uses filename and first few lines to infer purpose.\n    \"\"\"\n    index: dict[str, str] = {}\n    for path, content in files.items():\n        # Try to extract a module docstring or first comment\n        desc = _infer_file_purpose(path, content)\n        index[path] = desc\n    return index\n\n\ndef _infer_file_purpose(path: str, content: str) -> str:\n    \"\"\"Infer a file's purpose from its name and content.\"\"\"\n    name = Path(path).stem.lower()\n    suffix = Path(path).suffix.lower()\n\n    # Known config files\n    config_files = {\n        \"package.json\": \"Node.js package configuration\",\n        \"tsconfig.json\": \"TypeScript configuration\",\n        \"tailwind.config.ts\": \"Tailwind CSS configuration\",\n        \"tailwind.config.js\": \"Tailwind CSS configuration\",\n        \"postcss.config.js\": \"PostCSS configuration\",\n        \"next.config.js\": \"Next.js configuration\",\n        \"vite.config.ts\": \"Vite configuration\",\n        \"requirements.txt\": \"Python dependencies\",\n        \"pyproject.toml\": \"Python project configuration\",\n        \".gitignore\": \"Git ignore rules\",\n        \"Dockerfile\": \"Docker image definition\",\n        \"docker-compose.yml\": \"Docker Compose services\",\n    }\n\n    basename = Path(path).name\n    if basename in config_files:\n        return config_files[basename]\n\n    # Try to extract docstring (Python)\n    if suffix == \".py\":\n        doc_match = re.match(r'^(?:#!/.*\\n)?(?:#.*\\n)*\\s*(?:\"\"\"(.*?)\"\"\"|\\'\\'\\'(.*?)\\'\\'\\')',\n                             content, re.DOTALL)\n        if doc_match:\n            doc = (doc_match.group(1) or doc_match.group(2) or \"\").strip()\n            first_line = doc.split(\"\\n\")[0].strip()\n            if first_line:\n                return first_line[:100]\n\n    # Try to extract first comment (JS/TS)\n    if suffix in (\".js\", \".jsx\", \".ts\", \".tsx\"):\n        comment_match = re.match(r'\\s*/\\*\\*?\\s*(.*?)(?:\\*/|\\n)', content)\n        if comment_match:\n            return comment_match.group(1).strip()[:100]\n\n    # Common name patterns\n    name_hints = {\n        \"index\": \"Entry point / main module\",\n        \"main\": \"Main application entry point\",\n        \"app\": \"Application setup\",\n        \"server\": \"Server configuration\",\n        \"config\": \"Configuration\",\n        \"utils\": \"Utility functions\",\n        \"helpers\": \"Helper functions\",\n        \"types\": \"Type definitions\",\n        \"models\": \"Data models\",\n        \"routes\": \"Route definitions\",\n        \"api\": \"API endpoints\",\n        \"auth\": \"Authentication\",\n        \"db\": \"Database connection\",\n        \"database\": \"Database connection\",\n        \"middleware\": \"Middleware\",\n        \"test\": \"Tests\",\n        \"spec\": \"Tests\",\n        \"layout\": \"Page layout\",\n        \"page\": \"Page component\",\n        \"component\": \"UI component\",\n        \"style\": \"Styles\",\n        \"global\": \"Global styles/config\",\n    }\n\n    for hint_key, hint_val in name_hints.items():\n        if hint_key in name:\n            return hint_val\n\n    return f\"{suffix.lstrip('.')} source file\"\n\n\n# \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n# Dependency graph (import analysis)\n# \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n\ndef build_dependency_graph(files: dict[str, str]) -> dict[str, list[str]]:\n    \"\"\"\n    Build a simplified dependency graph from import statements.\n    Returns {file_path: [list of local files it imports]}.\n    Only tracks imports that resolve to files within the project.\n    \"\"\"\n    graph: dict[str, list[str]] = {}\n    all_paths = set(files.keys())\n\n    for path, content in files.items():\n        deps: list[str] = []\n        suffix = Path(path).suffix.lower()\n\n        if suffix == \".py\":\n            deps = _extract_python_imports(path, content, all_paths)\n        elif suffix in (\".js\", \".jsx\", \".ts\", \".tsx\"):\n            deps = _extract_js_imports(path, content, all_paths)\n\n        if deps:\n            graph[path] = deps\n\n    return graph\n\n\ndef _extract_python_imports(path: str, content: str, all_paths: set[str]) -> list[str]:\n    \"\"\"Extract local Python imports.\"\"\"\n    deps: list[str] = []\n    pkg_dir = str(Path(path).parent)\n\n    for line in content.split(\"\\n\"):\n        line = line.strip()\n        # from .module import ... or from package.module import ...\n        m = re.match(r\"from\\s+(\\.?\\w[\\w.]*)\\s+import\", line)\n        if m:\n            module = m.group(1)\n            # Convert dotted path to file path\n            if module.startswith(\".\"):\n                # Relative import\n                rel = module.lstrip(\".\").replace(\".\", \"/\")\n                candidate = f\"{pkg_dir}/{rel}.py\" if pkg_dir != \".\" else f\"{rel}.py\"\n            else:\n                candidate = module.replace(\".\", \"/\") + \".py\"\n\n            if candidate in all_paths:\n                deps.append(candidate)\n\n        # import module\n        m = re.match(r\"import\\s+(\\w[\\w.]*)\", line)\n        if m:\n            module = m.group(1)\n            candidate = module.replace(\".\", \"/\") + \".py\"\n            if candidate in all_paths:\n                deps.append(candidate)\n\n    return deps\n\n\ndef _extract_js_imports(path: str, content: str, all_paths: set[str]) -> list[str]:\n    \"\"\"Extract local JS/TS imports.\"\"\"\n    deps: list[str] = []\n    file_dir = str(Path(path).parent)\n\n    # import ... from './module' or require('./module')\n    pattern = re.compile(r'''(?:import\\s+.*?from\\s+|require\\s*\\(\\s*)['\"](\\.[^'\"]+)['\"]''')\n\n    for m in pattern.finditer(content):\n        rel_import = m.group(1)\n        # Resolve relative path\n        if file_dir == \".\":\n            candidate_base = rel_import.lstrip(\"./\")\n        else:\n            candidate_base = str(Path(file_dir) / rel_import.lstrip(\"./\"))\n\n        # Try various extensions\n        for ext in (\"\", \".js\", \".jsx\", \".ts\", \".tsx\", \"/index.js\", \"/index.tsx\", \"/index.ts\"):\n            candidate = candidate_base + ext\n            if candidate in all_paths:\n                deps.append(candidate)\n                break\n\n    return deps\n\n\n# \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n# Full project scan \u2192 ContextManager\n# \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n\ndef scan_project(project_dir: Path) -> ContextManager:\n    \"\"\"\n    Perform a complete scan of an existing project and return\n    a fully populated ContextManager.\n\n    This is the main entry point \u2014 used when JCode is launched\n    inside an existing project directory.\n    \"\"\"\n    console.print(f\"  [dim]Scanning project...[/dim]\")\n\n    # 1. Detect project type and tech stack\n    project_type = detect_project_type(project_dir)\n    tech_stack = detect_tech_stack(project_dir)\n\n    console.print(f\"  [cyan]Project type:[/cyan] {project_type}\")\n    if tech_stack:\n        console.print(f\"  [cyan]Tech stack:[/cyan] {', '.join(tech_stack)}\")\n\n    # 2. Scan all source files\n    files = scan_files(project_dir)\n    file_count = len(files)\n    console.print(f\"  [cyan]Files found:[/cyan] {file_count}\")\n\n    # 3. Build file index\n    file_index = build_file_index(files)\n\n    # 4. Build dependency graph\n    dep_graph = build_dependency_graph(files)\n\n    # 5. Create ProjectState\n    state = ProjectState(\n        name=project_dir.name,\n        description=f\"{project_type} project\",\n        tech_stack=tech_stack,\n        output_dir=project_dir,\n        files=files,\n        file_index=file_index,\n        dependency_graph=dep_graph,\n        architecture_summary=_build_architecture_summary(\n            project_dir.name, project_type, tech_stack, file_index,\n        ),\n    )\n\n    # 6. Create ContextManager\n    ctx = ContextManager(state)\n\n    console.print(f\"  [dim]Project context loaded ({file_count} files)[/dim]\")\n    return ctx\n\n\ndef _build_architecture_summary(\n    name: str,\n    project_type: str,\n    tech_stack: list[str],\n    file_index: dict[str, str],\n) -> str:\n    \"\"\"Build a brief architecture summary from scanned data.\"\"\"\n    parts = [\n        f\"{name} is a {project_type} project\",\n    ]\n    if tech_stack:\n        parts[0] += f\" using {', '.join(tech_stack[:5])}\"\n    parts[0] += \".\"\n\n    # Count by directory\n    dirs: dict[str, int] = {}\n    for path in file_index:\n        d = str(Path(path).parent)\n        if d == \".\":\n            d = \"(root)\"\n        dirs[d] = dirs.get(d, 0) + 1\n\n    if dirs:\n        dir_summary = \", \".join(\n            f\"{d} ({c} files)\" for d, c in sorted(dirs.items(), key=lambda x: -x[1])[:5]\n        )\n        parts.append(f\"Structure: {dir_summary}.\")\n\n    return \" \".join(parts)\n",
      "jcode/settings.py": "\"\"\"\nUser settings and persistent configuration.\nStored in ~/.jcode/settings.json\n\nv0.7.0 \u2014 Added git settings, CWD mode, agentic/chat mode preferences.\n\"\"\"\n\nfrom __future__ import annotations\n\nimport json\nfrom pathlib import Path\nfrom dataclasses import dataclass, asdict\n\n\n@dataclass\nclass UserSettings:\n    \"\"\"Persistent user settings.\"\"\"\n    default_output_dir: str = \"~/jcode_projects\"\n    auto_save_sessions: bool = True\n    last_project: str = \"\"\n    autonomous_access: bool | None = None   # None = never asked\n    internet_access: bool | None = None     # None = never asked\n\n    # v0.7.0 \u2014 Git integration\n    git_auto_commit: bool = True            # Auto-commit after builds/modifications\n    git_auto_push: bool = False             # Auto-push after commits (needs remote)\n    git_default_remote: str = \"origin\"\n\n    # v0.7.0 \u2014 Mode preference\n    default_mode: str = \"agentic\"           # \"agentic\" or \"chat\"\n\n    # v0.7.0 \u2014 CWD mode (operate in current directory)\n    cwd_mode: bool = True                   # Use CWD instead of ~/jcode_projects\n\n    def to_dict(self) -> dict:\n        return asdict(self)\n\n    @classmethod\n    def from_dict(cls, data: dict) -> UserSettings:\n        # Filter to known fields only for forward-compat\n        known = {f.name for f in cls.__dataclass_fields__.values()}\n        filtered = {k: v for k, v in data.items() if k in known}\n        return cls(**filtered)\n\n\nclass SettingsManager:\n    \"\"\"Manages user settings persistence.\"\"\"\n    \n    def __init__(self):\n        self.config_dir = Path.home() / \".jcode\"\n        self.settings_file = self.config_dir / \"settings.json\"\n        self.projects_dir = self.config_dir / \"projects\"\n        self.settings = self._load_settings()\n    \n    def _load_settings(self) -> UserSettings:\n        \"\"\"Load settings from disk or create defaults.\"\"\"\n        if self.settings_file.exists():\n            try:\n                data = json.loads(self.settings_file.read_text())\n                return UserSettings.from_dict(data)\n            except Exception:\n                pass\n        return UserSettings()\n    \n    def save_settings(self) -> None:\n        \"\"\"Persist settings to disk.\"\"\"\n        self.config_dir.mkdir(parents=True, exist_ok=True)\n        self.settings_file.write_text(\n            json.dumps(self.settings.to_dict(), indent=2)\n        )\n    \n    def is_first_run(self) -> bool:\n        \"\"\"Check if this is the user's first time running JCode.\"\"\"\n        return not self.settings_file.exists()\n    \n    def get_default_output_dir(self) -> Path:\n        \"\"\"Return the default output directory as a Path.\"\"\"\n        return Path(self.settings.default_output_dir).expanduser().resolve()\n    \n    def set_default_output_dir(self, path: str | Path) -> None:\n        \"\"\"Update the default output directory.\"\"\"\n        self.settings.default_output_dir = str(path)\n        self.save_settings()\n    \n    def get_projects_dir(self) -> Path:\n        \"\"\"Get the directory where project metadata is stored.\"\"\"\n        self.projects_dir.mkdir(parents=True, exist_ok=True)\n        return self.projects_dir\n    \n    def list_projects(self) -> list[dict]:\n        \"\"\"List all saved projects with metadata.\"\"\"\n        projects = []\n        if self.projects_dir.exists():\n            for proj_file in self.projects_dir.glob(\"*.json\"):\n                try:\n                    data = json.loads(proj_file.read_text())\n                    projects.append(data)\n                except Exception:\n                    continue\n        return sorted(projects, key=lambda p: p.get(\"last_modified\", \"\"), reverse=True)\n    \n    def save_project_metadata(self, project_data: dict) -> None:\n        \"\"\"Save project metadata for later resumption.\"\"\"\n        self.projects_dir.mkdir(parents=True, exist_ok=True)\n        \n        # Use project name as filename (sanitized)\n        name = project_data.get(\"name\", \"unnamed\")\n        safe_name = \"\".join(c if c.isalnum() or c in \"._- \" else \"_\" for c in name)\n        safe_name = safe_name.strip().replace(\" \", \"_\").lower()\n        \n        proj_file = self.projects_dir / f\"{safe_name}.json\"\n        proj_file.write_text(json.dumps(project_data, indent=2))\n        \n        self.settings.last_project = str(proj_file)\n        self.save_settings()\n    \n    def load_project_metadata(self, project_name: str) -> dict | None:\n        \"\"\"Load project metadata by name.\"\"\"\n        safe_name = \"\".join(c if c.isalnum() or c in \"._- \" else \"_\" for c in project_name)\n        safe_name = safe_name.strip().replace(\" \", \"_\").lower()\n        \n        proj_file = self.projects_dir / f\"{safe_name}.json\"\n        if proj_file.exists():\n            return json.loads(proj_file.read_text())\n        return None\n    \n    def get_last_project(self) -> dict | None:\n        \"\"\"Get the most recently worked on project.\"\"\"\n        if self.settings.last_project and Path(self.settings.last_project).exists():\n            try:\n                return json.loads(Path(self.settings.last_project).read_text())\n            except Exception:\n                pass\n        return None\n",
      "jcode/task_graph.py": "\"\"\"\nTask Graph Engine \u2014 DAG-based parallel task orchestration.\n\nFeatures:\n  1. Directed Acyclic Graph with dependency resolution\n  2. Parallel execution of independent nodes\n  3. Deterministic wave-based scheduling\n  4. Integrates with WorkerPool for adaptive concurrency\n\nThe graph groups tasks into \"waves\":\n  Wave 0: tasks with no dependencies (all run in parallel)\n  Wave 1: tasks that depend only on wave-0 tasks (parallel)\n  Wave 2: ...etc\n\nWithin each wave, all tasks run concurrently via the WorkerPool.\n\"\"\"\n\nfrom __future__ import annotations\n\nfrom collections import defaultdict, deque\nfrom dataclasses import dataclass, field\nfrom typing import Any, Callable\n\nfrom rich.console import Console\n\nfrom jcode.config import TaskNode, TaskStatus\nfrom jcode.worker_pool import WorkerPool, WorkerResult\n\nconsole = Console()\n\n\ndef compute_waves(dag: list[TaskNode]) -> list[list[TaskNode]]:\n    \"\"\"\n    Compute execution waves from a task DAG using topological sort.\n\n    Returns a list of waves, where each wave is a list of TaskNodes\n    that can run in parallel (all dependencies are in earlier waves).\n\n    Raises ValueError if the graph contains a cycle.\n    \"\"\"\n    if not dag:\n        return []\n\n    # Build adjacency and in-degree\n    id_to_node = {t.id: t for t in dag}\n    in_degree: dict[int, int] = {t.id: 0 for t in dag}\n    dependents: dict[int, list[int]] = defaultdict(list)\n\n    for t in dag:\n        for dep in t.depends_on:\n            if dep in id_to_node:\n                in_degree[t.id] += 1\n                dependents[dep].append(t.id)\n\n    # BFS topological sort in layers\n    waves: list[list[TaskNode]] = []\n    queue = deque([tid for tid, deg in in_degree.items() if deg == 0])\n\n    processed = 0\n    while queue:\n        wave_ids = list(queue)\n        queue.clear()\n\n        wave_nodes = [id_to_node[tid] for tid in wave_ids]\n        waves.append(wave_nodes)\n        processed += len(wave_ids)\n\n        for tid in wave_ids:\n            for child in dependents.get(tid, []):\n                in_degree[child] -= 1\n                if in_degree[child] == 0:\n                    queue.append(child)\n\n    if processed < len(dag):\n        # Some nodes were never reached \u2014 cycle detected\n        unreached = [t for t in dag if t.id not in {n.id for w in waves for n in w}]\n        raise ValueError(\n            f\"Cycle detected in task DAG. Unreachable tasks: \"\n            f\"{[t.id for t in unreached]}\"\n        )\n\n    return waves\n\n\ndef get_ready_wave(dag: list[TaskNode]) -> list[TaskNode]:\n    \"\"\"\n    Get the next wave of tasks that are ready to execute.\n    A task is ready if:\n      - Its status is PENDING\n      - All dependencies are in a terminal state (VERIFIED / SKIPPED)\n    \"\"\"\n    terminal_ids = {\n        t.id for t in dag\n        if t.status in (TaskStatus.VERIFIED, TaskStatus.SKIPPED)\n    }\n    return [\n        t for t in dag\n        if t.status == TaskStatus.PENDING\n        and all(dep in terminal_ids for dep in t.depends_on)\n    ]\n\n\ndef execute_wave_parallel(\n    wave: list[TaskNode],\n    worker_fn: Callable[[TaskNode], Any],\n    pool: WorkerPool,\n) -> list[WorkerResult]:\n    \"\"\"\n    Execute a wave of tasks in parallel using the worker pool.\n\n    Args:\n        wave: List of TaskNodes to execute concurrently.\n        worker_fn: Function that processes a single TaskNode.\n                   Signature: (TaskNode) -> Any\n        pool: The WorkerPool to submit tasks to.\n\n    Returns:\n        List of WorkerResults, one per task.\n    \"\"\"\n    # Submit all tasks in the wave\n    futures = []\n    for node in wave:\n        future = pool.submit(worker_fn, node, task_id=node.id)\n        futures.append(future)\n\n    # Collect results (blocks until all complete)\n    return pool.collect(futures)\n\n\ndef get_dag_stats(dag: list[TaskNode]) -> dict:\n    \"\"\"Return statistics about the DAG execution state.\"\"\"\n    stats = {\n        \"total\": len(dag),\n        \"pending\": 0,\n        \"in_progress\": 0,\n        \"verified\": 0,\n        \"failed\": 0,\n        \"skipped\": 0,\n        \"waves\": 0,\n    }\n    for t in dag:\n        if t.status == TaskStatus.PENDING:\n            stats[\"pending\"] += 1\n        elif t.status in (TaskStatus.IN_PROGRESS, TaskStatus.GENERATED,\n                          TaskStatus.REVIEWING, TaskStatus.NEEDS_FIX):\n            stats[\"in_progress\"] += 1\n        elif t.status == TaskStatus.VERIFIED:\n            stats[\"verified\"] += 1\n        elif t.status == TaskStatus.FAILED:\n            stats[\"failed\"] += 1\n        elif t.status == TaskStatus.SKIPPED:\n            stats[\"skipped\"] += 1\n\n    try:\n        pending_nodes = [t for t in dag if not t.is_terminal]\n        if pending_nodes:\n            stats[\"waves\"] = len(compute_waves(pending_nodes))\n    except ValueError:\n        stats[\"waves\"] = -1  # cycle\n\n    return stats\n",
      "jcode/web.py": "\"\"\"\nWeb search & documentation reader for JCode.\n\nCapabilities:\n  1. web_search(query)       \u2014 Search the web via DuckDuckGo (no API key needed)\n  2. fetch_page(url)         \u2014 Fetch and extract text content from a URL\n  3. fetch_docs(url)         \u2014 Alias for fetch_page, focused on documentation\n  4. search_and_summarize()  \u2014 Search + fetch top result\n  5. research_task()         \u2014 Full research pipeline for heavy tasks (v0.9.0)\n  6. fetch_tech_docs()       \u2014 Fetch official docs for specific technologies\n\nRequires internet_access permission to be granted by the user.\n\nv0.9.0 \u2014 Research pipeline for heavy tasks: multi-query search,\n         tech-specific documentation fetching, parallel result gathering.\n\"\"\"\n\nfrom __future__ import annotations\n\nimport re\nimport json\nimport urllib.parse\nimport urllib.request\nfrom html.parser import HTMLParser\n\nfrom rich.console import Console\n\nconsole = Console()\n\n# \u2500\u2500 Global permission flag \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n_internet_allowed: bool = False\n\n\ndef set_internet_access(value: bool) -> None:\n    \"\"\"Set whether the agent may access the internet.\"\"\"\n    global _internet_allowed\n    _internet_allowed = value\n\n\ndef is_internet_allowed() -> bool:\n    \"\"\"Check the current internet access setting.\"\"\"\n    return _internet_allowed\n\n\n# \u2500\u2500 Simple HTML text extractor \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\nclass _TextExtractor(HTMLParser):\n    \"\"\"Strip HTML tags and extract visible text.\"\"\"\n\n    _skip_tags = {\"script\", \"style\", \"noscript\", \"svg\", \"path\", \"meta\", \"link\", \"head\"}\n\n    def __init__(self):\n        super().__init__()\n        self._parts: list[str] = []\n        self._skip_depth = 0\n\n    def handle_starttag(self, tag, attrs):\n        if tag.lower() in self._skip_tags:\n            self._skip_depth += 1\n\n    def handle_endtag(self, tag):\n        if tag.lower() in self._skip_tags:\n            self._skip_depth = max(0, self._skip_depth - 1)\n\n    def handle_data(self, data):\n        if self._skip_depth == 0:\n            text = data.strip()\n            if text:\n                self._parts.append(text)\n\n    def get_text(self) -> str:\n        raw = \"\\n\".join(self._parts)\n        # Collapse multiple blank lines\n        raw = re.sub(r\"\\n{3,}\", \"\\n\\n\", raw)\n        return raw.strip()\n\n\ndef _fetch_raw(url: str, timeout: int = 15) -> str:\n    \"\"\"Fetch raw HTML from a URL using only stdlib.\"\"\"\n    req = urllib.request.Request(\n        url,\n        headers={\n            \"User-Agent\": \"Mozilla/5.0 (compatible; JCode/0.4; +https://github.com/ShakenTheCoder/JcodeAgent)\",\n            \"Accept\": \"text/html,application/xhtml+xml,application/json,text/plain\",\n        },\n    )\n    with urllib.request.urlopen(req, timeout=timeout) as resp:\n        charset = resp.headers.get_content_charset() or \"utf-8\"\n        return resp.read().decode(charset, errors=\"replace\")\n\n\n# \u2500\u2500 Public API \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\ndef web_search(query: str, max_results: int = 5) -> list[dict[str, str]]:\n    \"\"\"\n    Search the web using DuckDuckGo Lite (no API key required).\n\n    Returns a list of dicts: [{\"title\": ..., \"url\": ..., \"snippet\": ...}, ...]\n    \"\"\"\n    if not _internet_allowed:\n        return [{\"title\": \"Internet access not granted\", \"url\": \"\", \"snippet\": \"\"}]\n\n    try:\n        encoded = urllib.parse.urlencode({\"q\": query})\n        url = f\"https://lite.duckduckgo.com/lite/?{encoded}\"\n        html = _fetch_raw(url, timeout=10)\n\n        results: list[dict[str, str]] = []\n        # Parse DDG Lite results \u2014 they use a table with class \"result-link\"\n        link_pattern = re.compile(\n            r'<a[^>]+class=\"result-link\"[^>]*href=\"([^\"]+)\"[^>]*>(.*?)</a>',\n            re.DOTALL,\n        )\n        snippet_pattern = re.compile(\n            r'<td[^>]+class=\"result-snippet\"[^>]*>(.*?)</td>',\n            re.DOTALL,\n        )\n\n        links = link_pattern.findall(html)\n        snippets = snippet_pattern.findall(html)\n\n        for i, (href, title) in enumerate(links[:max_results]):\n            title_clean = re.sub(r\"<[^>]+>\", \"\", title).strip()\n            snippet_clean = \"\"\n            if i < len(snippets):\n                snippet_clean = re.sub(r\"<[^>]+>\", \"\", snippets[i]).strip()\n            results.append({\n                \"title\": title_clean,\n                \"url\": href,\n                \"snippet\": snippet_clean,\n            })\n\n        if not results:\n            # Fallback: try DuckDuckGo JSON API (limited but sometimes works)\n            api_url = f\"https://api.duckduckgo.com/?q={urllib.parse.quote(query)}&format=json&no_html=1\"\n            raw = _fetch_raw(api_url, timeout=10)\n            data = json.loads(raw)\n            for topic in data.get(\"RelatedTopics\", [])[:max_results]:\n                if \"Text\" in topic:\n                    results.append({\n                        \"title\": topic.get(\"Text\", \"\")[:80],\n                        \"url\": topic.get(\"FirstURL\", \"\"),\n                        \"snippet\": topic.get(\"Text\", \"\"),\n                    })\n\n        return results or [{\"title\": \"No results found\", \"url\": \"\", \"snippet\": \"\"}]\n\n    except Exception as e:\n        return [{\"title\": f\"Search failed: {e}\", \"url\": \"\", \"snippet\": \"\"}]\n\n\ndef fetch_page(url: str, max_chars: int = 15000) -> str:\n    \"\"\"\n    Fetch a URL and return extracted text content.\n    Useful for reading documentation, READMEs, guides, etc.\n    Strips HTML tags and returns clean text.\n    \"\"\"\n    if not _internet_allowed:\n        return \"[Internet access not granted by user]\"\n\n    try:\n        html = _fetch_raw(url, timeout=15)\n\n        # If it looks like JSON, return it directly\n        if url.endswith(\".json\") or html.strip().startswith(\"{\"):\n            return html[:max_chars]\n\n        # If it looks like plain text / markdown\n        if url.endswith((\".md\", \".txt\", \".rst\")) or \"<html\" not in html.lower()[:500]:\n            return html[:max_chars]\n\n        # Parse HTML to text\n        extractor = _TextExtractor()\n        extractor.feed(html)\n        text = extractor.get_text()\n\n        return text[:max_chars] if text else \"(page returned no extractable text)\"\n\n    except Exception as e:\n        return f\"[Failed to fetch {url}: {e}]\"\n\n\ndef fetch_docs(url: str, max_chars: int = 15000) -> str:\n    \"\"\"Alias for fetch_page \u2014 reads documentation from a URL.\"\"\"\n    return fetch_page(url, max_chars)\n\n\ndef search_and_summarize(query: str) -> str:\n    \"\"\"\n    Search the web and fetch the top result's content.\n    Returns a formatted string with search results + top page content.\n    \"\"\"\n    if not _internet_allowed:\n        return \"[Internet access not granted by user]\"\n\n    results = web_search(query, max_results=3)\n    parts = [f\"Web search: {query}\\n\"]\n\n    for i, r in enumerate(results, 1):\n        parts.append(f\"  {i}. {r['title']}\")\n        if r[\"url\"]:\n            parts.append(f\"     {r['url']}\")\n        if r[\"snippet\"]:\n            parts.append(f\"     {r['snippet'][:150]}\")\n        parts.append(\"\")\n\n    # Fetch the top result for full context\n    top_url = next((r[\"url\"] for r in results if r[\"url\"]), None)\n    if top_url:\n        parts.append(f\"--- Top result content ({top_url}) ---\\n\")\n        content = fetch_page(top_url, max_chars=8000)\n        parts.append(content)\n\n    return \"\\n\".join(parts)\n\n\n# \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n# Research Pipeline \u2014 for heavy tasks (v0.9.0)\n# \u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n\n# Official documentation URLs for common technologies\n_TECH_DOCS: dict[str, list[str]] = {\n    \"react\": [\n        \"https://react.dev/learn\",\n    ],\n    \"next\": [\n        \"https://nextjs.org/docs/getting-started/installation\",\n    ],\n    \"nextjs\": [\n        \"https://nextjs.org/docs/getting-started/installation\",\n    ],\n    \"vue\": [\n        \"https://vuejs.org/guide/quick-start.html\",\n    ],\n    \"svelte\": [\n        \"https://svelte.dev/docs/introduction\",\n    ],\n    \"fastapi\": [\n        \"https://fastapi.tiangolo.com/tutorial/first-steps/\",\n    ],\n    \"flask\": [\n        \"https://flask.palletsprojects.com/en/stable/quickstart/\",\n    ],\n    \"django\": [\n        \"https://docs.djangoproject.com/en/5.1/intro/tutorial01/\",\n    ],\n    \"express\": [\n        \"https://expressjs.com/en/starter/hello-world.html\",\n    ],\n    \"tailwind\": [\n        \"https://tailwindcss.com/docs/installation\",\n    ],\n    \"prisma\": [\n        \"https://www.prisma.io/docs/getting-started/quickstart\",\n    ],\n    \"mongodb\": [\n        \"https://www.mongodb.com/docs/manual/tutorial/getting-started/\",\n    ],\n    \"postgres\": [\n        \"https://www.postgresql.org/docs/current/tutorial.html\",\n    ],\n    \"redis\": [\n        \"https://redis.io/docs/latest/get-started/\",\n    ],\n    \"docker\": [\n        \"https://docs.docker.com/get-started/\",\n    ],\n    \"stripe\": [\n        \"https://docs.stripe.com/get-started\",\n    ],\n    \"socket.io\": [\n        \"https://socket.io/docs/v4/tutorial/introduction\",\n    ],\n    \"websocket\": [\n        \"https://developer.mozilla.org/en-US/docs/Web/API/WebSockets_API\",\n    ],\n    \"graphql\": [\n        \"https://graphql.org/learn/\",\n    ],\n}\n\n\ndef _extract_technologies(prompt: str) -> list[str]:\n    \"\"\"Extract technology keywords from a prompt for targeted doc lookup.\"\"\"\n    lower = prompt.lower()\n    found: list[str] = []\n    for tech in _TECH_DOCS:\n        if tech in lower:\n            found.append(tech)\n    return found\n\n\ndef fetch_tech_docs(\n    technologies: list[str],\n    max_per_tech: int = 1,\n    max_chars: int = 5000,\n) -> dict[str, str]:\n    \"\"\"Fetch official documentation for specific technologies.\n\n    Returns a dict of {technology: doc_content}.\n    \"\"\"\n    if not _internet_allowed:\n        return {}\n\n    docs: dict[str, str] = {}\n    for tech in technologies:\n        urls = _TECH_DOCS.get(tech, [])\n        for url in urls[:max_per_tech]:\n            try:\n                content = fetch_page(url, max_chars=max_chars)\n                if content and not content.startswith(\"[Failed\"):\n                    docs[tech] = content\n                    break\n            except Exception:\n                continue\n\n    return docs\n\n\ndef research_task(\n    prompt: str,\n    max_search_queries: int = 3,\n    max_doc_pages: int = 3,\n) -> str:\n    \"\"\"\n    Full research pipeline for heavy tasks.\n\n    Steps:\n    1. Extract technologies from the prompt\n    2. Generate search queries based on the task\n    3. Search the web for each query\n    4. Fetch official docs for detected technologies\n    5. Compile all findings into a research brief\n\n    Returns a formatted research brief string.\n    \"\"\"\n    if not _internet_allowed:\n        return \"[Internet access not granted \u2014 skipping research]\"\n\n    console.print(\"  [dim]\ud83d\udd0d Researching task...[/dim]\")\n    parts: list[str] = []\n\n    # 1. Extract technologies\n    technologies = _extract_technologies(prompt)\n    if technologies:\n        console.print(f\"  [dim]   Technologies detected: {', '.join(technologies)}[/dim]\")\n\n    # 2. Generate search queries\n    queries = _generate_search_queries(prompt, technologies)\n\n    # 3. Web search for each query\n    all_results: list[dict[str, str]] = []\n    for i, query in enumerate(queries[:max_search_queries]):\n        console.print(f\"  [dim]   Searching: {query}[/dim]\")\n        results = web_search(query, max_results=3)\n        all_results.extend(results)\n\n    # Format search results\n    if all_results:\n        parts.append(\"## Web Search Results\\n\")\n        seen_urls: set[str] = set()\n        for r in all_results:\n            if r[\"url\"] and r[\"url\"] not in seen_urls:\n                seen_urls.add(r[\"url\"])\n                parts.append(f\"- **{r['title']}**\")\n                parts.append(f\"  {r['snippet'][:200]}\")\n                parts.append(f\"  URL: {r['url']}\\n\")\n\n    # 4. Fetch top search result pages (up to max_doc_pages)\n    fetched = 0\n    for r in all_results:\n        if fetched >= max_doc_pages:\n            break\n        url = r.get(\"url\", \"\")\n        if not url:\n            continue\n        console.print(f\"  [dim]   Reading: {url[:60]}...[/dim]\")\n        content = fetch_page(url, max_chars=4000)\n        if content and not content.startswith(\"[Failed\"):\n            parts.append(f\"\\n## Page: {r['title']}\\n\")\n            parts.append(content[:4000])\n            fetched += 1\n\n    # 5. Fetch official docs\n    if technologies:\n        console.print(f\"  [dim]   Fetching official docs...[/dim]\")\n        tech_docs = fetch_tech_docs(technologies, max_chars=4000)\n        for tech, content in tech_docs.items():\n            parts.append(f\"\\n## Official Docs: {tech}\\n\")\n            parts.append(content[:4000])\n\n    research_text = \"\\n\".join(parts)\n\n    if not research_text.strip():\n        return \"[No relevant research found]\"\n\n    # Truncate total research to avoid overwhelming the context\n    max_total = 20000\n    if len(research_text) > max_total:\n        research_text = research_text[:max_total] + \"\\n\\n[... truncated ...]\"\n\n    console.print(f\"  [dim]   \u2713 Research complete ({len(research_text)} chars)[/dim]\")\n    return research_text\n\n\ndef _generate_search_queries(prompt: str, technologies: list[str]) -> list[str]:\n    \"\"\"Generate targeted search queries from the task prompt.\"\"\"\n    queries: list[str] = []\n\n    # Main task query\n    # Take first 80 chars of the prompt as the primary query\n    primary = prompt[:80].strip()\n    if primary:\n        queries.append(f\"{primary} tutorial implementation\")\n\n    # Technology-specific queries\n    for tech in technologies[:2]:\n        queries.append(f\"{tech} best practices 2025 implementation guide\")\n\n    # If there are specific patterns in the prompt\n    lower = prompt.lower()\n    if \"auth\" in lower:\n        queries.append(\"authentication implementation best practices 2025\")\n    if \"database\" in lower or \"postgres\" in lower or \"mongo\" in lower:\n        queries.append(\"database schema design best practices\")\n    if \"api\" in lower and \"rest\" in lower:\n        queries.append(\"REST API design best practices\")\n    if \"websocket\" in lower or \"real-time\" in lower:\n        queries.append(\"websocket implementation best practices\")\n    if \"docker\" in lower:\n        queries.append(\"Dockerfile best practices multi-stage build\")\n\n    return queries[:5]  # Cap at 5 queries\n",
      "jcode/worker_pool.py": "\"\"\"\nWorker Pool \u2014 adaptive concurrency engine with CPU-aware throttling.\n\nFeatures:\n  1. Queue-based task dispatch\n  2. Up to MAX_WORKERS concurrent threads\n  3. CPU usage monitoring \u2014 scales workers up/down\n  4. Per-task result collection\n  5. Deterministic ordering of results\n\nUsage:\n    pool = WorkerPool()\n    futures = pool.submit_batch(tasks, worker_fn)\n    results = pool.collect(futures)\n    pool.shutdown()\n\"\"\"\n\nfrom __future__ import annotations\n\nimport os\nimport time\nimport threading\nfrom concurrent.futures import ThreadPoolExecutor, Future\nfrom dataclasses import dataclass, field\nfrom datetime import datetime\nfrom typing import Any, Callable, TypeVar\n\nfrom rich.console import Console\n\nfrom jcode.config import (\n    MAX_WORKERS,\n    MIN_WORKERS,\n    CPU_HIGH_THRESHOLD,\n    CPU_LOW_THRESHOLD,\n    WORKER_POLL_INTERVAL,\n)\n\nconsole = Console()\n\nT = TypeVar(\"T\")\n\n\n@dataclass\nclass WorkerResult:\n    \"\"\"Result from a single worker task.\"\"\"\n    task_id: int\n    success: bool\n    result: Any = None\n    error: str = \"\"\n    duration_ms: int = 0\n\n\nclass WorkerPool:\n    \"\"\"\n    Adaptive thread pool with CPU-aware concurrency.\n\n    - Starts with MAX_WORKERS threads\n    - Monitors CPU usage and adjusts concurrency\n    - Provides submit_batch / collect API\n    - Thread-safe via internal locks\n    \"\"\"\n\n    def __init__(self, max_workers: int | None = None) -> None:\n        self._max = max_workers or MAX_WORKERS\n        self._current_workers = min(self._max, 4)  # Start moderate\n        self._executor = ThreadPoolExecutor(max_workers=self._max)\n        self._lock = threading.Lock()\n        self._active_count = 0\n        self._semaphore = threading.Semaphore(self._current_workers)\n        self._monitor_thread: threading.Thread | None = None\n        self._shutdown = False\n\n        # Start CPU monitor\n        self._start_monitor()\n\n    def _start_monitor(self) -> None:\n        \"\"\"Start background CPU monitoring thread.\"\"\"\n        self._monitor_thread = threading.Thread(\n            target=self._cpu_monitor_loop, daemon=True\n        )\n        self._monitor_thread.start()\n\n    def _cpu_monitor_loop(self) -> None:\n        \"\"\"Periodically check CPU usage and adjust concurrency.\"\"\"\n        while not self._shutdown:\n            try:\n                cpu = self._get_cpu_usage()\n                with self._lock:\n                    old = self._current_workers\n                    if cpu > CPU_HIGH_THRESHOLD and self._current_workers > MIN_WORKERS:\n                        self._current_workers = max(MIN_WORKERS, self._current_workers - 1)\n                    elif cpu < CPU_LOW_THRESHOLD and self._current_workers < self._max:\n                        self._current_workers = min(self._max, self._current_workers + 1)\n\n                    if self._current_workers != old:\n                        # Adjust semaphore\n                        diff = self._current_workers - old\n                        if diff > 0:\n                            for _ in range(diff):\n                                self._semaphore.release()\n                        # If shrinking, the semaphore will naturally block new acquisitions\n            except Exception:\n                pass\n            time.sleep(WORKER_POLL_INTERVAL)\n\n    @staticmethod\n    def _get_cpu_usage() -> float:\n        \"\"\"Get current CPU usage percentage. Cross-platform.\"\"\"\n        try:\n            import psutil\n            return psutil.cpu_percent(interval=0.5)\n        except ImportError:\n            # Fallback: use os.getloadavg on Unix\n            try:\n                load1, _, _ = os.getloadavg()\n                cpu_count = os.cpu_count() or 1\n                return min(100.0, (load1 / cpu_count) * 100.0)\n            except (OSError, AttributeError):\n                return 50.0  # Assume moderate if we can't measure\n\n    def submit(\n        self,\n        fn: Callable[..., T],\n        *args: Any,\n        task_id: int = 0,\n        **kwargs: Any,\n    ) -> Future[WorkerResult]:\n        \"\"\"Submit a single task to the pool with concurrency throttling.\"\"\"\n\n        def _wrapped() -> WorkerResult:\n            # Acquire semaphore to respect concurrency limit\n            self._semaphore.acquire()\n            with self._lock:\n                self._active_count += 1\n\n            start = time.monotonic()\n            try:\n                result = fn(*args, **kwargs)\n                elapsed = int((time.monotonic() - start) * 1000)\n                return WorkerResult(\n                    task_id=task_id,\n                    success=True,\n                    result=result,\n                    duration_ms=elapsed,\n                )\n            except Exception as e:\n                elapsed = int((time.monotonic() - start) * 1000)\n                return WorkerResult(\n                    task_id=task_id,\n                    success=False,\n                    error=str(e),\n                    duration_ms=elapsed,\n                )\n            finally:\n                with self._lock:\n                    self._active_count -= 1\n                self._semaphore.release()\n\n        return self._executor.submit(_wrapped)\n\n    def submit_batch(\n        self,\n        tasks: list[dict],\n        fn: Callable[..., Any],\n    ) -> list[Future[WorkerResult]]:\n        \"\"\"\n        Submit a batch of tasks. Each task dict must have an 'id' key.\n        The function `fn` receives the task dict as its only argument.\n        \"\"\"\n        futures = []\n        for task in tasks:\n            future = self.submit(fn, task, task_id=task.get(\"id\", 0))\n            futures.append(future)\n        return futures\n\n    def collect(\n        self,\n        futures: list[Future[WorkerResult]],\n        timeout: float | None = None,\n    ) -> list[WorkerResult]:\n        \"\"\"\n        Wait for all futures and return results in submission order.\n        \"\"\"\n        results = []\n        for f in futures:\n            try:\n                result = f.result(timeout=timeout)\n                results.append(result)\n            except Exception as e:\n                results.append(WorkerResult(\n                    task_id=-1, success=False, error=str(e),\n                ))\n        return results\n\n    @property\n    def active_count(self) -> int:\n        \"\"\"Number of currently active workers.\"\"\"\n        with self._lock:\n            return self._active_count\n\n    @property\n    def current_concurrency(self) -> int:\n        \"\"\"Current concurrency limit (may be adjusted by CPU monitor).\"\"\"\n        with self._lock:\n            return self._current_workers\n\n    def shutdown(self, wait: bool = True) -> None:\n        \"\"\"Shutdown the pool.\"\"\"\n        self._shutdown = True\n        self._executor.shutdown(wait=wait)\n\n    def __enter__(self) -> \"WorkerPool\":\n        return self\n\n    def __exit__(self, *args) -> None:\n        self.shutdown()\n",
      "jcode.egg-info/SOURCES.txt": "README.md\npyproject.toml\njcode/__init__.py\njcode/__main__.py\njcode/analyzer.py\njcode/cli.py\njcode/coder.py\njcode/config.py\njcode/context.py\njcode/executor.py\njcode/file_manager.py\njcode/git_manager.py\njcode/intent.py\njcode/iteration.py\njcode/memory.py\njcode/ollama_client.py\njcode/planner.py\njcode/prompts.py\njcode/reviewer.py\njcode/scanner.py\njcode/settings.py\njcode/task_graph.py\njcode/web.py\njcode/worker_pool.py\njcode.egg-info/PKG-INFO\njcode.egg-info/SOURCES.txt\njcode.egg-info/dependency_links.txt\njcode.egg-info/entry_points.txt\njcode.egg-info/requires.txt\njcode.egg-info/top_level.txt",
      "jcode.egg-info/dependency_links.txt": "\n",
      "jcode.egg-info/entry_points.txt": "[console_scripts]\njcode = jcode.cli:main\n",
      "jcode.egg-info/requires.txt": "ollama>=0.4.0\nrich>=13.0\nprompt_toolkit>=3.0\npydantic>=2.0\n",
      "jcode.egg-info/top_level.txt": "jcode\n",
      "pyproject.toml": "[build-system]\nrequires = [\"setuptools>=68.0\", \"wheel\"]\nbuild-backend = \"setuptools.build_meta\"\n\n[project]\nname = \"jcode\"\nversion = \"0.9.9\"\ndescription = \"JCode \u2014 A local AI coding agent powered by Ollama\"\nreadme = \"README.md\"\nrequires-python = \">=3.10\"\nlicense = {text = \"MIT\"}\nauthors = [{name = \"Ioan Andrei\"}]\n\ndependencies = [\n    \"ollama>=0.4.0\",\n    \"rich>=13.0\",\n    \"prompt_toolkit>=3.0\",\n    \"pydantic>=2.0\",\n]\n\n[project.scripts]\njcode = \"jcode.cli:main\"\n\n[tool.setuptools.packages.find]\nwhere = [\".\"]\ninclude = [\"jcode*\"]\n",
      "requirements.txt": "ollama>=0.4.0\nrich>=13.0\nprompt_toolkit>=3.0\npydantic>=2.0\n"
    },
    "errors": [],
    "iteration": 0,
    "completed": false,
    "complexity": "medium",
    "size": "medium",
    "created_at": "",
    "last_modified": "2026-02-18T17:27:36.857156",
    "architecture_summary": "JcodeAgent is a Python project using Python. Structure: jcode (22 files), (root) (13 files), inactive/frontend (9 files), docs (6 files), inactive/frontend/components (6 files).",
    "file_index": {
      "BEGINNER_GUIDE.md": "md source file",
      "CHANGELOG.md": "md source file",
      "FEATURES.md": "md source file",
      "FRONTEND_SETUP_COMPLETE.md": "md source file",
      "MIGRATION.md": "md source file",
      "NEXTJS_MIGRATION_COMPLETE.md": "md source file",
      "QUICKSTART.md": "md source file",
      "README.md": "md source file",
      "TECHNICAL_GUIDE.md": "md source file",
      "VERCEL_DEPLOY.md": "md source file",
      "docs/ANALYTICS.md": "md source file",
      "docs/api/install.ps1.js": "js source file",
      "docs/api/install.sh.js": "js source file",
      "docs/api/stats.js": "js source file",
      "docs/beginner-guide.html": "html source file",
      "docs/index.html": "Entry point / main module",
      "docs/package.json": "Node.js package configuration",
      "docs/technical.html": "html source file",
      "docs/vercel.json": "json source file",
      "inactive/frontend/README.md": "md source file",
      "inactive/frontend/app/api/install.ps1/route.ts": "ts source file",
      "inactive/frontend/app/api/install.sh/route.ts": "ts source file",
      "inactive/frontend/app/api/stats/route.ts": "ts source file",
      "inactive/frontend/app/globals.css": "Global styles/config",
      "inactive/frontend/app/guide/guide.module.css": "css source file",
      "inactive/frontend/app/guide/page.tsx": "Page component",
      "inactive/frontend/app/layout.tsx": "Page layout",
      "inactive/frontend/app/page.module.css": "Page component",
      "inactive/frontend/app/page.tsx": "Page component",
      "inactive/frontend/app/technical/page.tsx": "Page component",
      "inactive/frontend/app/technical/technical.module.css": "css source file",
      "inactive/frontend/components/Footer.module.css": "css source file",
      "inactive/frontend/components/Footer.tsx": "tsx source file",
      "inactive/frontend/components/Header.module.css": "css source file",
      "inactive/frontend/components/Header.tsx": "tsx source file",
      "inactive/frontend/components/HomeComponents.tsx": "UI component",
      "inactive/frontend/components/ThemeProvider.tsx": "tsx source file",
      "inactive/frontend/next-env.d.ts": "ts source file",
      "inactive/frontend/next.config.js": "Next.js configuration",
      "inactive/frontend/package-lock.json": "json source file",
      "inactive/frontend/package.json": "Node.js package configuration",
      "inactive/frontend/postcss.config.js": "PostCSS configuration",
      "inactive/frontend/tailwind.config.ts": "Tailwind CSS configuration",
      "inactive/frontend/tsconfig.json": "TypeScript configuration",
      "inactive/frontend/types/cache-life.d.ts": "ts source file",
      "inactive/frontend/types/routes.d.ts": "Route definitions",
      "inactive/frontend/types/validator.ts": "ts source file",
      "inactive/frontend/vercel.json": "json source file",
      "install.sh": "sh source file",
      "jcode/__init__.py": "JCode \u2014 A local AI coding agent powered by Ollama.",
      "jcode/__main__.py": "Allow running JCode as a module: python -m jcode",
      "jcode/analyzer.py": "Analyzer module \u2014 parses errors/stack traces into actionable fixes.",
      "jcode/cli.py": "JCode CLI v0.9.8 \u2014 Intelligent multi-model orchestrator.",
      "jcode/coder.py": "Coder module \u2014 generates files and applies targeted patches.",
      "jcode/config.py": "JCode configuration \u2014 multi-model orchestration engine.",
      "jcode/context.py": "Structured memory engine \u2014 replaces raw context dumps with",
      "jcode/executor.py": "Execution & verification pipeline \u2014 the quality gate that makes JCode reliable.",
      "jcode/file_manager.py": "File system manager \u2014 creates project directories and writes files to disk.",
      "jcode/git_manager.py": "Git integration for JCode \u2014 version control, commits, push, GitHub.",
      "jcode/intent.py": "Intent router \u2014 lightweight classifier for user input.",
      "jcode/iteration.py": "Iteration engine v5.0 \u2014 Parallel DAG-based task execution.",
      "jcode/memory.py": "Project memory engine \u2014 vector-based retrieval-augmented generation (RAG).",
      "jcode/ollama_client.py": "Ollama client wrapper \u2014 talks to the local Ollama server.",
      "jcode/planner.py": "Planner module \u2014 uses the reasoning model to understand requests,",
      "jcode/prompts.py": "Prompt templates for all roles + modes:",
      "jcode/reviewer.py": "Reviewer module \u2014 code critic that catches bugs BEFORE execution.",
      "jcode/scanner.py": "Project scanner \u2014 reads an existing project directory and builds",
      "jcode/settings.py": "User settings and persistent configuration.",
      "jcode/task_graph.py": "Task Graph Engine \u2014 DAG-based parallel task orchestration.",
      "jcode/web.py": "Web search & documentation reader for JCode.",
      "jcode/worker_pool.py": "Worker Pool \u2014 adaptive concurrency engine with CPU-aware throttling.",
      "jcode.egg-info/SOURCES.txt": "txt source file",
      "jcode.egg-info/dependency_links.txt": "txt source file",
      "jcode.egg-info/entry_points.txt": "txt source file",
      "jcode.egg-info/requires.txt": "txt source file",
      "jcode.egg-info/top_level.txt": "txt source file",
      "pyproject.toml": "Python project configuration",
      "requirements.txt": "Python dependencies"
    },
    "dependency_graph": {
      "inactive/frontend/app/guide/page.tsx": [
        "inactive/frontend/app/guide/guide.module.css"
      ],
      "inactive/frontend/app/page.tsx": [
        "inactive/frontend/app/page.module.css"
      ],
      "inactive/frontend/app/technical/page.tsx": [
        "inactive/frontend/app/technical/technical.module.css"
      ],
      "inactive/frontend/components/Footer.tsx": [
        "inactive/frontend/components/Footer.module.css"
      ],
      "inactive/frontend/components/Header.tsx": [
        "inactive/frontend/components/ThemeProvider.tsx",
        "inactive/frontend/components/Header.module.css"
      ],
      "jcode/__main__.py": [
        "jcode/cli.py"
      ],
      "jcode/analyzer.py": [
        "jcode/ollama_client.py",
        "jcode/prompts.py",
        "jcode/context.py"
      ],
      "jcode/cli.py": [
        "jcode/config.py",
        "jcode/context.py",
        "jcode/planner.py",
        "jcode/iteration.py",
        "jcode/file_manager.py",
        "jcode/ollama_client.py",
        "jcode/settings.py",
        "jcode/executor.py",
        "jcode/web.py",
        "jcode/prompts.py",
        "jcode/intent.py",
        "jcode/scanner.py",
        "jcode/config.py"
      ],
      "jcode/coder.py": [
        "jcode/ollama_client.py",
        "jcode/prompts.py",
        "jcode/context.py"
      ],
      "jcode/context.py": [
        "jcode/config.py",
        "jcode/memory.py"
      ],
      "jcode/iteration.py": [
        "jcode/config.py",
        "jcode/context.py",
        "jcode/coder.py",
        "jcode/reviewer.py",
        "jcode/analyzer.py",
        "jcode/planner.py",
        "jcode/file_manager.py",
        "jcode/executor.py",
        "jcode/worker_pool.py",
        "jcode/task_graph.py"
      ],
      "jcode/memory.py": [
        "jcode/config.py"
      ],
      "jcode/ollama_client.py": [
        "jcode/config.py",
        "jcode/config.py"
      ],
      "jcode/planner.py": [
        "jcode/ollama_client.py",
        "jcode/prompts.py",
        "jcode/context.py"
      ],
      "jcode/reviewer.py": [
        "jcode/ollama_client.py",
        "jcode/prompts.py",
        "jcode/context.py"
      ],
      "jcode/scanner.py": [
        "jcode/config.py",
        "jcode/context.py"
      ],
      "jcode/task_graph.py": [
        "jcode/config.py",
        "jcode/worker_pool.py"
      ],
      "jcode/worker_pool.py": [
        "jcode/config.py"
      ]
    },
    "failure_log": [],
    "task_nodes": []
  },
  "planner_history": [],
  "coder_history": [],
  "chat_history": [],
  "memory": {
    "model": null,
    "embeddings": {}
  }
}